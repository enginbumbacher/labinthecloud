!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=76)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){return e&&e.__esModule?e:{default:e}}(n(8));var o={ensureDefaults:function(e,t){return i.default.extend(!0,{},t,e)},validateString:function(e,t){if("string"!=typeof e)return!1;switch(void 0===t?"undefined":r(t)){case"string":return e==t;case"function":return t(e);case"object":if(t instanceof RegExp)return t.test(e)}throw new Error("Validation is not acceptable type.")},guid4:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.floor(16*Math.random());return("x"==e?t:3&t|8).toString(16)})},guidReString:function(){return"[A-Fa-f0-9]{8}-(?:[A-Fa-f0-9]{4}-){3}[A-Fa-f0-9]{12}"},slugify:function(e){return e.toLowerCase().replace(/\s+/g,"_").replace(/[^\w]/g,"")},promiseErrorHandler:function(e){console.log(e.message,e.stack)},promiseAjax:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,r){t.url=e,t.success=function(e,t,r){n(e)},t.error=function(e,t,n){var i=new Error;i.statusCode=t,i.message=n,r(i)},i.default.ajax(t)})},posMod:function(e,t){for(;e<0;)e+=t;return e%t},isEmpty:function(e){return!e||e instanceof Array&&0==e.length||("string"==typeof e||e instanceof String)&&""==e},sortValue:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=void 0;return r=void 0!=e&&null!=e||void 0!=t&&null!=t?void 0==e||null==e?1:void 0==t||null==t?-1:e>t?1:e<t?-1:0:0,n||(r*=-1),r},sortValueIgnoreArticles:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return("string"==typeof e||e instanceof String)&&(e=e.replace(/^((the)|a)\s+/i,"")),("string"==typeof t||t instanceof String)&&(t=t.replace(/^((the)|a)\s+/i,"")),o.sortValue(e,t,n)},zeropad:function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n},isString:function(e){return e instanceof String||"string"==typeof e},isArray:function(e){return e instanceof Array},isNumeric:function(e){return i.default.isNumeric(e)},isJSON:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},ensureArray:function(e){return o.isArray(e)?e:[e]},clearTextSelection:function(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},md5:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){md5(e)}),objectValues:function(e){if(Object.values)return Object.values(e);var t=[];for(var n in e)t.push(e[n]);return t},exists:function(e){return void 0!==e&&null!==e},bindMethods:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e[s]=e[s].bind(e)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}},bindAllMethods:function(e){this.bindMethods(e,Object.keys(e).filter(function(t){return"function"==typeof e[t]}))},secondsToTimeString:function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60);return n<10&&(n="0"+n),r<10&&(r="0"+r),t+":"+n+":"+r},urlParam:function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var r=t[n].split("=");if(r[0]==e)return r[1]}return null},mouseTouchPosition:function(e){return e.pageX?{x:e.pageX,y:e.pageY}:e.type.match(/^touch/)?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:0,y:0}},decimalAdjust:function(e,t,n){return void 0===n||0==+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!=0?NaN:t<0?-o.decimalAdjust(e,-t,n):(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))},roundDecimal:function(e,t){return o.decimalAdjust("round",e,t)},ceilDecimal:function(e,t){return o.decimalAdjust("ceil",e,t)},floorDecimal:function(e,t){return o.decimalAdjust("floor",e,t)},TAU:2*Math.PI};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(13)),i=o(n(6));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{data:{},defaults:{}}));return e.set("Relay",new r.default),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=new a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._hooks={}}return r(e,[{key:"hook",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._hooks[e]=this._hooks[e]||[],this._hooks[e].push({callback:t,priorty:n})}},{key:"invoke",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._hooks[e]&&(this._hooks[e].sort(function(e,t){return t.priorty-e.priorty}),this._hooks[e].forEach(function(e){t=e.callback.call(null,t,n)})),t}}]),e}();t.default=new i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},o=s(n(80)),a=s(n(8));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.$el="string"==typeof e?(0,a.default)(a.default.parseHTML(e)):(0,a.default)(e),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"addChild",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addChild",this).call(this,e);var o=n?this.$el.find(n).first():this.$el;-1==r||o.children().length<=r?o.append(e.$dom()):e.$dom().insertBefore(o.children()[r])}},{key:"removeChild",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeChild",this).call(this,e),a.default.contains(this.dom(),e.dom())&&e.$dom().detach()}},{key:"$dom",value:function(){return this.$el}},{key:"dom",value:function(){return this.$el[0]}},{key:"show",value:function(){this.$el.show()}},{key:"hide",value:function(){this.$el.hide()}},{key:"bounds",value:function(){var e=this.$el.offset();return e.width=this.$el.outerWidth(),e.height=this.$el.outerHeight(),e}}]),t}();t.default=u},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(r),o=r.sources.map(function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"});return[n].concat(o).concat([i]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t,n){var r={},i=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),o=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),a=null,s=0,u=[],l=n(96);function c(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=r[i.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](i.parts[a]);for(;a<i.parts.length;a++)o.parts.push(m(i.parts[a],t))}else{var s=[];for(a=0;a<i.parts.length;a++)s.push(m(i.parts[a],t));r[i.id]={id:i.id,refs:1,parts:s}}}}function f(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function d(e,t){var n=o(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=u[u.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),u.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=o(e.insertAt.before,n);n.insertBefore(t,i)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function p(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return g(t,e.attrs),d(e,t),t}function g(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function m(e,t){var n,r,i,o;if(t.transform&&e.css){if(!(o=t.transform(e.css)))return function(){};e.css=o}if(t.singleton){var u=s++;n=a||(a=p(t)),r=y.bind(null,n,u,!1),i=y.bind(null,n,u,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",g(t,e.attrs),d(e,t),t}(t),r=function(e,t,n){var r=n.css,i=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(r=l(r));i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,t),i=function(){h(n),n.href&&URL.revokeObjectURL(n.href)}):(n=p(t),r=function(e,t){var n=t.css,r=t.media;r&&e.setAttribute("media",r);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){h(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=f(e,t);return c(n,t),function(e){for(var i=[],o=0;o<n.length;o++){var a=n[o];(s=r[a.id]).refs--,i.push(s)}e&&c(f(e,t),t);for(o=0;o<i.length;o++){var s;if(0===(s=i[o]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete r[s.id]}}}};var v=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function y(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=v(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(13)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={data:{},defaults:{}},u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e=o.default.ensureDefaults(e,s),n._data=o.default.ensureDefaults(e.data,e.defaults),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=void 0,r=void 0,i=void 0;n=e.split("."),r=this._data,t&&(i=[r]);var o=!0,a=!1,s=void 0;try{for(var u,l=n[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;if(r&&r.get&&"function"==typeof r.get&&r.get(c))r=r.get(c);else{if(!r||null===r[c]){r=null;break}r=r[c]}t&&i.push(r)}}catch(e){a=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}return t?i:r}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=void 0,i=void 0,o=void 0,a=void 0;if(t!=this.get(e)){r=e.split("."),i=this._data;for(var s=0;s<r.length;s++)o=r[s],s==r.length-1?(i.set&&"function"==typeof i.set?(a=i.get(o),i.set(o,t)):(a=i[o],null===t?(i[o]=null,delete i[o]):i[o]=t),this.dispatchEvent("Model.Change",{path:e,value:t,old:a},!0)):i.get&&"function"==typeof i.get?(i.get(o)||i.set(o,{}),i=i.get(o)):(i[o]||(i[o]={}),i=i[o])}else(n||t instanceof Array)&&this.dispatchEvent("Model.Change",{path:e,value:t},!0)}},{key:"update",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=e[a];"id"==a&&this._data.id||(this._data[a]=s)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.dispatchEvent("Model.Change",{path:null,value:e},!0)}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(24));var o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._active=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"enable",value:function(){this._active=!0,this.dispatchEvent("Component.Enabled",{})}},{key:"disable",value:function(){this._active=!1,this.dispatchEvent("Component.Disabled",{})}},{key:"hide",value:function(){this._active=!1,this.dispatchEvent("Component.Hidden",{})}},{key:"isActive",value:function(){return this._active}}]),t}();t.default=o},function(e,t,n){var r;
/*!
 * jQuery JavaScript Library v3.3.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2018-01-20T17:24Z
 */
/*!
 * jQuery JavaScript Library v3.3.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2018-01-20T17:24Z
 */
!function(t,n){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,function(n,i){"use strict";var o=[],a=n.document,s=Object.getPrototypeOf,u=o.slice,l=o.concat,c=o.push,f=o.indexOf,d={},h=d.toString,p=d.hasOwnProperty,g=p.toString,m=g.call(Object),v={},y=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},_=function(e){return null!=e&&e===e.window},b={type:!0,src:!0,noModule:!0};function w(e,t,n){var r,i=(t=t||a).createElement("script");if(i.text=e,n)for(r in b)n[r]&&(i[r]=n[r]);t.head.appendChild(i).parentNode.removeChild(i)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?d[h.call(e)]||"object":typeof e}var E=function(e,t){return new E.fn.init(e,t)},M=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function C(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!y(e)&&!_(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}E.fn=E.prototype={jquery:"3.3.1",constructor:E,length:0,toArray:function(){return u.call(this)},get:function(e){return null==e?u.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=E.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return E.each(this,e)},map:function(e){return this.pushStack(E.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(u.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},E.extend=E.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||y(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&&(l&&r&&(E.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&E.isPlainObject(n)?n:{},a[t]=E.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},E.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==h.call(e))&&(!(t=s(e))||"function"==typeof(n=p.call(t,"constructor")&&t.constructor)&&g.call(n)===m)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){w(e)},each:function(e,t){var n,r=0;if(C(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(M,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(C(Object(e))?E.merge(n,"string"==typeof e?[e]:e):c.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:f.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(C(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return l.apply([],a)},guid:1,support:v}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=o[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){d["[object "+t+"]"]=t.toLowerCase()});var T=
/*!
 * Sizzle CSS Selector Engine v2.3.3
 * https://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-08-08
 */
function(e){var t,n,r,i,o,a,s,u,l,c,f,d,h,p,g,m,v,y,_,b="sizzle"+1*new Date,w=e.document,x=0,E=0,M=ae(),C=ae(),T=ae(),S=function(e,t){return e===t&&(f=!0),0},O={}.hasOwnProperty,k=[],A=k.pop,P=k.push,R=k.push,L=k.slice,j=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},D="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",F="\\["+N+"*("+I+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+N+"*\\]",B=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",U=new RegExp(N+"+","g"),z=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),V=new RegExp("^"+N+"*,"+N+"*"),H=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),q=new RegExp("="+N+"*([^\\]'\"]*?)"+N+"*\\]","g"),G=new RegExp(B),W=new RegExp("^"+I+"$"),X={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+D+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,$=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,K=/[+~]/,Q=new RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),ee=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ne=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},re=function(){d()},ie=ye(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{R.apply(k=L.call(w.childNodes),w.childNodes),k[w.childNodes.length].nodeType}catch(e){R={apply:k.length?function(e,t){P.apply(e,L.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function oe(e,t,r,i){var o,s,l,c,f,p,v,y=t&&t.ownerDocument,x=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==x&&9!==x&&11!==x)return r;if(!i&&((t?t.ownerDocument||t:w)!==h&&d(t),t=t||h,g)){if(11!==x&&(f=Z.exec(e)))if(o=f[1]){if(9===x){if(!(l=t.getElementById(o)))return r;if(l.id===o)return r.push(l),r}else if(y&&(l=y.getElementById(o))&&_(t,l)&&l.id===o)return r.push(l),r}else{if(f[2])return R.apply(r,t.getElementsByTagName(e)),r;if((o=f[3])&&n.getElementsByClassName&&t.getElementsByClassName)return R.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!T[e+" "]&&(!m||!m.test(e))){if(1!==x)y=t,v=e;else if("object"!==t.nodeName.toLowerCase()){for((c=t.getAttribute("id"))?c=c.replace(te,ne):t.setAttribute("id",c=b),s=(p=a(e)).length;s--;)p[s]="#"+c+" "+ve(p[s]);v=p.join(","),y=K.test(e)&&ge(t.parentNode)||t}if(v)try{return R.apply(r,y.querySelectorAll(v)),r}catch(e){}finally{c===b&&t.removeAttribute("id")}}}return u(e.replace(z,"$1"),t,r,i)}function ae(){var e=[];return function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function se(e){return e[b]=!0,e}function ue(e){var t=h.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){for(var n=e.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=t}function ce(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function de(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function he(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ie(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function pe(e){return se(function(t){return t=+t,se(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function ge(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=oe.support={},o=oe.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},d=oe.setDocument=function(e){var t,i,a=e?e.ownerDocument||e:w;return a!==h&&9===a.nodeType&&a.documentElement?(p=(h=a).documentElement,g=!o(h),w!==h&&(i=h.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",re,!1):i.attachEvent&&i.attachEvent("onunload",re)),n.attributes=ue(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ue(function(e){return e.appendChild(h.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=J.test(h.getElementsByClassName),n.getById=ue(function(e){return p.appendChild(e).id=b,!h.getElementsByName||!h.getElementsByName(b).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(Q,ee);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(Q,ee);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],m=[],(n.qsa=J.test(h.querySelectorAll))&&(ue(function(e){p.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+N+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+N+"*(?:value|"+D+")"),e.querySelectorAll("[id~="+b+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||m.push(".#.+[+~]")}),ue(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=h.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+N+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=J.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ue(function(e){n.disconnectedMatch=y.call(e,"*"),y.call(e,"[s!='']:x"),v.push("!=",B)}),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),t=J.test(p.compareDocumentPosition),_=t||J.test(p.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},S=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===h||e.ownerDocument===w&&_(w,e)?-1:t===h||t.ownerDocument===w&&_(w,t)?1:c?j(c,e)-j(c,t):0:4&r?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e===h?-1:t===h?1:i?-1:o?1:c?j(c,e)-j(c,t):0;if(i===o)return ce(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?ce(a[r],s[r]):a[r]===w?-1:s[r]===w?1:0},h):h},oe.matches=function(e,t){return oe(e,null,null,t)},oe.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&d(e),t=t.replace(q,"='$1']"),n.matchesSelector&&g&&!T[t+" "]&&(!v||!v.test(t))&&(!m||!m.test(t)))try{var r=y.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return oe(t,h,null,[e]).length>0},oe.contains=function(e,t){return(e.ownerDocument||e)!==h&&d(e),_(e,t)},oe.attr=function(e,t){(e.ownerDocument||e)!==h&&d(e);var i=r.attrHandle[t.toLowerCase()],o=i&&O.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},oe.escape=function(e){return(e+"").replace(te,ne)},oe.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},oe.uniqueSort=function(e){var t,r=[],i=0,o=0;if(f=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(S),f){for(;t=e[o++];)t===e[o]&&(i=r.push(o));for(;i--;)e.splice(r[i],1)}return c=null,e},i=oe.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=i(t);return n},(r=oe.selectors={cacheLength:50,createPseudo:se,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Q,ee),e[3]=(e[3]||e[4]||e[5]||"").replace(Q,ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||oe.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&oe.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&G.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Q,ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=M[e+" "];return t||(t=new RegExp("(^|"+N+")"+e+"("+N+"|$)"))&&M(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=oe.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(U," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,d,h,p,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!u&&!s,_=!1;if(m){if(o){for(;g;){for(d=t;d=d[g];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?m.firstChild:m.lastChild],a&&y){for(_=(h=(l=(c=(f=(d=m)[b]||(d[b]={}))[d.uniqueID]||(f[d.uniqueID]={}))[e]||[])[0]===x&&l[1])&&l[2],d=h&&m.childNodes[h];d=++h&&d&&d[g]||(_=h=0)||p.pop();)if(1===d.nodeType&&++_&&d===t){c[e]=[x,h,_];break}}else if(y&&(_=h=(l=(c=(f=(d=t)[b]||(d[b]={}))[d.uniqueID]||(f[d.uniqueID]={}))[e]||[])[0]===x&&l[1]),!1===_)for(;(d=++h&&d&&d[g]||(_=h=0)||p.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++_||(y&&((c=(f=d[b]||(d[b]={}))[d.uniqueID]||(f[d.uniqueID]={}))[e]=[x,_]),d!==t)););return(_-=i)===r||_%r==0&&_/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||oe.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,n){for(var r,o=i(e,t),a=o.length;a--;)e[r=j(e,o[a])]=!(n[r]=o[a])}):function(e){return i(e,0,n)}):i}},pseudos:{not:se(function(e){var t=[],n=[],r=s(e.replace(z,"$1"));return r[b]?se(function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:se(function(e){return function(t){return oe(e,t).length>0}}),contains:se(function(e){return e=e.replace(Q,ee),function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:se(function(e){return W.test(e||"")||oe.error("unsupported lang: "+e),e=e.replace(Q,ee).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:he(!1),disabled:he(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return $.test(e.nodeName)},input:function(e){return Y.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:pe(function(){return[0]}),last:pe(function(e,t){return[t-1]}),eq:pe(function(e,t,n){return[n<0?n+t:n]}),even:pe(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:pe(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:pe(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:pe(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=de(t);function me(){}function ve(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ye(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=E++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,u){var l,c,f,d=[x,s];if(u){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,u))return!0}else for(;t=t[r];)if(1===t.nodeType||a)if(c=(f=t[b]||(t[b]={}))[t.uniqueID]||(f[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((l=c[o])&&l[0]===x&&l[1]===s)return d[2]=l[2];if(c[o]=d,d[2]=e(t,n,u))return!0}return!1}}function _e(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function be(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function we(e,t,n,r,i,o){return r&&!r[b]&&(r=we(r)),i&&!i[b]&&(i=we(i,o)),se(function(o,a,s,u){var l,c,f,d=[],h=[],p=a.length,g=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)oe(e,t[r],n);return n}(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:be(g,d,e,s,u),v=n?i||(o?e:p||r)?[]:a:m;if(n&&n(m,v,s,u),r)for(l=be(v,h),r(l,[],s,u),c=l.length;c--;)(f=l[c])&&(v[h[c]]=!(m[h[c]]=f));if(o){if(i||e){if(i){for(l=[],c=v.length;c--;)(f=v[c])&&l.push(m[c]=f);i(null,v=[],l,u)}for(c=v.length;c--;)(f=v[c])&&(l=i?j(o,f):d[c])>-1&&(o[l]=!(a[l]=f))}}else v=be(v===a?v.splice(p,v.length):v),i?i(null,a,v,u):R.apply(a,v)})}function xe(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],u=a?1:0,c=ye(function(e){return e===t},s,!0),f=ye(function(e){return j(t,e)>-1},s,!0),d=[function(e,n,r){var i=!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):f(e,n,r));return t=null,i}];u<o;u++)if(n=r.relative[e[u].type])d=[ye(_e(d),n)];else{if((n=r.filter[e[u].type].apply(null,e[u].matches))[b]){for(i=++u;i<o&&!r.relative[e[i].type];i++);return we(u>1&&_e(d),u>1&&ve(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(z,"$1"),n,u<i&&xe(e.slice(u,i)),i<o&&xe(e=e.slice(i)),i<o&&ve(e))}d.push(n)}return _e(d)}return me.prototype=r.filters=r.pseudos,r.setFilters=new me,a=oe.tokenize=function(e,t){var n,i,o,a,s,u,l,c=C[e+" "];if(c)return t?0:c.slice(0);for(s=e,u=[],l=r.preFilter;s;){for(a in n&&!(i=V.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=H.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(z," ")}),s=s.slice(n.length)),r.filter)!(i=X[a].exec(s))||l[a]&&!(i=l[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return t?s.length:s?oe.error(e):C(e,u).slice(0)},s=oe.compile=function(e,t){var n,i=[],o=[],s=T[e+" "];if(!s){for(t||(t=a(e)),n=t.length;n--;)(s=xe(t[n]))[b]?i.push(s):o.push(s);(s=T(e,function(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,u,c){var f,p,m,v=0,y="0",_=o&&[],b=[],w=l,E=o||i&&r.find.TAG("*",c),M=x+=null==w?1:Math.random()||.1,C=E.length;for(c&&(l=a===h||a||c);y!==C&&null!=(f=E[y]);y++){if(i&&f){for(p=0,a||f.ownerDocument===h||(d(f),s=!g);m=e[p++];)if(m(f,a||h,s)){u.push(f);break}c&&(x=M)}n&&((f=!m&&f)&&v--,o&&_.push(f))}if(v+=y,n&&y!==v){for(p=0;m=t[p++];)m(_,b,a,s);if(o){if(v>0)for(;y--;)_[y]||b[y]||(b[y]=A.call(u));b=be(b)}R.apply(u,b),c&&!o&&b.length>0&&v+t.length>1&&oe.uniqueSort(u)}return c&&(x=M,l=w),_};return n?se(o):o}(o,i))).selector=e}return s},u=oe.select=function(e,t,n,i){var o,u,l,c,f,d="function"==typeof e&&e,h=!i&&a(e=d.selector||e);if(n=n||[],1===h.length){if((u=h[0]=h[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===t.nodeType&&g&&r.relative[u[1].type]){if(!(t=(r.find.ID(l.matches[0].replace(Q,ee),t)||[])[0]))return n;d&&(t=t.parentNode),e=e.slice(u.shift().value.length)}for(o=X.needsContext.test(e)?0:u.length;o--&&(l=u[o],!r.relative[c=l.type]);)if((f=r.find[c])&&(i=f(l.matches[0].replace(Q,ee),K.test(u[0].type)&&ge(t.parentNode)||t))){if(u.splice(o,1),!(e=i.length&&ve(u)))return R.apply(n,i),n;break}}return(d||s(e,h))(i,t,!g,n,!t||K.test(e)&&ge(t.parentNode)||t),n},n.sortStable=b.split("").sort(S).join("")===b,n.detectDuplicates=!!f,d(),n.sortDetached=ue(function(e){return 1&e.compareDocumentPosition(h.createElement("fieldset"))}),ue(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ue(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ue(function(e){return null==e.getAttribute("disabled")})||le(D,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),oe}(n);E.find=T,E.expr=T.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=T.uniqueSort,E.text=T.getText,E.isXMLDoc=T.isXML,E.contains=T.contains,E.escapeSelector=T.escape;var S=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&E(e).is(n))break;r.push(e)}return r},O=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=E.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var P=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function R(e,t,n){return y(t)?E.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?E.grep(e,function(e){return e===t!==n}):"string"!=typeof t?E.grep(e,function(e){return f.call(t,e)>-1!==n}):E.filter(t,e,n)}E.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?E.find.matchesSelector(r,e)?[r]:[]:E.find.matches(e,E.grep(t,function(e){return 1===e.nodeType}))},E.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(E(e).filter(function(){for(t=0;t<r;t++)if(E.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)E.find(e,i[t],n);return r>1?E.uniqueSort(n):n},filter:function(e){return this.pushStack(R(this,e||[],!1))},not:function(e){return this.pushStack(R(this,e||[],!0))},is:function(e){return!!R(this,"string"==typeof e&&k.test(e)?E(e):e||[],!1).length}});var L,j=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||L,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:j.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof E?t[0]:t,E.merge(this,E.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:a,!0)),P.test(r[1])&&E.isPlainObject(t))for(r in t)y(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=a.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):y(e)?void 0!==n.ready?n.ready(e):e(E):E.makeArray(e,this)}).prototype=E.fn,L=E(a);var D=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function I(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}E.fn.extend({has:function(e){var t=E(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(E.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&E(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&E.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?E.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?f.call(E(e),this[0]):f.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),E.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return S(e,"parentNode")},parentsUntil:function(e,t,n){return S(e,"parentNode",n)},next:function(e){return I(e,"nextSibling")},prev:function(e){return I(e,"previousSibling")},nextAll:function(e){return S(e,"nextSibling")},prevAll:function(e){return S(e,"previousSibling")},nextUntil:function(e,t,n){return S(e,"nextSibling",n)},prevUntil:function(e,t,n){return S(e,"previousSibling",n)},siblings:function(e){return O((e.parentNode||{}).firstChild,e)},children:function(e){return O(e.firstChild)},contents:function(e){return A(e,"iframe")?e.contentDocument:(A(e,"template")&&(e=e.content||e),E.merge([],e.childNodes))}},function(e,t){E.fn[e]=function(n,r){var i=E.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=E.filter(r,i)),this.length>1&&(N[e]||E.uniqueSort(i),D.test(e)&&i.reverse()),this.pushStack(i)}});var F=/[^\x20\t\r\n\f]+/g;function B(e){return e}function U(e){throw e}function z(e,t,n,r){var i;try{e&&y(i=e.promise)?i.call(e).done(t).fail(n):e&&y(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}E.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return E.each(e.match(F)||[],function(e,n){t[n]=!0}),t}(e):E.extend({},e);var t,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||e.once,r=t=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){E.each(n,function(n,r){y(r)?e.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==x(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return E.each(arguments,function(e,t){for(var n;(n=E.inArray(t,o,n))>-1;)o.splice(n,1),n<=s&&s--}),this},has:function(e){return e?E.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},E.extend({Deferred:function(e){var t=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return E.Deferred(function(n){E.each(t,function(t,r){var i=y(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&y(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(e,r,i){var o=0;function a(e,t,r,i){return function(){var s=this,u=arguments,l=function(){var n,l;if(!(e<o)){if((n=r.apply(s,u))===t.promise())throw new TypeError("Thenable self-resolution");l=n&&("object"==typeof n||"function"==typeof n)&&n.then,y(l)?i?l.call(n,a(o,t,B,i),a(o,t,U,i)):(o++,l.call(n,a(o,t,B,i),a(o,t,U,i),a(o,t,B,t.notifyWith))):(r!==B&&(s=void 0,u=[n]),(i||t.resolveWith)(s,u))}},c=i?l:function(){try{l()}catch(n){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(n,c.stackTrace),e+1>=o&&(r!==U&&(s=void 0,u=[n]),t.rejectWith(s,u))}};e?c():(E.Deferred.getStackHook&&(c.stackTrace=E.Deferred.getStackHook()),n.setTimeout(c))}}return E.Deferred(function(n){t[0][3].add(a(0,n,y(i)?i:B,n.notifyWith)),t[1][3].add(a(0,n,y(e)?e:B)),t[2][3].add(a(0,n,y(r)?r:U))}).promise()},promise:function(e){return null!=e?E.extend(e,i):i}},o={};return E.each(t,function(e,n){var a=n[2],s=n[5];i[n[1]]=a.add,s&&a.add(function(){r=s},t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),a.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=u.call(arguments),o=E.Deferred(),a=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?u.call(arguments):n,--t||o.resolveWith(r,i)}};if(t<=1&&(z(e,o.done(a(n)).resolve,o.reject,!t),"pending"===o.state()||y(i[n]&&i[n].then)))return o.then();for(;n--;)z(i[n],a(n),o.reject);return o.promise()}});var V=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(e,t){n.console&&n.console.warn&&e&&V.test(e.name)&&n.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},E.readyException=function(e){n.setTimeout(function(){throw e})};var H=E.Deferred();function q(){a.removeEventListener("DOMContentLoaded",q),n.removeEventListener("load",q),E.ready()}E.fn.ready=function(e){return H.then(e).catch(function(e){E.readyException(e)}),this},E.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--E.readyWait:E.isReady)||(E.isReady=!0,!0!==e&&--E.readyWait>0||H.resolveWith(a,[E]))}}),E.ready.then=H.then,"complete"===a.readyState||"loading"!==a.readyState&&!a.documentElement.doScroll?n.setTimeout(E.ready):(a.addEventListener("DOMContentLoaded",q),n.addEventListener("load",q));var G=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n))for(s in i=!0,n)G(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,y(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(E(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},W=/^-ms-/,X=/-([a-z])/g;function Y(e,t){return t.toUpperCase()}function $(e){return e.replace(W,"ms-").replace(X,Y)}var J=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Z(){this.expando=E.expando+Z.uid++}Z.uid=1,Z.prototype={cache:function(e){var t=e[this.expando];return t||(t={},J(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[$(t)]=n;else for(r in t)i[$(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][$(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map($):(t=$(t))in r?[t]:t.match(F)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||E.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!E.isEmptyObject(t)}};var K=new Z,Q=new Z,ee=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,te=/[A-Z]/g;function ne(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(te,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ee.test(e)?JSON.parse(e):e)}(n)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}E.extend({hasData:function(e){return Q.hasData(e)||K.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return K.access(e,t,n)},_removeData:function(e,t){K.remove(e,t)}}),E.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=Q.get(o),1===o.nodeType&&!K.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=$(r.slice(5)),ne(o,r,i[r]));K.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){Q.set(this,e)}):G(this,function(t){var n;if(o&&void 0===t)return void 0!==(n=Q.get(o,e))?n:void 0!==(n=ne(o,e))?n:void 0;this.each(function(){Q.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),E.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=K.get(e,t),n&&(!r||Array.isArray(n)?r=K.access(e,t,E.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=E.queue(e,t),r=n.length,i=n.shift(),o=E._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){E.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return K.get(e,n)||K.access(e,n,{empty:E.Callbacks("once memory").add(function(){K.remove(e,[t+"queue",n])})})}}),E.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?E.queue(this[0],e):void 0===t?this:this.each(function(){var n=E.queue(this,e,t);E._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&E.dequeue(this,e)})},dequeue:function(e){return this.each(function(){E.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=E.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=K.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ie=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),oe=["Top","Right","Bottom","Left"],ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&E.contains(e.ownerDocument,e)&&"none"===E.css(e,"display")},se=function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in i=n.apply(e,r||[]),t)e.style[o]=a[o];return i};function ue(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return E.css(e,t,"")},u=s(),l=n&&n[3]||(E.cssNumber[t]?"":"px"),c=(E.cssNumber[t]||"px"!==l&&+u)&&ie.exec(E.css(e,t));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;a--;)E.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,E.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var le={};function ce(e){var t,n=e.ownerDocument,r=e.nodeName,i=le[r];return i||(t=n.body.appendChild(n.createElement(r)),i=E.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),le[r]=i,i)}function fe(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=K.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ae(r)&&(i[o]=ce(r))):"none"!==n&&(i[o]="none",K.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}E.fn.extend({show:function(){return fe(this,!0)},hide:function(){return fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?E(this).show():E(this).hide()})}});var de=/^(?:checkbox|radio)$/i,he=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,pe=/^$|^module$|\/(?:java|ecma)script/i,ge={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function me(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?E.merge([e],n):n}function ve(e,t){for(var n=0,r=e.length;n<r;n++)K.set(e[n],"globalEval",!t||K.get(t[n],"globalEval"))}ge.optgroup=ge.option,ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td;var ye=/<|&#?\w+;/;function _e(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),d=[],h=0,p=e.length;h<p;h++)if((o=e[h])||0===o)if("object"===x(o))E.merge(d,o.nodeType?[o]:o);else if(ye.test(o)){for(a=a||f.appendChild(t.createElement("div")),s=(he.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+E.htmlPrefilter(o)+u[2],c=u[0];c--;)a=a.lastChild;E.merge(d,a.childNodes),(a=f.firstChild).textContent=""}else d.push(t.createTextNode(o));for(f.textContent="",h=0;o=d[h++];)if(r&&E.inArray(o,r)>-1)i&&i.push(o);else if(l=E.contains(o.ownerDocument,o),a=me(f.appendChild(o),"script"),l&&ve(a),n)for(c=0;o=a[c++];)pe.test(o.type||"")&&n.push(o);return f}!function(){var e=a.createDocumentFragment().appendChild(a.createElement("div")),t=a.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),v.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var be=a.documentElement,we=/^key/,xe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ee=/^([^.]*)(?:\.(.+)|)/;function Me(){return!0}function Ce(){return!1}function Te(){try{return a.activeElement}catch(e){}}function Se(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Se(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Ce;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return E().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=E.guid++)),e.each(function(){E.event.add(this,t,i,r,n)})}E.event={global:{},add:function(e,t,n,r,i){var o,a,s,u,l,c,f,d,h,p,g,m=K.get(e);if(m)for(n.handler&&(n=(o=n).handler,i=o.selector),i&&E.find.matchesSelector(be,i),n.guid||(n.guid=E.guid++),(u=m.events)||(u=m.events={}),(a=m.handle)||(a=m.handle=function(t){return void 0!==E&&E.event.triggered!==t.type?E.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(F)||[""]).length;l--;)h=g=(s=Ee.exec(t[l])||[])[1],p=(s[2]||"").split(".").sort(),h&&(f=E.event.special[h]||{},h=(i?f.delegateType:f.bindType)||h,f=E.event.special[h]||{},c=E.extend({type:h,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&E.expr.match.needsContext.test(i),namespace:p.join(".")},o),(d=u[h])||((d=u[h]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,r,p,a)||e.addEventListener&&e.addEventListener(h,a)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,c):d.push(c),E.event.global[h]=!0)},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,d,h,p,g,m=K.hasData(e)&&K.get(e);if(m&&(u=m.events)){for(l=(t=(t||"").match(F)||[""]).length;l--;)if(h=g=(s=Ee.exec(t[l])||[])[1],p=(s[2]||"").split(".").sort(),h){for(f=E.event.special[h]||{},d=u[h=(r?f.delegateType:f.bindType)||h]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)c=d[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,f.remove&&f.remove.call(e,c));a&&!d.length&&(f.teardown&&!1!==f.teardown.call(e,p,m.handle)||E.removeEvent(e,h,m.handle),delete u[h])}else for(h in u)E.event.remove(e,h+t[l],n,r,!0);E.isEmptyObject(u)&&K.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=E.event.fix(e),u=new Array(arguments.length),l=(K.get(this,"events")||{})[s.type]||[],c=E.event.special[s.type]||{};for(u[0]=s,t=1;t<arguments.length;t++)u[t]=arguments[t];if(s.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,s)){for(a=E.event.handlers.call(this,s,l),t=0;(i=a[t++])&&!s.isPropagationStopped();)for(s.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(o.namespace)||(s.handleObj=o,s.data=o.data,void 0!==(r=((E.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,u))&&!1===(s.result=r)&&(s.preventDefault(),s.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,s),s.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?E(i,this).index(l)>-1:E.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(e,t){Object.defineProperty(E.Event.prototype,e,{enumerable:!0,configurable:!0,get:y(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[E.expando]?e:new E.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Te()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Te()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&A(this,"input"))return this.click(),!1},_default:function(e){return A(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},E.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},E.Event=function(e,t){if(!(this instanceof E.Event))return new E.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Me:Ce,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&E.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:Ce,isPropagationStopped:Ce,isImmediatePropagationStopped:Ce,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Me,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Me,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Me,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&we.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&xe.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},E.event.addProp),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){E.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||E.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}}),E.fn.extend({on:function(e,t,n,r){return Se(this,e,t,n,r)},one:function(e,t,n,r){return Se(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,E(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ce),this.each(function(){E.event.remove(this,e,n,t)})}});var Oe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Pe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Re(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&E(e).children("tbody")[0]||e}function Le(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function je(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function De(e,t){var n,r,i,o,a,s,u,l;if(1===t.nodeType){if(K.hasData(e)&&(o=K.access(e),a=K.set(t,o),l=o.events))for(i in delete a.handle,a.events={},l)for(n=0,r=l[i].length;n<r;n++)E.event.add(t,i,l[i][n]);Q.hasData(e)&&(s=Q.access(e),u=E.extend({},s),Q.set(t,u))}}function Ne(e,t){var n=t.nodeName.toLowerCase();"input"===n&&de.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Ie(e,t,n,r){t=l.apply([],t);var i,o,a,s,u,c,f=0,d=e.length,h=d-1,p=t[0],g=y(p);if(g||d>1&&"string"==typeof p&&!v.checkClone&&Ae.test(p))return e.each(function(i){var o=e.eq(i);g&&(t[0]=p.call(this,i,o.html())),Ie(o,t,n,r)});if(d&&(o=(i=_e(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=o),o||r)){for(s=(a=E.map(me(i,"script"),Le)).length;f<d;f++)u=i,f!==h&&(u=E.clone(u,!0,!0),s&&E.merge(a,me(u,"script"))),n.call(e[f],u,f);if(s)for(c=a[a.length-1].ownerDocument,E.map(a,je),f=0;f<s;f++)u=a[f],pe.test(u.type||"")&&!K.access(u,"globalEval")&&E.contains(c,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?E._evalUrl&&E._evalUrl(u.src):w(u.textContent.replace(Pe,""),c,u))}return e}function Fe(e,t,n){for(var r,i=t?E.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||E.cleanData(me(r)),r.parentNode&&(n&&E.contains(r.ownerDocument,r)&&ve(me(r,"script")),r.parentNode.removeChild(r));return e}E.extend({htmlPrefilter:function(e){return e.replace(Oe,"<$1></$2>")},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),u=E.contains(e.ownerDocument,e);if(!(v.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||E.isXMLDoc(e)))for(a=me(s),r=0,i=(o=me(e)).length;r<i;r++)Ne(o[r],a[r]);if(t)if(n)for(o=o||me(e),a=a||me(s),r=0,i=o.length;r<i;r++)De(o[r],a[r]);else De(e,s);return(a=me(s,"script")).length>0&&ve(a,!u&&me(e,"script")),s},cleanData:function(e){for(var t,n,r,i=E.event.special,o=0;void 0!==(n=e[o]);o++)if(J(n)){if(t=n[K.expando]){if(t.events)for(r in t.events)i[r]?E.event.remove(n,r):E.removeEvent(n,r,t.handle);n[K.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),E.fn.extend({detach:function(e){return Fe(this,e,!0)},remove:function(e){return Fe(this,e)},text:function(e){return G(this,function(e){return void 0===e?E.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Ie(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Re(this,e).appendChild(e)})},prepend:function(){return Ie(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Re(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Ie(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Ie(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(E.cleanData(me(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return E.clone(this,e,t)})},html:function(e){return G(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(he.exec(e)||["",""])[1].toLowerCase()]){e=E.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(E.cleanData(me(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Ie(this,arguments,function(t){var n=this.parentNode;E.inArray(this,e)<0&&(E.cleanData(me(this)),n&&n.replaceChild(t,this))},e)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){E.fn[e]=function(e){for(var n,r=[],i=E(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),E(i[a])[t](n),c.apply(r,n.get());return this.pushStack(r)}});var Be=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),Ue=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=n),t.getComputedStyle(e)},ze=new RegExp(oe.join("|"),"i");function Ve(e,t,n){var r,i,o,a,s=e.style;return(n=n||Ue(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||E.contains(e.ownerDocument,e)||(a=E.style(e,t)),!v.pixelBoxStyles()&&Be.test(a)&&ze.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function He(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",be.appendChild(l).appendChild(c);var e=n.getComputedStyle(c);r="1%"!==e.top,u=12===t(e.marginLeft),c.style.right="60%",s=36===t(e.right),i=36===t(e.width),c.style.position="absolute",o=36===c.offsetWidth||"absolute",be.removeChild(l),c=null}}function t(e){return Math.round(parseFloat(e))}var r,i,o,s,u,l=a.createElement("div"),c=a.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===c.style.backgroundClip,E.extend(v,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),s},pixelPosition:function(){return e(),r},reliableMarginLeft:function(){return e(),u},scrollboxSize:function(){return e(),o}}))}();var qe=/^(none|table(?!-c[ea]).+)/,Ge=/^--/,We={position:"absolute",visibility:"hidden",display:"block"},Xe={letterSpacing:"0",fontWeight:"400"},Ye=["Webkit","Moz","ms"],$e=a.createElement("div").style;function Je(e){var t=E.cssProps[e];return t||(t=E.cssProps[e]=function(e){if(e in $e)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=Ye.length;n--;)if((e=Ye[n]+t)in $e)return e}(e)||e),t}function Ze(e,t,n){var r=ie.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ke(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=E.css(e,n+oe[a],!0,i)),r?("content"===n&&(u-=E.css(e,"padding"+oe[a],!0,i)),"margin"!==n&&(u-=E.css(e,"border"+oe[a]+"Width",!0,i))):(u+=E.css(e,"padding"+oe[a],!0,i),"padding"!==n?u+=E.css(e,"border"+oe[a]+"Width",!0,i):s+=E.css(e,"border"+oe[a]+"Width",!0,i));return!r&&o>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))),u}function Qe(e,t,n){var r=Ue(e),i=Ve(e,t,r),o="border-box"===E.css(e,"boxSizing",!1,r),a=o;if(Be.test(i)){if(!n)return i;i="auto"}return a=a&&(v.boxSizingReliable()||i===e.style[t]),("auto"===i||!parseFloat(i)&&"inline"===E.css(e,"display",!1,r))&&(i=e["offset"+t[0].toUpperCase()+t.slice(1)],a=!0),(i=parseFloat(i)||0)+Ke(e,t,n||(o?"border":"content"),a,r,i)+"px"}function et(e,t,n,r,i){return new et.prototype.init(e,t,n,r,i)}E.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ve(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=$(t),u=Ge.test(t),l=e.style;if(u||(t=Je(s)),a=E.cssHooks[t]||E.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=ie.exec(n))&&i[1]&&(n=ue(e,t,i),o="number"),null!=n&&n==n&&("number"===o&&(n+=i&&i[3]||(E.cssNumber[s]?"":"px")),v.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=$(t);return Ge.test(t)||(t=Je(s)),(a=E.cssHooks[t]||E.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Ve(e,t,r)),"normal"===i&&t in Xe&&(i=Xe[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),E.each(["height","width"],function(e,t){E.cssHooks[t]={get:function(e,n,r){if(n)return!qe.test(E.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Qe(e,t,r):se(e,We,function(){return Qe(e,t,r)})},set:function(e,n,r){var i,o=Ue(e),a="border-box"===E.css(e,"boxSizing",!1,o),s=r&&Ke(e,t,r,a,o);return a&&v.scrollboxSize()===o.position&&(s-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Ke(e,t,"border",!1,o)-.5)),s&&(i=ie.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=E.css(e,t)),Ze(0,n,s)}}}),E.cssHooks.marginLeft=He(v.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ve(e,"marginLeft"))||e.getBoundingClientRect().left-se(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),E.each({margin:"",padding:"",border:"Width"},function(e,t){E.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+oe[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(E.cssHooks[e+t].set=Ze)}),E.fn.extend({css:function(e,t){return G(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Ue(e),i=t.length;a<i;a++)o[t[a]]=E.css(e,t[a],!1,r);return o}return void 0!==n?E.style(e,t,n):E.css(e,t)},e,t,arguments.length>1)}}),E.Tween=et,et.prototype={constructor:et,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||E.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(E.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=E.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}},et.prototype.init.prototype=et.prototype,et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=E.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){E.fx.step[e.prop]?E.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[E.cssProps[e.prop]]&&!E.cssHooks[e.prop]?e.elem[e.prop]=e.now:E.style(e.elem,e.prop,e.now+e.unit)}}},et.propHooks.scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},E.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},E.fx=et.prototype.init,E.fx.step={};var tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){nt&&(!1===a.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(ot):n.setTimeout(ot,E.fx.interval),E.fx.tick())}function at(){return n.setTimeout(function(){tt=void 0}),tt=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=oe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(e,t,n){var r,i,o=0,a=lt.prefilters.length,s=E.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=tt||at(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(r);return s.notifyWith(e,[l,r,n]),r<1&&a?n:(a||s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:E.extend({},t),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},n),originalProperties:t,originalOptions:n,startTime:tt||at(),duration:n.duration,tweens:[],createTween:function(t,n){var r=E.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l,t])):s.rejectWith(e,[l,t]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=$(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=E.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);o<a;o++)if(r=lt.prefilters[o].call(l,e,c,l.opts))return y(r.stop)&&(E._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return E.map(c,ut,l),y(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),E.fx.timer(E.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}E.Animation=E.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ue(n.elem,e,ie.exec(t),n),n}]},tweener:function(e,t){y(e)?(t=e,e=["*"]):e=e.match(F);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,d=this,h={},p=e.style,g=e.nodeType&&ae(e),m=K.get(e,"fxshow");for(r in n.queue||(null==(a=E._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,d.always(function(){d.always(function(){a.unqueued--,E.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;g=!0}h[r]=m&&m[r]||E.style(e,r)}if((u=!E.isEmptyObject(t))||!E.isEmptyObject(h))for(r in f&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(l=m&&m.display)&&(l=K.get(e,"display")),"none"===(c=E.css(e,"display"))&&(l?c=l:(fe([e],!0),l=e.style.display||l,c=E.css(e,"display"),fe([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===E.css(e,"float")&&(u||(d.done(function(){p.display=l}),null==l&&(c=p.display,l="none"===c?"":c)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),u=!1,h)u||(m?"hidden"in m&&(g=m.hidden):m=K.access(e,"fxshow",{display:l}),o&&(m.hidden=!g),g&&fe([e],!0),d.done(function(){for(r in g||fe([e]),K.remove(e,"fxshow"),h)E.style(e,r,h[r])})),u=ut(g?m[r]:0,r,d),r in m||(m[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),E.speed=function(e,t,n){var r=e&&"object"==typeof e?E.extend({},e):{complete:n||!n&&t||y(e)&&e,duration:e,easing:n&&t||t&&!y(t)&&t};return E.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in E.fx.speeds?r.duration=E.fx.speeds[r.duration]:r.duration=E.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){y(r.old)&&r.old.call(this),r.queue&&E.dequeue(this,r.queue)},r},E.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=E.isEmptyObject(e),o=E.speed(t,n,r),a=function(){var t=lt(this,E.extend({},e),o);(i||K.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=E.timers,a=K.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&it.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||E.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=K.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=E.timers,a=r?r.length:0;for(n.finish=!0,E.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),E.each(["toggle","show","hide"],function(e,t){var n=E.fn[t];E.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(st(t,!0),e,r,i)}}),E.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){E.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),E.timers=[],E.fx.tick=function(){var e,t=0,n=E.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||E.fx.stop(),tt=void 0},E.fx.timer=function(e){E.timers.push(e),E.fx.start()},E.fx.interval=13,E.fx.start=function(){nt||(nt=!0,ot())},E.fx.stop=function(){nt=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(e,t){return e=E.fx&&E.fx.speeds[e]||e,t=t||"fx",this.queue(t,function(t,r){var i=n.setTimeout(t,e);r.stop=function(){n.clearTimeout(i)}})},function(){var e=a.createElement("input"),t=a.createElement("select").appendChild(a.createElement("option"));e.type="checkbox",v.checkOn=""!==e.value,v.optSelected=t.selected,(e=a.createElement("input")).value="t",e.type="radio",v.radioValue="t"===e.value}();var ct,ft=E.expr.attrHandle;E.fn.extend({attr:function(e,t){return G(this,E.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){E.removeAttr(this,e)})}}),E.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?E.prop(e,t,n):(1===o&&E.isXMLDoc(e)||(i=E.attrHooks[t.toLowerCase()]||(E.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void E.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=E.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!v.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(F);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?E.removeAttr(e,n):e.setAttribute(n,n),n}},E.each(E.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ft[t]||E.find.attr;ft[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=ft[a],ft[a]=i,i=null!=n(e,t,r)?a:null,ft[a]=o),i}});var dt=/^(?:input|select|textarea|button)$/i,ht=/^(?:a|area)$/i;function pt(e){return(e.match(F)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function mt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(F)||[]}E.fn.extend({prop:function(e,t){return G(this,E.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[E.propFix[e]||e]})}}),E.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&E.isXMLDoc(e)||(t=E.propFix[t]||t,i=E.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=E.find.attr(e,"tabindex");return t?parseInt(t,10):dt.test(e.nodeName)||ht.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(E.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){E.propFix[this.toLowerCase()]=this}),E.fn.extend({addClass:function(e){var t,n,r,i,o,a,s,u=0;if(y(e))return this.each(function(t){E(this).addClass(e.call(this,t,gt(this)))});if((t=mt(e)).length)for(;n=this[u++];)if(i=gt(n),r=1===n.nodeType&&" "+pt(i)+" "){for(a=0;o=t[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=pt(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,a,s,u=0;if(y(e))return this.each(function(t){E(this).removeClass(e.call(this,t,gt(this)))});if(!arguments.length)return this.attr("class","");if((t=mt(e)).length)for(;n=this[u++];)if(i=gt(n),r=1===n.nodeType&&" "+pt(i)+" "){for(a=0;o=t[a++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");i!==(s=pt(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e,r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):y(e)?this.each(function(n){E(this).toggleClass(e.call(this,n,gt(this),t),t)}):this.each(function(){var t,i,o,a;if(r)for(i=0,o=E(this),a=mt(e);t=a[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==n||((t=gt(this))&&K.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":K.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+pt(gt(n))+" ").indexOf(t)>-1)return!0;return!1}});var vt=/\r/g;E.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=y(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,E(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=E.map(i,function(e){return null==e?"":e+""})),(t=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))})):i?(t=E.valHooks[i.type]||E.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(vt,""):null==n?"":n:void 0}}),E.extend({valHooks:{option:{get:function(e){var t=E.find.attr(e,"value");return null!=t?t:pt(E.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=E(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=E.makeArray(t),a=i.length;a--;)((r=i[a]).selected=E.inArray(E.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),E.each(["radio","checkbox"],function(){E.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=E.inArray(E(e).val(),t)>-1}},v.checkOn||(E.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),v.focusin="onfocusin"in n;var yt=/^(?:focusinfocus|focusoutblur)$/,_t=function(e){e.stopPropagation()};E.extend(E.event,{trigger:function(e,t,r,i){var o,s,u,l,c,f,d,h,g=[r||a],m=p.call(e,"type")?e.type:e,v=p.call(e,"namespace")?e.namespace.split("."):[];if(s=h=u=r=r||a,3!==r.nodeType&&8!==r.nodeType&&!yt.test(m+E.event.triggered)&&(m.indexOf(".")>-1&&(m=(v=m.split(".")).shift(),v.sort()),c=m.indexOf(":")<0&&"on"+m,(e=e[E.expando]?e:new E.Event(m,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=v.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=null==t?[e]:E.makeArray(t,[e]),d=E.event.special[m]||{},i||!d.trigger||!1!==d.trigger.apply(r,t))){if(!i&&!d.noBubble&&!_(r)){for(l=d.delegateType||m,yt.test(l+m)||(s=s.parentNode);s;s=s.parentNode)g.push(s),u=s;u===(r.ownerDocument||a)&&g.push(u.defaultView||u.parentWindow||n)}for(o=0;(s=g[o++])&&!e.isPropagationStopped();)h=s,e.type=o>1?l:d.bindType||m,(f=(K.get(s,"events")||{})[e.type]&&K.get(s,"handle"))&&f.apply(s,t),(f=c&&s[c])&&f.apply&&J(s)&&(e.result=f.apply(s,t),!1===e.result&&e.preventDefault());return e.type=m,i||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(g.pop(),t)||!J(r)||c&&y(r[m])&&!_(r)&&((u=r[c])&&(r[c]=null),E.event.triggered=m,e.isPropagationStopped()&&h.addEventListener(m,_t),r[m](),e.isPropagationStopped()&&h.removeEventListener(m,_t),E.event.triggered=void 0,u&&(r[c]=u)),e.result}},simulate:function(e,t,n){var r=E.extend(new E.Event,n,{type:e,isSimulated:!0});E.event.trigger(r,null,t)}}),E.fn.extend({trigger:function(e,t){return this.each(function(){E.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return E.event.trigger(e,t,n,!0)}}),v.focusin||E.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){E.event.simulate(t,e.target,E.event.fix(e))};E.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=K.access(r,t);i||r.addEventListener(e,n,!0),K.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=K.access(r,t)-1;i?K.access(r,t,i):(r.removeEventListener(e,n,!0),K.remove(r,t))}}});var bt=n.location,wt=Date.now(),xt=/\?/;E.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new n.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||E.error("Invalid XML: "+e),t};var Et=/\[\]$/,Mt=/\r?\n/g,Ct=/^(?:submit|button|image|reset|file)$/i,Tt=/^(?:input|select|textarea|keygen)/i;function St(e,t,n,r){var i;if(Array.isArray(t))E.each(t,function(t,i){n||Et.test(e)?r(e,i):St(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==x(t))r(e,t);else for(i in t)St(e+"["+i+"]",t[i],n,r)}E.param=function(e,t){var n,r=[],i=function(e,t){var n=y(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!E.isPlainObject(e))E.each(e,function(){i(this.name,this.value)});else for(n in e)St(n,e[n],t,i);return r.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=E.prop(this,"elements");return e?E.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!E(this).is(":disabled")&&Tt.test(this.nodeName)&&!Ct.test(e)&&(this.checked||!de.test(e))}).map(function(e,t){var n=E(this).val();return null==n?null:Array.isArray(n)?E.map(n,function(e){return{name:t.name,value:e.replace(Mt,"\r\n")}}):{name:t.name,value:n.replace(Mt,"\r\n")}}).get()}});var Ot=/%20/g,kt=/#.*$/,At=/([?&])_=[^&]*/,Pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Rt=/^(?:GET|HEAD)$/,Lt=/^\/\//,jt={},Dt={},Nt="*/".concat("*"),It=a.createElement("a");function Ft(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(F)||[];if(y(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Bt(e,t,n,r){var i={},o=e===Dt;function a(s){var u;return i[s]=!0,E.each(e[s]||[],function(e,s){var l=s(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):void 0:(t.dataTypes.unshift(l),a(l),!1)}),u}return a(t.dataTypes[0])||!i["*"]&&a("*")}function Ut(e,t){var n,r,i=E.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&E.extend(!0,e,r),e}It.href=bt.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Nt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ut(Ut(e,E.ajaxSettings),t):Ut(E.ajaxSettings,e)},ajaxPrefilter:Ft(jt),ajaxTransport:Ft(Dt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var r,i,o,s,u,l,c,f,d,h,p=E.ajaxSetup({},t),g=p.context||p,m=p.context&&(g.nodeType||g.jquery)?E(g):E.event,v=E.Deferred(),y=E.Callbacks("once memory"),_=p.statusCode||{},b={},w={},x="canceled",M={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s)for(s={};t=Pt.exec(o);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(e,t){return null==c&&(e=w[e.toLowerCase()]=w[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==c&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)M.always(e[M.status]);else for(t in e)_[t]=[_[t],e[t]];return this},abort:function(e){var t=e||x;return r&&r.abort(t),C(0,t),this}};if(v.promise(M),p.url=((e||p.url||bt.href)+"").replace(Lt,bt.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(F)||[""],null==p.crossDomain){l=a.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=It.protocol+"//"+It.host!=l.protocol+"//"+l.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=E.param(p.data,p.traditional)),Bt(jt,p,t,M),c)return M;for(d in(f=E.event&&p.global)&&0==E.active++&&E.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Rt.test(p.type),i=p.url.replace(kt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ot,"+")):(h=p.url.slice(i.length),p.data&&(p.processData||"string"==typeof p.data)&&(i+=(xt.test(i)?"&":"?")+p.data,delete p.data),!1===p.cache&&(i=i.replace(At,"$1"),h=(xt.test(i)?"&":"?")+"_="+wt+++h),p.url=i+h),p.ifModified&&(E.lastModified[i]&&M.setRequestHeader("If-Modified-Since",E.lastModified[i]),E.etag[i]&&M.setRequestHeader("If-None-Match",E.etag[i])),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&M.setRequestHeader("Content-Type",p.contentType),M.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Nt+"; q=0.01":""):p.accepts["*"]),p.headers)M.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(!1===p.beforeSend.call(g,M,p)||c))return M.abort();if(x="abort",y.add(p.complete),M.done(p.success),M.fail(p.error),r=Bt(Dt,p,t,M)){if(M.readyState=1,f&&m.trigger("ajaxSend",[M,p]),c)return M;p.async&&p.timeout>0&&(u=n.setTimeout(function(){M.abort("timeout")},p.timeout));try{c=!1,r.send(b,C)}catch(e){if(c)throw e;C(-1,e)}}else C(-1,"No Transport");function C(e,t,a,s){var l,d,h,b,w,x=t;c||(c=!0,u&&n.clearTimeout(u),r=void 0,o=s||"",M.readyState=e>0?4:0,l=e>=200&&e<300||304===e,a&&(b=function(e,t,n){for(var r,i,o,a,s=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(p,M,a)),b=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(p,b,M,l),l?(p.ifModified&&((w=M.getResponseHeader("Last-Modified"))&&(E.lastModified[i]=w),(w=M.getResponseHeader("etag"))&&(E.etag[i]=w)),204===e||"HEAD"===p.type?x="nocontent":304===e?x="notmodified":(x=b.state,d=b.data,l=!(h=b.error))):(h=x,!e&&x||(x="error",e<0&&(e=0))),M.status=e,M.statusText=(t||x)+"",l?v.resolveWith(g,[d,x,M]):v.rejectWith(g,[M,x,h]),M.statusCode(_),_=void 0,f&&m.trigger(l?"ajaxSuccess":"ajaxError",[M,p,l?d:h]),y.fireWith(g,[M,x]),f&&(m.trigger("ajaxComplete",[M,p]),--E.active||E.event.trigger("ajaxStop")))}return M},getJSON:function(e,t,n){return E.get(e,t,n,"json")},getScript:function(e,t){return E.get(e,void 0,t,"script")}}),E.each(["get","post"],function(e,t){E[t]=function(e,n,r,i){return y(n)&&(i=i||r,r=n,n=void 0),E.ajax(E.extend({url:e,type:t,dataType:i,data:n,success:r},E.isPlainObject(e)&&e))}}),E._evalUrl=function(e){return E.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},E.fn.extend({wrapAll:function(e){var t;return this[0]&&(y(e)&&(e=e.call(this[0])),t=E(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return y(e)?this.each(function(t){E(this).wrapInner(e.call(this,t))}):this.each(function(){var t=E(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=y(e);return this.each(function(n){E(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){E(this).replaceWith(this.childNodes)}),this}}),E.expr.pseudos.hidden=function(e){return!E.expr.pseudos.visible(e)},E.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(e){}};var zt={0:200,1223:204},Vt=E.ajaxSettings.xhr();v.cors=!!Vt&&"withCredentials"in Vt,v.ajax=Vt=!!Vt,E.ajaxTransport(function(e){var t,r;if(v.cors||Vt&&!e.crossDomain)return{send:function(i,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(a,i[a]);t=function(e){return function(){t&&(t=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(zt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),r=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout(function(){t&&r()})},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),E.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return E.globalEval(e),e}}}),E.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),E.ajaxTransport("script",function(e){var t,n;if(e.crossDomain)return{send:function(r,i){t=E("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),a.head.appendChild(t[0])},abort:function(){n&&n()}}});var Ht=[],qt=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ht.pop()||E.expando+"_"+wt++;return this[e]=!0,e}}),E.ajaxPrefilter("json jsonp",function(e,t,r){var i,o,a,s=!1!==e.jsonp&&(qt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&qt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=y(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(qt,"$1"+i):!1!==e.jsonp&&(e.url+=(xt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||E.error(i+" was not called"),a[0]},e.dataTypes[0]="json",o=n[i],n[i]=function(){a=arguments},r.always(function(){void 0===o?E(n).removeProp(i):n[i]=o,e[i]&&(e.jsonpCallback=t.jsonpCallback,Ht.push(i)),a&&y(o)&&o(a[0]),a=o=void 0}),"script"}),v.createHTMLDocument=function(){var e=a.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),E.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(v.createHTMLDocument?((r=(t=a.implementation.createHTMLDocument("")).createElement("base")).href=a.location.href,t.head.appendChild(r)):t=a),i=P.exec(e),o=!n&&[],i?[t.createElement(i[1])]:(i=_e([e],t,o),o&&o.length&&E(o).remove(),E.merge([],i.childNodes)));var r,i,o},E.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=pt(e.slice(s)),e=e.slice(0,s)),y(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&E.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?E("<div>").append(E.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){E.fn[t]=function(e){return this.on(t,e)}}),E.expr.pseudos.animated=function(e){return E.grep(E.timers,function(t){return e===t.elem}).length},E.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=E.css(e,"position"),c=E(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=E.css(e,"top"),u=E.css(e,"left"),("absolute"===l||"fixed"===l)&&(o+u).indexOf("auto")>-1?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),y(t)&&(t=t.call(e,n,E.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},E.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){E.offset.setOffset(this,e,t)});var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===E.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===E.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=E(e).offset()).top+=E.css(e,"borderTopWidth",!0),i.left+=E.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-E.css(r,"marginTop",!0),left:t.left-i.left-E.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===E.css(e,"position");)e=e.offsetParent;return e||be})}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;E.fn[e]=function(r){return G(this,function(e,r,i){var o;if(_(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i},e,r,arguments.length)}}),E.each(["top","left"],function(e,t){E.cssHooks[t]=He(v.pixelPosition,function(e,n){if(n)return n=Ve(e,t),Be.test(n)?E(e).position()[t]+"px":n})}),E.each({Height:"height",Width:"width"},function(e,t){E.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){E.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return G(this,function(t,n,i){var o;return _(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?E.css(t,n,s):E.style(t,n,i,s)},t,a?i:void 0,a)}})}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){E.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),E.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),E.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),E.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),y(e))return r=u.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(u.call(arguments)))}).guid=e.guid=e.guid||E.guid++,i},E.holdReady=function(e){e?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=A,E.isFunction=y,E.isWindow=_,E.camelCase=$,E.type=x,E.now=Date.now,E.isNumeric=function(e){var t=E.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},void 0===(r=function(){return E}.apply(t,[]))||(e.exports=r);var Gt=n.jQuery,Wt=n.$;return E.noConflict=function(e){return n.$===E&&(n.$=Wt),e&&n.jQuery===E&&(n.jQuery=Gt),E},i||(n.jQuery=n.$=E),E})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=o(n(13));o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"load",value:function(){var e=this;return Promise.all(this.listPreload()).then(function(t){return e.handlePreload.apply(null,t)})}},{key:"listPreload",value:function(){return[]}},{key:"handlePreload",value:function(){}},{key:"init",value:function(){return Promise.resolve(!0)}},{key:"run",value:function(){}}]),t}();t.default=a},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty;function i(e,t){return!!e&&r.call(e,t)}var o=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function a(e){return!(e>=55296&&e<=57343)&&(!(e>=64976&&e<=65007)&&(65535!=(65535&e)&&65534!=(65535&e)&&(!(e>=0&&e<=8)&&(11!==e&&(!(e>=14&&e<=31)&&(!(e>=127&&e<=159)&&!(e>1114111)))))))}function s(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}var u=/&([a-z#][a-z0-9]{1,31});/gi,l=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i,c=n(44);function f(e,t){var n=0;return i(c,t)?c[t]:35===t.charCodeAt(0)&&l.test(t)&&a(n="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10))?s(n):e}var d=/[&<>"]/,h=/[&<>"]/g,p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function g(e){return p[e]}t.assign=function(e){return[].slice.call(arguments,1).forEach(function(t){if(t){if("object"!=typeof t)throw new TypeError(t+"must be object");Object.keys(t).forEach(function(n){e[n]=t[n]})}}),e},t.isString=function(e){return"[object String]"===function(e){return Object.prototype.toString.call(e)}(e)},t.has=i,t.unescapeMd=function(e){return e.indexOf("\\")<0?e:e.replace(o,"$1")},t.isValidEntityCode=a,t.fromCodePoint=s,t.replaceEntities=function(e){return e.indexOf("&")<0?e:e.replace(u,f)},t.escapeHtml=function(e){return d.test(e)?e.replace(h,g):e}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(15)),o=s(n(92)),a=s(n(97));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||o.default,e.modelClass=e.modelClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"trigger",value:function(){this._view._onClick(null)}},{key:"setLabel",value:function(e){this._model.set("label",e)}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(79));var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"addEventListener",value:function(e,t){return this.__listeners=this.__listeners||{},this.__listeners[e]=this.__listeners[e]||[],this.__listeners[e].includes(t)||this.__listeners[e].push(t),this}},{key:"removeEventListener",value:function(e,t){return this.__listeners&&this.__listeners[e]&&this.__listeners[e].includes(t)&&this.__listeners[e].splice(this.__listeners[e].indexOf(t),1),this}},{key:"removeAllListeners",value:function(e){if(e)this.__listeners&&this.__listeners[e]&&(this.__listeners[e].length=0);else{var t=!0,n=!1,r=void 0;try{for(var i,o=this.__listeners[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.__listeners[a].length=0}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}return this}},{key:"dispatchEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.__listeners&&("string"==typeof e&&(e=new i.default(e,n,r)),e.target=e.target||this,e.currentTarget=this,[e.name,"*"].forEach(function(n,r,i){t.__listeners[n]&&t.__listeners[n].slice(0).forEach(function(t){return t(e)})})),this}},{key:"on",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.addEventListener.apply(this,t)}},{key:"off",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.addEventListener.apply(this,t)}},{key:"fire",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.dispatchEvent.apply(this,t)}},{key:"bubbleEvent",value:function(e){e.bubbles&&this.dispatchEvent(e)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(6)),o=s(n(0)),a=s(n(90));function s(e){return e&&e.__esModule?e:{default:e}}var u={id:null,label:"",value:null,defaultValue:null,disabled:!1,required:!1,hasError:!1,errors:[],classes:[],validation:null},l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,u),e.data.validation=e.data.validation||{},e.data.required&&(e.data.validation.required={test:"exists",errorMessage:e.data.label+" required."}),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"enable",value:function(){this.set("disabled",!1)}},{key:"disable",value:function(){this.set("disabled",!0)}},{key:"value",value:function(){return o.default.exists(this.get("value"))?this.get("value"):this.get("defaultValue")}},{key:"_updateValidation",value:function(e){this.set("validation",e)}},{key:"validate",value:function(){var e=this,t=[],n=this.value();for(var r in this.get("validation")){var i=this.get("validation."+r),o=i.test||r;if(!a.default[o])return Promise.reject('Validation "'+o+'" could not be found.');t.push(a.default[o](n,i))}return Promise.all(t).then(function(t){var n=!0,r=[],i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l.isValid||(n=!1),l.error&&r.push(l.error)}}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}return e.set("errors",r),e.set("isValid",n),{id:e.get("id"),isValid:n,errors:r}})}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},o=u(n(7)),a=u(n(14)),s=u(n(16));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||a.default,e.viewClass=e.viewClass||s.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._onFieldChange=n._onFieldChange.bind(n),n._view.$dom().addClass(n._model.get("classes").join(" ")),n._view.addEventListener("Field.ValueChange",n._onFieldChange),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onFieldChange",value:function(e){e.bubbles&&e.stopPropagation();var t=this._model.value();this._model.set("value",e.data.value),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()})}},{key:"updateValidation",value:function(e){this._model._updateValidation(e)}},{key:"id",value:function(){return this._model.get("id")}},{key:"setId",value:function(e){this._model.set("id",e)}},{key:"label",value:function(){return this._model.get("label")}},{key:"enable",value:function(){this._model.enable(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)}},{key:"disable",value:function(){this._model.disable(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"show",value:function(){this._view.show()}},{key:"hide",value:function(){this._view.hide()}},{key:"validate",value:function(){return this._model.validate()}},{key:"value",value:function(){return this._model.value()}},{key:"setValue",value:function(e){var t=this._model.value();return this._model.set("value",e),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()}),Promise.resolve(e)}},{key:"clear",value:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?this.setValue(this._model.get("defaultValue")):this.setValue(null)}},{key:"setDefault",value:function(){this._model.set("value",this._model.get("defaultValue"))}},{key:"require",value:function(){this._model.set("required",!0)}},{key:"unrequire",value:function(){this._model.set("required",!1)}},{key:"focus",value:function(){this.view().focus()}},{key:"setErrors",value:function(e){this._model.set("errors",e),this._model.set("isValid",e.length)}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(91)),a=s(n(8));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));if(r._onModelChange=r._onModelChange.bind(r),e.addEventListener("Model.Change",r._onModelChange),r.$el.addClass(e.get("classes").join(" ")),e.get("description")){var i=document.createElement("div");i.className="description",i.innerHTML=e.get("description"),r.$el[0].appendChild(i),r.$el.find(".description").css({display:"none",position:"absolute","min-width":"150px","max-width":"300px","min-height":"25px","background-color":"#FFFFCD",border:"1px solid black",opacity:"0.95","z-index":"100","text-align":"left","font-size":"12px",padding:"5px","-webkit-box-shadow":"10px 10px 57px 0px rgba(107,107,107,1)","-moz-box-shadow":"10px 10px 57px 0px rgba(107,107,107,1)","box-shadow":"10px 10px 57px 0px rgba(107,107,107,1)","font-family":"Arial, Helvetica, sans-serif"}),r.$el.find("label").hover(function(e){var t=(0,a.default)(this).position().left,n=(0,a.default)(this).position().top,r=(0,a.default)(this).height(),i=(0,a.default)(this).width();(0,a.default)(this).parent().find(".description").css({display:"block",left:t+i/2,top:n+r+5})},function(){(0,a.default)(this).parent().find(".description").css({display:"none"})}).bind(r)}return r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_displayMessage",value:function(e){console.log("here")}},{key:"_onModelChange",value:function(e){switch(e.data.path){case"disabled":e.data.value?this.disable():this.enable()}}},{key:"focus",value:function(){}},{key:"disable",value:function(){}},{key:"enable",value:function(){}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(15)),o=s(n(234)),a=s(n(52));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||a.default,e.modelClass=e.modelClass||o.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addOption",value:function(e){this._model.addOption(e)}},{key:"removeOption",value:function(e){this._model.removeOption(e)}},{key:"clearOptions",value:function(){this._model.clearOptions()}},{key:"getOptions",value:function(){return this._model.get("options")}},{key:"getAbleOptions",value:function(){return this._model.listAbleOptions()}},{key:"disableOption",value:function(e){this._model.disableOption(e)}},{key:"enableOption",value:function(e){this._model.enableOption(e)}},{key:"selectFirstAble",value:function(){var e=this._model.listAbleOptions();e.includes(this.value())||this.setValue(e[0])}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(0)),o=a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getLightState",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=0,i={top:0,right:0,bottom:0,left:0};if(t<=e.reduce(function(e,t){return e+t.duration},0)){var o=function(e){if(["top","right","bottom","left"].forEach(function(t){i[t]=e[t]}),0==t||t>r&&t<=r+e.duration)return"break";r+=e.duration},a=!0,s=!1,u=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){if("break"===o(l.value))break}}catch(e){s=!0,u=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw u}}}return n.angle&&(i.angle=Math.atan2(i.bottom-i.top,i.left-i.right)),n.intensity&&(i.intensity=Math.sqrt(Math.pow(i.bottom-i.top,2)+Math.pow(i.left-i.right,2))),i}},{key:"normalizeResults",value:function(e){return(e.runTime?Promise.resolve(e):i.default.promiseAjax("/api/v1/Experiments/"+e.experimentId).then(function(t){var n=t.configuration.reduce(function(e,t){return e+t.duration},0);return e.runTime=n,e})).then(function(e){return e.tracks.forEach(function(e){e.samples.forEach(function(t,n){0==n?(t.speed=0,t.speedX=0,t.speedY=0,t.angleXY=2*Math.random()*Math.PI):(t.speed=Math.sqrt(Math.pow(t.x-e.samples[n-1].x,2)+Math.pow(t.y-e.samples[n-1].y,2))/(t.time-e.samples[n-1].time),t.speedX=(t.x-e.samples[n-1].x)/(t.time-e.samples[n-1].time),t.speedY=(t.y-e.samples[n-1].y)/(t.time-e.samples[n-1].time),t.angleXY=Math.atan2(t.y-e.samples[n-1].y,t.x-e.samples[n-1].x))})}),e.fps=e.numFrames/e.runTime,e})}},{key:"getLiveResults",value:function(e){var t=this,n=i.default.guid4();return o.default.get("Relay").dispatchEvent("Notifications.Add",{id:n,expireLabel:null,message:"Loading live results"}),i.default.promiseAjax("/api/v1/Results",{data:{filter:{where:{and:[{experimentId:e},{bpu_api_id:{neq:null}}]}}},contentType:"application/json"}).then(function(e){return t.normalizeResults(e[0])}).then(function(e){return o.default.get("Relay").dispatchEvent("Notifications.Remove",{noteId:n,type:"experiment"}),e})}},{key:"getModelResults",value:function(e,t){var n=this,r=void 0;return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||(r=i.default.guid4(),o.default.get("Relay").dispatchEvent("Notifications.Add",{id:r,expireLabel:null,message:"Loading model results"})),i.default.promiseAjax("/api/v1/Results",{data:{filter:{where:{and:[{experimentId:e},{euglenaModelId:t.id}]}}},contentType:"application/json"}).then(function(r){return r.length?r[0]:n.generateResults({experimentId:e,euglenaModelId:t.id,count:t.configuration.count,magnification:o.default.get("currentExperimentResults.magnification")}).then(function(){return n.getModelResults(e,t,!0)})}).then(function(e){return n.normalizeResults(e)}).then(function(e){return r&&o.default.get("Relay").dispatchEvent("Notifications.Remove",{noteId:r,type:"model"}),e})}},{key:"generateResults",value:function(e){return e.bpu_api_id?delete e.tracks:(e.fps=o.default.get("AppConfig.model.simulationFps"),delete e.count,delete e.magnification),i.default.promiseAjax("/api/v1/Results",{method:"POST",data:JSON.stringify(e),contentType:"application/json"})}},{key:"initializeModelEuglena",value:function(e,t,n){var r=[];if("1"===n)for(var o=0;o<e;o++)r.push({x:640*(2*Math.random()-1)/(2*t),y:480*(2*Math.random()-1)/(2*t),z:0,yaw:Math.random()*i.default.TAU,roll:0,pitch:Math.random()*i.default.TAU});else for(var a=0;a<e;a++)r.push({x:640*(2*Math.random()-1)/(2*liveResult.magnification),y:480*(2*Math.random()-1)/(2*liveResult.magnification),z:0,yaw:0,roll:.1,pitch:Math.PI/2});return r}},{key:"experimentMatch",value:function(e,t){if(e.configuration.length!=t.configuration.length)return!1;for(var n=0;n<e.configuration.length;n++){var r=e.configuration[n];for(var i in r)if(r[i]!==t.configuration[n][i])return!1}return!0}}]),e}();t.default=new s},function(e,t,n){"use strict";n.r(t);var r=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},i=function(e){return 1===e.length&&(e=function(e){return function(t,n){return r(e(t),n)}}(e)),{left:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)<0?r=o+1:i=o}return r},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)>0?i=o:r=o+1}return r}}};var o=i(r),a=o.right,s=o.left,u=a,l=function(e,t){null==t&&(t=c);for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return o};function c(e,t){return[e,t]}var f=function(e,t,n){var r,i,o,a,s=e.length,u=t.length,l=new Array(s*u);for(null==n&&(n=c),r=o=0;r<s;++r)for(a=e[r],i=0;i<u;++i,++o)l[o]=n(a,t[i]);return l},d=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},h=function(e){return null===e?NaN:+e},p=function(e,t){var n,r,i=e.length,o=0,a=-1,s=0,u=0;if(null==t)for(;++a<i;)isNaN(n=h(e[a]))||(u+=(r=n-s)*(n-(s+=r/++o)));else for(;++a<i;)isNaN(n=h(t(e[a],a,e)))||(u+=(r=n-s)*(n-(s+=r/++o)));if(o>1)return u/(o-1)},g=function(e,t){var n=p(e,t);return n?Math.sqrt(n):n},m=function(e,t){var n,r,i,o=e.length,a=-1;if(null==t){for(;++a<o;)if(null!=(n=e[a])&&n>=n)for(r=i=n;++a<o;)null!=(n=e[a])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++a<o;)if(null!=(n=t(e[a],a,e))&&n>=n)for(r=i=n;++a<o;)null!=(n=t(e[a],a,e))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},v=Array.prototype,y=v.slice,_=v.map,b=function(e){return function(){return e}},w=function(e){return e},x=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o},E=Math.sqrt(50),M=Math.sqrt(10),C=Math.sqrt(2),T=function(e,t,n){var r,i,o,a,s=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(a=S(e,t,n))||!isFinite(a))return[];if(a>0)for(e=Math.ceil(e/a),t=Math.floor(t/a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(e+s)*a;else for(e=Math.floor(e*a),t=Math.ceil(t*a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(e-s)/a;return r&&o.reverse(),o};function S(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=E?10:o>=M?5:o>=C?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=E?10:o>=M?5:o>=C?2:1)}function O(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=E?i*=10:o>=M?i*=5:o>=C&&(i*=2),t<e?-i:i}var k=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1},A=function(){var e=w,t=m,n=k;function r(r){var i,o,a=r.length,s=new Array(a);for(i=0;i<a;++i)s[i]=e(r[i],i,r);var l=t(s),c=l[0],f=l[1],d=n(s,c,f);Array.isArray(d)||(d=O(c,f,d),d=x(Math.ceil(c/d)*d,Math.floor(f/d)*d,d));for(var h=d.length;d[0]<=c;)d.shift(),--h;for(;d[h-1]>f;)d.pop(),--h;var p,g=new Array(h+1);for(i=0;i<=h;++i)(p=g[i]=[]).x0=i>0?d[i-1]:c,p.x1=i<h?d[i]:f;for(i=0;i<a;++i)c<=(o=s[i])&&o<=f&&g[u(d,o,0,h)].push(r[i]);return g}return r.value=function(t){return arguments.length?(e="function"==typeof t?t:b(t),r):e},r.domain=function(e){return arguments.length?(t="function"==typeof e?e:b([e[0],e[1]]),r):t},r.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?b(y.call(e)):b(e),r):n},r},P=function(e,t,n){if(null==n&&(n=h),r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}},R=function(e,t,n){return e=_.call(e,h).sort(r),Math.ceil((n-t)/(2*(P(e,.75)-P(e,.25))*Math.pow(e.length,-1/3)))},L=function(e,t,n){return Math.ceil((n-t)/(3.5*g(e)*Math.pow(e.length,-1/3)))},j=function(e,t){var n,r,i=e.length,o=-1;if(null==t){for(;++o<i;)if(null!=(n=e[o])&&n>=n)for(r=n;++o<i;)null!=(n=e[o])&&n>r&&(r=n)}else for(;++o<i;)if(null!=(n=t(e[o],o,e))&&n>=n)for(r=n;++o<i;)null!=(n=t(e[o],o,e))&&n>r&&(r=n);return r},D=function(e,t){var n,r=e.length,i=r,o=-1,a=0;if(null==t)for(;++o<r;)isNaN(n=h(e[o]))?--i:a+=n;else for(;++o<r;)isNaN(n=h(t(e[o],o,e)))?--i:a+=n;if(i)return a/i},N=function(e,t){var n,i=e.length,o=-1,a=[];if(null==t)for(;++o<i;)isNaN(n=h(e[o]))||a.push(n);else for(;++o<i;)isNaN(n=h(t(e[o],o,e)))||a.push(n);return P(a.sort(r),.5)},I=function(e){for(var t,n,r,i=e.length,o=-1,a=0;++o<i;)a+=e[o].length;for(n=new Array(a);--i>=0;)for(t=(r=e[i]).length;--t>=0;)n[--a]=r[t];return n},F=function(e,t){var n,r,i=e.length,o=-1;if(null==t){for(;++o<i;)if(null!=(n=e[o])&&n>=n)for(r=n;++o<i;)null!=(n=e[o])&&r>n&&(r=n)}else for(;++o<i;)if(null!=(n=t(e[o],o,e))&&n>=n)for(r=n;++o<i;)null!=(n=t(e[o],o,e))&&r>n&&(r=n);return r},B=function(e,t){for(var n=t.length,r=new Array(n);n--;)r[n]=e[t[n]];return r},U=function(e,t){if(n=e.length){var n,i,o=0,a=0,s=e[a];for(null==t&&(t=r);++o<n;)(t(i=e[o],s)<0||0!==t(s,s))&&(s=i,a=o);return 0===t(s,s)?a:void 0}},z=function(e,t,n){for(var r,i,o=(null==n?e.length:n)-(t=null==t?0:+t);o;)i=Math.random()*o--|0,r=e[o+t],e[o+t]=e[i+t],e[i+t]=r;return e},V=function(e,t){var n,r=e.length,i=-1,o=0;if(null==t)for(;++i<r;)(n=+e[i])&&(o+=n);else for(;++i<r;)(n=+t(e[i],i,e))&&(o+=n);return o},H=function(e){if(!(i=e.length))return[];for(var t=-1,n=F(e,q),r=new Array(n);++t<n;)for(var i,o=-1,a=r[t]=new Array(i);++o<i;)a[o]=e[o][t];return r};function q(e){return e.length}var G=function(){return H(arguments)},W=Array.prototype.slice,X=function(e){return e},Y=1,$=2,J=3,Z=4,K=1e-6;function Q(e){return"translate("+(e+.5)+",0)"}function ee(e){return"translate(0,"+(e+.5)+")"}function te(){return!this.__axis}function ne(e,t){var n=[],r=null,i=null,o=6,a=6,s=3,u=e===Y||e===Z?-1:1,l=e===Z||e===$?"x":"y",c=e===Y||e===J?Q:ee;function f(f){var d=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,h=null==i?t.tickFormat?t.tickFormat.apply(t,n):X:i,p=Math.max(o,0)+s,g=t.range(),m=+g[0]+.5,v=+g[g.length-1]+.5,y=(t.bandwidth?function(e){var t=Math.max(0,e.bandwidth()-1)/2;return e.round()&&(t=Math.round(t)),function(n){return+e(n)+t}}:function(e){return function(t){return+e(t)}})(t.copy()),_=f.selection?f.selection():f,b=_.selectAll(".domain").data([null]),w=_.selectAll(".tick").data(d,t).order(),x=w.exit(),E=w.enter().append("g").attr("class","tick"),M=w.select("line"),C=w.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),w=w.merge(E),M=M.merge(E.append("line").attr("stroke","#000").attr(l+"2",u*o)),C=C.merge(E.append("text").attr("fill","#000").attr(l,u*p).attr("dy",e===Y?"0em":e===J?"0.71em":"0.32em")),f!==_&&(b=b.transition(f),w=w.transition(f),M=M.transition(f),C=C.transition(f),x=x.transition(f).attr("opacity",K).attr("transform",function(e){return isFinite(e=y(e))?c(e):this.getAttribute("transform")}),E.attr("opacity",K).attr("transform",function(e){var t=this.parentNode.__axis;return c(t&&isFinite(t=t(e))?t:y(e))})),x.remove(),b.attr("d",e===Z||e==$?"M"+u*a+","+m+"H0.5V"+v+"H"+u*a:"M"+m+","+u*a+"V0.5H"+v+"V"+u*a),w.attr("opacity",1).attr("transform",function(e){return c(y(e))}),M.attr(l+"2",u*o),C.attr(l,u*p).text(h),_.filter(te).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===$?"start":e===Z?"end":"middle"),_.each(function(){this.__axis=y})}return f.scale=function(e){return arguments.length?(t=e,f):t},f.ticks=function(){return n=W.call(arguments),f},f.tickArguments=function(e){return arguments.length?(n=null==e?[]:W.call(e),f):n.slice()},f.tickValues=function(e){return arguments.length?(r=null==e?null:W.call(e),f):r&&r.slice()},f.tickFormat=function(e){return arguments.length?(i=e,f):i},f.tickSize=function(e){return arguments.length?(o=a=+e,f):o},f.tickSizeInner=function(e){return arguments.length?(o=+e,f):o},f.tickSizeOuter=function(e){return arguments.length?(a=+e,f):a},f.tickPadding=function(e){return arguments.length?(s=+e,f):s},f}function re(e){return ne(Y,e)}function ie(e){return ne($,e)}function oe(e){return ne(J,e)}function ae(e){return ne(Z,e)}var se={value:function(){}};function ue(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r)throw new Error("illegal type: "+e);r[e]=[]}return new le(r)}function le(e){this._=e}function ce(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function fe(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=se,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}le.prototype=ue.prototype={constructor:le,on:function(e,t){var n,r=this._,i=function(e,t){return e.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}(e+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=i[o]).type)r[n]=fe(r[n],e.name,t);else if(null==t)for(n in r)r[n]=fe(r[n],e.name,null);return this}for(;++o<a;)if((n=(e=i[o]).type)&&(n=ce(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new le(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};var de=ue,he="http://www.w3.org/1999/xhtml",pe={svg:"http://www.w3.org/2000/svg",xhtml:he,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ge=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),pe.hasOwnProperty(t)?{space:pe[t],local:e}:e};var me=function(e){var t=ge(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===he&&t.documentElement.namespaceURI===he?t.createElement(e):t.createElementNS(n,e)}})(t)};function ve(){}var ye=function(e){return null==e?ve:function(){return this.querySelector(e)}};function _e(){return[]}var be=function(e){return null==e?_e:function(){return this.querySelectorAll(e)}},we=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var xe=document.documentElement;if(!xe.matches){var Ee=xe.webkitMatchesSelector||xe.msMatchesSelector||xe.mozMatchesSelector||xe.oMatchesSelector;we=function(e){return function(){return Ee.call(this,e)}}}}var Me=we,Ce=function(e){return new Array(e.length)};function Te(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Te.prototype={constructor:Te,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var Se="$";function Oe(e,t,n,r,i,o){for(var a,s=0,u=t.length,l=o.length;s<l;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new Te(e,o[s]);for(;s<u;++s)(a=t[s])&&(i[s]=a)}function ke(e,t,n,r,i,o,a){var s,u,l,c={},f=t.length,d=o.length,h=new Array(f);for(s=0;s<f;++s)(u=t[s])&&(h[s]=l=Se+a.call(u,u.__data__,s,t),l in c?i[s]=u:c[l]=u);for(s=0;s<d;++s)(u=c[l=Se+a.call(e,o[s],s,o)])?(r[s]=u,u.__data__=o[s],c[l]=null):n[s]=new Te(e,o[s]);for(s=0;s<f;++s)(u=t[s])&&c[h[s]]===u&&(i[s]=u)}function Ae(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var Pe=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function Re(e,t){return e.style.getPropertyValue(t)||Pe(e).getComputedStyle(e,null).getPropertyValue(t)}function Le(e){return e.trim().split(/^|\s+/)}function je(e){return e.classList||new De(e)}function De(e){this._node=e,this._names=Le(e.getAttribute("class")||"")}function Ne(e,t){for(var n=je(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Ie(e,t){for(var n=je(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}De.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Fe(){this.textContent=""}function Be(){this.innerHTML=""}function Ue(){this.nextSibling&&this.parentNode.appendChild(this)}function ze(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ve(){return null}function He(){var e=this.parentNode;e&&e.removeChild(this)}function qe(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function Ge(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var We={},Xe=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(We={mouseenter:"mouseover",mouseleave:"mouseout"}));function Ye(e,t,n){return e=$e(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function $e(e,t,n){return function(r){var i=Xe;Xe=r;try{e.call(this,this.__data__,t,n)}finally{Xe=i}}}function Je(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function Ze(e,t,n){var r=We.hasOwnProperty(e.type)?Ye:$e;return function(i,o,a){var s,u=this.__on,l=r(t,o,a);if(u)for(var c=0,f=u.length;c<f;++c)if((s=u[c]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=t);this.addEventListener(e.type,l,n),s={type:e.type,name:e.name,value:t,listener:l,capture:n},u?u.push(s):this.__on=[s]}}function Ke(e,t,n,r){var i=Xe;e.sourceEvent=Xe,Xe=e;try{return t.apply(n,r)}finally{Xe=i}}function Qe(e,t,n){var r=Pe(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}var et=[null];function tt(e,t){this._groups=e,this._parents=t}function nt(){return new tt([[document.documentElement]],et)}tt.prototype=nt.prototype={constructor:tt,select:function(e){"function"!=typeof e&&(e=ye(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=t[i],u=s.length,l=r[i]=new Array(u),c=0;c<u;++c)(o=s[c])&&(a=e.call(o,o.__data__,c,s))&&("__data__"in o&&(a.__data__=o.__data__),l[c]=a);return new tt(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=be(e));for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a,s=t[o],u=s.length,l=0;l<u;++l)(a=s[l])&&(r.push(e.call(a,a.__data__,l,s)),i.push(a));return new tt(r,i)},filter:function(e){"function"!=typeof e&&(e=Me(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,u=r[i]=[],l=0;l<s;++l)(o=a[l])&&e.call(o,o.__data__,l,a)&&u.push(o);return new tt(r,this._parents)},data:function(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(e){h[++l]=e}),h;var n=t?ke:Oe,r=this._parents,i=this._groups;"function"!=typeof e&&(e=function(e){return function(){return e}}(e));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),l=0;l<o;++l){var c=r[l],f=i[l],d=f.length,h=e.call(c,c&&c.__data__,l,r),p=h.length,g=s[l]=new Array(p),m=a[l]=new Array(p);n(c,f,g,m,u[l]=new Array(d),h,t);for(var v,y,_=0,b=0;_<p;++_)if(v=g[_]){for(_>=b&&(b=_+1);!(y=m[b])&&++b<p;);v._next=y||null}}return(a=new tt(a,r))._enter=s,a._exit=u,a},enter:function(){return new tt(this._enter||this._groups.map(Ce),this._parents)},exit:function(){return new tt(this._exit||this._groups.map(Ce),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,l=t[s],c=n[s],f=l.length,d=a[s]=new Array(f),h=0;h<f;++h)(u=l[h]||c[h])&&(d[h]=u);for(;s<r;++s)a[s]=t[s];return new tt(a,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Ae);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,l=i[o]=new Array(u),c=0;c<u;++c)(a=s[c])&&(l[c]=a);l.sort(t)}return new tt(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],a=0,s=o.length;a<s;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var n=ge(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):Re(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=Le(e+"");if(arguments.length<2){for(var r=je(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?Ne:Ie)(this,e)}}:t?function(e){return function(){Ne(this,e)}}:function(e){return function(){Ie(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?Fe:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Be:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(Ue)},lower:function(){return this.each(ze)},append:function(e){var t="function"==typeof e?e:me(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:me(e),r=null==t?Ve:"function"==typeof t?t:ye(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(He)},clone:function(e){return this.select(e?Ge:qe)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),a=o.length;if(!(arguments.length<2)){for(s=t?Ze:Je,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],t,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return Qe(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return Qe(this,e,t)}})(e,t))}};var rt=nt,it=function(e){return"string"==typeof e?new tt([[document.querySelector(e)]],[document.documentElement]):new tt([[e]],et)},ot=function(e){return it(me(e).call(document.documentElement))},at=0;function st(){return new ut}function ut(){this._="@"+(++at).toString(36)}ut.prototype=st.prototype={constructor:ut,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var lt=function(){for(var e,t=Xe;e=t.sourceEvent;)t=e;return t},ct=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]},ft=function(e){var t=lt();return t.changedTouches&&(t=t.changedTouches[0]),ct(e,t)},dt=function(e){return"string"==typeof e?new tt([document.querySelectorAll(e)],[document.documentElement]):new tt([null==e?[]:e],et)},ht=function(e,t,n){arguments.length<3&&(n=t,t=lt().changedTouches);for(var r,i=0,o=t?t.length:0;i<o;++i)if((r=t[i]).identifier===n)return ct(e,r);return null},pt=function(e,t){null==t&&(t=lt().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=ct(e,t[n]);return i};function gt(){Xe.stopImmediatePropagation()}var mt=function(){Xe.preventDefault(),Xe.stopImmediatePropagation()},vt=function(e){var t=e.document.documentElement,n=it(e).on("dragstart.drag",mt,!0);"onselectstart"in t?n.on("selectstart.drag",mt,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")};function yt(e,t){var n=e.document.documentElement,r=it(e).on("dragstart.drag",null);t&&(r.on("click.drag",mt,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var _t=function(e){return function(){return e}};function bt(e,t,n,r,i,o,a,s,u,l){this.target=e,this.type=t,this.subject=n,this.identifier=r,this.active=i,this.x=o,this.y=a,this.dx=s,this.dy=u,this._=l}function wt(){return!Xe.button}function xt(){return this.parentNode}function Et(e){return null==e?{x:Xe.x,y:Xe.y}:e}function Mt(){return"ontouchstart"in this}bt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Ct=function(){var e,t,n,r,i=wt,o=xt,a=Et,s=Mt,u={},l=de("start","drag","end"),c=0,f=0;function d(e){e.on("mousedown.drag",h).filter(s).on("touchstart.drag",m).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(){if(!r&&i.apply(this,arguments)){var a=_("mouse",o.apply(this,arguments),ft,this,arguments);a&&(it(Xe.view).on("mousemove.drag",p,!0).on("mouseup.drag",g,!0),vt(Xe.view),gt(),n=!1,e=Xe.clientX,t=Xe.clientY,a("start"))}}function p(){if(mt(),!n){var r=Xe.clientX-e,i=Xe.clientY-t;n=r*r+i*i>f}u.mouse("drag")}function g(){it(Xe.view).on("mousemove.drag mouseup.drag",null),yt(Xe.view,n),mt(),u.mouse("end")}function m(){if(i.apply(this,arguments)){var e,t,n=Xe.changedTouches,r=o.apply(this,arguments),a=n.length;for(e=0;e<a;++e)(t=_(n[e].identifier,r,ht,this,arguments))&&(gt(),t("start"))}}function v(){var e,t,n=Xe.changedTouches,r=n.length;for(e=0;e<r;++e)(t=u[n[e].identifier])&&(mt(),t("drag"))}function y(){var e,t,n=Xe.changedTouches,i=n.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<i;++e)(t=u[n[e].identifier])&&(gt(),t("end"))}function _(e,t,n,r,i){var o,s,f,h=n(t,e),p=l.copy();if(Ke(new bt(d,"beforestart",o,e,c,h[0],h[1],0,0,p),function(){return null!=(Xe.subject=o=a.apply(r,i))&&(s=o.x-h[0]||0,f=o.y-h[1]||0,!0)}))return function a(l){var g,m=h;switch(l){case"start":u[e]=a,g=c++;break;case"end":delete u[e],--c;case"drag":h=n(t,e),g=c}Ke(new bt(d,l,o,e,g,h[0]+s,h[1]+f,h[0]-m[0],h[1]-m[1],p),p.apply,p,[l,r,i])}}return d.filter=function(e){return arguments.length?(i="function"==typeof e?e:_t(!!e),d):i},d.container=function(e){return arguments.length?(o="function"==typeof e?e:_t(e),d):o},d.subject=function(e){return arguments.length?(a="function"==typeof e?e:_t(e),d):a},d.touchable=function(e){return arguments.length?(s="function"==typeof e?e:_t(!!e),d):s},d.on=function(){var e=l.on.apply(l,arguments);return e===l?d:e},d.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,d):Math.sqrt(f)},d},Tt=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function St(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ot(){}var kt="\\s*([+-]?\\d+)\\s*",At="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Pt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rt=/^#([0-9a-f]{3})$/,Lt=/^#([0-9a-f]{6})$/,jt=new RegExp("^rgb\\("+[kt,kt,kt]+"\\)$"),Dt=new RegExp("^rgb\\("+[Pt,Pt,Pt]+"\\)$"),Nt=new RegExp("^rgba\\("+[kt,kt,kt,At]+"\\)$"),It=new RegExp("^rgba\\("+[Pt,Pt,Pt,At]+"\\)$"),Ft=new RegExp("^hsl\\("+[At,Pt,Pt]+"\\)$"),Bt=new RegExp("^hsla\\("+[At,Pt,Pt,At]+"\\)$"),Ut={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function zt(e){var t;return e=(e+"").trim().toLowerCase(),(t=Rt.exec(e))?new Wt((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=Lt.exec(e))?Vt(parseInt(t[1],16)):(t=jt.exec(e))?new Wt(t[1],t[2],t[3],1):(t=Dt.exec(e))?new Wt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Nt.exec(e))?Ht(t[1],t[2],t[3],t[4]):(t=It.exec(e))?Ht(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ft.exec(e))?Yt(t[1],t[2]/100,t[3]/100,1):(t=Bt.exec(e))?Yt(t[1],t[2]/100,t[3]/100,t[4]):Ut.hasOwnProperty(e)?Vt(Ut[e]):"transparent"===e?new Wt(NaN,NaN,NaN,0):null}function Vt(e){return new Wt(e>>16&255,e>>8&255,255&e,1)}function Ht(e,t,n,r){return r<=0&&(e=t=n=NaN),new Wt(e,t,n,r)}function qt(e){return e instanceof Ot||(e=zt(e)),e?new Wt((e=e.rgb()).r,e.g,e.b,e.opacity):new Wt}function Gt(e,t,n,r){return 1===arguments.length?qt(e):new Wt(e,t,n,null==r?1:r)}function Wt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Xt(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Yt(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Jt(e,t,n,r)}function $t(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Jt)return new Jt(e.h,e.s,e.l,e.opacity);if(e instanceof Ot||(e=zt(e)),!e)return new Jt;if(e instanceof Jt)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Jt(a,s,u,e.opacity)}(e):new Jt(e,t,n,null==r?1:r)}function Jt(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Zt(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Tt(Ot,zt,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),Tt(Wt,Gt,St(Ot,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Wt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Wt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+Xt(this.r)+Xt(this.g)+Xt(this.b)},toString:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),Tt(Jt,$t,St(Ot,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Jt(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Jt(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Wt(Zt(e>=240?e-240:e+120,i,r),Zt(e,i,r),Zt(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Kt=Math.PI/180,Qt=180/Math.PI,en=.96422,tn=1,nn=.82521,rn=4/29,on=6/29,an=3*on*on,sn=on*on*on;function un(e){if(e instanceof fn)return new fn(e.l,e.a,e.b,e.opacity);if(e instanceof _n){if(isNaN(e.h))return new fn(e.l,0,0,e.opacity);var t=e.h*Kt;return new fn(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof Wt||(e=qt(e));var n,r,i=gn(e.r),o=gn(e.g),a=gn(e.b),s=dn((.2225045*i+.7168786*o+.0606169*a)/tn);return i===o&&o===a?n=r=s:(n=dn((.4360747*i+.3850649*o+.1430804*a)/en),r=dn((.0139322*i+.0971045*o+.7141733*a)/nn)),new fn(116*s-16,500*(n-s),200*(s-r),e.opacity)}function ln(e,t){return new fn(e,0,0,null==t?1:t)}function cn(e,t,n,r){return 1===arguments.length?un(e):new fn(e,t,n,null==r?1:r)}function fn(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function dn(e){return e>sn?Math.pow(e,1/3):e/an+rn}function hn(e){return e>on?e*e*e:an*(e-rn)}function pn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function gn(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function mn(e){if(e instanceof _n)return new _n(e.h,e.c,e.l,e.opacity);if(e instanceof fn||(e=un(e)),0===e.a&&0===e.b)return new _n(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Qt;return new _n(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function vn(e,t,n,r){return 1===arguments.length?mn(e):new _n(n,t,e,null==r?1:r)}function yn(e,t,n,r){return 1===arguments.length?mn(e):new _n(e,t,n,null==r?1:r)}function _n(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}Tt(fn,cn,St(Ot,{brighter:function(e){return new fn(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new fn(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Wt(pn(3.1338561*(t=en*hn(t))-1.6168667*(e=tn*hn(e))-.4906146*(n=nn*hn(n))),pn(-.9787684*t+1.9161415*e+.033454*n),pn(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Tt(_n,yn,St(Ot,{brighter:function(e){return new _n(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new _n(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return un(this).rgb()}}));var bn=-.29227,wn=-.90649,xn=1.97294,En=xn*wn,Mn=1.78277*xn,Cn=1.78277*bn- -.14861*wn;function Tn(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Sn)return new Sn(e.h,e.s,e.l,e.opacity);e instanceof Wt||(e=qt(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Cn*r+En*t-Mn*n)/(Cn+En-Mn),o=r-i,a=(xn*(n-i)-bn*o)/wn,s=Math.sqrt(a*a+o*o)/(xn*i*(1-i)),u=s?Math.atan2(a,o)*Qt-120:NaN;return new Sn(u<0?u+360:u,s,i,e.opacity)}(e):new Sn(e,t,n,null==r?1:r)}function Sn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function On(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}Tt(Sn,Tn,St(Ot,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Sn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Sn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Kt,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Wt(255*(t+n*(-.14861*r+1.78277*i)),255*(t+n*(bn*r+wn*i)),255*(t+n*(xn*r)),this.opacity)}}));var kn=function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return On((n-r/t)*t,a,i,o,s)}},An=function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return On((n-r/t)*t,i,o,a,s)}},Pn=function(e){return function(){return e}};function Rn(e,t){return function(n){return e+n*t}}function Ln(e,t){var n=t-e;return n?Rn(e,n>180||n<-180?n-360*Math.round(n/360):n):Pn(isNaN(e)?t:e)}function jn(e){return 1==(e=+e)?Dn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Pn(isNaN(t)?n:t)}}function Dn(e,t){var n=t-e;return n?Rn(e,n):Pn(isNaN(e)?t:e)}var Nn=function e(t){var n=jn(t);function r(e,t){var r=n((e=Gt(e)).r,(t=Gt(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=Dn(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function In(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Gt(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}var Fn=In(kn),Bn=In(An),Un=function(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Zn(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}},zn=function(e,t){var n=new Date;return t-=e=+e,function(r){return n.setTime(e+t*r),n}},Vn=function(e,t){return t-=e=+e,function(n){return e+t*n}},Hn=function(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Zn(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}},qn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Gn=new RegExp(qn.source,"g");var Wn,Xn,Yn,$n,Jn=function(e,t){var n,r,i,o=qn.lastIndex=Gn.lastIndex=0,a=-1,s=[],u=[];for(e+="",t+="";(n=qn.exec(e))&&(r=Gn.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Vn(n,r)})),o=Gn.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})},Zn=function(e,t){var n,r=typeof t;return null==t||"boolean"===r?Pn(t):("number"===r?Vn:"string"===r?(n=zt(t))?(t=n,Nn):Jn:t instanceof zt?Nn:t instanceof Date?zn:Array.isArray(t)?Un:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Hn:Vn)(e,t)},Kn=function(e,t){return t-=e=+e,function(n){return Math.round(e+t*n)}},Qn=180/Math.PI,er={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},tr=function(e,t,n,r,i,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Qn,skewX:Math.atan(u)*Qn,scaleX:a,scaleY:s}};function nr(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],u=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var u=a.push("translate(",null,t,null,n);s.push({i:u-4,x:Vn(e,i)},{i:u-2,x:Vn(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Vn(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,u),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Vn(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,u),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Vn(e,n)},{i:s-2,x:Vn(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var rr=nr(function(e){return"none"===e?er:(Wn||(Wn=document.createElement("DIV"),Xn=document.documentElement,Yn=document.defaultView),Wn.style.transform=e,e=Yn.getComputedStyle(Xn.appendChild(Wn),null).getPropertyValue("transform"),Xn.removeChild(Wn),e=e.slice(7,-1).split(","),tr(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),ir=nr(function(e){return null==e?er:($n||($n=document.createElementNS("http://www.w3.org/2000/svg","g")),$n.setAttribute("transform",e),(e=$n.transform.baseVal.consolidate())?(e=e.matrix,tr(e.a,e.b,e.c,e.d,e.e,e.f)):er)},", ",")",")"),or=Math.SQRT2;function ar(e){return((e=Math.exp(e))+1/e)/2}var sr=function(e,t){var n,r,i=e[0],o=e[1],a=e[2],s=t[0],u=t[1],l=t[2],c=s-i,f=u-o,d=c*c+f*f;if(d<1e-12)r=Math.log(l/a)/or,n=function(e){return[i+e*c,o+e*f,a*Math.exp(or*e*r)]};else{var h=Math.sqrt(d),p=(l*l-a*a+4*d)/(2*a*2*h),g=(l*l-a*a-4*d)/(2*l*2*h),m=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(g*g+1)-g);r=(v-m)/or,n=function(e){var t=e*r,n=ar(m),s=a/(2*h)*(n*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(or*t+m)-function(e){return((e=Math.exp(e))-1/e)/2}(m));return[i+s*c,o+s*f,a*n/ar(or*t+m)]}}return n.duration=1e3*r,n};function ur(e){return function(t,n){var r=e((t=$t(t)).h,(n=$t(n)).h),i=Dn(t.s,n.s),o=Dn(t.l,n.l),a=Dn(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var lr=ur(Ln),cr=ur(Dn);function fr(e,t){var n=Dn((e=cn(e)).l,(t=cn(t)).l),r=Dn(e.a,t.a),i=Dn(e.b,t.b),o=Dn(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}}function dr(e){return function(t,n){var r=e((t=yn(t)).h,(n=yn(n)).h),i=Dn(t.c,n.c),o=Dn(t.l,n.l),a=Dn(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=o(e),t.opacity=a(e),t+""}}}var hr=dr(Ln),pr=dr(Dn);function gr(e){return function t(n){function r(t,r){var i=e((t=Tn(t)).h,(r=Tn(r)).h),o=Dn(t.s,r.s),a=Dn(t.l,r.l),s=Dn(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}var mr=gr(Ln),vr=gr(Dn);function yr(e,t){for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}var _r,br,wr=function(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n},xr=0,Er=0,Mr=0,Cr=1e3,Tr=0,Sr=0,Or=0,kr="object"==typeof performance&&performance.now?performance:Date,Ar="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Pr(){return Sr||(Ar(Rr),Sr=kr.now()+Or)}function Rr(){Sr=0}function Lr(){this._call=this._time=this._next=null}function jr(e,t,n){var r=new Lr;return r.restart(e,t,n),r}function Dr(){Pr(),++xr;for(var e,t=_r;t;)(e=Sr-t._time)>=0&&t._call.call(null,e),t=t._next;--xr}function Nr(){Sr=(Tr=kr.now())+Or,xr=Er=0;try{Dr()}finally{xr=0,function(){var e,t,n=_r,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:_r=t);br=e,Fr(r)}(),Sr=0}}function Ir(){var e=kr.now(),t=e-Tr;t>Cr&&(Or-=t,Tr=e)}function Fr(e){xr||(Er&&(Er=clearTimeout(Er)),e-Sr>24?(e<1/0&&(Er=setTimeout(Nr,e-kr.now()-Or)),Mr&&(Mr=clearInterval(Mr))):(Mr||(Tr=kr.now(),Mr=setInterval(Ir,Cr)),xr=1,Ar(Nr)))}Lr.prototype=jr.prototype={constructor:Lr,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?Pr():+n)+(null==t?0:+t),this._next||br===this||(br?br._next=this:_r=this,br=this),this._call=e,this._time=n,Fr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fr())}};var Br=function(e,t,n){var r=new Lr;return t=null==t?0:+t,r.restart(function(n){r.stop(),e(n+t)},t,n),r},Ur=function(e,t,n){var r=new Lr,i=t;return null==t?(r.restart(e,t,n),r):(t=+t,n=null==n?Pr():+n,r.restart(function o(a){a+=i,r.restart(o,i+=t,n),e(a)},t,n),r)},zr=de("start","end","interrupt"),Vr=[],Hr=0,qr=1,Gr=2,Wr=3,Xr=4,Yr=5,$r=6,Jr=function(e,t,n,r,i,o){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function o(u){var l,c,f,d;if(n.state!==qr)return s();for(l in i)if((d=i[l]).name===n.name){if(d.state===Wr)return Br(o);d.state===Xr?(d.state=$r,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[l]):+l<t&&(d.state=$r,d.timer.stop(),delete i[l])}if(Br(function(){n.state===Wr&&(n.state=Xr,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Gr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Gr){for(n.state=Wr,r=new Array(f=n.tween.length),l=0,c=-1;l<f;++l)(d=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(r[++c]=d);r.length=c+1}}function a(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=Yr,1),o=-1,a=r.length;++o<a;)r[o].call(null,i);n.state===Yr&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var r in n.state=$r,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=jr(function(e){n.state=qr,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)},0,n.time)}(e,n,{name:t,index:r,group:i,on:zr,tween:Vr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Hr})};function Zr(e,t){var n=Qr(e,t);if(n.state>Hr)throw new Error("too late; already scheduled");return n}function Kr(e,t){var n=Qr(e,t);if(n.state>Gr)throw new Error("too late; already started");return n}function Qr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var ei=function(e,t){var n,r,i,o=e.__transition,a=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>Gr&&n.state<Yr,n.state=$r,n.timer.stop(),r&&n.on.call("interrupt",e,e.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete e.__transition}};function ti(e,t,n){var r=e._id;return e.each(function(){var e=Kr(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return Qr(e,r).value[t]}}var ni=function(e,t){var n;return("number"==typeof t?Vn:t instanceof zt?Nn:(n=zt(t))?(t=n,Nn):Jn)(e,t)};var ri=rt.prototype.constructor;var ii=0;function oi(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ai(e){return rt().transition(e)}function si(){return++ii}var ui=rt.prototype;function li(e){return+e}function ci(e){return e*e}function fi(e){return e*(2-e)}function di(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function hi(e){return e*e*e}function pi(e){return--e*e*e+1}function gi(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}oi.prototype=ai.prototype={constructor:oi,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=ye(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,u,l=r[a],c=l.length,f=o[a]=new Array(c),d=0;d<c;++d)(s=l[d])&&(u=e.call(s,s.__data__,d,l))&&("__data__"in s&&(u.__data__=s.__data__),f[d]=u,Jr(f[d],t,n,d,f,Qr(s,n)));return new oi(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=be(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var u,l=r[s],c=l.length,f=0;f<c;++f)if(u=l[f]){for(var d,h=e.call(u,u.__data__,f,l),p=Qr(u,n),g=0,m=h.length;g<m;++g)(d=h[g])&&Jr(d,t,n,g,h,p);o.push(h),a.push(u)}return new oi(o,a,t,n)},filter:function(e){"function"!=typeof e&&(e=Me(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],s=a.length,u=r[i]=[],l=0;l<s;++l)(o=a[l])&&e.call(o,o.__data__,l,a)&&u.push(o);return new oi(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,l=t[s],c=n[s],f=l.length,d=a[s]=new Array(f),h=0;h<f;++h)(u=l[h]||c[h])&&(d[h]=u);for(;s<r;++s)a[s]=t[s];return new oi(a,this._parents,this._name,this._id)},selection:function(){return new ri(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=si(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,l=0;l<u;++l)if(a=s[l]){var c=Qr(a,t);Jr(a,e,n,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new oi(r,this._parents,e,n)},call:ui.call,nodes:ui.nodes,node:ui.node,size:ui.size,empty:ui.empty,each:ui.each,on:function(e,t){var n=this._id;return arguments.length<2?Qr(this.node(),n).on.on(e):this.each(function(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?Zr:Kr;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}(n,e,t))},attr:function(e,t){var n=ge(e),r="transform"===n?ir:ni;return this.attrTween(e,"function"==typeof t?(n.local?function(e,t,n){var r,i,o;return function(){var a,s=n(this);if(null!=s)return(a=this.getAttributeNS(e.space,e.local))===s?null:a===r&&s===i?o:o=t(r=a,i=s);this.removeAttributeNS(e.space,e.local)}}:function(e,t,n){var r,i,o;return function(){var a,s=n(this);if(null!=s)return(a=this.getAttribute(e))===s?null:a===r&&s===i?o:o=t(r=a,i=s);this.removeAttribute(e)}})(n,r,ti(this,"attr."+e,t)):null==t?(n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}})(n):(n.local?function(e,t,n){var r,i;return function(){var o=this.getAttributeNS(e.space,e.local);return o===n?null:o===r?i:i=t(r=o,n)}}:function(e,t,n){var r,i;return function(){var o=this.getAttribute(e);return o===n?null:o===r?i:i=t(r=o,n)}})(n,r,t+""))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=ge(e);return this.tween(n,(r.local?function(e,t){function n(){var n=this,r=t.apply(n,arguments);return r&&function(t){n.setAttributeNS(e.space,e.local,r(t))}}return n._value=t,n}:function(e,t){function n(){var n=this,r=t.apply(n,arguments);return r&&function(t){n.setAttribute(e,r(t))}}return n._value=t,n})(r,t))},style:function(e,t,n){var r="transform"==(e+="")?rr:ni;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=Re(this,e),a=(this.style.removeProperty(e),Re(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}(e,r)).on("end.style."+e,function(e){return function(){this.style.removeProperty(e)}}(e)):this.styleTween(e,"function"==typeof t?function(e,t,n){var r,i,o;return function(){var a=Re(this,e),s=n(this);return null==s&&(this.style.removeProperty(e),s=Re(this,e)),a===s?null:a===r&&s===i?o:o=t(r=a,i=s)}}(e,r,ti(this,"style."+e,t)):function(e,t,n){var r,i;return function(){var o=Re(this,e);return o===n?null:o===r?i:i=t(r=o,n)}}(e,r,t+""),n)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,function(e,t,n){function r(){var r=this,i=t.apply(r,arguments);return i&&function(t){r.style.setProperty(e,i(t),n)}}return r._value=t,r}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(ti(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=Qr(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?function(e,t){var n,r;return function(){var i=Kr(this,e),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}i.tween=r}}:function(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Kr(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===t){i[u]=s;break}u===l&&i.push(s)}o.tween=i}})(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){Zr(this,e).delay=+t.apply(this,arguments)}}:function(e,t){return t=+t,function(){Zr(this,e).delay=t}})(t,e)):Qr(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){Kr(this,e).duration=+t.apply(this,arguments)}}:function(e,t){return t=+t,function(){Kr(this,e).duration=t}})(t,e)):Qr(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){Kr(this,e).ease=t}}(t,e)):Qr(this.node(),t).ease}};var mi=function e(t){function n(e){return Math.pow(e,t)}return t=+t,n.exponent=e,n}(3),vi=function e(t){function n(e){return 1-Math.pow(1-e,t)}return t=+t,n.exponent=e,n}(3),yi=function e(t){function n(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,n.exponent=e,n}(3),_i=Math.PI,bi=_i/2;function wi(e){return 1-Math.cos(e*bi)}function xi(e){return Math.sin(e*bi)}function Ei(e){return(1-Math.cos(_i*e))/2}function Mi(e){return Math.pow(2,10*e-10)}function Ci(e){return 1-Math.pow(2,-10*e)}function Ti(e){return((e*=2)<=1?Math.pow(2,10*e-10):2-Math.pow(2,10-10*e))/2}function Si(e){return 1-Math.sqrt(1-e*e)}function Oi(e){return Math.sqrt(1- --e*e)}function ki(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var Ai=4/11,Pi=6/11,Ri=8/11,Li=.75,ji=9/11,Di=10/11,Ni=.9375,Ii=21/22,Fi=63/64,Bi=1/Ai/Ai;function Ui(e){return 1-zi(1-e)}function zi(e){return(e=+e)<Ai?Bi*e*e:e<Ri?Bi*(e-=Pi)*e+Li:e<Di?Bi*(e-=ji)*e+Ni:Bi*(e-=Ii)*e+Fi}function Vi(e){return((e*=2)<=1?1-zi(1-e):zi(e-1)+1)/2}var Hi=function e(t){function n(e){return e*e*((t+1)*e-t)}return t=+t,n.overshoot=e,n}(1.70158),qi=function e(t){function n(e){return--e*e*((t+1)*e+t)+1}return t=+t,n.overshoot=e,n}(1.70158),Gi=function e(t){function n(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,n.overshoot=e,n}(1.70158),Wi=2*Math.PI,Xi=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Wi);function i(e){return t*Math.pow(2,10*--e)*Math.sin((r-e)/n)}return i.amplitude=function(t){return e(t,n*Wi)},i.period=function(n){return e(t,n)},i}(1,.3),Yi=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Wi);function i(e){return 1-t*Math.pow(2,-10*(e=+e))*Math.sin((e+r)/n)}return i.amplitude=function(t){return e(t,n*Wi)},i.period=function(n){return e(t,n)},i}(1,.3),$i=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Wi);function i(e){return((e=2*e-1)<0?t*Math.pow(2,10*e)*Math.sin((r-e)/n):2-t*Math.pow(2,-10*e)*Math.sin((r+e)/n))/2}return i.amplitude=function(t){return e(t,n*Wi)},i.period=function(n){return e(t,n)},i}(1,.3),Ji={time:null,delay:0,duration:250,ease:gi};function Zi(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))return Ji.time=Pr(),Ji;return n}rt.prototype.interrupt=function(e){return this.each(function(){ei(this,e)})},rt.prototype.transition=function(e){var t,n;e instanceof oi?(t=e._id,e=e._name):(t=si(),(n=Ji).time=Pr(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,l=0;l<u;++l)(a=s[l])&&Jr(a,e,t,l,s,n||Zi(a,t));return new oi(r,this._parents,e,t)};var Ki=[null],Qi=function(e,t){var n,r,i=e.__transition;if(i)for(r in t=null==t?null:t+"",i)if((n=i[r]).state>qr&&n.name===t)return new oi([[e]],Ki,t,+r);return null},eo=function(e){return function(){return e}},to=function(e,t,n){this.target=e,this.type=t,this.selection=n};function no(){Xe.stopImmediatePropagation()}var ro=function(){Xe.preventDefault(),Xe.stopImmediatePropagation()},io={name:"drag"},oo={name:"space"},ao={name:"handle"},so={name:"center"},uo={name:"x",handles:["e","w"].map(vo),input:function(e,t){return e&&[[e[0],t[0][1]],[e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},lo={name:"y",handles:["n","s"].map(vo),input:function(e,t){return e&&[[t[0][0],e[0]],[t[1][0],e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},co={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(vo),input:function(e){return e},output:function(e){return e}},fo={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ho={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},po={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},go={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},mo={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function vo(e){return{type:e}}function yo(){return!Xe.button}function _o(){var e=this.ownerSVGElement||this;return[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function bo(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function wo(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function xo(e){var t=e.__brush;return t?t.dim.output(t.selection):null}function Eo(){return To(uo)}function Mo(){return To(lo)}var Co=function(){return To(co)};function To(e){var t,n=_o,r=yo,i=de(a,"start","brush","end"),o=6;function a(t){var n=t.property("__brush",f).selectAll(".overlay").data([vo("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",fo.overlay).merge(n).each(function(){var e=bo(this).extent;it(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])}),t.selectAll(".selection").data([vo("selection")]).enter().append("rect").attr("class","selection").attr("cursor",fo.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(e.handles,function(e){return e.type});r.exit().remove(),r.enter().append("rect").attr("class",function(e){return"handle handle--"+e.type}).attr("cursor",function(e){return fo[e.type]}),t.each(s).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",c)}function s(){var e=it(this),t=bo(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",function(e){return"e"===e.type[e.type.length-1]?t[1][0]-o/2:t[0][0]-o/2}).attr("y",function(e){return"s"===e.type[0]?t[1][1]-o/2:t[0][1]-o/2}).attr("width",function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+o:o}).attr("height",function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+o:o})):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(e,t){return e.__brush.emitter||new l(e,t)}function l(e,t){this.that=e,this.args=t,this.state=e.__brush,this.active=0}function c(){if(Xe.touches){if(Xe.changedTouches.length<Xe.touches.length)return ro()}else if(t)return;if(r.apply(this,arguments)){var n,i,o,a,l,c,f,d,h,p,g,m,v,y=this,_=Xe.target.__data__.type,b="selection"===(Xe.metaKey?_="overlay":_)?io:Xe.altKey?so:ao,w=e===lo?null:go[_],x=e===uo?null:mo[_],E=bo(y),M=E.extent,C=E.selection,T=M[0][0],S=M[0][1],O=M[1][0],k=M[1][1],A=w&&x&&Xe.shiftKey,P=ft(y),R=P,L=u(y,arguments).beforestart();"overlay"===_?E.selection=C=[[n=e===lo?T:P[0],o=e===uo?S:P[1]],[l=e===lo?O:n,f=e===uo?k:o]]:(n=C[0][0],o=C[0][1],l=C[1][0],f=C[1][1]),i=n,a=o,c=l,d=f;var j=it(y).attr("pointer-events","none"),D=j.selectAll(".overlay").attr("cursor",fo[_]);if(Xe.touches)j.on("touchmove.brush",I,!0).on("touchend.brush touchcancel.brush",B,!0);else{var N=it(Xe.view).on("keydown.brush",function(){switch(Xe.keyCode){case 16:A=w&&x;break;case 18:b===ao&&(w&&(l=c-h*w,n=i+h*w),x&&(f=d-p*x,o=a+p*x),b=so,F());break;case 32:b!==ao&&b!==so||(w<0?l=c-h:w>0&&(n=i-h),x<0?f=d-p:x>0&&(o=a-p),b=oo,D.attr("cursor",fo.selection),F());break;default:return}ro()},!0).on("keyup.brush",function(){switch(Xe.keyCode){case 16:A&&(m=v=A=!1,F());break;case 18:b===so&&(w<0?l=c:w>0&&(n=i),x<0?f=d:x>0&&(o=a),b=ao,F());break;case 32:b===oo&&(Xe.altKey?(w&&(l=c-h*w,n=i+h*w),x&&(f=d-p*x,o=a+p*x),b=so):(w<0?l=c:w>0&&(n=i),x<0?f=d:x>0&&(o=a),b=ao),D.attr("cursor",fo[_]),F());break;default:return}ro()},!0).on("mousemove.brush",I,!0).on("mouseup.brush",B,!0);vt(Xe.view)}no(),ei(y),s.call(y),L.start()}function I(){var e=ft(y);!A||m||v||(Math.abs(e[0]-R[0])>Math.abs(e[1]-R[1])?v=!0:m=!0),R=e,g=!0,ro(),F()}function F(){var e;switch(h=R[0]-P[0],p=R[1]-P[1],b){case oo:case io:w&&(h=Math.max(T-n,Math.min(O-l,h)),i=n+h,c=l+h),x&&(p=Math.max(S-o,Math.min(k-f,p)),a=o+p,d=f+p);break;case ao:w<0?(h=Math.max(T-n,Math.min(O-n,h)),i=n+h,c=l):w>0&&(h=Math.max(T-l,Math.min(O-l,h)),i=n,c=l+h),x<0?(p=Math.max(S-o,Math.min(k-o,p)),a=o+p,d=f):x>0&&(p=Math.max(S-f,Math.min(k-f,p)),a=o,d=f+p);break;case so:w&&(i=Math.max(T,Math.min(O,n-h*w)),c=Math.max(T,Math.min(O,l+h*w))),x&&(a=Math.max(S,Math.min(k,o-p*x)),d=Math.max(S,Math.min(k,f+p*x)))}c<i&&(w*=-1,e=n,n=l,l=e,e=i,i=c,c=e,_ in ho&&D.attr("cursor",fo[_=ho[_]])),d<a&&(x*=-1,e=o,o=f,f=e,e=a,a=d,d=e,_ in po&&D.attr("cursor",fo[_=po[_]])),E.selection&&(C=E.selection),m&&(i=C[0][0],c=C[1][0]),v&&(a=C[0][1],d=C[1][1]),C[0][0]===i&&C[0][1]===a&&C[1][0]===c&&C[1][1]===d||(E.selection=[[i,a],[c,d]],s.call(y),L.brush())}function B(){if(no(),Xe.touches){if(Xe.touches.length)return;t&&clearTimeout(t),t=setTimeout(function(){t=null},500),j.on("touchmove.brush touchend.brush touchcancel.brush",null)}else yt(Xe.view,g),N.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);j.attr("pointer-events","all"),D.attr("cursor",fo.overlay),E.selection&&(C=E.selection),wo(C)&&(E.selection=null,s.call(y)),L.end()}}function f(){var t=this.__brush||{selection:null};return t.extent=n.apply(this,arguments),t.dim=e,t}return a.move=function(t,n){t.selection?t.on("start.brush",function(){u(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){u(this,arguments).end()}).tween("brush",function(){var t=this,r=t.__brush,i=u(t,arguments),o=r.selection,a=e.input("function"==typeof n?n.apply(this,arguments):n,r.extent),l=Zn(o,a);function c(e){r.selection=1===e&&wo(a)?null:l(e),s.call(t),i.brush()}return o&&a?c:c(1)}):t.each(function(){var t=arguments,r=this.__brush,i=e.input("function"==typeof n?n.apply(this,t):n,r.extent),o=u(this,t).beforestart();ei(this),r.selection=null==i||wo(i)?null:i,s.call(this),o.start().brush().end()})},l.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){Ke(new to(a,t,e.output(this.state.selection)),i.apply,i,[t,this.that,this.args])}},a.extent=function(e){return arguments.length?(n="function"==typeof e?e:eo([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),a):n},a.filter=function(e){return arguments.length?(r="function"==typeof e?e:eo(!!e),a):r},a.handleSize=function(e){return arguments.length?(o=+e,a):o},a.on=function(){var e=i.on.apply(i,arguments);return e===i?a:e},a}var So=Math.cos,Oo=Math.sin,ko=Math.PI,Ao=ko/2,Po=2*ko,Ro=Math.max;var Lo=function(){var e=0,t=null,n=null,r=null;function i(i){var o,a,s,u,l,c,f=i.length,d=[],h=x(f),p=[],g=[],m=g.groups=new Array(f),v=new Array(f*f);for(o=0,l=-1;++l<f;){for(a=0,c=-1;++c<f;)a+=i[l][c];d.push(a),p.push(x(f)),o+=a}for(t&&h.sort(function(e,n){return t(d[e],d[n])}),n&&p.forEach(function(e,t){e.sort(function(e,r){return n(i[t][e],i[t][r])})}),u=(o=Ro(0,Po-e*f)/o)?e:Po/f,a=0,l=-1;++l<f;){for(s=a,c=-1;++c<f;){var y=h[l],_=p[y][c],b=i[y][_],w=a,E=a+=b*o;v[_*f+y]={index:y,subindex:_,startAngle:w,endAngle:E,value:b}}m[y]={index:y,startAngle:s,endAngle:a,value:d[y]},a+=u}for(l=-1;++l<f;)for(c=l-1;++c<f;){var M=v[c*f+l],C=v[l*f+c];(M.value||C.value)&&g.push(M.value<C.value?{source:C,target:M}:{source:M,target:C})}return r?g.sort(r):g}return i.padAngle=function(t){return arguments.length?(e=Ro(0,t),i):e},i.sortGroups=function(e){return arguments.length?(t=e,i):t},i.sortSubgroups=function(e){return arguments.length?(n=e,i):n},i.sortChords=function(e){return arguments.length?(null==e?r=null:(r=function(e){return function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)}}(e))._=e,i):r&&r._},i},jo=Array.prototype.slice,Do=function(e){return function(){return e}},No=Math.PI,Io=2*No,Fo=Io-1e-6;function Bo(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Uo(){return new Bo}Bo.prototype=Uo.prototype={constructor:Bo,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-e,u=r-t,l=o-e,c=a-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>1e-6)if(Math.abs(c*s-u*l)>1e-6&&i){var d=n-o,h=r-a,p=s*s+u*u,g=d*d+h*h,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((No-Math.acos((p+f-g)/(2*m*v)))/2),_=y/v,b=y/m;Math.abs(_-1)>1e-6&&(this._+="L"+(e+_*l)+","+(t+_*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+b*s)+","+(this._y1=t+b*u)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,i,o){e=+e,t=+t;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=e+a,l=t+s,c=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+u+","+l),n&&(f<0&&(f=f%Io+Io),f>Fo?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=No)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var zo=Uo;function Vo(e){return e.source}function Ho(e){return e.target}function qo(e){return e.radius}function Go(e){return e.startAngle}function Wo(e){return e.endAngle}var Xo=function(){var e=Vo,t=Ho,n=qo,r=Go,i=Wo,o=null;function a(){var a,s=jo.call(arguments),u=e.apply(this,s),l=t.apply(this,s),c=+n.apply(this,(s[0]=u,s)),f=r.apply(this,s)-Ao,d=i.apply(this,s)-Ao,h=c*So(f),p=c*Oo(f),g=+n.apply(this,(s[0]=l,s)),m=r.apply(this,s)-Ao,v=i.apply(this,s)-Ao;if(o||(o=a=zo()),o.moveTo(h,p),o.arc(0,0,c,f,d),f===m&&d===v||(o.quadraticCurveTo(0,0,g*So(m),g*Oo(m)),o.arc(0,0,g,m,v)),o.quadraticCurveTo(0,0,h,p),o.closePath(),a)return o=null,a+""||null}return a.radius=function(e){return arguments.length?(n="function"==typeof e?e:Do(+e),a):n},a.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:Do(+e),a):r},a.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:Do(+e),a):i},a.source=function(t){return arguments.length?(e=t,a):e},a.target=function(e){return arguments.length?(t=e,a):t},a.context=function(e){return arguments.length?(o=null==e?null:e,a):o},a};function Yo(){}function $o(e,t){var n=new Yo;if(e instanceof Yo)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var r,i=-1,o=e.length;if(null==t)for(;++i<o;)n.set(i,e[i]);else for(;++i<o;)n.set(t(r=e[i],i,e),r)}else if(e)for(var a in e)n.set(a,e[a]);return n}Yo.prototype=$o.prototype={constructor:Yo,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var Jo=$o,Zo=function(){var e,t,n,r=[],i=[];function o(n,i,a,s){if(i>=r.length)return null!=e&&n.sort(e),null!=t?t(n):n;for(var u,l,c,f=-1,d=n.length,h=r[i++],p=Jo(),g=a();++f<d;)(c=p.get(u=h(l=n[f])+""))?c.push(l):p.set(u,[l]);return p.each(function(e,t){s(g,t,o(e,i,a,s))}),g}return n={object:function(e){return o(e,0,Ko,Qo)},map:function(e){return o(e,0,ea,ta)},entries:function(e){return function e(n,o){if(++o>r.length)return n;var a,s=i[o-1];return null!=t&&o>=r.length?a=n.entries():(a=[],n.each(function(t,n){a.push({key:n,values:e(t,o)})})),null!=s?a.sort(function(e,t){return s(e.key,t.key)}):a}(o(e,0,ea,ta),0)},key:function(e){return r.push(e),n},sortKeys:function(e){return i[r.length-1]=e,n},sortValues:function(t){return e=t,n},rollup:function(e){return t=e,n}}};function Ko(){return{}}function Qo(e,t,n){e[t]=n}function ea(){return Jo()}function ta(e,t,n){e.set(t,n)}function na(){}var ra=Jo.prototype;function ia(e,t){var n=new na;if(e instanceof na)e.each(function(e){n.add(e)});else if(e){var r=-1,i=e.length;if(null==t)for(;++r<i;)n.add(e[r]);else for(;++r<i;)n.add(t(e[r],r,e))}return n}na.prototype=ia.prototype={constructor:na,has:ra.has,add:function(e){return this["$"+(e+="")]=e,this},remove:ra.remove,clear:ra.clear,values:ra.keys,size:ra.size,empty:ra.empty,each:ra.each};var oa=ia,aa=function(e){var t=[];for(var n in e)t.push(n);return t},sa=function(e){var t=[];for(var n in e)t.push(e[n]);return t},ua=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},la=Array.prototype.slice,ca=function(e,t){return e-t},fa=function(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r},da=function(e){return function(){return e}},ha=function(e,t){for(var n,r=-1,i=t.length;++r<i;)if(n=pa(e,t[r]))return n;return 0};function pa(e,t){for(var n=t[0],r=t[1],i=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(ga(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function ga(e,t,n){var r;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&function(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}(e[r=+(e[0]===t[0])],n[r],t[r])}var ma=function(){},va=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],ya=function(){var e=1,t=1,n=k,r=s;function i(e){var t=n(e);if(Array.isArray(t))t=t.slice().sort(ca);else{var r=m(e),i=r[0],a=r[1];t=O(i,a,t),t=x(Math.floor(i/t)*t,Math.floor(a/t)*t,t)}return t.map(function(t){return o(e,t)})}function o(n,i){var o=[],s=[];return function(n,r,i){var o,s,u,l,c,f,d=new Array,h=new Array;o=s=-1,l=n[0]>=r,va[l<<1].forEach(p);for(;++o<e-1;)u=l,l=n[o+1]>=r,va[u|l<<1].forEach(p);va[l<<0].forEach(p);for(;++s<t-1;){for(o=-1,l=n[s*e+e]>=r,c=n[s*e]>=r,va[l<<1|c<<2].forEach(p);++o<e-1;)u=l,l=n[s*e+e+o+1]>=r,f=c,c=n[s*e+o+1]>=r,va[u|l<<1|c<<2|f<<3].forEach(p);va[l|c<<3].forEach(p)}o=-1,c=n[s*e]>=r,va[c<<2].forEach(p);for(;++o<e-1;)f=c,c=n[s*e+o+1]>=r,va[c<<2|f<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+o,e[0][1]+s],u=[e[1][0]+o,e[1][1]+s],l=a(r),c=a(u);(t=h[l])?(n=d[c])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(u),i(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(u),h[t.end=c]=t):(t=d[c])?(n=h[l])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(u),i(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=l]=t):d[l]=h[c]={start:l,end:c,ring:[r,u]}}va[c<<3].forEach(p)}(n,i,function(e){r(e,n,i),fa(e)>0?o.push([e]):s.push(e)}),s.forEach(function(e){for(var t,n=0,r=o.length;n<r;++n)if(-1!==ha((t=o[n])[0],e))return void t.push(e)}),{type:"MultiPolygon",value:i,coordinates:o}}function a(t){return 2*t[0]+t[1]*(e+1)*4}function s(n,r,i){n.forEach(function(n){var o,a=n[0],s=n[1],u=0|a,l=0|s,c=r[l*e+u];a>0&&a<e&&u===a&&(o=r[l*e+u-1],n[0]=a+(i-o)/(c-o)-.5),s>0&&s<t&&l===s&&(o=r[(l-1)*e+u],n[1]=s+(i-o)/(c-o)-.5)})}return i.contour=o,i.size=function(n){if(!arguments.length)return[e,t];var r=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(r>0&&o>0))throw new Error("invalid size");return e=r,t=o,i},i.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?da(la.call(e)):da(e),i):n},i.smooth=function(e){return arguments.length?(r=e?s:ma,i):r===s},i};function _a(e,t,n){for(var r=e.width,i=e.height,o=1+(n<<1),a=0;a<i;++a)for(var s=0,u=0;s<r+n;++s)s<r&&(u+=e.data[s+a*r]),s>=n&&(s>=o&&(u-=e.data[s-o+a*r]),t.data[s-n+a*r]=u/Math.min(s+1,r-1+o-s,o))}function ba(e,t,n){for(var r=e.width,i=e.height,o=1+(n<<1),a=0;a<r;++a)for(var s=0,u=0;s<i+n;++s)s<i&&(u+=e.data[a+s*r]),s>=n&&(s>=o&&(u-=e.data[a+(s-o)*r]),t.data[a+(s-n)*r]=u/Math.min(s+1,i-1+o-s,o))}function wa(e){return e[0]}function xa(e){return e[1]}function Ea(){return 1}var Ma=function(){var e=wa,t=xa,n=Ea,r=960,i=500,o=20,a=2,s=3*o,u=r+2*s>>a,l=i+2*s>>a,c=da(20);function f(r){var i=new Float32Array(u*l),f=new Float32Array(u*l);r.forEach(function(r,o,c){var f=+e(r,o,c)+s>>a,d=+t(r,o,c)+s>>a,h=+n(r,o,c);f>=0&&f<u&&d>=0&&d<l&&(i[f+d*u]+=h)}),_a({width:u,height:l,data:i},{width:u,height:l,data:f},o>>a),ba({width:u,height:l,data:f},{width:u,height:l,data:i},o>>a),_a({width:u,height:l,data:i},{width:u,height:l,data:f},o>>a),ba({width:u,height:l,data:f},{width:u,height:l,data:i},o>>a),_a({width:u,height:l,data:i},{width:u,height:l,data:f},o>>a),ba({width:u,height:l,data:f},{width:u,height:l,data:i},o>>a);var h=c(i);if(!Array.isArray(h)){var p=j(i);h=O(0,p,h),(h=x(0,Math.floor(p/h)*h,h)).shift()}return ya().thresholds(h).size([u,l])(i).map(d)}function d(e){return e.value*=Math.pow(2,-2*a),e.coordinates.forEach(h),e}function h(e){e.forEach(p)}function p(e){e.forEach(g)}function g(e){e[0]=e[0]*Math.pow(2,a)-s,e[1]=e[1]*Math.pow(2,a)-s}function m(){return u=r+2*(s=3*o)>>a,l=i+2*s>>a,f}return f.x=function(t){return arguments.length?(e="function"==typeof t?t:da(+t),f):e},f.y=function(e){return arguments.length?(t="function"==typeof e?e:da(+e),f):t},f.weight=function(e){return arguments.length?(n="function"==typeof e?e:da(+e),f):n},f.size=function(e){if(!arguments.length)return[r,i];var t=Math.ceil(e[0]),n=Math.ceil(e[1]);if(!(t>=0||t>=0))throw new Error("invalid size");return r=t,i=n,m()},f.cellSize=function(e){if(!arguments.length)return 1<<a;if(!((e=+e)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(e)/Math.LN2),m()},f.thresholds=function(e){return arguments.length?(c="function"==typeof e?e:Array.isArray(e)?da(la.call(e)):da(e),f):c},f.bandwidth=function(e){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((e=+e)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*e*e+1)-1)/2),m()},f},Ca={},Ta={},Sa=34,Oa=10,ka=13;function Aa(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}")}var Pa=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],o=e.length,a=0,s=0,u=o<=0,l=!1;function c(){if(u)return Ta;if(l)return l=!1,Ca;var t,r,i=a;if(e.charCodeAt(i)===Sa){for(;a++<o&&e.charCodeAt(a)!==Sa||e.charCodeAt(++a)===Sa;);return(t=a)>=o?u=!0:(r=e.charCodeAt(a++))===Oa?l=!0:r===ka&&(l=!0,e.charCodeAt(a)===Oa&&++a),e.slice(i+1,t-1).replace(/""/g,'"')}for(;a<o;){if((r=e.charCodeAt(t=a++))===Oa)l=!0;else if(r===ka)l=!0,e.charCodeAt(a)===Oa&&++a;else if(r!==n)continue;return e.slice(i,t)}return u=!0,e.slice(i,o)}for(e.charCodeAt(o-1)===Oa&&--o,e.charCodeAt(o-1)===ka&&--o;(r=c())!==Ta;){for(var f=[];r!==Ca&&r!==Ta;)f.push(r),r=c();t&&null==(f=t(f,s++))||i.push(f)}return i}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=Aa(e);return function(r,i){return t(n(r),i,e)}}(e,t):Aa(e)});return o.columns=i||[],o},parseRows:r,format:function(t,n){return null==n&&(n=function(e){var t=Object.create(null),n=[];return e.forEach(function(e){for(var r in e)r in t||n.push(t[r]=r)}),n}(t)),[n.map(o).join(e)].concat(t.map(function(t){return n.map(function(e){return o(t[e])}).join(e)})).join("\n")},formatRows:function(e){return e.map(i).join("\n")}}},Ra=Pa(","),La=Ra.parse,ja=Ra.parseRows,Da=Ra.format,Na=Ra.formatRows,Ia=Pa("\t"),Fa=Ia.parse,Ba=Ia.parseRows,Ua=Ia.format,za=Ia.formatRows;function Va(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}var Ha=function(e,t){return fetch(e,t).then(Va)};function qa(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}var Ga=function(e,t){return fetch(e,t).then(qa)};function Wa(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}var Xa=function(e,t){return fetch(e,t).then(Wa)};function Ya(e){return function(t,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),Xa(t,n).then(function(t){return e(t,r)})}}function $a(e,t,n,r){3===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var i=Pa(e);return Xa(t,n).then(function(e){return i.parse(e,r)})}var Ja=Ya(La),Za=Ya(Fa),Ka=function(e,t){return new Promise(function(n,r){var i=new Image;for(var o in t)i[o]=t[o];i.onerror=r,i.onload=function(){n(i)},i.src=e})};function Qa(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.json()}var es=function(e,t){return fetch(e,t).then(Qa)};function ts(e){return function(t,n){return Xa(t,n).then(function(t){return(new DOMParser).parseFromString(t,e)})}}var ns=ts("application/xml"),rs=ts("text/html"),is=ts("image/svg+xml"),os=function(e,t){var n;function r(){var r,i,o=n.length,a=0,s=0;for(r=0;r<o;++r)a+=(i=n[r]).x,s+=i.y;for(a=a/o-e,s=s/o-t,r=0;r<o;++r)(i=n[r]).x-=a,i.y-=s}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(e){n=e},r.x=function(t){return arguments.length?(e=+t,r):e},r.y=function(e){return arguments.length?(t=+e,r):t},r},as=function(e){return function(){return e}},ss=function(){return 1e-6*(Math.random()-.5)};function us(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,a,s,u,l,c,f,d,h=e._root,p={data:r},g=e._x0,m=e._y0,v=e._x1,y=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((l=t>=(o=(g+v)/2))?g=o:v=o,(c=n>=(a=(m+y)/2))?m=a:y=a,i=h,!(h=h[f=c<<1|l]))return i[f]=p,e;if(s=+e._x.call(null,h.data),u=+e._y.call(null,h.data),t===s&&n===u)return p.next=h,i?i[f]=p:e._root=p,e;do{i=i?i[f]=new Array(4):e._root=new Array(4),(l=t>=(o=(g+v)/2))?g=o:v=o,(c=n>=(a=(m+y)/2))?m=a:y=a}while((f=c<<1|l)==(d=(u>=a)<<1|s>=o));return i[d]=h,i[f]=p,e}var ls=function(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i};function cs(e){return e[0]}function fs(e){return e[1]}function ds(e,t,n){var r=new hs(null==t?cs:t,null==n?fs:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function hs(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function ps(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var gs=ds.prototype=hs.prototype;function ms(e){return e.x+e.vx}function vs(e){return e.y+e.vy}gs.copy=function(){var e,t,n=new hs(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=ps(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=ps(t));return n},gs.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return us(this.cover(t,n),t,n,e)},gs.addAll=function(e){var t,n,r,i,o=e.length,a=new Array(o),s=new Array(o),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=r,s[n]=i,r<u&&(u=r),r>c&&(c=r),i<l&&(l=i),i>f&&(f=i));for(c<u&&(u=this._x0,c=this._x1),f<l&&(l=this._y0,f=this._y1),this.cover(u,l).cover(c,f),n=0;n<o;++n)us(this,a[n],s[n],e[n]);return this},gs.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{if(!(n>e||e>i||r>t||t>o))return this;var a,s,u=i-n,l=this._root;switch(s=(t<(r+o)/2)<<1|e<(n+i)/2){case 0:do{(a=new Array(4))[s]=l,l=a}while(o=r+(u*=2),e>(i=n+u)||t>o);break;case 1:do{(a=new Array(4))[s]=l,l=a}while(o=r+(u*=2),(n=i-u)>e||t>o);break;case 2:do{(a=new Array(4))[s]=l,l=a}while(r=o-(u*=2),e>(i=n+u)||r>t);break;case 3:do{(a=new Array(4))[s]=l,l=a}while(r=o-(u*=2),(n=i-u)>e||r>t)}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},gs.data=function(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e},gs.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},gs.find=function(e,t,n){var r,i,o,a,s,u,l,c=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],g=this._root;for(g&&p.push(new ls(g,c,f,d,h)),null==n?n=1/0:(c=e-n,f=t-n,d=e+n,h=t+n,n*=n);u=p.pop();)if(!(!(g=u.node)||(i=u.x0)>d||(o=u.y0)>h||(a=u.x1)<c||(s=u.y1)<f))if(g.length){var m=(i+a)/2,v=(o+s)/2;p.push(new ls(g[3],m,v,a,s),new ls(g[2],i,v,m,s),new ls(g[1],m,o,a,v),new ls(g[0],i,o,m,v)),(l=(t>=v)<<1|e>=m)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=u)}else{var y=e-+this._x.call(null,g.data),_=t-+this._y.call(null,g.data),b=y*y+_*_;if(b<n){var w=Math.sqrt(n=b);c=e-w,f=t-w,d=e+w,h=t+w,r=g.data}}return r},gs.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var t,n,r,i,o,a,s,u,l,c,f,d,h=this._root,p=this._x0,g=this._y0,m=this._x1,v=this._y1;if(!h)return this;if(h.length)for(;;){if((l=o>=(s=(p+m)/2))?p=s:m=s,(c=a>=(u=(g+v)/2))?g=u:v=u,t=h,!(h=h[f=c<<1|l]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,d=f)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(i=h.next)&&delete h.next,r?(i?r.next=i:delete r.next,this):t?(i?t[f]=i:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=i,this)},gs.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},gs.root=function(){return this._root},gs.size=function(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e},gs.visit=function(e){var t,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new ls(u,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(u=t.node,r=t.x0,i=t.y0,o=t.x1,a=t.y1)&&u.length){var l=(r+o)/2,c=(i+a)/2;(n=u[3])&&s.push(new ls(n,l,c,o,a)),(n=u[2])&&s.push(new ls(n,r,c,l,a)),(n=u[1])&&s.push(new ls(n,l,i,o,c)),(n=u[0])&&s.push(new ls(n,r,i,l,c))}return this},gs.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new ls(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,a=t.x0,s=t.y0,u=t.x1,l=t.y1,c=(a+u)/2,f=(s+l)/2;(o=i[0])&&n.push(new ls(o,a,s,c,f)),(o=i[1])&&n.push(new ls(o,c,s,u,f)),(o=i[2])&&n.push(new ls(o,a,f,c,l)),(o=i[3])&&n.push(new ls(o,c,f,u,l))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},gs.x=function(e){return arguments.length?(this._x=e,this):this._x},gs.y=function(e){return arguments.length?(this._y=e,this):this._y};var ys=function(e){var t,n,r=1,i=1;function o(){for(var e,o,s,u,l,c,f,d=t.length,h=0;h<i;++h)for(o=ds(t,ms,vs).visitAfter(a),e=0;e<d;++e)s=t[e],c=n[s.index],f=c*c,u=s.x+s.vx,l=s.y+s.vy,o.visit(p);function p(e,t,n,i,o){var a=e.data,d=e.r,h=c+d;if(!a)return t>u+h||i<u-h||n>l+h||o<l-h;if(a.index>s.index){var p=u-a.x-a.vx,g=l-a.y-a.vy,m=p*p+g*g;m<h*h&&(0===p&&(m+=(p=ss())*p),0===g&&(m+=(g=ss())*g),m=(h-(m=Math.sqrt(m)))/m*r,s.vx+=(p*=m)*(h=(d*=d)/(f+d)),s.vy+=(g*=m)*h,a.vx-=p*(h=1-h),a.vy-=g*h)}}}function a(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function s(){if(t){var r,i,o=t.length;for(n=new Array(o),r=0;r<o;++r)i=t[r],n[i.index]=+e(i,r,t)}}return"function"!=typeof e&&(e=as(null==e?1:+e)),o.initialize=function(e){t=e,s()},o.iterations=function(e){return arguments.length?(i=+e,o):i},o.strength=function(e){return arguments.length?(r=+e,o):r},o.radius=function(t){return arguments.length?(e="function"==typeof t?t:as(+t),s(),o):e},o};function _s(e){return e.index}function bs(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}var ws=function(e){var t,n,r,i,o,a=_s,s=function(e){return 1/Math.min(i[e.source.index],i[e.target.index])},u=as(30),l=1;function c(r){for(var i=0,a=e.length;i<l;++i)for(var s,u,c,f,d,h,p,g=0;g<a;++g)u=(s=e[g]).source,f=(c=s.target).x+c.vx-u.x-u.vx||ss(),d=c.y+c.vy-u.y-u.vy||ss(),f*=h=((h=Math.sqrt(f*f+d*d))-n[g])/h*r*t[g],d*=h,c.vx-=f*(p=o[g]),c.vy-=d*p,u.vx+=f*(p=1-p),u.vy+=d*p}function f(){if(r){var s,u,l=r.length,c=e.length,f=Jo(r,a);for(s=0,i=new Array(l);s<c;++s)(u=e[s]).index=s,"object"!=typeof u.source&&(u.source=bs(f,u.source)),"object"!=typeof u.target&&(u.target=bs(f,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(s=0,o=new Array(c);s<c;++s)u=e[s],o[s]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);t=new Array(c),d(),n=new Array(c),h()}}function d(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+s(e[n],n,e)}function h(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+u(e[t],t,e)}return null==e&&(e=[]),c.initialize=function(e){r=e,f()},c.links=function(t){return arguments.length?(e=t,f(),c):e},c.id=function(e){return arguments.length?(a=e,c):a},c.iterations=function(e){return arguments.length?(l=+e,c):l},c.strength=function(e){return arguments.length?(s="function"==typeof e?e:as(+e),d(),c):s},c.distance=function(e){return arguments.length?(u="function"==typeof e?e:as(+e),h(),c):u},c};function xs(e){return e.x}function Es(e){return e.y}var Ms=10,Cs=Math.PI*(3-Math.sqrt(5)),Ts=function(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=Jo(),u=jr(c),l=de("tick","end");function c(){f(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function f(){var t,r,u=e.length;for(n+=(o-n)*i,s.each(function(e){e(n)}),t=0;t<u;++t)null==(r=e[t]).fx?r.x+=r.vx*=a:(r.x=r.fx,r.vx=0),null==r.fy?r.y+=r.vy*=a:(r.y=r.fy,r.vy=0)}function d(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,isNaN(t.x)||isNaN(t.y)){var i=Ms*Math.sqrt(n),o=n*Cs;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function h(t){return t.initialize&&t.initialize(e),t}return null==e&&(e=[]),d(),t={tick:f,restart:function(){return u.restart(c),t},stop:function(){return u.stop(),t},nodes:function(n){return arguments.length?(e=n,d(),s.each(h),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},force:function(e,n){return arguments.length>1?(null==n?s.remove(e):s.set(e,h(n)),t):s.get(e)},find:function(t,n,r){var i,o,a,s,u,l=0,c=e.length;for(null==r?r=1/0:r*=r,l=0;l<c;++l)(a=(i=t-(s=e[l]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(e,n){return arguments.length>1?(l.on(e,n),t):l.on(e)}}},Ss=function(){var e,t,n,r,i=as(-30),o=1,a=1/0,s=.81;function u(r){var i,o=e.length,a=ds(e,xs,Es).visitAfter(c);for(n=r,i=0;i<o;++i)t=e[i],a.visit(f)}function l(){if(e){var t,n,o=e.length;for(r=new Array(o),t=0;t<o;++t)n=e[t],r[n.index]=+i(n,t,e)}}function c(e){var t,n,i,o,a,s=0,u=0;if(e.length){for(i=o=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,u+=n,i+=n*t.x,o+=n*t.y);e.x=i/u,e.y=o/u}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=r[t.data.index]}while(t=t.next)}e.value=s}function f(e,i,u,l){if(!e.value)return!0;var c=e.x-t.x,f=e.y-t.y,d=l-i,h=c*c+f*f;if(d*d/s<h)return h<a&&(0===c&&(h+=(c=ss())*c),0===f&&(h+=(f=ss())*f),h<o&&(h=Math.sqrt(o*h)),t.vx+=c*e.value*n/h,t.vy+=f*e.value*n/h),!0;if(!(e.length||h>=a)){(e.data!==t||e.next)&&(0===c&&(h+=(c=ss())*c),0===f&&(h+=(f=ss())*f),h<o&&(h=Math.sqrt(o*h)));do{e.data!==t&&(d=r[e.data.index]*n/h,t.vx+=c*d,t.vy+=f*d)}while(e=e.next)}}return u.initialize=function(t){e=t,l()},u.strength=function(e){return arguments.length?(i="function"==typeof e?e:as(+e),l(),u):i},u.distanceMin=function(e){return arguments.length?(o=e*e,u):Math.sqrt(o)},u.distanceMax=function(e){return arguments.length?(a=e*e,u):Math.sqrt(a)},u.theta=function(e){return arguments.length?(s=e*e,u):Math.sqrt(s)},u},Os=function(e,t,n){var r,i,o,a=as(.1);function s(e){for(var a=0,s=r.length;a<s;++a){var u=r[a],l=u.x-t||1e-6,c=u.y-n||1e-6,f=Math.sqrt(l*l+c*c),d=(o[a]-f)*i[a]*e/f;u.vx+=l*d,u.vy+=c*d}}function u(){if(r){var t,n=r.length;for(i=new Array(n),o=new Array(n),t=0;t<n;++t)o[t]=+e(r[t],t,r),i[t]=isNaN(o[t])?0:+a(r[t],t,r)}}return"function"!=typeof e&&(e=as(+e)),null==t&&(t=0),null==n&&(n=0),s.initialize=function(e){r=e,u()},s.strength=function(e){return arguments.length?(a="function"==typeof e?e:as(+e),u(),s):a},s.radius=function(t){return arguments.length?(e="function"==typeof t?t:as(+t),u(),s):e},s.x=function(e){return arguments.length?(t=+e,s):t},s.y=function(e){return arguments.length?(n=+e,s):n},s},ks=function(e){var t,n,r,i=as(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vx+=(r[o]-i.x)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=as(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:as(+e),a(),o):i},o.x=function(t){return arguments.length?(e="function"==typeof t?t:as(+t),a(),o):e},o},As=function(e){var t,n,r,i=as(.1);function o(e){for(var i,o=0,a=t.length;o<a;++o)(i=t[o]).vy+=(r[o]-i.y)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+e(t[o],o,t))?0:+i(t[o],o,t)}}return"function"!=typeof e&&(e=as(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:as(+e),a(),o):i},o.y=function(t){return arguments.length?(e="function"==typeof t?t:as(+t),a(),o):e},o},Ps=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},Rs=function(e){return(e=Ps(Math.abs(e)))?e[1]:NaN},Ls=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function js(e){return new Ds(e)}function Ds(e){if(!(t=Ls.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}js.prototype=Ds.prototype,Ds.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ns,Is,Fs,Bs,Us=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(i>0){if(!+e[r])break e;i=0}}return i>0?e.slice(0,i)+e.slice(t+1):e},zs=function(e,t){var n=Ps(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Vs={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return zs(100*e,t)},r:zs,s:function(e,t){var n=Ps(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(Ns=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Ps(e,Math.max(0,t+o-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},Hs=function(e){return e},qs=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],Gs=function(e){var t=e.grouping&&e.thousands?function(e,t){return function(n,r){for(var i=n.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}(e.grouping,e.thousands):Hs,n=e.currency,r=e.decimal,i=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(e.numerals):Hs,o=e.percent||"%";function a(e){var a=(e=js(e)).fill,s=e.align,u=e.sign,l=e.symbol,c=e.zero,f=e.width,d=e.comma,h=e.precision,p=e.trim,g=e.type;"n"===g?(d=!0,g="g"):Vs[g]||(null==h&&(h=12),p=!0,g="g"),(c||"0"===a&&"="===s)&&(c=!0,a="0",s="=");var m="$"===l?n[0]:"#"===l&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",v="$"===l?n[1]:/[%p]/.test(g)?o:"",y=Vs[g],_=/[defgprs%]/.test(g);function b(e){var n,o,l,b=m,w=v;if("c"===g)w=y(e)+w,e="";else{var x=(e=+e)<0;if(e=y(Math.abs(e),h),p&&(e=Us(e)),x&&0==+e&&(x=!1),b=(x?"("===u?u:"-":"-"===u||"("===u?"":u)+b,w=("s"===g?qs[8+Ns/3]:"")+w+(x&&"("===u?")":""),_)for(n=-1,o=e.length;++n<o;)if(48>(l=e.charCodeAt(n))||l>57){w=(46===l?r+e.slice(n+1):e.slice(n))+w,e=e.slice(0,n);break}}d&&!c&&(e=t(e,1/0));var E=b.length+e.length+w.length,M=E<f?new Array(f-E+1).join(a):"";switch(d&&c&&(e=t(M+e,M.length?f-w.length:1/0),M=""),s){case"<":e=b+e+w+M;break;case"=":e=b+M+e+w;break;case"^":e=M.slice(0,E=M.length>>1)+b+e+w+M.slice(E);break;default:e=M+b+e+w}return i(e)}return h=null==h?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h)),b.toString=function(){return e+""},b}return{format:a,formatPrefix:function(e,t){var n=a(((e=js(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Rs(t)/3))),i=Math.pow(10,-r),o=qs[8+r/3];return function(e){return n(i*e)+o}}}};function Ws(e){return Is=Gs(e),Fs=Is.format,Bs=Is.formatPrefix,Is}Ws({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Xs=function(e){return Math.max(0,-Rs(Math.abs(e)))},Ys=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Rs(t)/3)))-Rs(Math.abs(e)))},$s=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Rs(t)-Rs(e))+1},Js=function(){return new Zs};function Zs(){this.reset()}Zs.prototype={constructor:Zs,reset:function(){this.s=this.t=0},add:function(e){Qs(Ks,e,this.t),Qs(this,Ks.s,this.s),this.s?this.t+=Ks.t:this.s=Ks.t},valueOf:function(){return this.s}};var Ks=new Zs;function Qs(e,t,n){var r=e.s=t+n,i=r-t,o=r-i;e.t=t-o+(n-i)}var eu=1e-6,tu=Math.PI,nu=tu/2,ru=tu/4,iu=2*tu,ou=180/tu,au=tu/180,su=Math.abs,uu=Math.atan,lu=Math.atan2,cu=Math.cos,fu=Math.ceil,du=Math.exp,hu=(Math.floor,Math.log),pu=Math.pow,gu=Math.sin,mu=Math.sign||function(e){return e>0?1:e<0?-1:0},vu=Math.sqrt,yu=Math.tan;function _u(e){return e>1?0:e<-1?tu:Math.acos(e)}function bu(e){return e>1?nu:e<-1?-nu:Math.asin(e)}function wu(e){return(e=gu(e/2))*e}function xu(){}function Eu(e,t){e&&Cu.hasOwnProperty(e.type)&&Cu[e.type](e,t)}var Mu={Feature:function(e,t){Eu(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Eu(n[r].geometry,t)}},Cu={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Tu(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Tu(n[r],t,0)},Polygon:function(e,t){Su(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Su(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Eu(n[r],t)}};function Tu(e,t,n){var r,i=-1,o=e.length-n;for(t.lineStart();++i<o;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function Su(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Tu(e[n],t,1);t.polygonEnd()}var Ou,ku,Au,Pu,Ru,Lu=function(e,t){e&&Mu.hasOwnProperty(e.type)?Mu[e.type](e,t):Eu(e,t)},ju=Js(),Du=Js(),Nu={point:xu,lineStart:xu,lineEnd:xu,polygonStart:function(){ju.reset(),Nu.lineStart=Iu,Nu.lineEnd=Fu},polygonEnd:function(){var e=+ju;Du.add(e<0?iu+e:e),this.lineStart=this.lineEnd=this.point=xu},sphere:function(){Du.add(iu)}};function Iu(){Nu.point=Bu}function Fu(){Uu(Ou,ku)}function Bu(e,t){Nu.point=Uu,Ou=e,ku=t,Au=e*=au,Pu=cu(t=(t*=au)/2+ru),Ru=gu(t)}function Uu(e,t){t=(t*=au)/2+ru;var n=(e*=au)-Au,r=n>=0?1:-1,i=r*n,o=cu(t),a=gu(t),s=Ru*a,u=Pu*o+s*cu(i),l=s*r*gu(i);ju.add(lu(l,u)),Au=e,Pu=o,Ru=a}var zu=function(e){return Du.reset(),Lu(e,Nu),2*Du};function Vu(e){return[lu(e[1],e[0]),bu(e[2])]}function Hu(e){var t=e[0],n=e[1],r=cu(n);return[r*cu(t),r*gu(t),gu(n)]}function qu(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Gu(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Wu(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Xu(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Yu(e){var t=vu(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var $u,Ju,Zu,Ku,Qu,el,tl,nl,rl,il,ol=Js(),al={point:sl,lineStart:ll,lineEnd:cl,polygonStart:function(){al.point=fl,al.lineStart=dl,al.lineEnd=hl,ol.reset(),Nu.polygonStart()},polygonEnd:function(){Nu.polygonEnd(),al.point=sl,al.lineStart=ll,al.lineEnd=cl,ju<0?($u=-(Zu=180),Ju=-(Ku=90)):ol>eu?Ku=90:ol<-eu&&(Ju=-90),il[0]=$u,il[1]=Zu}};function sl(e,t){rl.push(il=[$u=e,Zu=e]),t<Ju&&(Ju=t),t>Ku&&(Ku=t)}function ul(e,t){var n=Hu([e*au,t*au]);if(nl){var r=Gu(nl,n),i=Gu([r[1],-r[0],0],r);Yu(i),i=Vu(i);var o,a=e-Qu,s=a>0?1:-1,u=i[0]*ou*s,l=su(a)>180;l^(s*Qu<u&&u<s*e)?(o=i[1]*ou)>Ku&&(Ku=o):l^(s*Qu<(u=(u+360)%360-180)&&u<s*e)?(o=-i[1]*ou)<Ju&&(Ju=o):(t<Ju&&(Ju=t),t>Ku&&(Ku=t)),l?e<Qu?pl($u,e)>pl($u,Zu)&&(Zu=e):pl(e,Zu)>pl($u,Zu)&&($u=e):Zu>=$u?(e<$u&&($u=e),e>Zu&&(Zu=e)):e>Qu?pl($u,e)>pl($u,Zu)&&(Zu=e):pl(e,Zu)>pl($u,Zu)&&($u=e)}else rl.push(il=[$u=e,Zu=e]);t<Ju&&(Ju=t),t>Ku&&(Ku=t),nl=n,Qu=e}function ll(){al.point=ul}function cl(){il[0]=$u,il[1]=Zu,al.point=sl,nl=null}function fl(e,t){if(nl){var n=e-Qu;ol.add(su(n)>180?n+(n>0?360:-360):n)}else el=e,tl=t;Nu.point(e,t),ul(e,t)}function dl(){Nu.lineStart()}function hl(){fl(el,tl),Nu.lineEnd(),su(ol)>eu&&($u=-(Zu=180)),il[0]=$u,il[1]=Zu,nl=null}function pl(e,t){return(t-=e)<0?t+360:t}function gl(e,t){return e[0]-t[0]}function ml(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var vl,yl,_l,bl,wl,xl,El,Ml,Cl,Tl,Sl,Ol,kl,Al,Pl,Rl,Ll=function(e){var t,n,r,i,o,a,s;if(Ku=Zu=-($u=Ju=1/0),rl=[],Lu(e,al),n=rl.length){for(rl.sort(gl),t=1,o=[r=rl[0]];t<n;++t)ml(r,(i=rl[t])[0])||ml(r,i[1])?(pl(r[0],i[1])>pl(r[0],r[1])&&(r[1]=i[1]),pl(i[0],r[1])>pl(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,t=0,r=o[n=o.length-1];t<=n;r=i,++t)i=o[t],(s=pl(r[1],i[0]))>a&&(a=s,$u=i[0],Zu=r[1])}return rl=il=null,$u===1/0||Ju===1/0?[[NaN,NaN],[NaN,NaN]]:[[$u,Ju],[Zu,Ku]]},jl={sphere:xu,point:Dl,lineStart:Il,lineEnd:Ul,polygonStart:function(){jl.lineStart=zl,jl.lineEnd=Vl},polygonEnd:function(){jl.lineStart=Il,jl.lineEnd=Ul}};function Dl(e,t){e*=au;var n=cu(t*=au);Nl(n*cu(e),n*gu(e),gu(t))}function Nl(e,t,n){_l+=(e-_l)/++vl,bl+=(t-bl)/vl,wl+=(n-wl)/vl}function Il(){jl.point=Fl}function Fl(e,t){e*=au;var n=cu(t*=au);Al=n*cu(e),Pl=n*gu(e),Rl=gu(t),jl.point=Bl,Nl(Al,Pl,Rl)}function Bl(e,t){e*=au;var n=cu(t*=au),r=n*cu(e),i=n*gu(e),o=gu(t),a=lu(vu((a=Pl*o-Rl*i)*a+(a=Rl*r-Al*o)*a+(a=Al*i-Pl*r)*a),Al*r+Pl*i+Rl*o);yl+=a,xl+=a*(Al+(Al=r)),El+=a*(Pl+(Pl=i)),Ml+=a*(Rl+(Rl=o)),Nl(Al,Pl,Rl)}function Ul(){jl.point=Dl}function zl(){jl.point=Hl}function Vl(){ql(Ol,kl),jl.point=Dl}function Hl(e,t){Ol=e,kl=t,e*=au,t*=au,jl.point=ql;var n=cu(t);Al=n*cu(e),Pl=n*gu(e),Rl=gu(t),Nl(Al,Pl,Rl)}function ql(e,t){e*=au;var n=cu(t*=au),r=n*cu(e),i=n*gu(e),o=gu(t),a=Pl*o-Rl*i,s=Rl*r-Al*o,u=Al*i-Pl*r,l=vu(a*a+s*s+u*u),c=bu(l),f=l&&-c/l;Cl+=f*a,Tl+=f*s,Sl+=f*u,yl+=c,xl+=c*(Al+(Al=r)),El+=c*(Pl+(Pl=i)),Ml+=c*(Rl+(Rl=o)),Nl(Al,Pl,Rl)}var Gl=function(e){vl=yl=_l=bl=wl=xl=El=Ml=Cl=Tl=Sl=0,Lu(e,jl);var t=Cl,n=Tl,r=Sl,i=t*t+n*n+r*r;return i<1e-12&&(t=xl,n=El,r=Ml,yl<eu&&(t=_l,n=bl,r=wl),(i=t*t+n*n+r*r)<1e-12)?[NaN,NaN]:[lu(n,t)*ou,bu(r/vu(i))*ou]},Wl=function(e){return function(){return e}},Xl=function(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n};function Yl(e,t){return[e>tu?e-iu:e<-tu?e+iu:e,t]}function $l(e,t,n){return(e%=iu)?t||n?Xl(Zl(e),Kl(t,n)):Zl(e):t||n?Kl(t,n):Yl}function Jl(e){return function(t,n){return[(t+=e)>tu?t-iu:t<-tu?t+iu:t,n]}}function Zl(e){var t=Jl(e);return t.invert=Jl(-e),t}function Kl(e,t){var n=cu(e),r=gu(e),i=cu(t),o=gu(t);function a(e,t){var a=cu(t),s=cu(e)*a,u=gu(e)*a,l=gu(t),c=l*n+s*r;return[lu(u*i-c*o,s*n-l*r),bu(c*i+u*o)]}return a.invert=function(e,t){var a=cu(t),s=cu(e)*a,u=gu(e)*a,l=gu(t),c=l*i-u*o;return[lu(u*i+l*o,s*n+c*r),bu(c*n-s*r)]},a}Yl.invert=Yl;var Ql=function(e){function t(t){return(t=e(t[0]*au,t[1]*au))[0]*=ou,t[1]*=ou,t}return e=$l(e[0]*au,e[1]*au,e.length>2?e[2]*au:0),t.invert=function(t){return(t=e.invert(t[0]*au,t[1]*au))[0]*=ou,t[1]*=ou,t},t};function ec(e,t,n,r,i,o){if(n){var a=cu(t),s=gu(t),u=r*n;null==i?(i=t+r*iu,o=t-u/2):(i=tc(a,i),o=tc(a,o),(r>0?i<o:i>o)&&(i+=r*iu));for(var l,c=i;r>0?c>o:c<o;c-=u)l=Vu([a,-s*cu(c),-s*gu(c)]),e.point(l[0],l[1])}}function tc(e,t){(t=Hu(t))[0]-=e,Yu(t);var n=_u(-t[1]);return((-t[2]<0?-n:n)+iu-eu)%iu}var nc=function(){var e,t,n=Wl([0,0]),r=Wl(90),i=Wl(6),o={point:function(n,r){e.push(n=t(n,r)),n[0]*=ou,n[1]*=ou}};function a(){var a=n.apply(this,arguments),s=r.apply(this,arguments)*au,u=i.apply(this,arguments)*au;return e=[],t=$l(-a[0]*au,-a[1]*au,0).invert,ec(o,s,u,1),a={type:"Polygon",coordinates:[e]},e=t=null,a}return a.center=function(e){return arguments.length?(n="function"==typeof e?e:Wl([+e[0],+e[1]]),a):n},a.radius=function(e){return arguments.length?(r="function"==typeof e?e:Wl(+e),a):r},a.precision=function(e){return arguments.length?(i="function"==typeof e?e:Wl(+e),a):i},a},rc=function(){var e,t=[];return{point:function(t,n){e.push([t,n])},lineStart:function(){t.push(e=[])},lineEnd:xu,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}},ic=function(e,t){return su(e[0]-t[0])<eu&&su(e[1]-t[1])<eu};function oc(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var ac=function(e,t,n,r,i){var o,a,s=[],u=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],a=e[t];if(ic(r,a)){for(i.lineStart(),o=0;o<t;++o)i.point((r=e[o])[0],r[1]);i.lineEnd()}else s.push(n=new oc(r,e,null,!0)),u.push(n.o=new oc(r,null,n,!1)),s.push(n=new oc(a,e,null,!1)),u.push(n.o=new oc(a,null,n,!0))}}),s.length){for(u.sort(t),sc(s),sc(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var l,c,f=s[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;l=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=l.length;o<a;++o)i.point((c=l[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(l=d.p.z,o=l.length-1;o>=0;--o)i.point((c=l[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}l=(d=d.o).z,h=!h}while(!d.v);i.lineEnd()}}};function sc(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}var uc=Js(),lc=function(e,t){var n=t[0],r=t[1],i=gu(r),o=[gu(n),-cu(n),0],a=0,s=0;uc.reset(),1===i?r=nu+eu:-1===i&&(r=-nu-eu);for(var u=0,l=e.length;u<l;++u)if(f=(c=e[u]).length)for(var c,f,d=c[f-1],h=d[0],p=d[1]/2+ru,g=gu(p),m=cu(p),v=0;v<f;++v,h=_,g=w,m=x,d=y){var y=c[v],_=y[0],b=y[1]/2+ru,w=gu(b),x=cu(b),E=_-h,M=E>=0?1:-1,C=M*E,T=C>tu,S=g*w;if(uc.add(lu(S*M*gu(C),m*x+S*cu(C))),a+=T?E+M*iu:E,T^h>=n^_>=n){var O=Gu(Hu(d),Hu(y));Yu(O);var k=Gu(o,O);Yu(k);var A=(T^E>=0?-1:1)*bu(k[2]);(r>A||r===A&&(O[0]||O[1]))&&(s+=T^E>=0?1:-1)}}return(a<-eu||a<eu&&uc<-eu)^1&s},cc=function(e,t,n,r){return function(i){var o,a,s,u=t(i),l=rc(),c=t(l),f=!1,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=_,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,a=I(a);var e=lc(o,r);a.length?(f||(i.polygonStart(),f=!0),ac(a,dc,e,n,i)):e&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(t,n){e(t,n)&&i.point(t,n)}function p(e,t){u.point(e,t)}function g(){d.point=p,u.lineStart()}function m(){d.point=h,u.lineEnd()}function v(e,t){s.push([e,t]),c.point(e,t)}function y(){c.lineStart(),s=[]}function _(){v(s[0][0],s[0][1]),c.lineEnd();var e,t,n,r,u=c.clean(),d=l.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&u){if((t=(n=d[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else h>1&&2&u&&d.push(d.pop().concat(d.shift())),a.push(d.filter(fc))}return d}};function fc(e){return e.length>1}function dc(e,t){return((e=e.x)[0]<0?e[1]-nu-eu:nu-e[1])-((t=t.x)[0]<0?t[1]-nu-eu:nu-t[1])}var hc=cc(function(){return!0},function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?tu:-tu,u=su(o-n);su(u-tu)<eu?(e.point(n,r=(r+a)/2>0?nu:-nu),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&u>=tu&&(su(n-i)<eu&&(n-=i*eu),su(o-s)<eu&&(o-=s*eu),r=function(e,t,n,r){var i,o,a=gu(e-n);return su(a)>eu?uu((gu(t)*(o=cu(r))*gu(n)-gu(r)*(i=cu(t))*gu(e))/(i*o*a)):(t+r)/2}(n,r,o,a),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=a),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}},function(e,t,n,r){var i;if(null==e)i=n*nu,r.point(-tu,i),r.point(0,i),r.point(tu,i),r.point(tu,0),r.point(tu,-i),r.point(0,-i),r.point(-tu,-i),r.point(-tu,0),r.point(-tu,i);else if(su(e[0]-t[0])>eu){var o=e[0]<t[0]?tu:-tu;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])},[-tu,-nu]);var pc=function(e){var t=cu(e),n=6*au,r=t>0,i=su(t)>eu;function o(e,n){return cu(e)*cu(n)>t}function a(e,n,r){var i=[1,0,0],o=Gu(Hu(e),Hu(n)),a=qu(o,o),s=o[0],u=a-s*s;if(!u)return!r&&e;var l=t*a/u,c=-t*s/u,f=Gu(i,o),d=Xu(i,l);Wu(d,Xu(o,c));var h=f,p=qu(d,h),g=qu(h,h),m=p*p-g*(qu(d,d)-1);if(!(m<0)){var v=vu(m),y=Xu(h,(-p-v)/g);if(Wu(y,d),y=Vu(y),!r)return y;var _,b=e[0],w=n[0],x=e[1],E=n[1];w<b&&(_=b,b=w,w=_);var M=w-b,C=su(M-tu)<eu;if(!C&&E<x&&(_=x,x=E,E=_),C||M<eu?C?x+E>0^y[1]<(su(y[0]-b)<eu?x:E):x<=y[1]&&y[1]<=E:M>tu^(b<=y[0]&&y[0]<=w)){var T=Xu(h,(-p+v)/g);return Wu(T,d),[y,Vu(T)]}}}function s(t,n){var i=r?e:tu-e,o=0;return t<-i?o|=1:t>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return cc(o,function(e){var t,n,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(f,d){var h,p=[f,d],g=o(f,d),m=r?g?0:s(f,d):g?s(f+(f<0?tu:-tu),d):0;if(!t&&(l=u=g)&&e.lineStart(),g!==u&&(!(h=a(t,p))||ic(t,h)||ic(p,h))&&(p[0]+=eu,p[1]+=eu,g=o(p[0],p[1])),g!==u)c=0,g?(e.lineStart(),h=a(p,t),e.point(h[0],h[1])):(h=a(t,p),e.point(h[0],h[1]),e.lineEnd()),t=h;else if(i&&t&&r^g){var v;m&n||!(v=a(p,t,!0))||(c=0,r?(e.lineStart(),e.point(v[0][0],v[0][1]),e.point(v[1][0],v[1][1]),e.lineEnd()):(e.point(v[1][0],v[1][1]),e.lineEnd(),e.lineStart(),e.point(v[0][0],v[0][1])))}!g||t&&ic(t,p)||e.point(p[0],p[1]),t=p,u=g,n=m},lineEnd:function(){u&&e.lineEnd(),t=null},clean:function(){return c|(l&&u)<<1}}},function(t,r,i,o){ec(o,e,n,i,t,r)},r?[0,-e]:[-tu,e-tu])},gc=function(e,t,n,r,i,o){var a,s=e[0],u=e[1],l=0,c=1,f=t[0]-s,d=t[1]-u;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<l)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>l&&(l=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>l&&(l=a)}else if(f>0){if(a<l)return;a<c&&(c=a)}if(a=r-u,d||!(a>0)){if(a/=d,d<0){if(a<l)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>l&&(l=a)}if(a=o-u,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>l&&(l=a)}else if(d>0){if(a<l)return;a<c&&(c=a)}return l>0&&(e[0]=s+l*f,e[1]=u+l*d),c<1&&(t[0]=s+c*f,t[1]=u+c*d),!0}}}}},mc=1e9,vc=-mc;function yc(e,t,n,r){function i(i,o){return e<=i&&i<=n&&t<=o&&o<=r}function o(i,o,s,l){var c=0,f=0;if(null==i||(c=a(i,s))!==(f=a(o,s))||u(i,o)<0^s>0)do{l.point(0===c||3===c?e:n,c>1?r:t)}while((c=(c+s+4)%4)!==f);else l.point(o[0],o[1])}function a(r,i){return su(r[0]-e)<eu?i>0?0:3:su(r[0]-n)<eu?i>0?2:1:su(r[1]-t)<eu?i>0?1:0:i>0?3:2}function s(e,t){return u(e.x,t.x)}function u(e,t){var n=a(e,1),r=a(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var u,l,c,f,d,h,p,g,m,v,y,_=a,b=rc(),w={point:x,lineStart:function(){w.point=E,l&&l.push(c=[]);v=!0,m=!1,p=g=NaN},lineEnd:function(){u&&(E(f,d),h&&m&&b.rejoin(),u.push(b.result()));w.point=x,m&&_.lineEnd()},polygonStart:function(){_=b,u=[],l=[],y=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=l.length;n<i;++n)for(var o,a,s=l[n],u=1,c=s.length,f=s[0],d=f[0],h=f[1];u<c;++u)o=d,a=h,f=s[u],d=f[0],h=f[1],a<=r?h>r&&(d-o)*(r-a)>(h-a)*(e-o)&&++t:h<=r&&(d-o)*(r-a)<(h-a)*(e-o)&&--t;return t}(),n=y&&t,i=(u=I(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&ac(u,s,t,o,a),a.polygonEnd());_=a,u=l=c=null}};function x(e,t){i(e,t)&&_.point(e,t)}function E(o,a){var s=i(o,a);if(l&&c.push([o,a]),v)f=o,d=a,h=s,v=!1,s&&(_.lineStart(),_.point(o,a));else if(s&&m)_.point(o,a);else{var u=[p=Math.max(vc,Math.min(mc,p)),g=Math.max(vc,Math.min(mc,g))],b=[o=Math.max(vc,Math.min(mc,o)),a=Math.max(vc,Math.min(mc,a))];gc(u,b,e,t,n,r)?(m||(_.lineStart(),_.point(u[0],u[1])),_.point(b[0],b[1]),s||_.lineEnd(),y=!1):s&&(_.lineStart(),_.point(o,a),y=!1)}p=o,g=a,m=s}return w}}var _c,bc,wc,xc=function(){var e,t,n,r=0,i=0,o=960,a=500;return n={stream:function(n){return e&&t===n?e:e=yc(r,i,o,a)(t=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],o=+s[1][0],a=+s[1][1],e=t=null,n):[[r,i],[o,a]]}}},Ec=Js(),Mc={sphere:xu,point:xu,lineStart:function(){Mc.point=Tc,Mc.lineEnd=Cc},lineEnd:xu,polygonStart:xu,polygonEnd:xu};function Cc(){Mc.point=Mc.lineEnd=xu}function Tc(e,t){_c=e*=au,bc=gu(t*=au),wc=cu(t),Mc.point=Sc}function Sc(e,t){e*=au;var n=gu(t*=au),r=cu(t),i=su(e-_c),o=cu(i),a=r*gu(i),s=wc*n-bc*r*o,u=bc*n+wc*r*o;Ec.add(lu(vu(a*a+s*s),u)),_c=e,bc=n,wc=r}var Oc=function(e){return Ec.reset(),Lu(e,Mc),+Ec},kc=[null,null],Ac={type:"LineString",coordinates:kc},Pc=function(e,t){return kc[0]=e,kc[1]=t,Oc(Ac)},Rc={Feature:function(e,t){return jc(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)if(jc(n[r].geometry,t))return!0;return!1}},Lc={Sphere:function(){return!0},Point:function(e,t){return Dc(e.coordinates,t)},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Dc(n[r],t))return!0;return!1},LineString:function(e,t){return Nc(e.coordinates,t)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Nc(n[r],t))return!0;return!1},Polygon:function(e,t){return Ic(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Ic(n[r],t))return!0;return!1},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)if(jc(n[r],t))return!0;return!1}};function jc(e,t){return!(!e||!Lc.hasOwnProperty(e.type))&&Lc[e.type](e,t)}function Dc(e,t){return 0===Pc(e,t)}function Nc(e,t){var n=Pc(e[0],e[1]);return Pc(e[0],t)+Pc(t,e[1])<=n+eu}function Ic(e,t){return!!lc(e.map(Fc),Bc(t))}function Fc(e){return(e=e.map(Bc)).pop(),e}function Bc(e){return[e[0]*au,e[1]*au]}var Uc=function(e,t){return(e&&Rc.hasOwnProperty(e.type)?Rc[e.type]:jc)(e,t)};function zc(e,t,n){var r=x(e,t-eu,n).concat(t);return function(e){return r.map(function(t){return[e,t]})}}function Vc(e,t,n){var r=x(e,t-eu,n).concat(t);return function(e){return r.map(function(t){return[t,e]})}}function Hc(){var e,t,n,r,i,o,a,s,u,l,c,f,d=10,h=d,p=90,g=360,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return x(fu(r/p)*p,n,p).map(c).concat(x(fu(s/g)*g,a,g).map(f)).concat(x(fu(t/d)*d,e,d).filter(function(e){return su(e%p)>eu}).map(u)).concat(x(fu(o/h)*h,i,h).filter(function(e){return su(e%g)>eu}).map(l))}return v.lines=function(){return y().map(function(e){return{type:"LineString",coordinates:e}})},v.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(f(a).slice(1),c(n).reverse().slice(1),f(s).reverse().slice(1))]}},v.extent=function(e){return arguments.length?v.extentMajor(e).extentMinor(e):v.extentMinor()},v.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],r>n&&(e=r,r=n,n=e),s>a&&(e=s,s=a,a=e),v.precision(m)):[[r,s],[n,a]]},v.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],o=+n[0][1],i=+n[1][1],t>e&&(n=t,t=e,e=n),o>i&&(n=o,o=i,i=n),v.precision(m)):[[t,o],[e,i]]},v.step=function(e){return arguments.length?v.stepMajor(e).stepMinor(e):v.stepMinor()},v.stepMajor=function(e){return arguments.length?(p=+e[0],g=+e[1],v):[p,g]},v.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],v):[d,h]},v.precision=function(d){return arguments.length?(m=+d,u=zc(o,i,90),l=Vc(t,e,m),c=zc(s,a,90),f=Vc(r,n,m),v):m},v.extentMajor([[-180,-90+eu],[180,90-eu]]).extentMinor([[-180,-80-eu],[180,80+eu]])}function qc(){return Hc()()}var Gc,Wc,Xc,Yc,$c=function(e,t){var n=e[0]*au,r=e[1]*au,i=t[0]*au,o=t[1]*au,a=cu(r),s=gu(r),u=cu(o),l=gu(o),c=a*cu(n),f=a*gu(n),d=u*cu(i),h=u*gu(i),p=2*bu(vu(wu(o-r)+a*u*wu(i-n))),g=gu(p),m=p?function(e){var t=gu(e*=p)/g,n=gu(p-e)/g,r=n*c+t*d,i=n*f+t*h,o=n*s+t*l;return[lu(i,r)*ou,lu(o,vu(r*r+i*i))*ou]}:function(){return[n*ou,r*ou]};return m.distance=p,m},Jc=function(e){return e},Zc=Js(),Kc=Js(),Qc={point:xu,lineStart:xu,lineEnd:xu,polygonStart:function(){Qc.lineStart=ef,Qc.lineEnd=rf},polygonEnd:function(){Qc.lineStart=Qc.lineEnd=Qc.point=xu,Zc.add(su(Kc)),Kc.reset()},result:function(){var e=Zc/2;return Zc.reset(),e}};function ef(){Qc.point=tf}function tf(e,t){Qc.point=nf,Gc=Xc=e,Wc=Yc=t}function nf(e,t){Kc.add(Yc*e-Xc*t),Xc=e,Yc=t}function rf(){nf(Gc,Wc)}var of=Qc,af=1/0,sf=af,uf=-af,lf=uf;var cf,ff,df,hf,pf={point:function(e,t){e<af&&(af=e);e>uf&&(uf=e);t<sf&&(sf=t);t>lf&&(lf=t)},lineStart:xu,lineEnd:xu,polygonStart:xu,polygonEnd:xu,result:function(){var e=[[af,sf],[uf,lf]];return uf=lf=-(sf=af=1/0),e}},gf=0,mf=0,vf=0,yf=0,_f=0,bf=0,wf=0,xf=0,Ef=0,Mf={point:Cf,lineStart:Tf,lineEnd:kf,polygonStart:function(){Mf.lineStart=Af,Mf.lineEnd=Pf},polygonEnd:function(){Mf.point=Cf,Mf.lineStart=Tf,Mf.lineEnd=kf},result:function(){var e=Ef?[wf/Ef,xf/Ef]:bf?[yf/bf,_f/bf]:vf?[gf/vf,mf/vf]:[NaN,NaN];return gf=mf=vf=yf=_f=bf=wf=xf=Ef=0,e}};function Cf(e,t){gf+=e,mf+=t,++vf}function Tf(){Mf.point=Sf}function Sf(e,t){Mf.point=Of,Cf(df=e,hf=t)}function Of(e,t){var n=e-df,r=t-hf,i=vu(n*n+r*r);yf+=i*(df+e)/2,_f+=i*(hf+t)/2,bf+=i,Cf(df=e,hf=t)}function kf(){Mf.point=Cf}function Af(){Mf.point=Rf}function Pf(){Lf(cf,ff)}function Rf(e,t){Mf.point=Lf,Cf(cf=df=e,ff=hf=t)}function Lf(e,t){var n=e-df,r=t-hf,i=vu(n*n+r*r);yf+=i*(df+e)/2,_f+=i*(hf+t)/2,bf+=i,wf+=(i=hf*e-df*t)*(df+e),xf+=i*(hf+t),Ef+=3*i,Cf(df=e,hf=t)}var jf=Mf;function Df(e){this._context=e}Df.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,iu)}},result:xu};var Nf,If,Ff,Bf,Uf,zf=Js(),Vf={point:xu,lineStart:function(){Vf.point=Hf},lineEnd:function(){Nf&&qf(If,Ff),Vf.point=xu},polygonStart:function(){Nf=!0},polygonEnd:function(){Nf=null},result:function(){var e=+zf;return zf.reset(),e}};function Hf(e,t){Vf.point=qf,If=Bf=e,Ff=Uf=t}function qf(e,t){Bf-=e,Uf-=t,zf.add(vu(Bf*Bf+Uf*Uf)),Bf=e,Uf=t}var Gf=Vf;function Wf(){this._string=[]}function Xf(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}Wf.prototype={_radius:4.5,_circle:Xf(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=Xf(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var Yf=function(e,t){var n,r,i=4.5;function o(e){return e&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Lu(e,n(r))),r.result()}return o.area=function(e){return Lu(e,n(of)),of.result()},o.measure=function(e){return Lu(e,n(Gf)),Gf.result()},o.bounds=function(e){return Lu(e,n(pf)),pf.result()},o.centroid=function(e){return Lu(e,n(jf)),jf.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,Jc):(e=t).stream,o):e},o.context=function(e){return arguments.length?(r=null==e?(t=null,new Wf):new Df(t=e),"function"!=typeof i&&r.pointRadius(i),o):t},o.pointRadius=function(e){return arguments.length?(i="function"==typeof e?e:(r.pointRadius(+e),+e),o):i},o.projection(e).context(t)},$f=function(e){return{stream:Jf(e)}};function Jf(e){return function(t){var n=new Zf;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Zf(){}function Kf(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),Lu(n,e.stream(pf)),t(pf.result()),null!=r&&e.clipExtent(r),e}function Qf(e,t,n){return Kf(e,function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+t[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])},n)}function ed(e,t,n){return Qf(e,[[0,0],t],n)}function td(e,t,n){return Kf(e,function(n){var r=+t,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];e.scale(150*i).translate([o,a])},n)}function nd(e,t,n){return Kf(e,function(n){var r=+t,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,a])},n)}Zf.prototype={constructor:Zf,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var rd=16,id=cu(30*au),od=function(e,t){return+t?function(e,t){function n(r,i,o,a,s,u,l,c,f,d,h,p,g,m){var v=l-r,y=c-i,_=v*v+y*y;if(_>4*t&&g--){var b=a+d,w=s+h,x=u+p,E=vu(b*b+w*w+x*x),M=bu(x/=E),C=su(su(x)-1)<eu||su(o-f)<eu?(o+f)/2:lu(w,b),T=e(C,M),S=T[0],O=T[1],k=S-r,A=O-i,P=y*k-v*A;(P*P/_>t||su((v*k+y*A)/_-.5)>.3||a*d+s*h+u*p<id)&&(n(r,i,o,a,s,u,S,O,C,b/=E,w/=E,x,g,m),m.point(S,O),n(S,O,C,b,w,x,l,c,f,d,h,p,g,m))}}return function(t){var r,i,o,a,s,u,l,c,f,d,h,p,g={point:m,lineStart:v,lineEnd:_,polygonStart:function(){t.polygonStart(),g.lineStart=b},polygonEnd:function(){t.polygonEnd(),g.lineStart=v}};function m(n,r){n=e(n,r),t.point(n[0],n[1])}function v(){c=NaN,g.point=y,t.lineStart()}function y(r,i){var o=Hu([r,i]),a=e(r,i);n(c,f,l,d,h,p,c=a[0],f=a[1],l=r,d=o[0],h=o[1],p=o[2],rd,t),t.point(c,f)}function _(){g.point=m,t.lineEnd()}function b(){v(),g.point=w,g.lineEnd=x}function w(e,t){y(r=e,t),i=c,o=f,a=d,s=h,u=p,g.point=y}function x(){n(c,f,l,d,h,p,i,o,r,a,s,u,rd,t),g.lineEnd=_,_()}return g}}(e,t):function(e){return Jf({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)};var ad=Jf({point:function(e,t){this.stream.point(e*au,t*au)}});function sd(e,t,n,r){var i=cu(r),o=gu(r),a=i*e,s=o*e,u=i/e,l=o/e,c=(o*n-i*t)/e,f=(o*t+i*n)/e;function d(e,r){return[a*e-s*r+t,n-s*e-a*r]}return d.invert=function(e,t){return[u*e-l*t+c,f-l*e-u*t]},d}function ud(e){return ld(function(){return e})()}function ld(e){var t,n,r,i,o,a,s,u,l,c,f=150,d=480,h=250,p=0,g=0,m=0,v=0,y=0,_=0,b=null,w=hc,x=null,E=Jc,M=.5;function C(e){return u(e[0]*au,e[1]*au)}function T(e){return(e=u.invert(e[0],e[1]))&&[e[0]*ou,e[1]*ou]}function S(){var e=sd(f,0,0,_).apply(null,t(p,g)),r=(_?sd:function(e,t,n){function r(r,i){return[t+e*r,n-e*i]}return r.invert=function(r,i){return[(r-t)/e,(n-i)/e]},r})(f,d-e[0],h-e[1],_);return n=$l(m,v,y),s=Xl(t,r),u=Xl(n,s),a=od(s,M),O()}function O(){return l=c=null,C}return C.stream=function(e){return l&&c===e?l:l=ad(function(e){return Jf({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(w(a(E(c=e)))))},C.preclip=function(e){return arguments.length?(w=e,b=void 0,O()):w},C.postclip=function(e){return arguments.length?(E=e,x=r=i=o=null,O()):E},C.clipAngle=function(e){return arguments.length?(w=+e?pc(b=e*au):(b=null,hc),O()):b*ou},C.clipExtent=function(e){return arguments.length?(E=null==e?(x=r=i=o=null,Jc):yc(x=+e[0][0],r=+e[0][1],i=+e[1][0],o=+e[1][1]),O()):null==x?null:[[x,r],[i,o]]},C.scale=function(e){return arguments.length?(f=+e,S()):f},C.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],S()):[d,h]},C.center=function(e){return arguments.length?(p=e[0]%360*au,g=e[1]%360*au,S()):[p*ou,g*ou]},C.rotate=function(e){return arguments.length?(m=e[0]%360*au,v=e[1]%360*au,y=e.length>2?e[2]%360*au:0,S()):[m*ou,v*ou,y*ou]},C.angle=function(e){return arguments.length?(_=e%360*au,S()):_*ou},C.precision=function(e){return arguments.length?(a=od(s,M=e*e),O()):vu(M)},C.fitExtent=function(e,t){return Qf(C,e,t)},C.fitSize=function(e,t){return ed(C,e,t)},C.fitWidth=function(e,t){return td(C,e,t)},C.fitHeight=function(e,t){return nd(C,e,t)},function(){return t=e.apply(this,arguments),C.invert=t.invert&&T,S()}}function cd(e){var t=0,n=tu/3,r=ld(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*au,n=e[1]*au):[t*ou,n*ou]},i}function fd(e,t){var n=gu(e),r=(n+gu(t))/2;if(su(r)<eu)return function(e){var t=cu(e);function n(e,n){return[e*t,gu(n)/t]}return n.invert=function(e,n){return[e/t,bu(n*t)]},n}(e);var i=1+n*(2*r-n),o=vu(i)/r;function a(e,t){var n=vu(i-2*r*gu(t))/r;return[n*gu(e*=r),o-n*cu(e)]}return a.invert=function(e,t){var n=o-t;return[lu(e,su(n))/r*mu(n),bu((i-(e*e+n*n)*r*r)/(2*r))]},a}var dd=function(){return cd(fd).scale(155.424).center([0,33.6442])},hd=function(){return dd().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var pd=function(){var e,t,n,r,i,o,a=hd(),s=dd().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=dd().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,t){o=[e,t]}};function c(e){var t=e[0],a=e[1];return o=null,n.point(t,a),o||(r.point(t,a),o)||(i.point(t,a),o)}function f(){return e=t=null,c}return c.invert=function(e){var t=a.scale(),n=a.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:a).invert(e)},c.stream=function(n){return e&&t===n?e:e=function(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([a.stream(t=n),s.stream(n),u.stream(n)])},c.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),u.precision(e),f()):a.precision()},c.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),u.scale(e),c.translate(a.translate())):a.scale()},c.translate=function(e){if(!arguments.length)return a.translate();var t=a.scale(),o=+e[0],c=+e[1];return n=a.translate(e).clipExtent([[o-.455*t,c-.238*t],[o+.455*t,c+.238*t]]).stream(l),r=s.translate([o-.307*t,c+.201*t]).clipExtent([[o-.425*t+eu,c+.12*t+eu],[o-.214*t-eu,c+.234*t-eu]]).stream(l),i=u.translate([o-.205*t,c+.212*t]).clipExtent([[o-.214*t+eu,c+.166*t+eu],[o-.115*t-eu,c+.234*t-eu]]).stream(l),f()},c.fitExtent=function(e,t){return Qf(c,e,t)},c.fitSize=function(e,t){return ed(c,e,t)},c.fitWidth=function(e,t){return td(c,e,t)},c.fitHeight=function(e,t){return nd(c,e,t)},c.scale(1070)};function gd(e){return function(t,n){var r=cu(t),i=cu(n),o=e(r*i);return[o*i*gu(t),o*gu(n)]}}function md(e){return function(t,n){var r=vu(t*t+n*n),i=e(r),o=gu(i),a=cu(i);return[lu(t*o,r*a),bu(r&&n*o/r)]}}var vd=gd(function(e){return vu(2/(1+e))});vd.invert=md(function(e){return 2*bu(e/2)});var yd=function(){return ud(vd).scale(124.75).clipAngle(179.999)},_d=gd(function(e){return(e=_u(e))&&e/gu(e)});_d.invert=md(function(e){return e});var bd=function(){return ud(_d).scale(79.4188).clipAngle(179.999)};function wd(e,t){return[e,hu(yu((nu+t)/2))]}wd.invert=function(e,t){return[e,2*uu(du(t))-nu]};var xd=function(){return Ed(wd).scale(961/iu)};function Ed(e){var t,n,r,i=ud(e),o=i.center,a=i.scale,s=i.translate,u=i.clipExtent,l=null;function c(){var o=tu*a(),s=i(Ql(i.rotate()).invert([0,0]));return u(null==l?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:e===wd?[[Math.max(s[0]-o,l),t],[Math.min(s[0]+o,n),r]]:[[l,Math.max(s[1]-o,t)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(e){return arguments.length?(a(e),c()):a()},i.translate=function(e){return arguments.length?(s(e),c()):s()},i.center=function(e){return arguments.length?(o(e),c()):o()},i.clipExtent=function(e){return arguments.length?(null==e?l=t=n=r=null:(l=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),c()):null==l?null:[[l,t],[n,r]]},c()}function Md(e){return yu((nu+e)/2)}function Cd(e,t){var n=cu(e),r=e===t?gu(e):hu(n/cu(t))/hu(Md(t)/Md(e)),i=n*pu(Md(e),r)/r;if(!r)return wd;function o(e,t){i>0?t<-nu+eu&&(t=-nu+eu):t>nu-eu&&(t=nu-eu);var n=i/pu(Md(t),r);return[n*gu(r*e),i-n*cu(r*e)]}return o.invert=function(e,t){var n=i-t,o=mu(r)*vu(e*e+n*n);return[lu(e,su(n))/r*mu(n),2*uu(pu(i/o,1/r))-nu]},o}var Td=function(){return cd(Cd).scale(109.5).parallels([30,30])};function Sd(e,t){return[e,t]}Sd.invert=Sd;var Od=function(){return ud(Sd).scale(152.63)};function kd(e,t){var n=cu(e),r=e===t?gu(e):(n-cu(t))/(t-e),i=n/r+e;if(su(r)<eu)return Sd;function o(e,t){var n=i-t,o=r*e;return[n*gu(o),i-n*cu(o)]}return o.invert=function(e,t){var n=i-t;return[lu(e,su(n))/r*mu(n),i-mu(r)*vu(e*e+n*n)]},o}var Ad=function(){return cd(kd).scale(131.154).center([0,13.9389])};function Pd(e,t){var n=cu(t),r=cu(e)*n;return[n*gu(e)/r,gu(t)/r]}Pd.invert=md(uu);var Rd=function(){return ud(Pd).scale(144.049).clipAngle(60)};function Ld(e,t,n,r){return 1===e&&1===t&&0===n&&0===r?Jc:Jf({point:function(i,o){this.stream.point(i*e+n,o*t+r)}})}var jd=function(){var e,t,n,r,i,o,a=1,s=0,u=0,l=1,c=1,f=Jc,d=null,h=Jc;function p(){return r=i=null,o}return o={stream:function(e){return r&&i===e?r:r=f(h(i=e))},postclip:function(r){return arguments.length?(h=r,d=e=t=n=null,p()):h},clipExtent:function(r){return arguments.length?(h=null==r?(d=e=t=n=null,Jc):yc(d=+r[0][0],e=+r[0][1],t=+r[1][0],n=+r[1][1]),p()):null==d?null:[[d,e],[t,n]]},scale:function(e){return arguments.length?(f=Ld((a=+e)*l,a*c,s,u),p()):a},translate:function(e){return arguments.length?(f=Ld(a*l,a*c,s=+e[0],u=+e[1]),p()):[s,u]},reflectX:function(e){return arguments.length?(f=Ld(a*(l=e?-1:1),a*c,s,u),p()):l<0},reflectY:function(e){return arguments.length?(f=Ld(a*l,a*(c=e?-1:1),s,u),p()):c<0},fitExtent:function(e,t){return Qf(o,e,t)},fitSize:function(e,t){return ed(o,e,t)},fitWidth:function(e,t){return td(o,e,t)},fitHeight:function(e,t){return nd(o,e,t)}}};function Dd(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}Dd.invert=function(e,t){var n,r=t,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(su(n)>eu&&--i>0);return[e/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]};var Nd=function(){return ud(Dd).scale(175.295)};function Id(e,t){return[cu(t)*gu(e),gu(t)]}Id.invert=md(bu);var Fd=function(){return ud(Id).scale(249.5).clipAngle(90+eu)};function Bd(e,t){var n=cu(t),r=1+cu(e)*n;return[n*gu(e)/r,gu(t)/r]}Bd.invert=md(function(e){return 2*uu(e)});var Ud=function(){return ud(Bd).scale(250).clipAngle(142)};function zd(e,t){return[hu(yu((nu+t)/2)),-e]}zd.invert=function(e,t){return[-t,2*uu(du(e))-nu]};var Vd=function(){var e=Ed(zd),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)};function Hd(e,t){return e.parent===t.parent?1:2}function qd(e,t){return e+t.x}function Gd(e,t){return Math.max(e,t.y)}var Wd=function(){var e=Hd,t=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter(function(t){var n=t.children;n?(t.x=function(e){return e.reduce(qd,0)/e.length}(n),t.y=function(e){return 1+e.reduce(Gd,0)}(n)):(t.x=o?a+=e(t,o):0,t.y=0,o=t)});var s=function(e){for(var t;t=e.children;)e=t[0];return e}(i),u=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(i),l=s.x-e(s,u)/2,c=u.x+e(u,s)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t,e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-l)/(c-l)*t,e.y=(1-(i.y?e.y/i.y:1))*n})}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i};function Xd(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function Yd(e,t){var n,r,i,o,a,s=new Kd(e),u=+e.value&&(s.value=e.value),l=[s];for(null==t&&(t=$d);n=l.pop();)if(u&&(n.value=+n.data.value),(i=t(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)l.push(r=n.children[o]=new Kd(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(Zd)}function $d(e){return e.children}function Jd(e){e.data=e.data.data}function Zd(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function Kd(e){this.data=e,this.depth=this.height=0,this.parent=null}Kd.prototype=Yd.prototype={constructor:Kd,count:function(){return this.eachAfter(Xd)},each:function(e){var t,n,r,i,o=this,a=[o];do{for(t=a.reverse(),a=[];o=t.pop();)if(e(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(e){for(var t,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),t=i.children)for(n=0,r=t.length;n<r;++n)o.push(t[n]);for(;i=a.pop();)e(i);return this},eachBefore:function(e){for(var t,n,r=this,i=[r];r=i.pop();)if(e(r),t=r.children)for(n=t.length-1;n>=0;--n)i.push(t[n]);return this},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each(function(t){e.push(t)}),e},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return Yd(this).eachBefore(Jd)}};var Qd=Array.prototype.slice;var eh=function(e){for(var t,n,r=0,i=(e=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}(Qd.call(e))).length,o=[];r<i;)t=e[r],n&&rh(n,t)?++r:(n=oh(o=th(o,t)),r=0);return n};function th(e,t){var n,r;if(ih(t,e))return[t];for(n=0;n<e.length;++n)if(nh(t,e[n])&&ih(ah(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(nh(ah(e[n],e[r]),t)&&nh(ah(e[n],t),e[r])&&nh(ah(e[r],t),e[n])&&ih(sh(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function nh(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function rh(e,t){var n=e.r-t.r+1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function ih(e,t){for(var n=0;n<t.length;++n)if(!rh(e,t[n]))return!1;return!0}function oh(e){switch(e.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return ah(e[0],e[1]);case 3:return sh(e[0],e[1],e[2])}}function ah(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,a=t.y,s=t.r,u=o-n,l=a-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(r+a+l/f*c)/2,r:(f+i+s)/2}}function sh(e,t,n){var r=e.x,i=e.y,o=e.r,a=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-a,h=r-l,p=i-s,g=i-c,m=u-o,v=f-o,y=r*r+i*i-o*o,_=y-a*a-s*s+u*u,b=y-l*l-c*c+f*f,w=h*p-d*g,x=(p*b-g*_)/(2*w)-r,E=(g*m-p*v)/w,M=(h*_-d*b)/(2*w)-i,C=(d*v-h*m)/w,T=E*E+C*C-1,S=2*(o+x*E+M*C),O=x*x+M*M-o*o,k=-(T?(S+Math.sqrt(S*S-4*T*O))/(2*T):O/S);return{x:r+x+E*k,y:i+M+C*k,r:k}}function uh(e,t,n){var r,i,o,a,s=e.x-t.x,u=e.y-t.y,l=s*s+u*u;l?(i=t.r+n.r,i*=i,a=e.r+n.r,i>(a*=a)?(r=(l+a-i)/(2*l),o=Math.sqrt(Math.max(0,a/l-r*r)),n.x=e.x-r*s-o*u,n.y=e.y-r*u+o*s):(r=(l+i-a)/(2*l),o=Math.sqrt(Math.max(0,i/l-r*r)),n.x=t.x+r*s-o*u,n.y=t.y+r*u+o*s)):(n.x=t.x+n.r,n.y=t.y)}function lh(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function ch(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function fh(e){this._=e,this.next=null,this.previous=null}function dh(e){if(!(i=e.length))return 0;var t,n,r,i,o,a,s,u,l,c,f;if((t=e[0]).x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;uh(n,t,r=e[2]),t=new fh(t),n=new fh(n),r=new fh(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){uh(t._,n._,r=e[s]),r=new fh(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do{if(c<=f){if(lh(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(lh(l._,r._)){(t=l).next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,o=ch(t);(r=r.next)!==n;)(a=ch(r))<o&&(t=r,o=a);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=eh(t),s=0;s<i;++s)(t=e[s]).x-=r.x,t.y-=r.y;return r.r}var hh=function(e){return dh(e),e};function ph(e){if("function"!=typeof e)throw new Error;return e}function gh(){return 0}var mh=function(e){return function(){return e}};function vh(e){return Math.sqrt(e.value)}var yh=function(){var e=null,t=1,n=1,r=gh;function i(i){return i.x=t/2,i.y=n/2,e?i.eachBefore(_h(e)).eachAfter(bh(r,.5)).eachBefore(wh(1)):i.eachBefore(_h(vh)).eachAfter(bh(gh,1)).eachAfter(bh(r,i.r/Math.min(t,n))).eachBefore(wh(Math.min(t,n)/(2*i.r))),i}return i.radius=function(t){return arguments.length?(e=function(e){return null==e?null:ph(e)}(t),i):e},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(e){return arguments.length?(r="function"==typeof e?e:mh(+e),i):r},i};function _h(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function bh(e,t){return function(n){if(r=n.children){var r,i,o,a=r.length,s=e(n)*t||0;if(s)for(i=0;i<a;++i)r[i].r+=s;if(o=dh(r),s)for(i=0;i<a;++i)r[i].r-=s;n.r=o+s}}}function wh(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}var xh=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)},Eh=function(e,t,n,r,i){for(var o,a=e.children,s=-1,u=a.length,l=e.value&&(r-t)/e.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l},Mh=function(){var e=1,t=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=e,i.y1=t/o,i.eachBefore(function(e,t){return function(r){r.children&&Eh(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(t,o)),r&&i.eachBefore(xh),i}return i.round=function(e){return arguments.length?(r=!!e,i):r},i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]},i.padding=function(e){return arguments.length?(n=+e,i):n},i},Ch="$",Th={depth:-1},Sh={};function Oh(e){return e.id}function kh(e){return e.parentId}var Ah=function(){var e=Oh,t=kh;function n(n){var r,i,o,a,s,u,l,c=n.length,f=new Array(c),d={};for(i=0;i<c;++i)r=n[i],s=f[i]=new Kd(r),null!=(u=e(r,i,n))&&(u+="")&&(d[l=Ch+(s.id=u)]=l in d?Sh:s);for(i=0;i<c;++i)if(s=f[i],null!=(u=t(n[i],i,n))&&(u+="")){if(!(a=d[Ch+u]))throw new Error("missing: "+u);if(a===Sh)throw new Error("ambiguous: "+u);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=Th,o.eachBefore(function(e){e.depth=e.parent.depth+1,--c}).eachBefore(Zd),o.parent=null,c>0)throw new Error("cycle");return o}return n.id=function(t){return arguments.length?(e=ph(t),n):e},n.parentId=function(e){return arguments.length?(t=ph(e),n):t},n};function Ph(e,t){return e.parent===t.parent?1:2}function Rh(e){var t=e.children;return t?t[0]:e.t}function Lh(e){var t=e.children;return t?t[t.length-1]:e.t}function jh(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Dh(e,t,n){return e.a.parent===t.parent?e.a:n}function Nh(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Nh.prototype=Object.create(Kd.prototype);var Ih=function(){var e=Ph,t=1,n=1,r=null;function i(i){var u=function(e){for(var t,n,r,i,o,a=new Nh(e,0),s=[a];t=s.pop();)if(r=t._.children)for(t.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=t.children[i]=new Nh(r[i],i)),n.parent=t;return(a.parent=new Nh(null,0)).children=[a],a}(i);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(a),r)i.eachBefore(s);else{var l=i,c=i,f=i;i.eachBefore(function(e){e.x<l.x&&(l=e),e.x>c.x&&(c=e),e.depth>f.depth&&(f=e)});var d=l===c?1:e(l,c)/2,h=d-l.x,p=t/(c.x+d+h),g=n/(f.depth||1);i.eachBefore(function(e){e.x=(e.x+h)*p,e.y=e.depth*g})}return i}function o(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,o=i.length;--o>=0;)(t=i[o]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,o=t,a=t,s=n,u=o.parent.children[0],l=o.m,c=a.m,f=s.m,d=u.m;s=Lh(s),o=Rh(o),s&&o;)u=Rh(u),(a=Lh(a)).a=t,(i=s.z+f-o.z-l+e(s._,o._))>0&&(jh(Dh(s,t,r),t,i),l+=i,c+=i),f+=s.m,l+=o.m,d+=u.m,c+=a.m;s&&!Lh(a)&&(a.t=s,a.m+=f-c),o&&!Rh(u)&&(u.t=o,u.m+=l-d,r=t)}return r}(t,i,t.parent.A||r[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i},Fh=function(e,t,n,r,i){for(var o,a=e.children,s=-1,u=a.length,l=e.value&&(i-n)/e.value;++s<u;)(o=a[s]).x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l},Bh=(1+Math.sqrt(5))/2;function Uh(e,t,n,r,i,o){for(var a,s,u,l,c,f,d,h,p,g,m,v=[],y=t.children,_=0,b=0,w=y.length,x=t.value;_<w;){u=i-n,l=o-r;do{c=y[b++].value}while(!c&&b<w);for(f=d=c,m=c*c*(g=Math.max(l/u,u/l)/(x*e)),p=Math.max(d/m,m/f);b<w;++b){if(c+=s=y[b].value,s<f&&(f=s),s>d&&(d=s),m=c*c*g,(h=Math.max(d/m,m/f))>p){c-=s;break}p=h}v.push(a={value:c,dice:u<l,children:y.slice(_,b)}),a.dice?Eh(a,n,r,i,x?r+=l*c/x:o):Fh(a,n,r,x?n+=u*c/x:i,o),x-=c,_=b}return v}var zh=function e(t){function n(e,n,r,i,o){Uh(t,e,n,r,i,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(Bh),Vh=function(){var e=zh,t=!1,n=1,r=1,i=[0],o=gh,a=gh,s=gh,u=gh,l=gh;function c(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(f),i=[0],t&&e.eachBefore(xh),e}function f(t){var n=i[t.depth],r=t.x0+n,c=t.y0+n,f=t.x1-n,d=t.y1-n;f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),t.x0=r,t.y0=c,t.x1=f,t.y1=d,t.children&&(n=i[t.depth+1]=o(t)/2,r+=l(t)-n,c+=a(t)-n,f-=s(t)-n,d-=u(t)-n,f<r&&(r=f=(r+f)/2),d<c&&(c=d=(c+d)/2),e(t,r,c,f,d))}return c.round=function(e){return arguments.length?(t=!!e,c):t},c.size=function(e){return arguments.length?(n=+e[0],r=+e[1],c):[n,r]},c.tile=function(t){return arguments.length?(e=ph(t),c):e},c.padding=function(e){return arguments.length?c.paddingInner(e).paddingOuter(e):c.paddingInner()},c.paddingInner=function(e){return arguments.length?(o="function"==typeof e?e:mh(+e),c):o},c.paddingOuter=function(e){return arguments.length?c.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):c.paddingTop()},c.paddingTop=function(e){return arguments.length?(a="function"==typeof e?e:mh(+e),c):a},c.paddingRight=function(e){return arguments.length?(s="function"==typeof e?e:mh(+e),c):s},c.paddingBottom=function(e){return arguments.length?(u="function"==typeof e?e:mh(+e),c):u},c.paddingLeft=function(e){return arguments.length?(l="function"==typeof e?e:mh(+e),c):l},c},Hh=function(e,t,n,r,i){var o,a,s=e.children,u=s.length,l=new Array(u+1);for(l[0]=a=o=0;o<u;++o)l[o+1]=a+=s[o].value;!function e(t,n,r,i,o,a,u){if(t>=n-1){var c=s[t];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=u)}var f=l[t],d=r/2+f,h=t+1,p=n-1;for(;h<p;){var g=h+p>>>1;l[g]<d?h=g+1:p=g}d-l[h-1]<l[h]-d&&t+1<h&&--h;var m=l[h]-f,v=r-m;if(a-i>u-o){var y=(i*v+a*m)/r;e(t,h,m,i,o,y,u),e(h,n,v,y,o,a,u)}else{var _=(o*v+u*m)/r;e(t,h,m,i,o,a,_),e(h,n,v,i,_,a,u)}}(0,u,e.value,t,n,r,i)},qh=function(e,t,n,r,i){(1&e.depth?Fh:Eh)(e,t,n,r,i)},Gh=function e(t){function n(e,n,r,i,o){if((a=e._squarify)&&a.ratio===t)for(var a,s,u,l,c,f=-1,d=a.length,h=e.value;++f<d;){for(u=(s=a[f]).children,l=s.value=0,c=u.length;l<c;++l)s.value+=u[l].value;s.dice?Eh(s,n,r,i,r+=(o-r)*s.value/h):Fh(s,n,r,n+=(i-n)*s.value/h,o),h-=s.value}else e._squarify=a=Uh(t,e,n,r,i,o),a.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(Bh),Wh=function(e){for(var t,n=-1,r=e.length,i=e[r-1],o=0;++n<r;)t=i,i=e[n],o+=t[1]*i[0]-t[0]*i[1];return o/2},Xh=function(e){for(var t,n,r=-1,i=e.length,o=0,a=0,s=e[i-1],u=0;++r<i;)t=s,s=e[r],u+=n=t[0]*s[1]-s[0]*t[1],o+=(t[0]+s[0])*n,a+=(t[1]+s[1])*n;return[o/(u*=3),a/u]},Yh=function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])};function $h(e,t){return e[0]-t[0]||e[1]-t[1]}function Jh(e){for(var t=e.length,n=[0,1],r=2,i=2;i<t;++i){for(;r>1&&Yh(e[n[r-2]],e[n[r-1]],e[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}var Zh=function(e){if((n=e.length)<3)return null;var t,n,r=new Array(n),i=new Array(n);for(t=0;t<n;++t)r[t]=[+e[t][0],+e[t][1],t];for(r.sort($h),t=0;t<n;++t)i[t]=[r[t][0],-r[t][1]];var o=Jh(r),a=Jh(i),s=a[0]===o[0],u=a[a.length-1]===o[o.length-1],l=[];for(t=o.length-1;t>=0;--t)l.push(e[r[o[t]][2]]);for(t=+s;t<a.length-u;++t)l.push(e[r[a[t]][2]]);return l},Kh=function(e,t){for(var n,r,i=e.length,o=e[i-1],a=t[0],s=t[1],u=o[0],l=o[1],c=!1,f=0;f<i;++f)n=(o=e[f])[0],(r=o[1])>s!=l>s&&a<(u-n)*(s-r)/(l-r)+n&&(c=!c),u=n,l=r;return c},Qh=function(e){for(var t,n,r=-1,i=e.length,o=e[i-1],a=o[0],s=o[1],u=0;++r<i;)t=a,n=s,t-=a=(o=e[r])[0],n-=s=o[1],u+=Math.sqrt(t*t+n*n);return u},ep=function(){return Math.random()},tp=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,1===arguments.length?(n=e,e=0):n-=e,function(){return t()*n+e}}return n.source=e,n}(ep),np=function e(t){function n(e,n){var r,i;return e=null==e?0:+e,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*t()-1,o=2*t()-1,i=r*r+o*o}while(!i||i>1);return e+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=e,n}(ep),rp=function e(t){function n(){var e=np.source(t).apply(this,arguments);return function(){return Math.exp(e())}}return n.source=e,n}(ep),ip=function e(t){function n(e){return function(){for(var n=0,r=0;r<e;++r)n+=t();return n}}return n.source=e,n}(ep),op=function e(t){function n(e){var n=ip.source(t)(e);return function(){return n()/e}}return n.source=e,n}(ep),ap=function e(t){function n(e){return function(){return-Math.log(1-t())/e}}return n.source=e,n}(ep),sp=Array.prototype,up=sp.map,lp=sp.slice,cp={name:"implicit"};function fp(e){var t=Jo(),n=[],r=cp;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==cp)return r;t.set(o,a=n.push(i))}return e[(a-1)%e.length]}return e=null==e?[]:lp.call(e),i.domain=function(e){if(!arguments.length)return n.slice();n=[],t=Jo();for(var r,o,a=-1,s=e.length;++a<s;)t.has(o=(r=e[a])+"")||t.set(o,n.push(r));return i},i.range=function(t){return arguments.length?(e=lp.call(t),i):e.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return fp().domain(n).range(e).unknown(r)},i}function dp(){var e,t,n=fp().unknown(void 0),r=n.domain,i=n.range,o=[0,1],a=!1,s=0,u=0,l=.5;function c(){var n=r().length,c=o[1]<o[0],f=o[c-0],d=o[1-c];e=(d-f)/Math.max(1,n-s+2*u),a&&(e=Math.floor(e)),f+=(d-f-e*(n-s))*l,t=e*(1-s),a&&(f=Math.round(f),t=Math.round(t));var h=x(n).map(function(t){return f+e*t});return i(c?h.reverse():h)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),c()):r()},n.range=function(e){return arguments.length?(o=[+e[0],+e[1]],c()):o.slice()},n.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,c()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(a=!!e,c()):a},n.padding=function(e){return arguments.length?(s=u=Math.max(0,Math.min(1,e)),c()):s},n.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),c()):s},n.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),c()):u},n.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),c()):l},n.copy=function(){return dp().domain(r()).range(o).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function hp(){return function e(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return e(n())},t}(dp().paddingInner(1))}var pp=function(e){return function(){return e}},gp=function(e){return+e},mp=[0,1];function vp(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:pp(t)}function yp(e,t,n,r){var i=e[0],o=e[1],a=t[0],s=t[1];return o<i?(i=n(o,i),a=r(s,a)):(i=n(i,o),a=r(a,s)),function(e){return a(i(e))}}function _p(e,t,n,r){var i=Math.min(e.length,t.length)-1,o=new Array(i),a=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)o[s]=n(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(t){var n=u(e,t,1,i)-1;return a[n](o[n](t))}}function bp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function wp(e,t){var n,r,i,o=mp,a=mp,s=Zn,u=!1;function l(){return n=Math.min(o.length,a.length)>2?_p:yp,r=i=null,c}function c(t){return(r||(r=n(o,a,u?function(e){return function(t,n){var r=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:r(e)}}}(e):e,s)))(+t)}return c.invert=function(e){return(i||(i=n(a,o,vp,u?function(e){return function(t,n){var r=e(t=+t,n=+n);return function(e){return e<=0?t:e>=1?n:r(e)}}}(t):t)))(+e)},c.domain=function(e){return arguments.length?(o=up.call(e,gp),l()):o.slice()},c.range=function(e){return arguments.length?(a=lp.call(e),l()):a.slice()},c.rangeRound=function(e){return a=lp.call(e),s=Kn,l()},c.clamp=function(e){return arguments.length?(u=!!e,l()):u},c.interpolate=function(e){return arguments.length?(s=e,l()):s},l()}var xp=function(e,t,n){var r,i=e[0],o=e[e.length-1],a=O(i,o,null==t?10:t);switch((n=js(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(i),Math.abs(o));return null!=n.precision||isNaN(r=Ys(a,s))||(n.precision=r),Bs(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=$s(a,Math.max(Math.abs(i),Math.abs(o))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=Xs(a))||(n.precision=r-2*("%"===n.type))}return Fs(n)};function Ep(e){var t=e.domain;return e.ticks=function(e){var n=t();return T(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return xp(t(),e,n)},e.nice=function(n){null==n&&(n=10);var r,i=t(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=S(s,u,n))>0?r=S(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=S(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,t(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,t(i)),e},e}function Mp(){var e=wp(vp,Vn);return e.copy=function(){return bp(e,Mp())},Ep(e)}function Cp(){var e=[0,1];function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=up.call(n,gp),t):e.slice()},t.copy=function(){return Cp().domain(e)},Ep(t)}var Tp=function(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e};function Sp(e,t){return(t=Math.log(t/e))?function(n){return Math.log(n/e)/t}:pp(t)}function Op(e,t){return e<0?function(n){return-Math.pow(-t,n)*Math.pow(-e,1-n)}:function(n){return Math.pow(t,n)*Math.pow(e,1-n)}}function kp(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Ap(e){return 10===e?kp:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function Pp(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function Rp(e){return function(t){return-e(-t)}}function Lp(){var e=wp(Sp,Op).domain([1,10]),t=e.domain,n=10,r=Pp(10),i=Ap(10);function o(){return r=Pp(n),i=Ap(n),t()[0]<0&&(r=Rp(r),i=Rp(i)),e}return e.base=function(e){return arguments.length?(n=+e,o()):n},e.domain=function(e){return arguments.length?(t(e),o()):t()},e.ticks=function(e){var o,a=t(),s=a[0],u=a[a.length-1];(o=u<s)&&(d=s,s=u,u=d);var l,c,f,d=r(s),h=r(u),p=null==e?10:+e,g=[];if(!(n%1)&&h-d<p){if(d=Math.round(d)-1,h=Math.round(h)+1,s>0){for(;d<h;++d)for(c=1,l=i(d);c<n;++c)if(!((f=l*c)<s)){if(f>u)break;g.push(f)}}else for(;d<h;++d)for(c=n-1,l=i(d);c>=1;--c)if(!((f=l*c)<s)){if(f>u)break;g.push(f)}}else g=T(d,h,Math.min(h-d,p)).map(i);return o?g.reverse():g},e.tickFormat=function(t,o){if(null==o&&(o=10===n?".0e":","),"function"!=typeof o&&(o=Fs(o)),t===1/0)return o;null==t&&(t=10);var a=Math.max(1,n*t/e.ticks().length);return function(e){var t=e/i(Math.round(r(e)));return t*n<n-.5&&(t*=n),t<=a?o(e):""}},e.nice=function(){return t(Tp(t(),{floor:function(e){return i(Math.floor(r(e)))},ceil:function(e){return i(Math.ceil(r(e)))}}))},e.copy=function(){return bp(e,Lp().base(n))},e}function jp(e,t){return e<0?-Math.pow(-e,t):Math.pow(e,t)}function Dp(){var e=1,t=wp(function(t,n){return(n=jp(n,e)-(t=jp(t,e)))?function(r){return(jp(r,e)-t)/n}:pp(n)},function(t,n){return n=jp(n,e)-(t=jp(t,e)),function(r){return jp(t+n*r,1/e)}}),n=t.domain;return t.exponent=function(t){return arguments.length?(e=+t,n(n())):e},t.copy=function(){return bp(t,Dp().exponent(e))},Ep(t)}function Np(){return Dp().exponent(.5)}function Ip(){var e=[],t=[],n=[];function i(){var r=0,i=Math.max(1,t.length);for(n=new Array(i-1);++r<i;)n[r-1]=P(e,r/i);return o}function o(e){if(!isNaN(e=+e))return t[u(n,e)]}return o.invertExtent=function(r){var i=t.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]},o.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,o=0,a=t.length;o<a;++o)null==(n=t[o])||isNaN(n=+n)||e.push(n);return e.sort(r),i()},o.range=function(e){return arguments.length?(t=lp.call(e),i()):t.slice()},o.quantiles=function(){return n.slice()},o.copy=function(){return Ip().domain(e).range(t)},o}function Fp(){var e=0,t=1,n=1,r=[.5],i=[0,1];function o(e){if(e<=e)return i[u(r,e,0,n)]}function a(){var i=-1;for(r=new Array(n);++i<n;)r[i]=((i+1)*t-(i-n)*e)/(n+1);return o}return o.domain=function(n){return arguments.length?(e=+n[0],t=+n[1],a()):[e,t]},o.range=function(e){return arguments.length?(n=(i=lp.call(e)).length-1,a()):i.slice()},o.invertExtent=function(o){var a=i.indexOf(o);return a<0?[NaN,NaN]:a<1?[e,r[0]]:a>=n?[r[n-1],t]:[r[a-1],r[a]]},o.copy=function(){return Fp().domain([e,t]).range(i)},Ep(o)}function Bp(){var e=[.5],t=[0,1],n=1;function r(r){if(r<=r)return t[u(e,r,0,n)]}return r.domain=function(i){return arguments.length?(e=lp.call(i),n=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(i){return arguments.length?(t=lp.call(i),n=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]},r.copy=function(){return Bp().domain(e).range(t)},r}var Up=new Date,zp=new Date;function Vp(e,t,n,r){function i(t){return e(t=new Date(+t)),t}return i.floor=i,i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<r);return s},i.filter=function(n){return Vp(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(i.count=function(t,r){return Up.setTime(+t),zp.setTime(+r),e(Up),e(zp),Math.floor(n(Up,zp))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var Hp=Vp(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Hp.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Vp(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):Hp:null};var qp=Hp,Gp=Hp.range,Wp=6e4,Xp=6048e5,Yp=Vp(function(e){e.setTime(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),$p=Yp,Jp=Yp.range,Zp=Vp(function(e){e.setTime(Math.floor(e/Wp)*Wp)},function(e,t){e.setTime(+e+t*Wp)},function(e,t){return(t-e)/Wp},function(e){return e.getMinutes()}),Kp=Zp,Qp=Zp.range,eg=Vp(function(e){var t=e.getTimezoneOffset()*Wp%36e5;t<0&&(t+=36e5),e.setTime(36e5*Math.floor((+e-t)/36e5)+t)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),tg=eg,ng=eg.range,rg=Vp(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Wp)/864e5},function(e){return e.getDate()-1}),ig=rg,og=rg.range;function ag(e){return Vp(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Wp)/Xp})}var sg=ag(0),ug=ag(1),lg=ag(2),cg=ag(3),fg=ag(4),dg=ag(5),hg=ag(6),pg=sg.range,gg=ug.range,mg=lg.range,vg=cg.range,yg=fg.range,_g=dg.range,bg=hg.range,wg=Vp(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),xg=wg,Eg=wg.range,Mg=Vp(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Mg.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Vp(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var Cg=Mg,Tg=Mg.range,Sg=Vp(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Wp)},function(e,t){return(t-e)/Wp},function(e){return e.getUTCMinutes()}),Og=Sg,kg=Sg.range,Ag=Vp(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()}),Pg=Ag,Rg=Ag.range,Lg=Vp(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),jg=Lg,Dg=Lg.range;function Ng(e){return Vp(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/Xp})}var Ig=Ng(0),Fg=Ng(1),Bg=Ng(2),Ug=Ng(3),zg=Ng(4),Vg=Ng(5),Hg=Ng(6),qg=Ig.range,Gg=Fg.range,Wg=Bg.range,Xg=Ug.range,Yg=zg.range,$g=Vg.range,Jg=Hg.range,Zg=Vp(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),Kg=Zg,Qg=Zg.range,em=Vp(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});em.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Vp(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var tm=em,nm=em.range;function rm(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function im(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function om(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function am(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=ym(i),c=_m(i),f=ym(o),d=_m(o),h=ym(a),p=_m(a),g=ym(s),m=_m(s),v=ym(u),y=_m(u),_={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Bm,e:Bm,f:qm,H:Um,I:zm,j:Vm,L:Hm,m:Gm,M:Wm,p:function(e){return i[+(e.getHours()>=12)]},Q:bv,s:wv,S:Xm,u:Ym,U:$m,V:Jm,w:Zm,W:Km,x:null,X:null,y:Qm,Y:ev,Z:tv,"%":_v},b={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:nv,e:nv,f:sv,H:rv,I:iv,j:ov,L:av,m:uv,M:lv,p:function(e){return i[+(e.getUTCHours()>=12)]},Q:bv,s:wv,S:cv,u:fv,U:dv,V:hv,w:pv,W:gv,x:null,X:null,y:mv,Y:vv,Z:yv,"%":_v},w={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m[r[0].toLowerCase()],n+r[0].length):-1},c:function(e,n,r){return M(e,t,n,r)},d:km,e:km,f:Dm,H:Pm,I:Pm,j:Am,L:jm,m:Om,M:Rm,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=c[r[0].toLowerCase()],n+r[0].length):-1},Q:Im,s:Fm,S:Lm,u:wm,U:xm,V:Em,w:bm,W:Mm,x:function(e,t,r){return M(e,n,t,r)},X:function(e,t,n){return M(e,r,t,n)},y:Tm,Y:Cm,Z:Sm,"%":Nm};function x(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=dm[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function E(e,t){return function(n){var r,i,o=om(1900);if(M(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=(i=(r=im(om(o.y))).getUTCDay())>4||0===i?Fg.ceil(r):Fg(r),r=jg.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(r=(i=(r=t(om(o.y))).getDay())>4||0===i?ug.ceil(r):ug(r),r=ig.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?im(om(o.y)).getUTCDay():t(om(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,im(o)):t(o)}}function M(e,t,n,r){for(var i,o,a=0,s=t.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=w[i in dm?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return _.x=x(n,_),_.X=x(r,_),_.c=x(t,_),b.x=x(n,b),b.X=x(r,b),b.c=x(t,b),{format:function(e){var t=x(e+="",_);return t.toString=function(){return e},t},parse:function(e){var t=E(e+="",rm);return t.toString=function(){return e},t},utcFormat:function(e){var t=x(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=E(e,im);return t.toString=function(){return e},t}}}var sm,um,lm,cm,fm,dm={"-":"",_:" ",0:"0"},hm=/^\s*\d+/,pm=/^%/,gm=/[\\^$*+?|[\]().{}]/g;function mm(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function vm(e){return e.replace(gm,"\\$&")}function ym(e){return new RegExp("^(?:"+e.map(vm).join("|")+")","i")}function _m(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function bm(e,t,n){var r=hm.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function wm(e,t,n){var r=hm.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function xm(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Em(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Mm(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Cm(e,t,n){var r=hm.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Tm(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Sm(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Om(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function km(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Am(e,t,n){var r=hm.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Pm(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Rm(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Lm(e,t,n){var r=hm.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function jm(e,t,n){var r=hm.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Dm(e,t,n){var r=hm.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Nm(e,t,n){var r=pm.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Im(e,t,n){var r=hm.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Fm(e,t,n){var r=hm.exec(t.slice(n));return r?(e.Q=1e3*+r[0],n+r[0].length):-1}function Bm(e,t){return mm(e.getDate(),t,2)}function Um(e,t){return mm(e.getHours(),t,2)}function zm(e,t){return mm(e.getHours()%12||12,t,2)}function Vm(e,t){return mm(1+ig.count(Cg(e),e),t,3)}function Hm(e,t){return mm(e.getMilliseconds(),t,3)}function qm(e,t){return Hm(e,t)+"000"}function Gm(e,t){return mm(e.getMonth()+1,t,2)}function Wm(e,t){return mm(e.getMinutes(),t,2)}function Xm(e,t){return mm(e.getSeconds(),t,2)}function Ym(e){var t=e.getDay();return 0===t?7:t}function $m(e,t){return mm(sg.count(Cg(e),e),t,2)}function Jm(e,t){var n=e.getDay();return e=n>=4||0===n?fg(e):fg.ceil(e),mm(fg.count(Cg(e),e)+(4===Cg(e).getDay()),t,2)}function Zm(e){return e.getDay()}function Km(e,t){return mm(ug.count(Cg(e),e),t,2)}function Qm(e,t){return mm(e.getFullYear()%100,t,2)}function ev(e,t){return mm(e.getFullYear()%1e4,t,4)}function tv(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+mm(t/60|0,"0",2)+mm(t%60,"0",2)}function nv(e,t){return mm(e.getUTCDate(),t,2)}function rv(e,t){return mm(e.getUTCHours(),t,2)}function iv(e,t){return mm(e.getUTCHours()%12||12,t,2)}function ov(e,t){return mm(1+jg.count(tm(e),e),t,3)}function av(e,t){return mm(e.getUTCMilliseconds(),t,3)}function sv(e,t){return av(e,t)+"000"}function uv(e,t){return mm(e.getUTCMonth()+1,t,2)}function lv(e,t){return mm(e.getUTCMinutes(),t,2)}function cv(e,t){return mm(e.getUTCSeconds(),t,2)}function fv(e){var t=e.getUTCDay();return 0===t?7:t}function dv(e,t){return mm(Ig.count(tm(e),e),t,2)}function hv(e,t){var n=e.getUTCDay();return e=n>=4||0===n?zg(e):zg.ceil(e),mm(zg.count(tm(e),e)+(4===tm(e).getUTCDay()),t,2)}function pv(e){return e.getUTCDay()}function gv(e,t){return mm(Fg.count(tm(e),e),t,2)}function mv(e,t){return mm(e.getUTCFullYear()%100,t,2)}function vv(e,t){return mm(e.getUTCFullYear()%1e4,t,4)}function yv(){return"+0000"}function _v(){return"%"}function bv(e){return+e}function wv(e){return Math.floor(+e/1e3)}function xv(e){return sm=am(e),um=sm.format,lm=sm.parse,cm=sm.utcFormat,fm=sm.utcParse,sm}xv({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Ev=Date.prototype.toISOString?function(e){return e.toISOString()}:cm("%Y-%m-%dT%H:%M:%S.%LZ");var Mv=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:fm("%Y-%m-%dT%H:%M:%S.%LZ"),Cv=1e3,Tv=60*Cv,Sv=60*Tv,Ov=24*Sv,kv=7*Ov,Av=30*Ov,Pv=365*Ov;function Rv(e){return new Date(e)}function Lv(e){return e instanceof Date?+e:+new Date(+e)}function jv(e,t,n,r,o,a,s,u,l){var c=wp(vp,Vn),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),v=l("%a %d"),y=l("%b %d"),_=l("%B"),b=l("%Y"),w=[[s,1,Cv],[s,5,5*Cv],[s,15,15*Cv],[s,30,30*Cv],[a,1,Tv],[a,5,5*Tv],[a,15,15*Tv],[a,30,30*Tv],[o,1,Sv],[o,3,3*Sv],[o,6,6*Sv],[o,12,12*Sv],[r,1,Ov],[r,2,2*Ov],[n,1,kv],[t,1,Av],[t,3,3*Av],[e,1,Pv]];function x(i){return(s(i)<i?h:a(i)<i?p:o(i)<i?g:r(i)<i?m:t(i)<i?n(i)<i?v:y:e(i)<i?_:b)(i)}function E(t,n,r,o){if(null==t&&(t=10),"number"==typeof t){var a=Math.abs(r-n)/t,s=i(function(e){return e[2]}).right(w,a);s===w.length?(o=O(n/Pv,r/Pv,t),t=e):s?(o=(s=w[a/w[s-1][2]<w[s][2]/a?s-1:s])[1],t=s[0]):(o=Math.max(O(n,r,t),1),t=u)}return null==o?t:t.every(o)}return c.invert=function(e){return new Date(f(e))},c.domain=function(e){return arguments.length?d(up.call(e,Lv)):d().map(Rv)},c.ticks=function(e,t){var n,r=d(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=(n=E(e,i,o,t))?n.range(i,o+1):[],a?n.reverse():n},c.tickFormat=function(e,t){return null==t?x:l(t)},c.nice=function(e,t){var n=d();return(e=E(e,n[0],n[n.length-1],t))?d(Tp(n,e)):c},c.copy=function(){return bp(c,jv(e,t,n,r,o,a,s,u,l))},c}var Dv=function(){return jv(Cg,xg,sg,ig,tg,Kp,$p,qp,um).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},Nv=function(){return jv(tm,Kg,Ig,jg,Pg,Og,$p,qp,cm).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])};function Iv(e){var t=0,n=1,r=1,i=!1;function o(n){var o=(n-t)*r;return e(i?Math.max(0,Math.min(1,o)):o)}return o.domain=function(e){return arguments.length?(t=+e[0],n=+e[1],r=t===n?0:1/(n-t),o):[t,n]},o.clamp=function(e){return arguments.length?(i=!!e,o):i},o.interpolator=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return Iv(e).domain([t,n]).clamp(i)},Ep(o)}function Fv(e){var t=0,n=.5,r=1,i=1,o=1,a=!1;function s(t){var r=.5+((t=+t)-n)*(t<n?i:o);return e(a?Math.max(0,Math.min(1,r)):r)}return s.domain=function(e){return arguments.length?(t=+e[0],n=+e[1],r=+e[2],i=t===n?0:.5/(n-t),o=n===r?0:.5/(r-n),s):[t,n,r]},s.clamp=function(e){return arguments.length?(a=!!e,s):a},s.interpolator=function(t){return arguments.length?(e=t,s):e},s.copy=function(){return Fv(e).domain([t,n,r]).clamp(a)},Ep(s)}var Bv=function(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n},Uv=Bv("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),zv=Bv("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Vv=Bv("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Hv=Bv("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),qv=Bv("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Gv=Bv("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Wv=Bv("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Xv=Bv("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Yv=Bv("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),$v=function(e){return Fn(e[e.length-1])},Jv=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Bv),Zv=$v(Jv),Kv=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Bv),Qv=$v(Kv),ey=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Bv),ty=$v(ey),ny=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Bv),ry=$v(ny),iy=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Bv),oy=$v(iy),ay=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Bv),sy=$v(ay),uy=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Bv),ly=$v(uy),cy=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Bv),fy=$v(cy),dy=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Bv),hy=$v(dy),py=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Bv),gy=$v(py),my=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Bv),vy=$v(my),yy=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Bv),_y=$v(yy),by=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Bv),wy=$v(by),xy=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Bv),Ey=$v(xy),My=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Bv),Cy=$v(My),Ty=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Bv),Sy=$v(Ty),Oy=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Bv),ky=$v(Oy),Ay=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Bv),Py=$v(Ay),Ry=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Bv),Ly=$v(Ry),jy=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Bv),Dy=$v(jy),Ny=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Bv),Iy=$v(Ny),Fy=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Bv),By=$v(Fy),Uy=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Bv),zy=$v(Uy),Vy=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Bv),Hy=$v(Vy),qy=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Bv),Gy=$v(qy),Wy=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Bv),Xy=$v(Wy),Yy=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Bv),$y=$v(Yy),Jy=vr(Tn(300,.5,0),Tn(-240,.5,1)),Zy=vr(Tn(-100,.75,.35),Tn(80,1.5,.8)),Ky=vr(Tn(260,.75,.35),Tn(80,1.5,.8)),Qy=Tn(),e_=function(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return Qy.h=360*e-100,Qy.s=1.5-1.5*t,Qy.l=.8-.9*t,Qy+""},t_=Gt(),n_=Math.PI/3,r_=2*Math.PI/3,i_=function(e){var t;return e=(.5-e)*Math.PI,t_.r=255*(t=Math.sin(e))*t,t_.g=255*(t=Math.sin(e+n_))*t,t_.b=255*(t=Math.sin(e+r_))*t,t_+""};function o_(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var a_=o_(Bv("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),s_=o_(Bv("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),u_=o_(Bv("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),l_=o_(Bv("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),c_=function(e){return function(){return e}},f_=Math.abs,d_=Math.atan2,h_=Math.cos,p_=Math.max,g_=Math.min,m_=Math.sin,v_=Math.sqrt,y_=1e-12,__=Math.PI,b_=__/2,w_=2*__;function x_(e){return e>=1?b_:e<=-1?-b_:Math.asin(e)}function E_(e){return e.innerRadius}function M_(e){return e.outerRadius}function C_(e){return e.startAngle}function T_(e){return e.endAngle}function S_(e){return e&&e.padAngle}function O_(e,t,n,r,i,o,a){var s=e-n,u=t-r,l=(a?o:-o)/v_(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,v=(h+g)/2,y=p-d,_=g-h,b=y*y+_*_,w=i-o,x=d*g-p*h,E=(_<0?-1:1)*v_(p_(0,w*w*b-x*x)),M=(x*_-y*E)/b,C=(-x*y-_*E)/b,T=(x*_+y*E)/b,S=(-x*y+_*E)/b,O=M-m,k=C-v,A=T-m,P=S-v;return O*O+k*k>A*A+P*P&&(M=T,C=S),{cx:M,cy:C,x01:-c,y01:-f,x11:M*(i/w-1),y11:C*(i/w-1)}}var k_=function(){var e=E_,t=M_,n=c_(0),r=null,i=C_,o=T_,a=S_,s=null;function u(){var u,l,c=+e.apply(this,arguments),f=+t.apply(this,arguments),d=i.apply(this,arguments)-b_,h=o.apply(this,arguments)-b_,p=f_(h-d),g=h>d;if(s||(s=u=zo()),f<c&&(l=f,f=c,c=l),f>y_)if(p>w_-y_)s.moveTo(f*h_(d),f*m_(d)),s.arc(0,0,f,d,h,!g),c>y_&&(s.moveTo(c*h_(h),c*m_(h)),s.arc(0,0,c,h,d,g));else{var m,v,y=d,_=h,b=d,w=h,x=p,E=p,M=a.apply(this,arguments)/2,C=M>y_&&(r?+r.apply(this,arguments):v_(c*c+f*f)),T=g_(f_(f-c)/2,+n.apply(this,arguments)),S=T,O=T;if(C>y_){var k=x_(C/c*m_(M)),A=x_(C/f*m_(M));(x-=2*k)>y_?(b+=k*=g?1:-1,w-=k):(x=0,b=w=(d+h)/2),(E-=2*A)>y_?(y+=A*=g?1:-1,_-=A):(E=0,y=_=(d+h)/2)}var P=f*h_(y),R=f*m_(y),L=c*h_(w),j=c*m_(w);if(T>y_){var D=f*h_(_),N=f*m_(_),I=c*h_(b),F=c*m_(b);if(p<__){var B=x>y_?function(e,t,n,r,i,o,a,s){var u=n-e,l=r-t,c=a-i,f=s-o,d=(c*(t-o)-f*(e-i))/(f*u-c*l);return[e+d*u,t+d*l]}(P,R,I,F,D,N,L,j):[L,j],U=P-B[0],z=R-B[1],V=D-B[0],H=N-B[1],q=1/m_(function(e){return e>1?0:e<-1?__:Math.acos(e)}((U*V+z*H)/(v_(U*U+z*z)*v_(V*V+H*H)))/2),G=v_(B[0]*B[0]+B[1]*B[1]);S=g_(T,(c-G)/(q-1)),O=g_(T,(f-G)/(q+1))}}E>y_?O>y_?(m=O_(I,F,P,R,f,O,g),v=O_(D,N,L,j,f,O,g),s.moveTo(m.cx+m.x01,m.cy+m.y01),O<T?s.arc(m.cx,m.cy,O,d_(m.y01,m.x01),d_(v.y01,v.x01),!g):(s.arc(m.cx,m.cy,O,d_(m.y01,m.x01),d_(m.y11,m.x11),!g),s.arc(0,0,f,d_(m.cy+m.y11,m.cx+m.x11),d_(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,O,d_(v.y11,v.x11),d_(v.y01,v.x01),!g))):(s.moveTo(P,R),s.arc(0,0,f,y,_,!g)):s.moveTo(P,R),c>y_&&x>y_?S>y_?(m=O_(L,j,D,N,c,-S,g),v=O_(P,R,I,F,c,-S,g),s.lineTo(m.cx+m.x01,m.cy+m.y01),S<T?s.arc(m.cx,m.cy,S,d_(m.y01,m.x01),d_(v.y01,v.x01),!g):(s.arc(m.cx,m.cy,S,d_(m.y01,m.x01),d_(m.y11,m.x11),!g),s.arc(0,0,c,d_(m.cy+m.y11,m.cx+m.x11),d_(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,S,d_(v.y11,v.x11),d_(v.y01,v.x01),!g))):s.arc(0,0,c,w,b,g):s.lineTo(L,j)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-__/2;return[h_(r)*n,m_(r)*n]},u.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:c_(+t),u):e},u.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:c_(+e),u):t},u.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:c_(+e),u):n},u.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:c_(+e),u):r},u.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:c_(+e),u):i},u.endAngle=function(e){return arguments.length?(o="function"==typeof e?e:c_(+e),u):o},u.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:c_(+e),u):a},u.context=function(e){return arguments.length?(s=null==e?null:e,u):s},u};function A_(e){this._context=e}A_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var P_=function(e){return new A_(e)};function R_(e){return e[0]}function L_(e){return e[1]}var j_=function(){var e=R_,t=L_,n=c_(!0),r=null,i=P_,o=null;function a(a){var s,u,l,c=a.length,f=!1;for(null==r&&(o=i(l=zo())),s=0;s<=c;++s)!(s<c&&n(u=a[s],s,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(u,s,a),+t(u,s,a));if(l)return o=null,l+""||null}return a.x=function(t){return arguments.length?(e="function"==typeof t?t:c_(+t),a):e},a.y=function(e){return arguments.length?(t="function"==typeof e?e:c_(+e),a):t},a.defined=function(e){return arguments.length?(n="function"==typeof e?e:c_(!!e),a):n},a.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),a):i},a.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),a):r},a},D_=function(){var e=R_,t=null,n=c_(0),r=L_,i=c_(!0),o=null,a=P_,s=null;function u(u){var l,c,f,d,h,p=u.length,g=!1,m=new Array(p),v=new Array(p);for(null==o&&(s=a(h=zo())),l=0;l<=p;++l){if(!(l<p&&i(d=u[l],l,u))===g)if(g=!g)c=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),f=l-1;f>=c;--f)s.point(m[f],v[f]);s.lineEnd(),s.areaEnd()}g&&(m[l]=+e(d,l,u),v[l]=+n(d,l,u),s.point(t?+t(d,l,u):m[l],r?+r(d,l,u):v[l]))}if(h)return s=null,h+""||null}function l(){return j_().defined(i).curve(a).context(o)}return u.x=function(n){return arguments.length?(e="function"==typeof n?n:c_(+n),t=null,u):e},u.x0=function(t){return arguments.length?(e="function"==typeof t?t:c_(+t),u):e},u.x1=function(e){return arguments.length?(t=null==e?null:"function"==typeof e?e:c_(+e),u):t},u.y=function(e){return arguments.length?(n="function"==typeof e?e:c_(+e),r=null,u):n},u.y0=function(e){return arguments.length?(n="function"==typeof e?e:c_(+e),u):n},u.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:c_(+e),u):r},u.lineX0=u.lineY0=function(){return l().x(e).y(n)},u.lineY1=function(){return l().x(e).y(r)},u.lineX1=function(){return l().x(t).y(n)},u.defined=function(e){return arguments.length?(i="function"==typeof e?e:c_(!!e),u):i},u.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),u):a},u.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),u):o},u},N_=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},I_=function(e){return e},F_=function(){var e=I_,t=N_,n=null,r=c_(0),i=c_(w_),o=c_(0);function a(a){var s,u,l,c,f,d=a.length,h=0,p=new Array(d),g=new Array(d),m=+r.apply(this,arguments),v=Math.min(w_,Math.max(-w_,i.apply(this,arguments)-m)),y=Math.min(Math.abs(v)/d,o.apply(this,arguments)),_=y*(v<0?-1:1);for(s=0;s<d;++s)(f=g[p[s]=s]=+e(a[s],s,a))>0&&(h+=f);for(null!=t?p.sort(function(e,n){return t(g[e],g[n])}):null!=n&&p.sort(function(e,t){return n(a[e],a[t])}),s=0,l=h?(v-d*_)/h:0;s<d;++s,m=c)u=p[s],c=m+((f=g[u])>0?f*l:0)+_,g[u]={data:a[u],index:s,value:f,startAngle:m,endAngle:c,padAngle:y};return g}return a.value=function(t){return arguments.length?(e="function"==typeof t?t:c_(+t),a):e},a.sortValues=function(e){return arguments.length?(t=e,n=null,a):t},a.sort=function(e){return arguments.length?(n=e,t=null,a):n},a.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:c_(+e),a):r},a.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:c_(+e),a):i},a.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:c_(+e),a):o},a},B_=z_(P_);function U_(e){this._curve=e}function z_(e){function t(t){return new U_(e(t))}return t._curve=e,t}function V_(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(z_(e)):t()._curve},e}U_.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};var H_=function(){return V_(j_().curve(B_))},q_=function(){var e=D_().curve(B_),t=e.curve,n=e.lineX0,r=e.lineX1,i=e.lineY0,o=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return V_(n())},delete e.lineX0,e.lineEndAngle=function(){return V_(r())},delete e.lineX1,e.lineInnerRadius=function(){return V_(i())},delete e.lineY0,e.lineOuterRadius=function(){return V_(o())},delete e.lineY1,e.curve=function(e){return arguments.length?t(z_(e)):t()._curve},e},G_=function(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]},W_=Array.prototype.slice;function X_(e){return e.source}function Y_(e){return e.target}function $_(e){var t=X_,n=Y_,r=R_,i=L_,o=null;function a(){var a,s=W_.call(arguments),u=t.apply(this,s),l=n.apply(this,s);if(o||(o=a=zo()),e(o,+r.apply(this,(s[0]=u,s)),+i.apply(this,s),+r.apply(this,(s[0]=l,s)),+i.apply(this,s)),a)return o=null,a+""||null}return a.source=function(e){return arguments.length?(t=e,a):t},a.target=function(e){return arguments.length?(n=e,a):n},a.x=function(e){return arguments.length?(r="function"==typeof e?e:c_(+e),a):r},a.y=function(e){return arguments.length?(i="function"==typeof e?e:c_(+e),a):i},a.context=function(e){return arguments.length?(o=null==e?null:e,a):o},a}function J_(e,t,n,r,i){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,i,r,i)}function Z_(e,t,n,r,i){e.moveTo(t,n),e.bezierCurveTo(t,n=(n+i)/2,r,n,r,i)}function K_(e,t,n,r,i){var o=G_(t,n),a=G_(t,n=(n+i)/2),s=G_(r,n),u=G_(r,i);e.moveTo(o[0],o[1]),e.bezierCurveTo(a[0],a[1],s[0],s[1],u[0],u[1])}function Q_(){return $_(J_)}function eb(){return $_(Z_)}function tb(){var e=$_(K_);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}var nb={draw:function(e,t){var n=Math.sqrt(t/__);e.moveTo(n,0),e.arc(0,0,n,0,w_)}},rb={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},ib=Math.sqrt(1/3),ob=2*ib,ab={draw:function(e,t){var n=Math.sqrt(t/ob),r=n*ib;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},sb=Math.sin(__/10)/Math.sin(7*__/10),ub=Math.sin(w_/10)*sb,lb=-Math.cos(w_/10)*sb,cb={draw:function(e,t){var n=Math.sqrt(.8908130915292852*t),r=ub*n,i=lb*n;e.moveTo(0,-n),e.lineTo(r,i);for(var o=1;o<5;++o){var a=w_*o/5,s=Math.cos(a),u=Math.sin(a);e.lineTo(u*n,-s*n),e.lineTo(s*r-u*i,u*r+s*i)}e.closePath()}},fb={draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},db=Math.sqrt(3),hb={draw:function(e,t){var n=-Math.sqrt(t/(3*db));e.moveTo(0,2*n),e.lineTo(-db*n,-n),e.lineTo(db*n,-n),e.closePath()}},pb=Math.sqrt(3)/2,gb=1/Math.sqrt(12),mb=3*(gb/2+1),vb={draw:function(e,t){var n=Math.sqrt(t/mb),r=n/2,i=n*gb,o=r,a=n*gb+n,s=-o,u=a;e.moveTo(r,i),e.lineTo(o,a),e.lineTo(s,u),e.lineTo(-.5*r-pb*i,pb*r+-.5*i),e.lineTo(-.5*o-pb*a,pb*o+-.5*a),e.lineTo(-.5*s-pb*u,pb*s+-.5*u),e.lineTo(-.5*r+pb*i,-.5*i-pb*r),e.lineTo(-.5*o+pb*a,-.5*a-pb*o),e.lineTo(-.5*s+pb*u,-.5*u-pb*s),e.closePath()}},yb=[nb,rb,ab,fb,cb,hb,vb],_b=function(){var e=c_(nb),t=c_(64),n=null;function r(){var r;if(n||(n=r=zo()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(t){return arguments.length?(e="function"==typeof t?t:c_(t),r):e},r.size=function(e){return arguments.length?(t="function"==typeof e?e:c_(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r},bb=function(){};function wb(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function xb(e){this._context=e}xb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:wb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:wb(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Eb=function(e){return new xb(e)};function Mb(e){this._context=e}Mb.prototype={areaStart:bb,areaEnd:bb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:wb(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Cb=function(e){return new Mb(e)};function Tb(e){this._context=e}Tb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:wb(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Sb=function(e){return new Tb(e)};function Ob(e,t){this._basis=new xb(e),this._beta=t}Ob.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],o=t[0],a=e[n]-i,s=t[n]-o,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*e[u]+(1-this._beta)*(i+r*a),this._beta*t[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var kb=function e(t){function n(e){return 1===t?new xb(e):new Ob(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function Ab(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Pb(e,t){this._context=e,this._k=(1-t)/6}Pb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ab(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Ab(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Rb=function e(t){function n(e){return new Pb(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Lb(e,t){this._context=e,this._k=(1-t)/6}Lb.prototype={areaStart:bb,areaEnd:bb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ab(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var jb=function e(t){function n(e){return new Lb(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Db(e,t){this._context=e,this._k=(1-t)/6}Db.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ab(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Nb=function e(t){function n(e){return new Db(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Ib(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>y_){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>y_){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function Fb(e,t){this._context=e,this._alpha=t}Fb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Ib(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Bb=function e(t){function n(e){return t?new Fb(e,t):new Pb(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Ub(e,t){this._context=e,this._alpha=t}Ub.prototype={areaStart:bb,areaEnd:bb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ib(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var zb=function e(t){function n(e){return t?new Ub(e,t):new Lb(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Vb(e,t){this._context=e,this._alpha=t}Vb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ib(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Hb=function e(t){function n(e){return t?new Vb(e,t):new Db(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function qb(e){this._context=e}qb.prototype={areaStart:bb,areaEnd:bb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};var Gb=function(e){return new qb(e)};function Wb(e){return e<0?-1:1}function Xb(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Wb(o)+Wb(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Yb(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function $b(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function Jb(e){this._context=e}function Zb(e){this._context=new Kb(e)}function Kb(e){this._context=e}function Qb(e){return new Jb(e)}function ew(e){return new Zb(e)}function tw(e){this._context=e}function nw(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}Jb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:$b(this,this._t0,Yb(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,$b(this,Yb(this,n=Xb(this,e,t)),n);break;default:$b(this,this._t0,n=Xb(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Zb.prototype=Object.create(Jb.prototype)).point=function(e,t){Jb.prototype.point.call(this,t,e)},Kb.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},tw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=nw(e),i=nw(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var rw=function(e){return new tw(e)};function iw(e,t){this._context=e,this._t=t}iw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var ow=function(e){return new iw(e,.5)};function aw(e){return new iw(e,0)}function sw(e){return new iw(e,1)}var uw=function(e,t){if((i=e.length)>1)for(var n,r,i,o=1,a=e[t[0]],s=a.length;o<i;++o)for(r=a,a=e[t[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},lw=function(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n};function cw(e,t){return e[t]}var fw=function(){var e=c_([]),t=lw,n=uw,r=cw;function i(i){var o,a,s=e.apply(this,arguments),u=i.length,l=s.length,c=new Array(l);for(o=0;o<l;++o){for(var f,d=s[o],h=c[o]=new Array(u),p=0;p<u;++p)h[p]=f=[0,+r(i[p],d,p,i)],f.data=i[p];h.key=d}for(o=0,a=t(c);o<l;++o)c[a[o]].index=o;return n(c,a),c}return i.keys=function(t){return arguments.length?(e="function"==typeof t?t:c_(W_.call(t)),i):e},i.value=function(e){return arguments.length?(r="function"==typeof e?e:c_(+e),i):r},i.order=function(e){return arguments.length?(t=null==e?lw:"function"==typeof e?e:c_(W_.call(e)),i):t},i.offset=function(e){return arguments.length?(n=null==e?uw:e,i):n},i},dw=function(e,t){if((r=e.length)>0){for(var n,r,i,o=0,a=e[0].length;o<a;++o){for(i=n=0;n<r;++n)i+=e[n][o][1]||0;if(i)for(n=0;n<r;++n)e[n][o][1]/=i}uw(e,t)}},hw=function(e,t){if((s=e.length)>1)for(var n,r,i,o,a,s,u=0,l=e[t[0]].length;u<l;++u)for(o=a=0,n=0;n<s;++n)(i=(r=e[t[n]][u])[1]-r[0])>=0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=a,r[0]=a+=i):r[0]=o},pw=function(e,t){if((n=e.length)>0){for(var n,r=0,i=e[t[0]],o=i.length;r<o;++r){for(var a=0,s=0;a<n;++a)s+=e[a][r][1]||0;i[r][1]+=i[r][0]=-s/2}uw(e,t)}},gw=function(e,t){if((i=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,i,o=0,a=1;a<r;++a){for(var s=0,u=0,l=0;s<i;++s){for(var c=e[t[s]],f=c[a][1]||0,d=(f-(c[a-1][1]||0))/2,h=0;h<s;++h){var p=e[t[h]];d+=(p[a][1]||0)-(p[a-1][1]||0)}u+=f,l+=d*f}n[a-1][1]+=n[a-1][0]=o,u&&(o-=l/u)}n[a-1][1]+=n[a-1][0]=o,uw(e,t)}},mw=function(e){var t=e.map(vw);return lw(e).sort(function(e,n){return t[e]-t[n]})};function vw(e){for(var t,n=0,r=-1,i=e.length;++r<i;)(t=+e[r][1])&&(n+=t);return n}var yw=function(e){return mw(e).reverse()},_w=function(e){var t,n,r=e.length,i=e.map(vw),o=lw(e).sort(function(e,t){return i[t]-i[e]}),a=0,s=0,u=[],l=[];for(t=0;t<r;++t)n=o[t],a<s?(a+=i[n],u.push(n)):(s+=i[n],l.push(n));return l.reverse().concat(u)},bw=function(e){return lw(e).reverse()},ww=function(e){return function(){return e}};function xw(e){return e[0]}function Ew(e){return e[1]}function Mw(){this._=null}function Cw(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function Tw(e,t){var n=t,r=t.R,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Sw(e,t){var n=t,r=t.L,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Ow(e){for(;e.L;)e=e.L;return e}Mw.prototype={constructor:Mw,insert:function(e,t){var n,r,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=Ow(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.R&&(Tw(this,n),n=(e=n).U),n.C=!1,r.C=!0,Sw(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.L&&(Sw(this,n),n=(e=n).U),n.C=!1,r.C=!0,Tw(this,r)),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,r,i=e.U,o=e.L,a=e.R;if(n=o?a?Ow(a):o:a,i?i.L===e?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=e.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=e.U,e=n.R,i.L=e,n.R=a,a.U=n):(n.U=i,i=n,e=n.R)):(r=e.C,e=n),e&&(e.U=i),!r)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===i.L){if((t=i.R).C&&(t.C=!1,i.C=!0,Tw(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,Sw(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,Tw(this,i),e=this._;break}}else if((t=i.L).C&&(t.C=!1,i.C=!0,Sw(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,Tw(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,Sw(this,i),e=this._;break}t.C=!0,e=i,i=i.U}while(!e.C);e&&(e.C=!1)}}};var kw=Mw;function Aw(e,t,n,r){var i=[null,null],o=Kw.push(i)-1;return i.left=e,i.right=t,n&&Rw(i,e,t,n),r&&Rw(i,t,e,r),Jw[e.index].halfedges.push(o),Jw[t.index].halfedges.push(o),i}function Pw(e,t,n){var r=[t,n];return r.left=e,r}function Rw(e,t,n,r){e[0]||e[1]?e.left===n?e[1]=r:e[0]=r:(e[0]=r,e.left=t,e.right=n)}function Lw(e,t,n,r,i){var o,a=e[0],s=e[1],u=a[0],l=a[1],c=0,f=1,d=s[0]-u,h=s[1]-l;if(o=t-u,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<f&&(f=o)}else if(d>0){if(o>f)return;o>c&&(c=o)}if(o=r-u,d||!(o<0)){if(o/=d,d<0){if(o>f)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<f&&(f=o)}if(o=n-l,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<f&&(f=o)}else if(h>0){if(o>f)return;o>c&&(c=o)}if(o=i-l,h||!(o<0)){if(o/=h,h<0){if(o>f)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<f&&(f=o)}return!(c>0||f<1)||(c>0&&(e[0]=[u+c*d,l+c*h]),f<1&&(e[1]=[u+f*d,l+f*h]),!0)}}}}}function jw(e,t,n,r,i){var o=e[1];if(o)return!0;var a,s,u=e[0],l=e.left,c=e.right,f=l[0],d=l[1],h=c[0],p=c[1],g=(f+h)/2,m=(d+p)/2;if(p===d){if(g<t||g>=r)return;if(f>h){if(u){if(u[1]>=i)return}else u=[g,n];o=[g,i]}else{if(u){if(u[1]<n)return}else u=[g,i];o=[g,n]}}else if(s=m-(a=(f-h)/(p-d))*g,a<-1||a>1)if(f>h){if(u){if(u[1]>=i)return}else u=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(u){if(u[1]<n)return}else u=[(i-s)/a,i];o=[(n-s)/a,n]}else if(d<p){if(u){if(u[0]>=r)return}else u=[t,a*t+s];o=[r,a*r+s]}else{if(u){if(u[0]<t)return}else u=[r,a*r+s];o=[t,a*t+s]}return e[0]=u,e[1]=o,!0}function Dw(e,t){var n=e.site,r=t.left,i=t.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=t[1],i=t[0]):(r=t[0],i=t[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Nw(e,t){return t[+(t.left!==e.site)]}function Iw(e,t){return t[+(t.left===e.site)]}var Fw,Bw=[];function Uw(e){var t=e.P,n=e.N;if(t&&n){var r=t.site,i=e.site,o=n.site;if(r!==o){var a=i[0],s=i[1],u=r[0]-a,l=r[1]-s,c=o[0]-a,f=o[1]-s,d=2*(u*f-l*c);if(!(d>=-ex)){var h=u*u+l*l,p=c*c+f*f,g=(f*h-l*p)/d,m=(u*p-c*h)/d,v=Bw.pop()||new function(){Cw(this),this.x=this.y=this.arc=this.site=this.cy=null};v.arc=e,v.site=i,v.x=g+a,v.y=(v.cy=m+s)+Math.sqrt(g*g+m*m),e.circle=v;for(var y=null,_=Zw._;_;)if(v.y<_.y||v.y===_.y&&v.x<=_.x){if(!_.L){y=_.P;break}_=_.L}else{if(!_.R){y=_;break}_=_.R}Zw.insert(y,v),y||(Fw=v)}}}}function zw(e){var t=e.circle;t&&(t.P||(Fw=t.N),Zw.remove(t),Bw.push(t),Cw(t),e.circle=null)}var Vw=[];function Hw(e){var t=Vw.pop()||new function(){Cw(this),this.edge=this.site=this.circle=null};return t.site=e,t}function qw(e){zw(e),$w.remove(e),Vw.push(e),Cw(e)}function Gw(e){var t=e.circle,n=t.x,r=t.cy,i=[n,r],o=e.P,a=e.N,s=[e];qw(e);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<Qw&&Math.abs(r-u.circle.cy)<Qw;)o=u.P,s.unshift(u),qw(u),u=o;s.unshift(u),zw(u);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<Qw&&Math.abs(r-l.circle.cy)<Qw;)a=l.N,s.push(l),qw(l),l=a;s.push(l),zw(l);var c,f=s.length;for(c=1;c<f;++c)l=s[c],u=s[c-1],Rw(l.edge,u.site,l.site,i);u=s[0],(l=s[f-1]).edge=Aw(u.site,l.site,null,i),Uw(u),Uw(l)}function Ww(e){for(var t,n,r,i,o=e[0],a=e[1],s=$w._;s;)if((r=Xw(s,a)-o)>Qw)s=s.L;else{if(!((i=o-Yw(s,a))>Qw)){r>-Qw?(t=s.P,n=s):i>-Qw?(t=s,n=s.N):t=n=s;break}if(!s.R){t=s;break}s=s.R}!function(e){Jw[e.index]={site:e,halfedges:[]}}(e);var u=Hw(e);if($w.insert(t,u),t||n){if(t===n)return zw(t),n=Hw(t.site),$w.insert(u,n),u.edge=n.edge=Aw(t.site,u.site),Uw(t),void Uw(n);if(n){zw(t),zw(n);var l=t.site,c=l[0],f=l[1],d=e[0]-c,h=e[1]-f,p=n.site,g=p[0]-c,m=p[1]-f,v=2*(d*m-h*g),y=d*d+h*h,_=g*g+m*m,b=[(m*y-h*_)/v+c,(d*_-g*y)/v+f];Rw(n.edge,l,p,b),u.edge=Aw(l,e,null,b),n.edge=Aw(e,p,null,b),Uw(t),Uw(n)}else u.edge=Aw(t.site,u.site)}}function Xw(e,t){var n=e.site,r=n[0],i=n[1],o=i-t;if(!o)return r;var a=e.P;if(!a)return-1/0;var s=(n=a.site)[0],u=n[1],l=u-t;if(!l)return s;var c=s-r,f=1/o-1/l,d=c/l;return f?(-d+Math.sqrt(d*d-2*f*(c*c/(-2*l)-u+l/2+i-o/2)))/f+r:(r+s)/2}function Yw(e,t){var n=e.N;if(n)return Xw(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var $w,Jw,Zw,Kw,Qw=1e-6,ex=1e-12;function tx(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function nx(e,t){return t[1]-e[1]||t[0]-e[0]}function rx(e,t){var n,r,i,o=e.sort(nx).pop();for(Kw=[],Jw=new Array(e.length),$w=new kw,Zw=new kw;;)if(i=Fw,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(Ww(o),n=o[0],r=o[1]),o=e.pop();else{if(!i)break;Gw(i.arc)}if(function(){for(var e,t,n,r,i=0,o=Jw.length;i<o;++i)if((e=Jw[i])&&(r=(t=e.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=Dw(e,Kw[t[n]]);for(a.sort(function(e,t){return s[t]-s[e]}),n=0;n<r;++n)s[n]=t[a[n]];for(n=0;n<r;++n)t[n]=s[n]}}(),t){var a=+t[0][0],s=+t[0][1],u=+t[1][0],l=+t[1][1];!function(e,t,n,r){for(var i,o=Kw.length;o--;)jw(i=Kw[o],e,t,n,r)&&Lw(i,e,t,n,r)&&(Math.abs(i[0][0]-i[1][0])>Qw||Math.abs(i[0][1]-i[1][1])>Qw)||delete Kw[o]}(a,s,u,l),function(e,t,n,r){var i,o,a,s,u,l,c,f,d,h,p,g,m=Jw.length,v=!0;for(i=0;i<m;++i)if(o=Jw[i]){for(a=o.site,s=(u=o.halfedges).length;s--;)Kw[u[s]]||u.splice(s,1);for(s=0,l=u.length;s<l;)p=(h=Iw(o,Kw[u[s]]))[0],g=h[1],f=(c=Nw(o,Kw[u[++s%l]]))[0],d=c[1],(Math.abs(p-f)>Qw||Math.abs(g-d)>Qw)&&(u.splice(s,0,Kw.push(Pw(a,h,Math.abs(p-e)<Qw&&r-g>Qw?[e,Math.abs(f-e)<Qw?d:r]:Math.abs(g-r)<Qw&&n-p>Qw?[Math.abs(d-r)<Qw?f:n,r]:Math.abs(p-n)<Qw&&g-t>Qw?[n,Math.abs(f-n)<Qw?d:t]:Math.abs(g-t)<Qw&&p-e>Qw?[Math.abs(d-t)<Qw?f:e,t]:null))-1),++l);l&&(v=!1)}if(v){var y,_,b,w=1/0;for(i=0,v=null;i<m;++i)(o=Jw[i])&&(b=(y=(a=o.site)[0]-e)*y+(_=a[1]-t)*_)<w&&(w=b,v=o);if(v){var x=[e,t],E=[e,r],M=[n,r],C=[n,t];v.halfedges.push(Kw.push(Pw(a=v.site,x,E))-1,Kw.push(Pw(a,E,M))-1,Kw.push(Pw(a,M,C))-1,Kw.push(Pw(a,C,x))-1)}}for(i=0;i<m;++i)(o=Jw[i])&&(o.halfedges.length||delete Jw[i])}(a,s,u,l)}this.edges=Kw,this.cells=Jw,$w=Zw=Kw=Jw=null}rx.prototype={constructor:rx,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(n){return Nw(t,e[n])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s=n.site,u=-1,l=t[i[o-1]],c=l.left===s?l.right:l.left;++u<o;)a=c,c=(l=t[i[u]]).left===s?l.right:l.left,a&&c&&r<a.index&&r<c.index&&tx(s,a,c)<0&&e.push([s.data,a.data,c.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var u=e-i.site[0],l=t-i.site[1],c=u*u+l*l;do{i=o.cells[r=a],a=null,i.halfedges.forEach(function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var u=e-s[0],l=t-s[1],f=u*u+l*l;f<c&&(c=f,a=s.index)}})}while(null!==a);return o._found=r,null==n||c<=n*n?i.site:null}};var ix=function(){var e=xw,t=Ew,n=null;function r(r){return new rx(r.map(function(n,i){var o=[Math.round(e(n,i,r)/Qw)*Qw,Math.round(t(n,i,r)/Qw)*Qw];return o.index=i,o.data=n,o}),n)}return r.polygons=function(e){return r(e).polygons()},r.links=function(e){return r(e).links()},r.triangles=function(e){return r(e).triangles()},r.x=function(t){return arguments.length?(e="function"==typeof t?t:ww(+t),r):e},r.y=function(e){return arguments.length?(t="function"==typeof e?e:ww(+e),r):t},r.extent=function(e){return arguments.length?(n=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(e){return arguments.length?(n=null==e?null:[[0,0],[+e[0],+e[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r},ox=function(e){return function(){return e}};function ax(e,t,n){this.k=e,this.x=t,this.y=n}ax.prototype={constructor:ax,scale:function(e){return 1===e?this:new ax(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new ax(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var sx=new ax(1,0,0);function ux(e){return e.__zoom||sx}function lx(){Xe.stopImmediatePropagation()}ux.prototype=ax.prototype;var cx=function(){Xe.preventDefault(),Xe.stopImmediatePropagation()};function fx(){return!Xe.button}function dx(){var e,t,n=this;return n instanceof SVGElement?(e=(n=n.ownerSVGElement||n).width.baseVal.value,t=n.height.baseVal.value):(e=n.clientWidth,t=n.clientHeight),[[0,0],[e,t]]}function hx(){return this.__zoom||sx}function px(){return-Xe.deltaY*(Xe.deltaMode?120:1)/500}function gx(){return"ontouchstart"in this}function mx(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}var vx=function(){var e,t,n=fx,r=dx,i=mx,o=px,a=gx,s=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],l=250,c=sr,f=[],d=de("start","zoom","end"),h=500,p=150,g=0;function m(e){e.property("__zoom",hx).on("wheel.zoom",E).on("mousedown.zoom",M).on("dblclick.zoom",C).filter(a).on("touchstart.zoom",T).on("touchmove.zoom",S).on("touchend.zoom touchcancel.zoom",O).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(e,t){return(t=Math.max(s[0],Math.min(s[1],t)))===e.k?e:new ax(t,e.x,e.y)}function y(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new ax(e.k,r,i)}function _(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function b(e,t,n){e.on("start.zoom",function(){w(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).end()}).tween("zoom",function(){var e=arguments,i=w(this,e),o=r.apply(this,e),a=n||_(o),s=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),u=this.__zoom,l="function"==typeof t?t.apply(this,e):t,f=c(u.invert(a).concat(s/u.k),l.invert(a).concat(s/l.k));return function(e){if(1===e)e=l;else{var t=f(e),n=s/t[2];e=new ax(n,a[0]-t[0]*n,a[1]-t[1]*n)}i.zoom(null,e)}})}function w(e,t){for(var n,r=0,i=f.length;r<i;++r)if((n=f[r]).that===e)return n;return new x(e,t)}function x(e,t){this.that=e,this.args=t,this.index=-1,this.active=0,this.extent=r.apply(e,t)}function E(){if(n.apply(this,arguments)){var e=w(this,arguments),t=this.__zoom,r=Math.max(s[0],Math.min(s[1],t.k*Math.pow(2,o.apply(this,arguments)))),a=ft(this);if(e.wheel)e.mouse[0][0]===a[0]&&e.mouse[0][1]===a[1]||(e.mouse[1]=t.invert(e.mouse[0]=a)),clearTimeout(e.wheel);else{if(t.k===r)return;e.mouse=[a,t.invert(a)],ei(this),e.start()}cx(),e.wheel=setTimeout(function(){e.wheel=null,e.end()},p),e.zoom("mouse",i(y(v(t,r),e.mouse[0],e.mouse[1]),e.extent,u))}}function M(){if(!t&&n.apply(this,arguments)){var e=w(this,arguments),r=it(Xe.view).on("mousemove.zoom",function(){if(cx(),!e.moved){var t=Xe.clientX-a,n=Xe.clientY-s;e.moved=t*t+n*n>g}e.zoom("mouse",i(y(e.that.__zoom,e.mouse[0]=ft(e.that),e.mouse[1]),e.extent,u))},!0).on("mouseup.zoom",function(){r.on("mousemove.zoom mouseup.zoom",null),yt(Xe.view,e.moved),cx(),e.end()},!0),o=ft(this),a=Xe.clientX,s=Xe.clientY;vt(Xe.view),lx(),e.mouse=[o,this.__zoom.invert(o)],ei(this),e.start()}}function C(){if(n.apply(this,arguments)){var e=this.__zoom,t=ft(this),o=e.invert(t),a=e.k*(Xe.shiftKey?.5:2),s=i(y(v(e,a),t,o),r.apply(this,arguments),u);cx(),l>0?it(this).transition().duration(l).call(b,s,t):it(this).call(m.transform,s)}}function T(){if(n.apply(this,arguments)){var t,r,i,o,a=w(this,arguments),s=Xe.changedTouches,u=s.length;for(lx(),r=0;r<u;++r)i=s[r],o=[o=ht(this,s,i.identifier),this.__zoom.invert(o),i.identifier],a.touch0?a.touch1||(a.touch1=o):(a.touch0=o,t=!0);if(e&&(e=clearTimeout(e),!a.touch1))return a.end(),void((o=it(this).on("dblclick.zoom"))&&o.apply(this,arguments));t&&(e=setTimeout(function(){e=null},h),ei(this),a.start())}}function S(){var t,n,r,o,a=w(this,arguments),s=Xe.changedTouches,l=s.length;for(cx(),e&&(e=clearTimeout(e)),t=0;t<l;++t)n=s[t],r=ht(this,s,n.identifier),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=r);if(n=a.that.__zoom,a.touch1){var c=a.touch0[0],f=a.touch0[1],d=a.touch1[0],h=a.touch1[1],p=(p=d[0]-c[0])*p+(p=d[1]-c[1])*p,g=(g=h[0]-f[0])*g+(g=h[1]-f[1])*g;n=v(n,Math.sqrt(p/g)),r=[(c[0]+d[0])/2,(c[1]+d[1])/2],o=[(f[0]+h[0])/2,(f[1]+h[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],o=a.touch0[1]}a.zoom("touch",i(y(n,r,o),a.extent,u))}function O(){var e,n,r=w(this,arguments),i=Xe.changedTouches,o=i.length;for(lx(),t&&clearTimeout(t),t=setTimeout(function(){t=null},h),e=0;e<o;++e)n=i[e],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0?r.touch0[1]=this.__zoom.invert(r.touch0[0]):r.end()}return m.transform=function(e,t){var n=e.selection?e.selection():e;n.property("__zoom",hx),e!==n?b(e,t):n.interrupt().each(function(){w(this,arguments).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},m.scaleBy=function(e,t){m.scaleTo(e,function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)})},m.scaleTo=function(e,t){m.transform(e,function(){var e=r.apply(this,arguments),n=this.__zoom,o=_(e),a=n.invert(o),s="function"==typeof t?t.apply(this,arguments):t;return i(y(v(n,s),o,a),e,u)})},m.translateBy=function(e,t,n){m.transform(e,function(){return i(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),u)})},m.translateTo=function(e,t,n){m.transform(e,function(){var e=r.apply(this,arguments),o=this.__zoom,a=_(e);return i(sx.translate(a[0],a[1]).scale(o.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,u)})},x.prototype={start:function(){return 1==++this.active&&(this.index=f.push(this)-1,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(f.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(e){Ke(new function(e,t,n){this.target=e,this.type=t,this.transform=n}(m,e,this.that.__zoom),d.apply,d,[e,this.that,this.args])}},m.wheelDelta=function(e){return arguments.length?(o="function"==typeof e?e:ox(+e),m):o},m.filter=function(e){return arguments.length?(n="function"==typeof e?e:ox(!!e),m):n},m.touchable=function(e){return arguments.length?(a="function"==typeof e?e:ox(!!e),m):a},m.extent=function(e){return arguments.length?(r="function"==typeof e?e:ox([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),m):r},m.scaleExtent=function(e){return arguments.length?(s[0]=+e[0],s[1]=+e[1],m):[s[0],s[1]]},m.translateExtent=function(e){return arguments.length?(u[0][0]=+e[0][0],u[1][0]=+e[1][0],u[0][1]=+e[0][1],u[1][1]=+e[1][1],m):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},m.constrain=function(e){return arguments.length?(i=e,m):i},m.duration=function(e){return arguments.length?(l=+e,m):l},m.interpolate=function(e){return arguments.length?(c=e,m):c},m.on=function(){var e=d.on.apply(d,arguments);return e===d?m:e},m.clickDistance=function(e){return arguments.length?(g=(e=+e)*e,m):Math.sqrt(g)},m};n.d(t,"version",function(){return"5.5.0"}),n.d(t,"bisect",function(){return u}),n.d(t,"bisectRight",function(){return a}),n.d(t,"bisectLeft",function(){return s}),n.d(t,"ascending",function(){return r}),n.d(t,"bisector",function(){return i}),n.d(t,"cross",function(){return f}),n.d(t,"descending",function(){return d}),n.d(t,"deviation",function(){return g}),n.d(t,"extent",function(){return m}),n.d(t,"histogram",function(){return A}),n.d(t,"thresholdFreedmanDiaconis",function(){return R}),n.d(t,"thresholdScott",function(){return L}),n.d(t,"thresholdSturges",function(){return k}),n.d(t,"max",function(){return j}),n.d(t,"mean",function(){return D}),n.d(t,"median",function(){return N}),n.d(t,"merge",function(){return I}),n.d(t,"min",function(){return F}),n.d(t,"pairs",function(){return l}),n.d(t,"permute",function(){return B}),n.d(t,"quantile",function(){return P}),n.d(t,"range",function(){return x}),n.d(t,"scan",function(){return U}),n.d(t,"shuffle",function(){return z}),n.d(t,"sum",function(){return V}),n.d(t,"ticks",function(){return T}),n.d(t,"tickIncrement",function(){return S}),n.d(t,"tickStep",function(){return O}),n.d(t,"transpose",function(){return H}),n.d(t,"variance",function(){return p}),n.d(t,"zip",function(){return G}),n.d(t,"axisTop",function(){return re}),n.d(t,"axisRight",function(){return ie}),n.d(t,"axisBottom",function(){return oe}),n.d(t,"axisLeft",function(){return ae}),n.d(t,"brush",function(){return Co}),n.d(t,"brushX",function(){return Eo}),n.d(t,"brushY",function(){return Mo}),n.d(t,"brushSelection",function(){return xo}),n.d(t,"chord",function(){return Lo}),n.d(t,"ribbon",function(){return Xo}),n.d(t,"nest",function(){return Zo}),n.d(t,"set",function(){return oa}),n.d(t,"map",function(){return Jo}),n.d(t,"keys",function(){return aa}),n.d(t,"values",function(){return sa}),n.d(t,"entries",function(){return ua}),n.d(t,"color",function(){return zt}),n.d(t,"rgb",function(){return Gt}),n.d(t,"hsl",function(){return $t}),n.d(t,"lab",function(){return cn}),n.d(t,"hcl",function(){return yn}),n.d(t,"lch",function(){return vn}),n.d(t,"gray",function(){return ln}),n.d(t,"cubehelix",function(){return Tn}),n.d(t,"contours",function(){return ya}),n.d(t,"contourDensity",function(){return Ma}),n.d(t,"dispatch",function(){return de}),n.d(t,"drag",function(){return Ct}),n.d(t,"dragDisable",function(){return vt}),n.d(t,"dragEnable",function(){return yt}),n.d(t,"dsvFormat",function(){return Pa}),n.d(t,"csvParse",function(){return La}),n.d(t,"csvParseRows",function(){return ja}),n.d(t,"csvFormat",function(){return Da}),n.d(t,"csvFormatRows",function(){return Na}),n.d(t,"tsvParse",function(){return Fa}),n.d(t,"tsvParseRows",function(){return Ba}),n.d(t,"tsvFormat",function(){return Ua}),n.d(t,"tsvFormatRows",function(){return za}),n.d(t,"easeLinear",function(){return li}),n.d(t,"easeQuad",function(){return di}),n.d(t,"easeQuadIn",function(){return ci}),n.d(t,"easeQuadOut",function(){return fi}),n.d(t,"easeQuadInOut",function(){return di}),n.d(t,"easeCubic",function(){return gi}),n.d(t,"easeCubicIn",function(){return hi}),n.d(t,"easeCubicOut",function(){return pi}),n.d(t,"easeCubicInOut",function(){return gi}),n.d(t,"easePoly",function(){return yi}),n.d(t,"easePolyIn",function(){return mi}),n.d(t,"easePolyOut",function(){return vi}),n.d(t,"easePolyInOut",function(){return yi}),n.d(t,"easeSin",function(){return Ei}),n.d(t,"easeSinIn",function(){return wi}),n.d(t,"easeSinOut",function(){return xi}),n.d(t,"easeSinInOut",function(){return Ei}),n.d(t,"easeExp",function(){return Ti}),n.d(t,"easeExpIn",function(){return Mi}),n.d(t,"easeExpOut",function(){return Ci}),n.d(t,"easeExpInOut",function(){return Ti}),n.d(t,"easeCircle",function(){return ki}),n.d(t,"easeCircleIn",function(){return Si}),n.d(t,"easeCircleOut",function(){return Oi}),n.d(t,"easeCircleInOut",function(){return ki}),n.d(t,"easeBounce",function(){return zi}),n.d(t,"easeBounceIn",function(){return Ui}),n.d(t,"easeBounceOut",function(){return zi}),n.d(t,"easeBounceInOut",function(){return Vi}),n.d(t,"easeBack",function(){return Gi}),n.d(t,"easeBackIn",function(){return Hi}),n.d(t,"easeBackOut",function(){return qi}),n.d(t,"easeBackInOut",function(){return Gi}),n.d(t,"easeElastic",function(){return Yi}),n.d(t,"easeElasticIn",function(){return Xi}),n.d(t,"easeElasticOut",function(){return Yi}),n.d(t,"easeElasticInOut",function(){return $i}),n.d(t,"blob",function(){return Ha}),n.d(t,"buffer",function(){return Ga}),n.d(t,"dsv",function(){return $a}),n.d(t,"csv",function(){return Ja}),n.d(t,"tsv",function(){return Za}),n.d(t,"image",function(){return Ka}),n.d(t,"json",function(){return es}),n.d(t,"text",function(){return Xa}),n.d(t,"xml",function(){return ns}),n.d(t,"html",function(){return rs}),n.d(t,"svg",function(){return is}),n.d(t,"forceCenter",function(){return os}),n.d(t,"forceCollide",function(){return ys}),n.d(t,"forceLink",function(){return ws}),n.d(t,"forceManyBody",function(){return Ss}),n.d(t,"forceRadial",function(){return Os}),n.d(t,"forceSimulation",function(){return Ts}),n.d(t,"forceX",function(){return ks}),n.d(t,"forceY",function(){return As}),n.d(t,"formatDefaultLocale",function(){return Ws}),n.d(t,"format",function(){return Fs}),n.d(t,"formatPrefix",function(){return Bs}),n.d(t,"formatLocale",function(){return Gs}),n.d(t,"formatSpecifier",function(){return js}),n.d(t,"precisionFixed",function(){return Xs}),n.d(t,"precisionPrefix",function(){return Ys}),n.d(t,"precisionRound",function(){return $s}),n.d(t,"geoArea",function(){return zu}),n.d(t,"geoBounds",function(){return Ll}),n.d(t,"geoCentroid",function(){return Gl}),n.d(t,"geoCircle",function(){return nc}),n.d(t,"geoClipAntimeridian",function(){return hc}),n.d(t,"geoClipCircle",function(){return pc}),n.d(t,"geoClipExtent",function(){return xc}),n.d(t,"geoClipRectangle",function(){return yc}),n.d(t,"geoContains",function(){return Uc}),n.d(t,"geoDistance",function(){return Pc}),n.d(t,"geoGraticule",function(){return Hc}),n.d(t,"geoGraticule10",function(){return qc}),n.d(t,"geoInterpolate",function(){return $c}),n.d(t,"geoLength",function(){return Oc}),n.d(t,"geoPath",function(){return Yf}),n.d(t,"geoAlbers",function(){return hd}),n.d(t,"geoAlbersUsa",function(){return pd}),n.d(t,"geoAzimuthalEqualArea",function(){return yd}),n.d(t,"geoAzimuthalEqualAreaRaw",function(){return vd}),n.d(t,"geoAzimuthalEquidistant",function(){return bd}),n.d(t,"geoAzimuthalEquidistantRaw",function(){return _d}),n.d(t,"geoConicConformal",function(){return Td}),n.d(t,"geoConicConformalRaw",function(){return Cd}),n.d(t,"geoConicEqualArea",function(){return dd}),n.d(t,"geoConicEqualAreaRaw",function(){return fd}),n.d(t,"geoConicEquidistant",function(){return Ad}),n.d(t,"geoConicEquidistantRaw",function(){return kd}),n.d(t,"geoEquirectangular",function(){return Od}),n.d(t,"geoEquirectangularRaw",function(){return Sd}),n.d(t,"geoGnomonic",function(){return Rd}),n.d(t,"geoGnomonicRaw",function(){return Pd}),n.d(t,"geoIdentity",function(){return jd}),n.d(t,"geoProjection",function(){return ud}),n.d(t,"geoProjectionMutator",function(){return ld}),n.d(t,"geoMercator",function(){return xd}),n.d(t,"geoMercatorRaw",function(){return wd}),n.d(t,"geoNaturalEarth1",function(){return Nd}),n.d(t,"geoNaturalEarth1Raw",function(){return Dd}),n.d(t,"geoOrthographic",function(){return Fd}),n.d(t,"geoOrthographicRaw",function(){return Id}),n.d(t,"geoStereographic",function(){return Ud}),n.d(t,"geoStereographicRaw",function(){return Bd}),n.d(t,"geoTransverseMercator",function(){return Vd}),n.d(t,"geoTransverseMercatorRaw",function(){return zd}),n.d(t,"geoRotation",function(){return Ql}),n.d(t,"geoStream",function(){return Lu}),n.d(t,"geoTransform",function(){return $f}),n.d(t,"cluster",function(){return Wd}),n.d(t,"hierarchy",function(){return Yd}),n.d(t,"pack",function(){return yh}),n.d(t,"packSiblings",function(){return hh}),n.d(t,"packEnclose",function(){return eh}),n.d(t,"partition",function(){return Mh}),n.d(t,"stratify",function(){return Ah}),n.d(t,"tree",function(){return Ih}),n.d(t,"treemap",function(){return Vh}),n.d(t,"treemapBinary",function(){return Hh}),n.d(t,"treemapDice",function(){return Eh}),n.d(t,"treemapSlice",function(){return Fh}),n.d(t,"treemapSliceDice",function(){return qh}),n.d(t,"treemapSquarify",function(){return zh}),n.d(t,"treemapResquarify",function(){return Gh}),n.d(t,"interpolate",function(){return Zn}),n.d(t,"interpolateArray",function(){return Un}),n.d(t,"interpolateBasis",function(){return kn}),n.d(t,"interpolateBasisClosed",function(){return An}),n.d(t,"interpolateDate",function(){return zn}),n.d(t,"interpolateNumber",function(){return Vn}),n.d(t,"interpolateObject",function(){return Hn}),n.d(t,"interpolateRound",function(){return Kn}),n.d(t,"interpolateString",function(){return Jn}),n.d(t,"interpolateTransformCss",function(){return rr}),n.d(t,"interpolateTransformSvg",function(){return ir}),n.d(t,"interpolateZoom",function(){return sr}),n.d(t,"interpolateRgb",function(){return Nn}),n.d(t,"interpolateRgbBasis",function(){return Fn}),n.d(t,"interpolateRgbBasisClosed",function(){return Bn}),n.d(t,"interpolateHsl",function(){return lr}),n.d(t,"interpolateHslLong",function(){return cr}),n.d(t,"interpolateLab",function(){return fr}),n.d(t,"interpolateHcl",function(){return hr}),n.d(t,"interpolateHclLong",function(){return pr}),n.d(t,"interpolateCubehelix",function(){return mr}),n.d(t,"interpolateCubehelixLong",function(){return vr}),n.d(t,"piecewise",function(){return yr}),n.d(t,"quantize",function(){return wr}),n.d(t,"path",function(){return zo}),n.d(t,"polygonArea",function(){return Wh}),n.d(t,"polygonCentroid",function(){return Xh}),n.d(t,"polygonHull",function(){return Zh}),n.d(t,"polygonContains",function(){return Kh}),n.d(t,"polygonLength",function(){return Qh}),n.d(t,"quadtree",function(){return ds}),n.d(t,"randomUniform",function(){return tp}),n.d(t,"randomNormal",function(){return np}),n.d(t,"randomLogNormal",function(){return rp}),n.d(t,"randomBates",function(){return op}),n.d(t,"randomIrwinHall",function(){return ip}),n.d(t,"randomExponential",function(){return ap}),n.d(t,"scaleBand",function(){return dp}),n.d(t,"scalePoint",function(){return hp}),n.d(t,"scaleIdentity",function(){return Cp}),n.d(t,"scaleLinear",function(){return Mp}),n.d(t,"scaleLog",function(){return Lp}),n.d(t,"scaleOrdinal",function(){return fp}),n.d(t,"scaleImplicit",function(){return cp}),n.d(t,"scalePow",function(){return Dp}),n.d(t,"scaleSqrt",function(){return Np}),n.d(t,"scaleQuantile",function(){return Ip}),n.d(t,"scaleQuantize",function(){return Fp}),n.d(t,"scaleThreshold",function(){return Bp}),n.d(t,"scaleTime",function(){return Dv}),n.d(t,"scaleUtc",function(){return Nv}),n.d(t,"scaleSequential",function(){return Iv}),n.d(t,"scaleDiverging",function(){return Fv}),n.d(t,"schemeCategory10",function(){return Uv}),n.d(t,"schemeAccent",function(){return zv}),n.d(t,"schemeDark2",function(){return Vv}),n.d(t,"schemePaired",function(){return Hv}),n.d(t,"schemePastel1",function(){return qv}),n.d(t,"schemePastel2",function(){return Gv}),n.d(t,"schemeSet1",function(){return Wv}),n.d(t,"schemeSet2",function(){return Xv}),n.d(t,"schemeSet3",function(){return Yv}),n.d(t,"interpolateBrBG",function(){return Zv}),n.d(t,"schemeBrBG",function(){return Jv}),n.d(t,"interpolatePRGn",function(){return Qv}),n.d(t,"schemePRGn",function(){return Kv}),n.d(t,"interpolatePiYG",function(){return ty}),n.d(t,"schemePiYG",function(){return ey}),n.d(t,"interpolatePuOr",function(){return ry}),n.d(t,"schemePuOr",function(){return ny}),n.d(t,"interpolateRdBu",function(){return oy}),n.d(t,"schemeRdBu",function(){return iy}),n.d(t,"interpolateRdGy",function(){return sy}),n.d(t,"schemeRdGy",function(){return ay}),n.d(t,"interpolateRdYlBu",function(){return ly}),n.d(t,"schemeRdYlBu",function(){return uy}),n.d(t,"interpolateRdYlGn",function(){return fy}),n.d(t,"schemeRdYlGn",function(){return cy}),n.d(t,"interpolateSpectral",function(){return hy}),n.d(t,"schemeSpectral",function(){return dy}),n.d(t,"interpolateBuGn",function(){return gy}),n.d(t,"schemeBuGn",function(){return py}),n.d(t,"interpolateBuPu",function(){return vy}),n.d(t,"schemeBuPu",function(){return my}),n.d(t,"interpolateGnBu",function(){return _y}),n.d(t,"schemeGnBu",function(){return yy}),n.d(t,"interpolateOrRd",function(){return wy}),n.d(t,"schemeOrRd",function(){return by}),n.d(t,"interpolatePuBuGn",function(){return Ey}),n.d(t,"schemePuBuGn",function(){return xy}),n.d(t,"interpolatePuBu",function(){return Cy}),n.d(t,"schemePuBu",function(){return My}),n.d(t,"interpolatePuRd",function(){return Sy}),n.d(t,"schemePuRd",function(){return Ty}),n.d(t,"interpolateRdPu",function(){return ky}),n.d(t,"schemeRdPu",function(){return Oy}),n.d(t,"interpolateYlGnBu",function(){return Py}),n.d(t,"schemeYlGnBu",function(){return Ay}),n.d(t,"interpolateYlGn",function(){return Ly}),n.d(t,"schemeYlGn",function(){return Ry}),n.d(t,"interpolateYlOrBr",function(){return Dy}),n.d(t,"schemeYlOrBr",function(){return jy}),n.d(t,"interpolateYlOrRd",function(){return Iy}),n.d(t,"schemeYlOrRd",function(){return Ny}),n.d(t,"interpolateBlues",function(){return By}),n.d(t,"schemeBlues",function(){return Fy}),n.d(t,"interpolateGreens",function(){return zy}),n.d(t,"schemeGreens",function(){return Uy}),n.d(t,"interpolateGreys",function(){return Hy}),n.d(t,"schemeGreys",function(){return Vy}),n.d(t,"interpolatePurples",function(){return Gy}),n.d(t,"schemePurples",function(){return qy}),n.d(t,"interpolateReds",function(){return Xy}),n.d(t,"schemeReds",function(){return Wy}),n.d(t,"interpolateOranges",function(){return $y}),n.d(t,"schemeOranges",function(){return Yy}),n.d(t,"interpolateCubehelixDefault",function(){return Jy}),n.d(t,"interpolateRainbow",function(){return e_}),n.d(t,"interpolateWarm",function(){return Zy}),n.d(t,"interpolateCool",function(){return Ky}),n.d(t,"interpolateSinebow",function(){return i_}),n.d(t,"interpolateViridis",function(){return a_}),n.d(t,"interpolateMagma",function(){return s_}),n.d(t,"interpolateInferno",function(){return u_}),n.d(t,"interpolatePlasma",function(){return l_}),n.d(t,"create",function(){return ot}),n.d(t,"creator",function(){return me}),n.d(t,"local",function(){return st}),n.d(t,"matcher",function(){return Me}),n.d(t,"mouse",function(){return ft}),n.d(t,"namespace",function(){return ge}),n.d(t,"namespaces",function(){return pe}),n.d(t,"clientPoint",function(){return ct}),n.d(t,"select",function(){return it}),n.d(t,"selectAll",function(){return dt}),n.d(t,"selection",function(){return rt}),n.d(t,"selector",function(){return ye}),n.d(t,"selectorAll",function(){return be}),n.d(t,"style",function(){return Re}),n.d(t,"touch",function(){return ht}),n.d(t,"touches",function(){return pt}),n.d(t,"window",function(){return Pe}),n.d(t,"event",function(){return Xe}),n.d(t,"customEvent",function(){return Ke}),n.d(t,"arc",function(){return k_}),n.d(t,"area",function(){return D_}),n.d(t,"line",function(){return j_}),n.d(t,"pie",function(){return F_}),n.d(t,"areaRadial",function(){return q_}),n.d(t,"radialArea",function(){return q_}),n.d(t,"lineRadial",function(){return H_}),n.d(t,"radialLine",function(){return H_}),n.d(t,"pointRadial",function(){return G_}),n.d(t,"linkHorizontal",function(){return Q_}),n.d(t,"linkVertical",function(){return eb}),n.d(t,"linkRadial",function(){return tb}),n.d(t,"symbol",function(){return _b}),n.d(t,"symbols",function(){return yb}),n.d(t,"symbolCircle",function(){return nb}),n.d(t,"symbolCross",function(){return rb}),n.d(t,"symbolDiamond",function(){return ab}),n.d(t,"symbolSquare",function(){return fb}),n.d(t,"symbolStar",function(){return cb}),n.d(t,"symbolTriangle",function(){return hb}),n.d(t,"symbolWye",function(){return vb}),n.d(t,"curveBasisClosed",function(){return Cb}),n.d(t,"curveBasisOpen",function(){return Sb}),n.d(t,"curveBasis",function(){return Eb}),n.d(t,"curveBundle",function(){return kb}),n.d(t,"curveCardinalClosed",function(){return jb}),n.d(t,"curveCardinalOpen",function(){return Nb}),n.d(t,"curveCardinal",function(){return Rb}),n.d(t,"curveCatmullRomClosed",function(){return zb}),n.d(t,"curveCatmullRomOpen",function(){return Hb}),n.d(t,"curveCatmullRom",function(){return Bb}),n.d(t,"curveLinearClosed",function(){return Gb}),n.d(t,"curveLinear",function(){return P_}),n.d(t,"curveMonotoneX",function(){return Qb}),n.d(t,"curveMonotoneY",function(){return ew}),n.d(t,"curveNatural",function(){return rw}),n.d(t,"curveStep",function(){return ow}),n.d(t,"curveStepAfter",function(){return sw}),n.d(t,"curveStepBefore",function(){return aw}),n.d(t,"stack",function(){return fw}),n.d(t,"stackOffsetExpand",function(){return dw}),n.d(t,"stackOffsetDiverging",function(){return hw}),n.d(t,"stackOffsetNone",function(){return uw}),n.d(t,"stackOffsetSilhouette",function(){return pw}),n.d(t,"stackOffsetWiggle",function(){return gw}),n.d(t,"stackOrderAscending",function(){return mw}),n.d(t,"stackOrderDescending",function(){return yw}),n.d(t,"stackOrderInsideOut",function(){return _w}),n.d(t,"stackOrderNone",function(){return lw}),n.d(t,"stackOrderReverse",function(){return bw}),n.d(t,"timeInterval",function(){return Vp}),n.d(t,"timeMillisecond",function(){return qp}),n.d(t,"timeMilliseconds",function(){return Gp}),n.d(t,"utcMillisecond",function(){return qp}),n.d(t,"utcMilliseconds",function(){return Gp}),n.d(t,"timeSecond",function(){return $p}),n.d(t,"timeSeconds",function(){return Jp}),n.d(t,"utcSecond",function(){return $p}),n.d(t,"utcSeconds",function(){return Jp}),n.d(t,"timeMinute",function(){return Kp}),n.d(t,"timeMinutes",function(){return Qp}),n.d(t,"timeHour",function(){return tg}),n.d(t,"timeHours",function(){return ng}),n.d(t,"timeDay",function(){return ig}),n.d(t,"timeDays",function(){return og}),n.d(t,"timeWeek",function(){return sg}),n.d(t,"timeWeeks",function(){return pg}),n.d(t,"timeSunday",function(){return sg}),n.d(t,"timeSundays",function(){return pg}),n.d(t,"timeMonday",function(){return ug}),n.d(t,"timeMondays",function(){return gg}),n.d(t,"timeTuesday",function(){return lg}),n.d(t,"timeTuesdays",function(){return mg}),n.d(t,"timeWednesday",function(){return cg}),n.d(t,"timeWednesdays",function(){return vg}),n.d(t,"timeThursday",function(){return fg}),n.d(t,"timeThursdays",function(){return yg}),n.d(t,"timeFriday",function(){return dg}),n.d(t,"timeFridays",function(){return _g}),n.d(t,"timeSaturday",function(){return hg}),n.d(t,"timeSaturdays",function(){return bg}),n.d(t,"timeMonth",function(){return xg}),n.d(t,"timeMonths",function(){return Eg}),n.d(t,"timeYear",function(){return Cg}),n.d(t,"timeYears",function(){return Tg}),n.d(t,"utcMinute",function(){return Og}),n.d(t,"utcMinutes",function(){return kg}),n.d(t,"utcHour",function(){return Pg}),n.d(t,"utcHours",function(){return Rg}),n.d(t,"utcDay",function(){return jg}),n.d(t,"utcDays",function(){return Dg}),n.d(t,"utcWeek",function(){return Ig}),n.d(t,"utcWeeks",function(){return qg}),n.d(t,"utcSunday",function(){return Ig}),n.d(t,"utcSundays",function(){return qg}),n.d(t,"utcMonday",function(){return Fg}),n.d(t,"utcMondays",function(){return Gg}),n.d(t,"utcTuesday",function(){return Bg}),n.d(t,"utcTuesdays",function(){return Wg}),n.d(t,"utcWednesday",function(){return Ug}),n.d(t,"utcWednesdays",function(){return Xg}),n.d(t,"utcThursday",function(){return zg}),n.d(t,"utcThursdays",function(){return Yg}),n.d(t,"utcFriday",function(){return Vg}),n.d(t,"utcFridays",function(){return $g}),n.d(t,"utcSaturday",function(){return Hg}),n.d(t,"utcSaturdays",function(){return Jg}),n.d(t,"utcMonth",function(){return Kg}),n.d(t,"utcMonths",function(){return Qg}),n.d(t,"utcYear",function(){return tm}),n.d(t,"utcYears",function(){return nm}),n.d(t,"timeFormatDefaultLocale",function(){return xv}),n.d(t,"timeFormat",function(){return um}),n.d(t,"timeParse",function(){return lm}),n.d(t,"utcFormat",function(){return cm}),n.d(t,"utcParse",function(){return fm}),n.d(t,"timeFormatLocale",function(){return am}),n.d(t,"isoFormat",function(){return Ev}),n.d(t,"isoParse",function(){return Mv}),n.d(t,"now",function(){return Pr}),n.d(t,"timer",function(){return jr}),n.d(t,"timerFlush",function(){return Dr}),n.d(t,"timeout",function(){return Br}),n.d(t,"interval",function(){return Ur}),n.d(t,"transition",function(){return ai}),n.d(t,"active",function(){return Qi}),n.d(t,"interrupt",function(){return ei}),n.d(t,"voronoi",function(){return ix}),n.d(t,"zoom",function(){return vx}),n.d(t,"zoomTransform",function(){return ux}),n.d(t,"zoomIdentity",function(){return sx})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},o=u(n(7)),a=u(n(168)),s=u(n(169));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||a.default,e.viewClass=e.viewClass||s.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._onFieldChanged=n._onFieldChanged.bind(n),n._onSubmitRequest=n._onSubmitRequest.bind(n),n._model.addEventListener("Form.FieldChanged",n._onFieldChanged),n._view.addEventListener("Form.SubmitRequest",n._onSubmitRequest),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"validate",value:function(){return this._model.validate()}},{key:"export",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var i,o=this._model.getFields()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;e[a.id()]=a.value()}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e}},{key:"import",value:function(e){var t=this;return this.clear().then(function(){var n=!0,r=!1,i=void 0;try{for(var o,a=t._model.getFields()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;void 0!==e[s.id()]&&s.setValue(e[s.id()])}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}})}},{key:"getField",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this._model.getFields()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.id()==e)return a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return null}},{key:"addField",value:function(e,t){this._model.addField(e,t)}},{key:"removeField",value:function(e){this._model.removeField(e)}},{key:"addButton",value:function(e){this._model.addButton(e)}},{key:"removeButton",value:function(e){this._model.removeButton(e)}},{key:"getButton",value:function(e){return this._model.getButton(e)}},{key:"setTitle",value:function(e){this._model.set("title",e)}},{key:"focus",value:function(e){this.getField(e).focus()}},{key:"setErrors",value:function(e,t){t?this.getField(t).setErrors(e):this._model.set("errors",e)}},{key:"clear",value:function(){return this._model.clear()}},{key:"_onFieldChanged",value:function(e){this.dispatchEvent(e)}},{key:"_onSubmitRequest",value:function(e){var t=void 0;(t=this._model.getButton("submit"))&&t.trigger()}},{key:"disable",value:function(){this._model.disable(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"enable",value:function(){this._model.enable(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)}},{key:"hide",value:function(){this._model.hide(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hide",this).call(this)}},{key:"hideFields",value:function(){this._model.hideFields(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hide",this).call(this)}},{key:"disableFields",value:function(){this._model.disableFields(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"partiallyDisableFields",value:function(e){this._model.partiallyDisableFields(e),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){"use strict";function r(){}n.r(t),n.d(t,"WebGLRenderTargetCube",function(){return Yt}),n.d(t,"WebGLRenderTarget",function(){return Xt}),n.d(t,"WebGLRenderer",function(){return ai}),n.d(t,"ShaderLib",function(){return an}),n.d(t,"UniformsLib",function(){return on}),n.d(t,"UniformsUtils",function(){return tn}),n.d(t,"ShaderChunk",function(){return en}),n.d(t,"FogExp2",function(){return si}),n.d(t,"Fog",function(){return ui}),n.d(t,"Scene",function(){return li}),n.d(t,"Sprite",function(){return hi}),n.d(t,"LOD",function(){return pi}),n.d(t,"SkinnedMesh",function(){return vi}),n.d(t,"Skeleton",function(){return gi}),n.d(t,"Bone",function(){return mi}),n.d(t,"Mesh",function(){return Vn}),n.d(t,"LineSegments",function(){return bi}),n.d(t,"LineLoop",function(){return wi}),n.d(t,"Line",function(){return _i}),n.d(t,"Points",function(){return Ei}),n.d(t,"Group",function(){return ni}),n.d(t,"VideoTexture",function(){return Mi}),n.d(t,"DataTexture",function(){return $t}),n.d(t,"CompressedTexture",function(){return Ci}),n.d(t,"CubeTexture",function(){return qn}),n.d(t,"CanvasTexture",function(){return Ti}),n.d(t,"DepthTexture",function(){return Si}),n.d(t,"Texture",function(){return Gt}),n.d(t,"CompressedTextureLoader",function(){return ra}),n.d(t,"DataTextureLoader",function(){return ia}),n.d(t,"CubeTextureLoader",function(){return aa}),n.d(t,"TextureLoader",function(){return sa}),n.d(t,"ObjectLoader",function(){return us}),n.d(t,"MaterialLoader",function(){return ns}),n.d(t,"BufferGeometryLoader",function(){return rs}),n.d(t,"DefaultLoadingManager",function(){return ea}),n.d(t,"LoadingManager",function(){return Qo}),n.d(t,"JSONLoader",function(){return ss}),n.d(t,"ImageLoader",function(){return oa}),n.d(t,"ImageBitmapLoader",function(){return hs}),n.d(t,"FontLoader",function(){return vs}),n.d(t,"FileLoader",function(){return na}),n.d(t,"Loader",function(){return os}),n.d(t,"LoaderUtils",function(){return as}),n.d(t,"Cache",function(){return Ko}),n.d(t,"AudioLoader",function(){return _s}),n.d(t,"SpotLightShadow",function(){return ja}),n.d(t,"SpotLight",function(){return Da}),n.d(t,"PointLight",function(){return Na}),n.d(t,"RectAreaLight",function(){return Ua}),n.d(t,"HemisphereLight",function(){return Ra}),n.d(t,"DirectionalLightShadow",function(){return Ia}),n.d(t,"DirectionalLight",function(){return Fa}),n.d(t,"AmbientLight",function(){return Ba}),n.d(t,"LightShadow",function(){return La}),n.d(t,"Light",function(){return Pa}),n.d(t,"StereoCamera",function(){return bs}),n.d(t,"PerspectiveCamera",function(){return ri}),n.d(t,"OrthographicCamera",function(){return pn}),n.d(t,"CubeCamera",function(){return ws}),n.d(t,"ArrayCamera",function(){return ii}),n.d(t,"Camera",function(){return hn}),n.d(t,"AudioListener",function(){return xs}),n.d(t,"PositionalAudio",function(){return Ms}),n.d(t,"AudioContext",function(){return ys}),n.d(t,"AudioAnalyser",function(){return Cs}),n.d(t,"Audio",function(){return Es}),n.d(t,"VectorKeyframeTrack",function(){return Qa}),n.d(t,"StringKeyframeTrack",function(){return Ka}),n.d(t,"QuaternionKeyframeTrack",function(){return Za}),n.d(t,"NumberKeyframeTrack",function(){return $a}),n.d(t,"ColorKeyframeTrack",function(){return Ya}),n.d(t,"BooleanKeyframeTrack",function(){return Xa}),n.d(t,"PropertyMixer",function(){return Ts}),n.d(t,"PropertyBinding",function(){return As}),n.d(t,"KeyframeTrack",function(){return Wa}),n.d(t,"AnimationUtils",function(){return za}),n.d(t,"AnimationObjectGroup",function(){return Ps}),n.d(t,"AnimationMixer",function(){return Ls}),n.d(t,"AnimationClip",function(){return es}),n.d(t,"Uniform",function(){return js}),n.d(t,"InstancedBufferGeometry",function(){return Ds}),n.d(t,"BufferGeometry",function(){return Pn}),n.d(t,"Geometry",function(){return vn}),n.d(t,"InterleavedBufferAttribute",function(){return fi}),n.d(t,"InstancedInterleavedBuffer",function(){return Ns}),n.d(t,"InterleavedBuffer",function(){return ci}),n.d(t,"InstancedBufferAttribute",function(){return Is}),n.d(t,"Face3",function(){return gn}),n.d(t,"Object3D",function(){return dn}),n.d(t,"Raycaster",function(){return Fs}),n.d(t,"Layers",function(){return cn}),n.d(t,"EventDispatcher",function(){return r}),n.d(t,"Clock",function(){return zs}),n.d(t,"QuaternionLinearInterpolant",function(){return Ja}),n.d(t,"LinearInterpolant",function(){return qa}),n.d(t,"DiscreteInterpolant",function(){return Ga}),n.d(t,"CubicInterpolant",function(){return Ha}),n.d(t,"Interpolant",function(){return Va}),n.d(t,"Triangle",function(){return zn}),n.d(t,"Math",function(){return It}),n.d(t,"Spherical",function(){return Vs}),n.d(t,"Cylindrical",function(){return Hs}),n.d(t,"Plane",function(){return Kt}),n.d(t,"Frustum",function(){return Qt}),n.d(t,"Sphere",function(){return Zt}),n.d(t,"Ray",function(){return Un}),n.d(t,"Matrix4",function(){return Bt}),n.d(t,"Matrix3",function(){return Vt}),n.d(t,"Box3",function(){return Jt}),n.d(t,"Box2",function(){return qs}),n.d(t,"Line3",function(){return Gs}),n.d(t,"Euler",function(){return ln}),n.d(t,"Vector4",function(){return Wt}),n.d(t,"Vector3",function(){return zt}),n.d(t,"Vector2",function(){return Ft}),n.d(t,"Quaternion",function(){return Ut}),n.d(t,"Color",function(){return rn}),n.d(t,"ImmediateRenderObject",function(){return Ws}),n.d(t,"VertexNormalsHelper",function(){return Xs}),n.d(t,"SpotLightHelper",function(){return Ys}),n.d(t,"SkeletonHelper",function(){return $s}),n.d(t,"PointLightHelper",function(){return Js}),n.d(t,"RectAreaLightHelper",function(){return Zs}),n.d(t,"HemisphereLightHelper",function(){return Ks}),n.d(t,"GridHelper",function(){return Qs}),n.d(t,"PolarGridHelper",function(){return eu}),n.d(t,"FaceNormalsHelper",function(){return tu}),n.d(t,"DirectionalLightHelper",function(){return nu}),n.d(t,"CameraHelper",function(){return ru}),n.d(t,"BoxHelper",function(){return iu}),n.d(t,"Box3Helper",function(){return ou}),n.d(t,"PlaneHelper",function(){return au}),n.d(t,"ArrowHelper",function(){return su}),n.d(t,"AxesHelper",function(){return uu}),n.d(t,"Shape",function(){return Aa}),n.d(t,"Path",function(){return ka}),n.d(t,"ShapePath",function(){return ps}),n.d(t,"Font",function(){return gs}),n.d(t,"CurvePath",function(){return Oa}),n.d(t,"Curve",function(){return ua}),n.d(t,"ImageUtils",function(){return Ht}),n.d(t,"ShapeUtils",function(){return mo}),n.d(t,"WebGLUtils",function(){return ti}),n.d(t,"WireframeGeometry",function(){return Oi}),n.d(t,"ParametricGeometry",function(){return ki}),n.d(t,"ParametricBufferGeometry",function(){return Ai}),n.d(t,"TetrahedronGeometry",function(){return Li}),n.d(t,"TetrahedronBufferGeometry",function(){return ji}),n.d(t,"OctahedronGeometry",function(){return Di}),n.d(t,"OctahedronBufferGeometry",function(){return Ni}),n.d(t,"IcosahedronGeometry",function(){return Ii}),n.d(t,"IcosahedronBufferGeometry",function(){return Fi}),n.d(t,"DodecahedronGeometry",function(){return Bi}),n.d(t,"DodecahedronBufferGeometry",function(){return Ui}),n.d(t,"PolyhedronGeometry",function(){return Pi}),n.d(t,"PolyhedronBufferGeometry",function(){return Ri}),n.d(t,"TubeGeometry",function(){return zi}),n.d(t,"TubeBufferGeometry",function(){return Vi}),n.d(t,"TorusKnotGeometry",function(){return Hi}),n.d(t,"TorusKnotBufferGeometry",function(){return qi}),n.d(t,"TorusGeometry",function(){return Gi}),n.d(t,"TorusBufferGeometry",function(){return Wi}),n.d(t,"TextGeometry",function(){return Eo}),n.d(t,"TextBufferGeometry",function(){return Mo}),n.d(t,"SphereGeometry",function(){return Co}),n.d(t,"SphereBufferGeometry",function(){return To}),n.d(t,"RingGeometry",function(){return So}),n.d(t,"RingBufferGeometry",function(){return Oo}),n.d(t,"PlaneGeometry",function(){return jn}),n.d(t,"PlaneBufferGeometry",function(){return Dn}),n.d(t,"LatheGeometry",function(){return ko}),n.d(t,"LatheBufferGeometry",function(){return Ao}),n.d(t,"ShapeGeometry",function(){return Po}),n.d(t,"ShapeBufferGeometry",function(){return Ro}),n.d(t,"ExtrudeGeometry",function(){return _o}),n.d(t,"ExtrudeBufferGeometry",function(){return bo}),n.d(t,"EdgesGeometry",function(){return jo}),n.d(t,"ConeGeometry",function(){return Io}),n.d(t,"ConeBufferGeometry",function(){return Fo}),n.d(t,"CylinderGeometry",function(){return Do}),n.d(t,"CylinderBufferGeometry",function(){return No}),n.d(t,"CircleGeometry",function(){return Bo}),n.d(t,"CircleBufferGeometry",function(){return Uo}),n.d(t,"BoxGeometry",function(){return Rn}),n.d(t,"BoxBufferGeometry",function(){return Ln}),n.d(t,"ShadowMaterial",function(){return Vo}),n.d(t,"SpriteMaterial",function(){return di}),n.d(t,"RawShaderMaterial",function(){return Ho}),n.d(t,"ShaderMaterial",function(){return Bn}),n.d(t,"PointsMaterial",function(){return xi}),n.d(t,"MeshPhysicalMaterial",function(){return Go}),n.d(t,"MeshStandardMaterial",function(){return qo}),n.d(t,"MeshPhongMaterial",function(){return Wo}),n.d(t,"MeshToonMaterial",function(){return Xo}),n.d(t,"MeshNormalMaterial",function(){return Yo}),n.d(t,"MeshLambertMaterial",function(){return $o}),n.d(t,"MeshDepthMaterial",function(){return Zr}),n.d(t,"MeshDistanceMaterial",function(){return Kr}),n.d(t,"MeshBasicMaterial",function(){return Fn}),n.d(t,"LineDashedMaterial",function(){return Jo}),n.d(t,"LineBasicMaterial",function(){return yi}),n.d(t,"Material",function(){return In}),n.d(t,"Float64BufferAttribute",function(){return Sn}),n.d(t,"Float32BufferAttribute",function(){return Tn}),n.d(t,"Uint32BufferAttribute",function(){return Cn}),n.d(t,"Int32BufferAttribute",function(){return Mn}),n.d(t,"Uint16BufferAttribute",function(){return En}),n.d(t,"Int16BufferAttribute",function(){return xn}),n.d(t,"Uint8ClampedBufferAttribute",function(){return wn}),n.d(t,"Uint8BufferAttribute",function(){return bn}),n.d(t,"Int8BufferAttribute",function(){return _n}),n.d(t,"BufferAttribute",function(){return yn}),n.d(t,"ArcCurve",function(){return ca}),n.d(t,"CatmullRomCurve3",function(){return ma}),n.d(t,"CubicBezierCurve",function(){return ba}),n.d(t,"CubicBezierCurve3",function(){return wa}),n.d(t,"EllipseCurve",function(){return la}),n.d(t,"LineCurve",function(){return xa}),n.d(t,"LineCurve3",function(){return Ea}),n.d(t,"QuadraticBezierCurve",function(){return Ma}),n.d(t,"QuadraticBezierCurve3",function(){return Ca}),n.d(t,"SplineCurve",function(){return Ta}),n.d(t,"REVISION",function(){return i}),n.d(t,"MOUSE",function(){return o}),n.d(t,"CullFaceNone",function(){return a}),n.d(t,"CullFaceBack",function(){return s}),n.d(t,"CullFaceFront",function(){return u}),n.d(t,"CullFaceFrontBack",function(){return l}),n.d(t,"FrontFaceDirectionCW",function(){return c}),n.d(t,"FrontFaceDirectionCCW",function(){return f}),n.d(t,"BasicShadowMap",function(){return d}),n.d(t,"PCFShadowMap",function(){return h}),n.d(t,"PCFSoftShadowMap",function(){return p}),n.d(t,"FrontSide",function(){return g}),n.d(t,"BackSide",function(){return m}),n.d(t,"DoubleSide",function(){return v}),n.d(t,"FlatShading",function(){return y}),n.d(t,"SmoothShading",function(){return _}),n.d(t,"NoColors",function(){return b}),n.d(t,"FaceColors",function(){return w}),n.d(t,"VertexColors",function(){return x}),n.d(t,"NoBlending",function(){return E}),n.d(t,"NormalBlending",function(){return M}),n.d(t,"AdditiveBlending",function(){return C}),n.d(t,"SubtractiveBlending",function(){return T}),n.d(t,"MultiplyBlending",function(){return S}),n.d(t,"CustomBlending",function(){return O}),n.d(t,"AddEquation",function(){return k}),n.d(t,"SubtractEquation",function(){return A}),n.d(t,"ReverseSubtractEquation",function(){return P}),n.d(t,"MinEquation",function(){return R}),n.d(t,"MaxEquation",function(){return L}),n.d(t,"ZeroFactor",function(){return j}),n.d(t,"OneFactor",function(){return D}),n.d(t,"SrcColorFactor",function(){return N}),n.d(t,"OneMinusSrcColorFactor",function(){return I}),n.d(t,"SrcAlphaFactor",function(){return F}),n.d(t,"OneMinusSrcAlphaFactor",function(){return B}),n.d(t,"DstAlphaFactor",function(){return U}),n.d(t,"OneMinusDstAlphaFactor",function(){return z}),n.d(t,"DstColorFactor",function(){return V}),n.d(t,"OneMinusDstColorFactor",function(){return H}),n.d(t,"SrcAlphaSaturateFactor",function(){return q}),n.d(t,"NeverDepth",function(){return G}),n.d(t,"AlwaysDepth",function(){return W}),n.d(t,"LessDepth",function(){return X}),n.d(t,"LessEqualDepth",function(){return Y}),n.d(t,"EqualDepth",function(){return $}),n.d(t,"GreaterEqualDepth",function(){return J}),n.d(t,"GreaterDepth",function(){return Z}),n.d(t,"NotEqualDepth",function(){return K}),n.d(t,"MultiplyOperation",function(){return Q}),n.d(t,"MixOperation",function(){return ee}),n.d(t,"AddOperation",function(){return te}),n.d(t,"NoToneMapping",function(){return ne}),n.d(t,"LinearToneMapping",function(){return re}),n.d(t,"ReinhardToneMapping",function(){return ie}),n.d(t,"Uncharted2ToneMapping",function(){return oe}),n.d(t,"CineonToneMapping",function(){return ae}),n.d(t,"UVMapping",function(){return se}),n.d(t,"CubeReflectionMapping",function(){return ue}),n.d(t,"CubeRefractionMapping",function(){return le}),n.d(t,"EquirectangularReflectionMapping",function(){return ce}),n.d(t,"EquirectangularRefractionMapping",function(){return fe}),n.d(t,"SphericalReflectionMapping",function(){return de}),n.d(t,"CubeUVReflectionMapping",function(){return he}),n.d(t,"CubeUVRefractionMapping",function(){return pe}),n.d(t,"RepeatWrapping",function(){return ge}),n.d(t,"ClampToEdgeWrapping",function(){return me}),n.d(t,"MirroredRepeatWrapping",function(){return ve}),n.d(t,"NearestFilter",function(){return ye}),n.d(t,"NearestMipMapNearestFilter",function(){return _e}),n.d(t,"NearestMipMapLinearFilter",function(){return be}),n.d(t,"LinearFilter",function(){return we}),n.d(t,"LinearMipMapNearestFilter",function(){return xe}),n.d(t,"LinearMipMapLinearFilter",function(){return Ee}),n.d(t,"UnsignedByteType",function(){return Me}),n.d(t,"ByteType",function(){return Ce}),n.d(t,"ShortType",function(){return Te}),n.d(t,"UnsignedShortType",function(){return Se}),n.d(t,"IntType",function(){return Oe}),n.d(t,"UnsignedIntType",function(){return ke}),n.d(t,"FloatType",function(){return Ae}),n.d(t,"HalfFloatType",function(){return Pe}),n.d(t,"UnsignedShort4444Type",function(){return Re}),n.d(t,"UnsignedShort5551Type",function(){return Le}),n.d(t,"UnsignedShort565Type",function(){return je}),n.d(t,"UnsignedInt248Type",function(){return De}),n.d(t,"AlphaFormat",function(){return Ne}),n.d(t,"RGBFormat",function(){return Ie}),n.d(t,"RGBAFormat",function(){return Fe}),n.d(t,"LuminanceFormat",function(){return Be}),n.d(t,"LuminanceAlphaFormat",function(){return Ue}),n.d(t,"RGBEFormat",function(){return ze}),n.d(t,"DepthFormat",function(){return Ve}),n.d(t,"DepthStencilFormat",function(){return He}),n.d(t,"RGB_S3TC_DXT1_Format",function(){return qe}),n.d(t,"RGBA_S3TC_DXT1_Format",function(){return Ge}),n.d(t,"RGBA_S3TC_DXT3_Format",function(){return We}),n.d(t,"RGBA_S3TC_DXT5_Format",function(){return Xe}),n.d(t,"RGB_PVRTC_4BPPV1_Format",function(){return Ye}),n.d(t,"RGB_PVRTC_2BPPV1_Format",function(){return $e}),n.d(t,"RGBA_PVRTC_4BPPV1_Format",function(){return Je}),n.d(t,"RGBA_PVRTC_2BPPV1_Format",function(){return Ze}),n.d(t,"RGB_ETC1_Format",function(){return Ke}),n.d(t,"RGBA_ASTC_4x4_Format",function(){return Qe}),n.d(t,"RGBA_ASTC_5x4_Format",function(){return et}),n.d(t,"RGBA_ASTC_5x5_Format",function(){return tt}),n.d(t,"RGBA_ASTC_6x5_Format",function(){return nt}),n.d(t,"RGBA_ASTC_6x6_Format",function(){return rt}),n.d(t,"RGBA_ASTC_8x5_Format",function(){return it}),n.d(t,"RGBA_ASTC_8x6_Format",function(){return ot}),n.d(t,"RGBA_ASTC_8x8_Format",function(){return at}),n.d(t,"RGBA_ASTC_10x5_Format",function(){return st}),n.d(t,"RGBA_ASTC_10x6_Format",function(){return ut}),n.d(t,"RGBA_ASTC_10x8_Format",function(){return lt}),n.d(t,"RGBA_ASTC_10x10_Format",function(){return ct}),n.d(t,"RGBA_ASTC_12x10_Format",function(){return ft}),n.d(t,"RGBA_ASTC_12x12_Format",function(){return dt}),n.d(t,"LoopOnce",function(){return ht}),n.d(t,"LoopRepeat",function(){return pt}),n.d(t,"LoopPingPong",function(){return gt}),n.d(t,"InterpolateDiscrete",function(){return mt}),n.d(t,"InterpolateLinear",function(){return vt}),n.d(t,"InterpolateSmooth",function(){return yt}),n.d(t,"ZeroCurvatureEnding",function(){return _t}),n.d(t,"ZeroSlopeEnding",function(){return bt}),n.d(t,"WrapAroundEnding",function(){return wt}),n.d(t,"TrianglesDrawMode",function(){return xt}),n.d(t,"TriangleStripDrawMode",function(){return Et}),n.d(t,"TriangleFanDrawMode",function(){return Mt}),n.d(t,"LinearEncoding",function(){return Ct}),n.d(t,"sRGBEncoding",function(){return Tt}),n.d(t,"GammaEncoding",function(){return St}),n.d(t,"RGBEEncoding",function(){return Ot}),n.d(t,"LogLuvEncoding",function(){return kt}),n.d(t,"RGBM7Encoding",function(){return At}),n.d(t,"RGBM16Encoding",function(){return Pt}),n.d(t,"RGBDEncoding",function(){return Rt}),n.d(t,"BasicDepthPacking",function(){return Lt}),n.d(t,"RGBADepthPacking",function(){return jt}),n.d(t,"TangentSpaceNormalMap",function(){return Dt}),n.d(t,"ObjectSpaceNormalMap",function(){return Nt}),n.d(t,"CubeGeometry",function(){return Rn}),n.d(t,"Face4",function(){return lu}),n.d(t,"LineStrip",function(){return cu}),n.d(t,"LinePieces",function(){return fu}),n.d(t,"MeshFaceMaterial",function(){return du}),n.d(t,"MultiMaterial",function(){return hu}),n.d(t,"PointCloud",function(){return pu}),n.d(t,"Particle",function(){return gu}),n.d(t,"ParticleSystem",function(){return mu}),n.d(t,"PointCloudMaterial",function(){return vu}),n.d(t,"ParticleBasicMaterial",function(){return yu}),n.d(t,"ParticleSystemMaterial",function(){return _u}),n.d(t,"Vertex",function(){return bu}),n.d(t,"DynamicBufferAttribute",function(){return wu}),n.d(t,"Int8Attribute",function(){return xu}),n.d(t,"Uint8Attribute",function(){return Eu}),n.d(t,"Uint8ClampedAttribute",function(){return Mu}),n.d(t,"Int16Attribute",function(){return Cu}),n.d(t,"Uint16Attribute",function(){return Tu}),n.d(t,"Int32Attribute",function(){return Su}),n.d(t,"Uint32Attribute",function(){return Ou}),n.d(t,"Float32Attribute",function(){return ku}),n.d(t,"Float64Attribute",function(){return Au}),n.d(t,"ClosedSplineCurve3",function(){return Pu}),n.d(t,"SplineCurve3",function(){return Ru}),n.d(t,"Spline",function(){return Lu}),n.d(t,"AxisHelper",function(){return ju}),n.d(t,"BoundingBoxHelper",function(){return Du}),n.d(t,"EdgesHelper",function(){return Nu}),n.d(t,"WireframeHelper",function(){return Iu}),n.d(t,"XHRLoader",function(){return Fu}),n.d(t,"BinaryTextureLoader",function(){return Bu}),n.d(t,"GeometryUtils",function(){return Uu}),n.d(t,"Projector",function(){return zu}),n.d(t,"CanvasRenderer",function(){return Vu}),n.d(t,"SceneUtils",function(){return Hu}),n.d(t,"LensFlare",function(){return qu}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),Object.assign(r.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});var i="95",o={LEFT:0,MIDDLE:1,RIGHT:2},a=0,s=1,u=2,l=3,c=0,f=1,d=0,h=1,p=2,g=0,m=1,v=2,y=1,_=2,b=0,w=1,x=2,E=0,M=1,C=2,T=3,S=4,O=5,k=100,A=101,P=102,R=103,L=104,j=200,D=201,N=202,I=203,F=204,B=205,U=206,z=207,V=208,H=209,q=210,G=0,W=1,X=2,Y=3,$=4,J=5,Z=6,K=7,Q=0,ee=1,te=2,ne=0,re=1,ie=2,oe=3,ae=4,se=300,ue=301,le=302,ce=303,fe=304,de=305,he=306,pe=307,ge=1e3,me=1001,ve=1002,ye=1003,_e=1004,be=1005,we=1006,xe=1007,Ee=1008,Me=1009,Ce=1010,Te=1011,Se=1012,Oe=1013,ke=1014,Ae=1015,Pe=1016,Re=1017,Le=1018,je=1019,De=1020,Ne=1021,Ie=1022,Fe=1023,Be=1024,Ue=1025,ze=Fe,Ve=1026,He=1027,qe=33776,Ge=33777,We=33778,Xe=33779,Ye=35840,$e=35841,Je=35842,Ze=35843,Ke=36196,Qe=37808,et=37809,tt=37810,nt=37811,rt=37812,it=37813,ot=37814,at=37815,st=37816,ut=37817,lt=37818,ct=37819,ft=37820,dt=37821,ht=2200,pt=2201,gt=2202,mt=2300,vt=2301,yt=2302,_t=2400,bt=2401,wt=2402,xt=0,Et=1,Mt=2,Ct=3e3,Tt=3001,St=3007,Ot=3002,kt=3003,At=3004,Pt=3005,Rt=3006,Lt=3200,jt=3201,Dt=0,Nt=1,It={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&r|128]+e[r>>8&255]+"-"+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*It.DEG2RAD},radToDeg:function(e){return e*It.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Ft(e,t){this.x=e||0,this.y=t||0}function Bt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Ut(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}function zt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function Vt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Ft.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Ft.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(){var e=new Ft,t=new Ft;return function(n,r){return e.set(n,n),t.set(r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}}),Object.assign(Bt.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,o,a,s,u,l,c,f,d,h,p,g){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=o,m[9]=a,m[13]=s,m[2]=u,m[6]=l,m[10]=c,m[14]=f,m[3]=d,m[7]=h,m[11]=p,m[15]=g,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Bt).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new zt;return function(t){var n=this.elements,r=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),o=1/e.setFromMatrixColumn(t,1).length(),a=1/e.setFromMatrixColumn(t,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[7]=0,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var f=o*l,d=o*c,h=a*l,p=a*c;t[0]=s*l,t[4]=-s*c,t[8]=u,t[1]=d+h*u,t[5]=f-p*u,t[9]=-a*s,t[2]=p-f*u,t[6]=h+d*u,t[10]=o*s}else if("YXZ"===e.order){var g=s*l,m=s*c,v=u*l,y=u*c;t[0]=g+y*a,t[4]=v*a-m,t[8]=o*u,t[1]=o*c,t[5]=o*l,t[9]=-a,t[2]=m*a-v,t[6]=y+g*a,t[10]=o*s}else if("ZXY"===e.order){g=s*l,m=s*c,v=u*l,y=u*c;t[0]=g-y*a,t[4]=-o*c,t[8]=v+m*a,t[1]=m+v*a,t[5]=o*l,t[9]=y-g*a,t[2]=-o*u,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){f=o*l,d=o*c,h=a*l,p=a*c;t[0]=s*l,t[4]=h*u-d,t[8]=f*u+p,t[1]=s*c,t[5]=p*u+f,t[9]=d*u-h,t[2]=-u,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var _=o*s,b=o*u,w=a*s,x=a*u;t[0]=s*l,t[4]=x-_*c,t[8]=w*c+b,t[1]=c,t[5]=o*l,t[9]=-a*l,t[2]=-u*l,t[6]=b*c+w,t[10]=_-x*c}else if("XZY"===e.order){_=o*s,b=o*u,w=a*s,x=a*u;t[0]=s*l,t[4]=-c,t[8]=u*l,t[1]=_*c+x,t[5]=o*l,t[9]=b*c-w,t[2]=w*c-b,t[6]=a*l,t[10]=x*c+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(){var e=new zt(0,0,0),t=new zt(1,1,1);return function(n){return this.compose(e,n,t)}}(),lookAt:function(){var e=new zt,t=new zt,n=new zt;return function(r,i,o){var a=this.elements;return n.subVectors(r,i),0===n.lengthSq()&&(n.z=1),n.normalize(),e.crossVectors(o,n),0===e.lengthSq()&&(1===Math.abs(o.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),e.crossVectors(o,n)),e.normalize(),t.crossVectors(n,e),a[0]=e.x,a[4]=t.x,a[8]=n.x,a[1]=e.y,a[5]=t.y,a[9]=n.y,a[2]=e.z,a[6]=t.z,a[10]=n.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],l=n[1],c=n[5],f=n[9],d=n[13],h=n[2],p=n[6],g=n[10],m=n[14],v=n[3],y=n[7],_=n[11],b=n[15],w=r[0],x=r[4],E=r[8],M=r[12],C=r[1],T=r[5],S=r[9],O=r[13],k=r[2],A=r[6],P=r[10],R=r[14],L=r[3],j=r[7],D=r[11],N=r[15];return i[0]=o*w+a*C+s*k+u*L,i[4]=o*x+a*T+s*A+u*j,i[8]=o*E+a*S+s*P+u*D,i[12]=o*M+a*O+s*R+u*N,i[1]=l*w+c*C+f*k+d*L,i[5]=l*x+c*T+f*A+d*j,i[9]=l*E+c*S+f*P+d*D,i[13]=l*M+c*O+f*R+d*N,i[2]=h*w+p*C+g*k+m*L,i[6]=h*x+p*T+g*A+m*j,i[10]=h*E+p*S+g*P+m*D,i[14]=h*M+p*O+g*R+m*N,i[3]=v*w+y*C+_*k+b*L,i[7]=v*x+y*T+_*A+b*j,i[11]=v*E+y*S+_*P+b*D,i[15]=v*M+y*O+_*R+b*N,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new zt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix4(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],u=e[13],l=e[2],c=e[6],f=e[10],d=e[14];return e[3]*(+i*s*c-r*u*c-i*a*f+n*u*f+r*a*d-n*s*d)+e[7]*(+t*s*d-t*u*f+i*o*f-r*o*d+r*u*l-i*s*l)+e[11]*(+t*u*c-t*a*d-i*o*c+n*o*d+i*a*l-n*u*l)+e[15]*(-r*a*l-t*s*c+t*a*f+r*o*c-n*o*f+n*s*l)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=r[6],f=r[7],d=r[8],h=r[9],p=r[10],g=r[11],m=r[12],v=r[13],y=r[14],_=r[15],b=h*y*f-v*p*f+v*c*g-l*y*g-h*c*_+l*p*_,w=m*p*f-d*y*f-m*c*g+u*y*g+d*c*_-u*p*_,x=d*v*f-m*h*f+m*l*g-u*v*g-d*l*_+u*h*_,E=m*h*c-d*v*c-m*l*p+u*v*p+d*l*y-u*h*y,M=i*b+o*w+a*x+s*E;if(0===M){var C="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(C);return console.warn(C),this.identity()}var T=1/M;return n[0]=b*T,n[1]=(v*p*s-h*y*s-v*a*g+o*y*g+h*a*_-o*p*_)*T,n[2]=(l*y*s-v*c*s+v*a*f-o*y*f-l*a*_+o*c*_)*T,n[3]=(h*c*s-l*p*s-h*a*f+o*p*f+l*a*g-o*c*g)*T,n[4]=w*T,n[5]=(d*y*s-m*p*s+m*a*g-i*y*g-d*a*_+i*p*_)*T,n[6]=(m*c*s-u*y*s-m*a*f+i*y*f+u*a*_-i*c*_)*T,n[7]=(u*p*s-d*c*s+d*a*f-i*p*f-u*a*g+i*c*g)*T,n[8]=x*T,n[9]=(m*h*s-d*v*s-m*o*g+i*v*g+d*o*_-i*h*_)*T,n[10]=(u*v*s-m*l*s+m*o*f-i*v*f-u*o*_+i*l*_)*T,n[11]=(d*l*s-u*h*s-d*o*f+i*h*f+u*o*g-i*l*g)*T,n[12]=E*T,n[13]=(d*v*a-m*h*a+m*o*p-i*v*p-d*o*y+i*h*y)*T,n[14]=(m*l*a-u*v*a-m*o*c+i*v*c+u*o*y-i*l*y)*T,n[15]=(u*h*a-d*l*a+d*o*c-i*h*c-u*o*p+i*l*p)*T,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z,u=i*o,l=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,l*a+n,l*s-r*o,0,u*s-r*a,l*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,u=i+i,l=o+o,c=a+a,f=i*u,d=i*l,h=i*c,p=o*l,g=o*c,m=a*c,v=s*u,y=s*l,_=s*c,b=n.x,w=n.y,x=n.z;return r[0]=(1-(p+m))*b,r[1]=(d+_)*b,r[2]=(h-y)*b,r[3]=0,r[4]=(d-_)*w,r[5]=(1-(f+m))*w,r[6]=(g+v)*w,r[7]=0,r[8]=(h+y)*x,r[9]=(g-v)*x,r[10]=(1-(f+p))*x,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:function(){var e=new zt,t=new Bt;return function(n,r,i){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),u=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],t.copy(this);var l=1/a,c=1/s,f=1/u;return t.elements[0]*=l,t.elements[1]*=l,t.elements[2]*=l,t.elements[4]*=c,t.elements[5]*=c,t.elements[6]*=c,t.elements[8]*=f,t.elements[9]*=f,t.elements[10]*=f,r.setFromRotationMatrix(t),i.x=a,i.y=s,i.z=u,this}}(),makePerspective:function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),u=2*i/(n-r),l=(t+e)/(t-e),c=(n+r)/(n-r),f=-(o+i)/(o-i),d=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=u,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),u=1/(n-r),l=1/(o-i),c=(t+e)*s,f=(n+r)*u,d=(o+i)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(Ut,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,o,a){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],f=i[o+0],d=i[o+1],h=i[o+2],p=i[o+3];if(c!==p||s!==f||u!==d||l!==h){var g=1-a,m=s*f+u*d+l*h+c*p,v=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){var _=Math.sqrt(y),b=Math.atan2(_,m*v);g=Math.sin(g*b)/_,a=Math.sin(a*b)/_}var w=a*v;if(s=s*g+f*w,u=u*g+d*w,l=l*g+h*w,c=c*g+p*w,g===1-a){var x=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=x,u*=x,l*=x,c*=x}}e[t]=s,e[t+1]=u,e[t+2]=l,e[t+3]=c}}),Object.defineProperties(Ut.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Ut.prototype,{set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,u=a(n/2),l=a(r/2),c=a(i/2),f=s(n/2),d=s(r/2),h=s(i/2);return"XYZ"===o?(this._x=f*l*c+u*d*h,this._y=u*d*c-f*l*h,this._z=u*l*h+f*d*c,this._w=u*l*c-f*d*h):"YXZ"===o?(this._x=f*l*c+u*d*h,this._y=u*d*c-f*l*h,this._z=u*l*h-f*d*c,this._w=u*l*c+f*d*h):"ZXY"===o?(this._x=f*l*c-u*d*h,this._y=u*d*c+f*l*h,this._z=u*l*h+f*d*c,this._w=u*l*c-f*d*h):"ZYX"===o?(this._x=f*l*c-u*d*h,this._y=u*d*c+f*l*h,this._z=u*l*h-f*d*c,this._w=u*l*c+f*d*h):"YZX"===o?(this._x=f*l*c+u*d*h,this._y=u*d*c+f*l*h,this._z=u*l*h-f*d*c,this._w=u*l*c-f*d*h):"XZY"===o&&(this._x=f*l*c-u*d*h,this._y=u*d*c-f*l*h,this._z=u*l*h+f*d*c,this._w=u*l*c+f*d*h),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],l=n[2],c=n[6],f=n[10],d=r+s+f;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(c-u)*t,this._y=(o-l)*t,this._z=(a-i)*t):r>s&&r>f?(t=2*Math.sqrt(1+r-s-f),this._w=(c-u)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+l)/t):s>f?(t=2*Math.sqrt(1+s-r-f),this._w=(o-l)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(u+c)/t):(t=2*Math.sqrt(1+f-r-s),this._w=(a-i)/t,this._x=(o+l)/t,this._y=(u+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new zt;return function(n,r){return void 0===t&&(t=new zt),(e=n.dot(r)+1)<1e-6?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),angleTo:function(e){return 2*Math.acos(Math.abs(It.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y,u=t._z,l=t._w;return this._x=n*l+o*a+r*u-i*s,this._y=r*l+o*s+i*a-n*u,this._z=i*l+o*u+n*s-r*a,this._w=o*l-n*a-r*s-i*u,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var u=1-t;return this._w=u*o+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize()}var l=Math.sqrt(s),c=Math.atan2(l,a),f=Math.sin((1-t)*c)/l,d=Math.sin(t*c)/l;return this._w=o*f+this._w*d,this._x=n*f+this._x*d,this._y=r*f+this._y*d,this._z=i*f+this._z*d,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(zt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new Ut;return function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new Ut;return function(t,n){return this.applyQuaternion(e.setFromAxisAngle(t,n))}}(),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,u=s*t+o*r-a*n,l=s*n+a*t-i*r,c=s*r+i*n-o*t,f=-i*t-o*n-a*r;return this.x=u*s+f*-i+l*-a-c*-o,this.y=l*s+f*-o+c*-i-u*-a,this.z=c*s+f*-a+u*-o-l*-i,this},project:function(){var e=new Bt;return function(t){return e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyMatrix4(e)}}(),unproject:function(){var e=new Bt;return function(t){return e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new zt,t=new zt;return function(n,r){return e.set(n,n,n),t.set(r,r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new zt;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new zt;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(It.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Vt.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,o,a,s,u){var l=this.elements;return l[0]=e,l[1]=r,l[2]=a,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=o,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new zt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix3(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],l=n[4],c=n[7],f=n[2],d=n[5],h=n[8],p=r[0],g=r[3],m=r[6],v=r[1],y=r[4],_=r[7],b=r[2],w=r[5],x=r[8];return i[0]=o*p+a*v+s*b,i[3]=o*g+a*y+s*w,i[6]=o*m+a*_+s*x,i[1]=u*p+l*v+c*b,i[4]=u*g+l*y+c*w,i[7]=u*m+l*_+c*x,i[2]=f*p+d*v+h*b,i[5]=f*g+d*y+h*w,i[8]=f*m+d*_+h*x,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],l=e[8];return t*o*l-t*a*u-n*i*l+n*a*s+r*i*u-r*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6],f=n[7],d=n[8],h=d*u-l*f,p=l*c-d*s,g=f*s-u*c,m=i*h+o*p+a*g;if(0===m){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/m;return r[0]=h*y,r[1]=(a*f-d*o)*y,r[2]=(l*o-a*u)*y,r[3]=p*y,r[4]=(d*i-a*c)*y,r[5]=(a*s-l*i)*y,r[6]=g*y,r[7]=(o*c-f*i)*y,r[8]=(u*i-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*o+u*a)+o+e,-r*u,r*s,-r*(-u*o+s*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],l=r[7];return r[0]=t*i+n*s,r[3]=t*o+n*u,r[6]=t*a+n*l,r[1]=-n*i+t*s,r[4]=-n*o+t*u,r[7]=-n*a+t*l,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Ht={getDataURL:function(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{"undefined"!=typeof OffscreenCanvas?t=new OffscreenCanvas(e.width,e.height):((t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height);var n=t.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height)}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},qt=0;function Gt(e,t,n,r,i,o,a,s,u,l){Object.defineProperty(this,"id",{value:qt++}),this.uuid=It.generateUUID(),this.name="",this.image=void 0!==e?e:Gt.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Gt.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:me,this.wrapT=void 0!==r?r:me,this.magFilter=void 0!==i?i:we,this.minFilter=void 0!==o?o:Ee,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:Fe,this.type=void 0!==s?s:Me,this.offset=new Ft(0,0),this.repeat=new Ft(1,1),this.center=new Ft(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:Ct,this.version=0,this.onUpdate=null}function Wt(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function Xt(e,t,n){this.width=e,this.height=t,this.scissor=new Wt(0,0,e,t),this.scissorTest=!1,this.viewport=new Wt(0,0,e,t),void 0===(n=n||{}).minFilter&&(n.minFilter=we),this.texture=new Gt(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.generateMipmaps=void 0===n.generateMipmaps||n.generateMipmaps,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Yt(e,t,n){Xt.call(this,e,t,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function $t(e,t,n,r,i,o,a,s,u,l,c,f){Gt.call(this,null,o,a,s,u,l,r,i,c,f),this.image={data:e,width:t,height:n},this.magFilter=void 0!==u?u:ye,this.minFilter=void 0!==l?l:ye,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Jt(e,t){this.min=void 0!==e?e:new zt(1/0,1/0,1/0),this.max=void 0!==t?t:new zt(-1/0,-1/0,-1/0)}function Zt(e,t){this.center=void 0!==e?e:new zt,this.radius=void 0!==t?t:0}function Kt(e,t){this.normal=void 0!==e?e:new zt(1,0,0),this.constant=void 0!==t?t:0}function Qt(e,t,n,r,i,o){this.planes=[void 0!==e?e:new Kt,void 0!==t?t:new Kt,void 0!==n?n:new Kt,void 0!==r?r:new Kt,void 0!==i?i:new Kt,void 0!==o?o:new Kt]}Gt.DEFAULT_IMAGE=void 0,Gt.DEFAULT_MAPPING=se,Gt.prototype=Object.assign(Object.create(r.prototype),{constructor:Gt,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=It.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push(Ht.getDataURL(r[o]))}else i=Ht.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping===se){if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ge:e.x=e.x-Math.floor(e.x);break;case me:e.x=e.x<0?0:1;break;case ve:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ge:e.y=e.y-Math.floor(e.y);break;case me:e.y=e.y<0?0:1;break;case ve:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.defineProperty(Gt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Wt.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,o=e.elements,a=o[0],s=o[4],u=o[8],l=o[1],c=o[5],f=o[9],d=o[2],h=o[6],p=o[10];if(Math.abs(s-l)<.01&&Math.abs(u-d)<.01&&Math.abs(f-h)<.01){if(Math.abs(s+l)<.1&&Math.abs(u+d)<.1&&Math.abs(f+h)<.1&&Math.abs(a+c+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var g=(a+1)/2,m=(c+1)/2,v=(p+1)/2,y=(s+l)/4,_=(u+d)/4,b=(f+h)/4;return g>m&&g>v?g<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(g)),i=_/n):m>v?m<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(m)),i=b/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=_/(i=Math.sqrt(v)),r=b/i),this.set(n,r,i,t),this}var w=Math.sqrt((h-f)*(h-f)+(u-d)*(u-d)+(l-s)*(l-s));return Math.abs(w)<.001&&(w=1),this.x=(h-f)/w,this.y=(u-d)/w,this.z=(l-s)/w,this.w=Math.acos((a+c+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(n,r){return void 0===e&&(e=new Wt,t=new Wt),e.set(n,n,n,n),t.set(r,r,r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Xt.prototype=Object.assign(Object.create(r.prototype),{constructor:Xt,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Yt.prototype=Object.create(Xt.prototype),Yt.prototype.constructor=Yt,Yt.prototype.isWebGLRenderTargetCube=!0,$t.prototype=Object.create(Gt.prototype),$t.prototype.constructor=$t,$t.prototype.isDataTexture=!0,Object.assign(Jt.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=e.length;s<u;s+=3){var l=e[s],c=e[s+1],f=e[s+2];l<t&&(t=l),c<n&&(n=c),f<r&&(r=f),l>i&&(i=l),c>o&&(o=c),f>a&&(a=f)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=e.count;s<u;s++){var l=e.getX(s),c=e.getY(s),f=e.getZ(s);l<t&&(t=l),c<n&&(n=c),f<r&&(r=f),l>i&&(i=l),c>o&&(o=c),f>a&&(a=f)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new zt;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new zt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new zt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,n,r=new zt;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(t=0,n=a.length;t<n;t++)r.copy(a[t]),r.applyMatrix4(i.matrixWorld),e.expandByPoint(r)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(t=0,n=s.count;t<n;t++)r.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(r)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new zt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new zt;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=e.constant&&n>=e.constant},intersectsTriangle:function(){var e=new zt,t=new zt,n=new zt,r=new zt,i=new zt,o=new zt,a=new zt,s=new zt,u=new zt,l=new zt;function c(r){var i,o;for(i=0,o=r.length-3;i<=o;i+=3){a.fromArray(r,i);var s=u.x*Math.abs(a.x)+u.y*Math.abs(a.y)+u.z*Math.abs(a.z),l=e.dot(a),c=t.dot(a),f=n.dot(a);if(Math.max(-Math.max(l,c,f),Math.min(l,c,f))>s)return!1}return!0}return function(a){if(this.isEmpty())return!1;this.getCenter(s),u.subVectors(this.max,s),e.subVectors(a.a,s),t.subVectors(a.b,s),n.subVectors(a.c,s),r.subVectors(t,e),i.subVectors(n,t),o.subVectors(e,n);var f=[0,-r.z,r.y,0,-i.z,i.y,0,-o.z,o.y,r.z,0,-r.x,i.z,0,-i.x,o.z,0,-o.x,-r.y,r.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!c(f)&&(!!c(f=[1,0,0,0,1,0,0,0,1])&&(l.crossVectors(r,i),c(f=[l.x,l.y,l.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new zt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new zt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new zt;return function(t){return void 0===t&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),t=new Zt),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){if(this.isEmpty())return this;var t=e.elements,n=t[0]*this.min.x,r=t[1]*this.min.x,i=t[2]*this.min.x,o=t[0]*this.max.x,a=t[1]*this.max.x,s=t[2]*this.max.x,u=t[4]*this.min.y,l=t[5]*this.min.y,c=t[6]*this.min.y,f=t[4]*this.max.y,d=t[5]*this.max.y,h=t[6]*this.max.y,p=t[8]*this.min.z,g=t[9]*this.min.z,m=t[10]*this.min.z,v=t[8]*this.max.z,y=t[9]*this.max.z,_=t[10]*this.max.z;return this.min.x=Math.min(n,o)+Math.min(u,f)+Math.min(p,v)+t[12],this.min.y=Math.min(r,a)+Math.min(l,d)+Math.min(g,y)+t[13],this.min.z=Math.min(i,s)+Math.min(c,h)+Math.min(m,_)+t[14],this.max.x=Math.max(n,o)+Math.max(u,f)+Math.max(p,v)+t[12],this.max.y=Math.max(r,a)+Math.max(l,d)+Math.max(g,y)+t[13],this.max.z=Math.max(i,s)+Math.max(c,h)+Math.max(m,_)+t[14],this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Zt.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new Jt;return function(t,n){var r=this.center;void 0!==n?r.copy(n):e.setFromPoints(t).getCenter(r);for(var i=0,o=0,a=t.length;o<a;o++)i=Math.max(i,r.distanceToSquared(t[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new zt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Jt),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(Kt.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new zt,t=new zt;return function(n,r,i){var o=e.subVectors(i,r).cross(t.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new zt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new zt;return function(t,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new zt);var r=t.delta(e),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:n.copy(r).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new zt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new zt,t=new Vt;return function(n,r){var i=r||t.getNormalMatrix(n),o=this.coplanarPoint(e).applyMatrix4(n),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Qt.prototype,{set:function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],l=n[6],c=n[7],f=n[8],d=n[9],h=n[10],p=n[11],g=n[12],m=n[13],v=n[14],y=n[15];return t[0].setComponents(a-r,c-s,p-f,y-g).normalize(),t[1].setComponents(a+r,c+s,p+f,y+g).normalize(),t[2].setComponents(a+i,c+u,p+d,y+m).normalize(),t[3].setComponents(a-i,c-u,p-d,y-m).normalize(),t[4].setComponents(a-o,c-l,p-h,y-v).normalize(),t[5].setComponents(a+o,c+l,p+h,y+v).normalize(),this},intersectsObject:function(){var e=new Zt;return function(t){var n=t.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),e.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new Zt;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(){var e=new zt;return function(t){for(var n=this.planes,r=0;r<6;r++){var i=n[r];if(e.x=i.normal.x>0?t.max.x:t.min.x,e.y=i.normal.y>0?t.max.y:t.min.y,e.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(e)<0)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var en={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n"},tn={merge:function(e){for(var t={},n=0;n<e.length;n++){var r=this.clone(e[n]);for(var i in r)t[i]=r[i]}return t},clone:function(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}},nn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function rn(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}Object.assign(rn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function e(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}return function(t,n,r){if(t=It.euclideanModulo(t,1),n=It.clamp(n,0,1),r=It.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,o=2*r-i;this.r=e(o,i,t+1/3),this.g=e(o,i,t),this.b=e(o,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var l,c=(l=n[1]).length;if(3===c)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(l=nn[e])?this.setHex(l):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),u=(s+a)/2;if(s===a)t=0,n=0;else{var l=a-s;switch(n=u<=.5?l/(a+s):l/(2-a-s),a){case r:t=(i-o)/l+(i<o?6:0);break;case i:t=(o-r)/l+2;break;case o:t=(r-i)/l+4}t/=6}return e.h=t,e.s=n,e.l=u,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var e={};return function(t,n,r){return this.getHSL(e),e.h+=t,e.s+=n,e.l+=r,this.setHSL(e.h,e.s,e.l),this}}(),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var on={common:{diffuse:{value:new rn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Vt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ft(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new rn(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new rn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Vt}},sprite:{diffuse:{value:new rn(15658734)},opacity:{value:1},center:{value:new Ft(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new Vt}}},an={basic:{uniforms:tn.merge([on.common,on.specularmap,on.envmap,on.aomap,on.lightmap,on.fog]),vertexShader:en.meshbasic_vert,fragmentShader:en.meshbasic_frag},lambert:{uniforms:tn.merge([on.common,on.specularmap,on.envmap,on.aomap,on.lightmap,on.emissivemap,on.fog,on.lights,{emissive:{value:new rn(0)}}]),vertexShader:en.meshlambert_vert,fragmentShader:en.meshlambert_frag},phong:{uniforms:tn.merge([on.common,on.specularmap,on.envmap,on.aomap,on.lightmap,on.emissivemap,on.bumpmap,on.normalmap,on.displacementmap,on.gradientmap,on.fog,on.lights,{emissive:{value:new rn(0)},specular:{value:new rn(1118481)},shininess:{value:30}}]),vertexShader:en.meshphong_vert,fragmentShader:en.meshphong_frag},standard:{uniforms:tn.merge([on.common,on.envmap,on.aomap,on.lightmap,on.emissivemap,on.bumpmap,on.normalmap,on.displacementmap,on.roughnessmap,on.metalnessmap,on.fog,on.lights,{emissive:{value:new rn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:en.meshphysical_vert,fragmentShader:en.meshphysical_frag},points:{uniforms:tn.merge([on.points,on.fog]),vertexShader:en.points_vert,fragmentShader:en.points_frag},dashed:{uniforms:tn.merge([on.common,on.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:en.linedashed_vert,fragmentShader:en.linedashed_frag},depth:{uniforms:tn.merge([on.common,on.displacementmap]),vertexShader:en.depth_vert,fragmentShader:en.depth_frag},normal:{uniforms:tn.merge([on.common,on.bumpmap,on.normalmap,on.displacementmap,{opacity:{value:1}}]),vertexShader:en.normal_vert,fragmentShader:en.normal_frag},sprite:{uniforms:tn.merge([on.sprite,on.fog]),vertexShader:en.sprite_vert,fragmentShader:en.sprite_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:en.cube_vert,fragmentShader:en.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:en.equirect_vert,fragmentShader:en.equirect_frag},distanceRGBA:{uniforms:tn.merge([on.common,on.displacementmap,{referencePosition:{value:new zt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:en.distanceRGBA_vert,fragmentShader:en.distanceRGBA_frag},shadow:{uniforms:tn.merge([on.lights,on.fog,{color:{value:new rn(0)},opacity:{value:1}}]),vertexShader:en.shadow_vert,fragmentShader:en.shadow_frag}};function sn(){var e=null,t=!1,n=null;function r(i,o){!1!==t&&(n(i,o),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function un(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=t.get(n);void 0===i?t.set(n,function(t,n){var r=t.array,i=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,o=e.createBuffer();e.bindBuffer(n,o),e.bufferData(n,r,i),t.onUploadCallback();var a=e.FLOAT;return r instanceof Float32Array?a=e.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=e.UNSIGNED_SHORT:r instanceof Int16Array?a=e.SHORT:r instanceof Uint32Array?a=e.UNSIGNED_INT:r instanceof Int32Array?a=e.INT:r instanceof Int8Array?a=e.BYTE:r instanceof Uint8Array&&(a=e.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(n,r)):i.version<n.version&&(function(t,n,r){var i=n.array,o=n.updateRange;e.bindBuffer(r,t),!1===n.dynamic?e.bufferData(r,i,e.STATIC_DRAW):-1===o.count?e.bufferSubData(r,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(r,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,n,r),i.version=n.version)}}}function ln(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||ln.DefaultOrder}function cn(){this.mask=1}an.physical={uniforms:tn.merge([an.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:en.meshphysical_vert,fragmentShader:en.meshphysical_frag},ln.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ln.DefaultOrder="XYZ",Object.defineProperties(ln.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(ln.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=It.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],u=i[1],l=i[5],c=i[9],f=i[2],d=i[6],h=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,h),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-f,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-f,h),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===t?(this._y=Math.asin(-r(f,-1,1)),Math.abs(f)<.99999?(this._x=Math.atan2(d,h),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,l))):"YZX"===t?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(s,h))):"XZY"===t?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,l),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,h),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new Bt;return function(t,n,r){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,r)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new Ut;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new zt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(cn.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var fn=0;function dn(){Object.defineProperty(this,"id",{value:fn++}),this.uuid=It.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=dn.DefaultUp.clone();var e=new zt,t=new ln,n=new Ut,r=new zt(1,1,1);t.onChange(function(){n.setFromEuler(t,!1)}),n.onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new Bt},normalMatrix:{value:new Vt}}),this.matrix=new Bt,this.matrixWorld=new Bt,this.matrixAutoUpdate=dn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new cn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function hn(){dn.call(this),this.type="Camera",this.matrixWorldInverse=new Bt,this.projectionMatrix=new Bt}function pn(e,t,n,r,i,o){hn.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function gn(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new zt,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new rn,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}dn.DefaultUp=new zt(0,1,0),dn.DefaultMatrixAutoUpdate=!0,dn.prototype=Object.assign(Object.create(r.prototype),{constructor:dn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new Ut;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new Ut;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new zt(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new zt(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new zt(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new zt;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translateX:function(){var e=new zt(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new zt(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new zt(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new Bt;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new Bt,t=new zt;return function(n,r,i){n.isVector3?t.copy(n):t.set(n,r,i),this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new zt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new zt,t=new zt;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),n=new Ut),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,n,t),n}}(),getWorldScale:function(){var e=new zt,t=new Ut;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new zt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(){var e=new Ut;return function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new zt),this.getWorldQuaternion(e),t.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,u=a.length;s<u;s++){var l=a[s];i(e.shapes,l)}else i(e.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,u=this.material.length;s<u;s++)c.push(i(e.materials,this.material[s]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object)}if(t){var f=g(e.geometries),d=g(e.materials),h=g(e.textures),p=g(e.images);a=g(e.shapes);f.length>0&&(n.geometries=f),d.length>0&&(n.materials=d),h.length>0&&(n.textures=h),p.length>0&&(n.images=p),a.length>0&&(n.shapes=a)}return n.object=r,n;function g(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}),hn.prototype=Object.assign(Object.create(dn.prototype),{constructor:hn,isCamera:!0,copy:function(e,t){return dn.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new Ut;return function(t){return void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new zt),this.getWorldQuaternion(e),t.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){dn.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),pn.prototype=Object.assign(Object.create(hn.prototype),{constructor:pn,isOrthographicCamera:!0,copy:function(e,t){return hn.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,o=n+e,a=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,f=(this.top-this.bottom)/this.view.height;o=(i+=c*(this.view.offsetX/u))+c*(this.view.width/u),s=(a-=f*(this.view.offsetY/l))-f*(this.view.height/l)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far)},toJSON:function(e){var t=dn.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Object.assign(gn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var mn=0;function vn(){Object.defineProperty(this,"id",{value:mn+=2}),this.uuid=It.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function yn(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function _n(e,t,n){yn.call(this,new Int8Array(e),t,n)}function bn(e,t,n){yn.call(this,new Uint8Array(e),t,n)}function wn(e,t,n){yn.call(this,new Uint8ClampedArray(e),t,n)}function xn(e,t,n){yn.call(this,new Int16Array(e),t,n)}function En(e,t,n){yn.call(this,new Uint16Array(e),t,n)}function Mn(e,t,n){yn.call(this,new Int32Array(e),t,n)}function Cn(e,t,n){yn.call(this,new Uint32Array(e),t,n)}function Tn(e,t,n){yn.call(this,new Float32Array(e),t,n)}function Sn(e,t,n){yn.call(this,new Float64Array(e),t,n)}function On(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function kn(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}vn.prototype=Object.assign(Object.create(r.prototype),{constructor:vn,isGeometry:!0,applyMatrix:function(e){for(var t=(new Vt).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(e)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new Bt;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Bt;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Bt;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Bt;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new Bt;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new dn;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,r=e.attributes,i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var l=[],c=[],f=[],d=0,h=0;d<i.length;d+=3,h+=2)t.vertices.push(new zt(i[d],i[d+1],i[d+2])),void 0!==o&&l.push(new zt(o[d],o[d+1],o[d+2])),void 0!==a&&t.colors.push(new rn(a[d],a[d+1],a[d+2])),void 0!==s&&c.push(new Ft(s[h],s[h+1])),void 0!==u&&f.push(new Ft(u[h],u[h+1]));function p(e,n,r,i){var d=new gn(e,n,r,void 0!==o?[l[e].clone(),l[n].clone(),l[r].clone()]:[],void 0!==a?[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()]:[],i);t.faces.push(d),void 0!==s&&t.faceVertexUvs[0].push([c[e].clone(),c[n].clone(),c[r].clone()]),void 0!==u&&t.faceVertexUvs[1].push([f[e].clone(),f[n].clone(),f[r].clone()])}var g=e.groups;if(g.length>0)for(d=0;d<g.length;d++)for(var m=g[d],v=m.start,y=(h=v,v+m.count);h<y;h+=3)void 0!==n?p(n[h],n[h+1],n[h+2],m.materialIndex):p(h,h+1,h+2,m.materialIndex);else if(void 0!==n)for(d=0;d<n.length;d+=3)p(n[d],n[d+1],n[d+2]);else for(d=0;d<i.length/3;d+=3)p(d,d+1,d+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){var e=new zt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new Bt;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var e=new zt,t=new zt,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)a[t]=new zt;if(e){var s,u,l,c=new zt,f=new zt;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],u=this.vertices[o.b],l=this.vertices[o.c],c.subVectors(l,u),f.subVectors(s,u),c.cross(f),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,n=this.vertices.length;t<n;t++)a[t].normalize();for(r=0,i=this.faces.length;r<i;r++){var d=(o=this.faces[r]).vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new vn;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)u=new zt,l={a:new zt,b:new zt,c:new zt},a.push(u),s.push(l)}var u,l,c=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],u=c.faceNormals[n],l=c.vertexNormals[n],u.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Jt),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Zt),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,u=e.faces,l=this.faceVertexUvs[0],c=e.faceVertexUvs[0],f=this.colors,d=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new Vt).getNormalMatrix(t));for(var h=0,p=a.length;h<p;h++){var g=a[h].clone();void 0!==t&&g.applyMatrix4(t),o.push(g)}for(h=0,p=d.length;h<p;h++)f.push(d[h].clone());for(h=0,p=u.length;h<p;h++){var m,v,y,_=u[h],b=_.vertexNormals,w=_.vertexColors;(m=new gn(_.a+i,_.b+i,_.c+i)).normal.copy(_.normal),void 0!==r&&m.normal.applyMatrix3(r).normalize();for(var x=0,E=b.length;x<E;x++)v=b[x].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),m.vertexNormals.push(v);m.color.copy(_.color);for(x=0,E=w.length;x<E;x++)y=w[x],m.vertexColors.push(y.clone());m.materialIndex=_.materialIndex+n,s.push(m)}for(h=0,p=c.length;h<p;h++){var M=c[h],C=[];if(void 0!==M){for(x=0,E=M.length;x<E;x++)C.push(M[x].clone());l.push(C)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,r,i,o,a,s,u={},l=[],c=[],f=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)e=this.vertices[n],void 0===u[t=Math.round(e.x*f)+"_"+Math.round(e.y*f)+"_"+Math.round(e.z*f)]?(u[t]=n,l.push(this.vertices[n]),c[n]=l.length-1):c[n]=c[u[t]];var d=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var h=0;h<3;h++)if(o[h]===o[(h+1)%3]){d.push(n);break}}for(n=d.length-1;n>=0;n--){var p=d[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var g=this.vertices.length-l.length;return this.vertices=l,g},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new zt(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(r=[]),a&&a.length===t&&(i=[]);for(n=0;n<t;n++){var s=e[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],u={},l=[],c={},f=[],d={};for(i=0;i<this.faces.length;i++){var h=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],g=h.normal.length()>0,m=h.vertexNormals.length>0,v=1!==h.color.r||1!==h.color.g||1!==h.color.b,y=h.vertexColors.length>0,_=0;if(_=E(_=E(_=E(_=E(_=E(_=E(_=E(_=E(_,0,0),1,!0),2,!1),3,p),4,g),5,m),6,v),7,y),a.push(_),a.push(h.a,h.b,h.c),a.push(h.materialIndex),p){var b=this.faceVertexUvs[0][i];a.push(T(b[0]),T(b[1]),T(b[2]))}if(g&&a.push(M(h.normal)),m){var w=h.vertexNormals;a.push(M(w[0]),M(w[1]),M(w[2]))}if(v&&a.push(C(h.color)),y){var x=h.vertexColors;a.push(C(x[0]),C(x[1]),C(x[2]))}}function E(e,t,n){return n?e|1<<t:e&~(1<<t)}function M(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==u[t]?u[t]:(u[t]=s.length/3,s.push(e.x,e.y,e.z),u[t])}function C(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]?c[t]:(c[t]=l.length,l.push(e.getHex()),c[t])}function T(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=f.length/2,f.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=r,e.data.normals=s,l.length>0&&(e.data.colors=l),f.length>0&&(e.data.uvs=[f]),e.data.faces=a,e},clone:function(){return(new vn).copy(this)},copy:function(e){var t,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var u=e.colors;for(t=0,n=u.length;t<n;t++)this.colors.push(u[t].clone());var l=e.faces;for(t=0,n=l.length;t<n;t++)this.faces.push(l[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,i=c.length;r<i;r++){var f=c[r],d=[];for(o=0,a=f.length;o<a;o++){var h=f[o];d.push(h.clone())}this.faceVertexUvs[t].push(d)}}var p=e.morphTargets;for(t=0,n=p.length;t<n;t++){var g={};if(g.name=p[t].name,void 0!==p[t].vertices)for(g.vertices=[],r=0,i=p[t].vertices.length;r<i;r++)g.vertices.push(p[t].vertices[r].clone());if(void 0!==p[t].normals)for(g.normals=[],r=0,i=p[t].normals.length;r<i;r++)g.normals.push(p[t].normals[r].clone());this.morphTargets.push(g)}var m=e.morphNormals;for(t=0,n=m.length;t<n;t++){var v={};if(void 0!==m[t].vertexNormals)for(v.vertexNormals=[],r=0,i=m[t].vertexNormals.length;r<i;r++){var y=m[t].vertexNormals[r],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==m[t].faceNormals)for(v.faceNormals=[],r=0,i=m[t].faceNormals.length;r<i;r++)v.faceNormals.push(m[t].faceNormals[r].clone());this.morphNormals.push(v)}var b=e.skinWeights;for(t=0,n=b.length;t<n;t++)this.skinWeights.push(b[t].clone());var w=e.skinIndices;for(t=0,n=w.length;t<n;t++)this.skinIndices.push(w[t].clone());var x=e.lineDistances;for(t=0,n=x.length;t<n;t++)this.lineDistances.push(x[t]);var E=e.boundingBox;null!==E&&(this.boundingBox=E.clone());var M=e.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(yn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(yn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new rn),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Ft),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new zt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Wt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),_n.prototype=Object.create(yn.prototype),_n.prototype.constructor=_n,bn.prototype=Object.create(yn.prototype),bn.prototype.constructor=bn,wn.prototype=Object.create(yn.prototype),wn.prototype.constructor=wn,xn.prototype=Object.create(yn.prototype),xn.prototype.constructor=xn,En.prototype=Object.create(yn.prototype),En.prototype.constructor=En,Mn.prototype=Object.create(yn.prototype),Mn.prototype.constructor=Mn,Cn.prototype=Object.create(yn.prototype),Cn.prototype.constructor=Cn,Tn.prototype=Object.create(yn.prototype),Tn.prototype.constructor=Tn,Sn.prototype=Object.create(yn.prototype),Sn.prototype.constructor=Sn,Object.assign(On.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:r})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=e.morphTargets,u=s.length;if(u>0){t=[];for(var l=0;l<u;l++)t[l]=[];this.morphTargets.position=t}var c,f=e.morphNormals,d=f.length;if(d>0){c=[];for(l=0;l<d;l++)c[l]=[];this.morphTargets.normal=c}var h=e.skinIndices,p=e.skinWeights,g=h.length===r.length,m=p.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(l=0;l<n.length;l++){var v=n[l];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var _=v.normal;this.normals.push(_,_,_)}var b,w=v.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var x=v.color;this.colors.push(x,x,x)}if(!0===o)void 0!==(b=i[0][l])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new Ft,new Ft,new Ft));if(!0===a)void 0!==(b=i[1][l])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new Ft,new Ft,new Ft));for(var E=0;E<u;E++){var M=s[E].vertices;t[E].push(M[v.a],M[v.b],M[v.c])}for(E=0;E<d;E++){var C=f[E].vertexNormals[l];c[E].push(C.a,C.b,C.c)}g&&this.skinIndices.push(h[v.a],h[v.b],h[v.c]),m&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var An=1;function Pn(){Object.defineProperty(this,"id",{value:An+=2}),this.uuid=It.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Rn(e,t,n,r,i,o){vn.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Ln(e,t,n,r,i,o)),this.mergeVertices()}function Ln(e,t,n,r,i,o){Pn.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var a=this;e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1;var s=[],u=[],l=[],c=[],f=0,d=0;function h(e,t,n,r,i,o,h,p,g,m,v){var y,_,b=o/g,w=h/m,x=o/2,E=h/2,M=p/2,C=g+1,T=m+1,S=0,O=0,k=new zt;for(_=0;_<T;_++){var A=_*w-E;for(y=0;y<C;y++){var P=y*b-x;k[e]=P*r,k[t]=A*i,k[n]=M,u.push(k.x,k.y,k.z),k[e]=0,k[t]=0,k[n]=p>0?1:-1,l.push(k.x,k.y,k.z),c.push(y/g),c.push(1-_/m),S+=1}}for(_=0;_<m;_++)for(y=0;y<g;y++){var R=f+y+C*_,L=f+y+C*(_+1),j=f+(y+1)+C*(_+1),D=f+(y+1)+C*_;s.push(R,L,D),s.push(L,j,D),O+=6}a.addGroup(d,O,v),d+=O,f+=S}h("z","y","x",-1,-1,n,t,e,o=Math.floor(o)||1,i,0),h("z","y","x",1,-1,n,t,-e,o,i,1),h("x","z","y",1,1,e,n,t,r,o,2),h("x","z","y",1,-1,e,n,-t,r,o,3),h("x","y","z",1,-1,e,t,n,r,i,4),h("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.addAttribute("position",new Tn(u,3)),this.addAttribute("normal",new Tn(l,3)),this.addAttribute("uv",new Tn(c,2))}function jn(e,t,n,r){vn.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Dn(e,t,n,r)),this.mergeVertices()}function Dn(e,t,n,r){Pn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};var i,o,a=(e=e||1)/2,s=(t=t||1)/2,u=Math.floor(n)||1,l=Math.floor(r)||1,c=u+1,f=l+1,d=e/u,h=t/l,p=[],g=[],m=[],v=[];for(o=0;o<f;o++){var y=o*h-s;for(i=0;i<c;i++){var _=i*d-a;g.push(_,-y,0),m.push(0,0,1),v.push(i/u),v.push(1-o/l)}}for(o=0;o<l;o++)for(i=0;i<u;i++){var b=i+c*o,w=i+c*(o+1),x=i+1+c*(o+1),E=i+1+c*o;p.push(b,w,E),p.push(w,x,E)}this.setIndex(p),this.addAttribute("position",new Tn(g,3)),this.addAttribute("normal",new Tn(m,3)),this.addAttribute("uv",new Tn(v,2))}Pn.prototype=Object.assign(Object.create(r.prototype),{constructor:Pn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(kn(e)>65535?Cn:En)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new yn(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new Vt).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new Bt;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Bt;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Bt;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Bt;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new Bt;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new dn;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new zt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new Tn(3*t.vertices.length,3),r=new Tn(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new Tn(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Tn(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new On).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new yn(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new yn(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(3*e.colors.length);this.addAttribute("color",new yn(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new yn(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new yn(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],u=e.morphTargets[a],l=0,c=u.length;l<c;l++){var f=u[l],d=new Tn(3*f.length,3);s.push(d.copyVector3sArray(f))}this.morphAttributes[a]=s}if(e.skinIndices.length>0){var h=new Tn(4*e.skinIndices.length,4);this.addAttribute("skinIndex",h.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new Tn(4*e.skinWeights.length,4);this.addAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Jt);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new Jt,t=new zt;return function(){null===this.boundingSphere&&(this.boundingSphere=new Zt);var n=this.attributes.position;if(n){var r=this.boundingSphere.center;e.setFromBufferAttribute(n),e.getCenter(r);for(var i=0,o=0,a=n.count;o<a;o++)t.x=n.getX(o),t.y=n.getY(o),t.z=n.getZ(o),i=Math.max(i,r.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,n=this.groups;if(t.position){var r=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new yn(new Float32Array(r.length),3));else for(var i=t.normal.array,o=0,a=i.length;o<a;o++)i[o]=0;var s,u,l,c=t.normal.array,f=new zt,d=new zt,h=new zt,p=new zt,g=new zt;if(e){var m=e.array;0===n.length&&this.addGroup(0,m.length);for(var v=0,y=n.length;v<y;++v){var _=n[v],b=_.start;for(o=b,a=b+_.count;o<a;o+=3)s=3*m[o+0],u=3*m[o+1],l=3*m[o+2],f.fromArray(r,s),d.fromArray(r,u),h.fromArray(r,l),p.subVectors(h,d),g.subVectors(f,d),p.cross(g),c[s]+=p.x,c[s+1]+=p.y,c[s+2]+=p.z,c[u]+=p.x,c[u+1]+=p.y,c[u+2]+=p.z,c[l]+=p.x,c[l+1]+=p.y,c[l+2]+=p.z}}else for(o=0,a=r.length;o<a;o+=9)f.fromArray(r,o),d.fromArray(r,o+3),h.fromArray(r,o+6),p.subVectors(h,d),g.subVectors(f,d),p.cross(g),c[o]=p.x,c[o+1]=p.y,c[o+2]=p.z,c[o+3]=p.x,c[o+4]=p.y,c[o+5]=p.z,c[o+6]=p.x,c[o+7]=p.y,c[o+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,o=e.attributes[r],a=o.array,s=0,u=o.itemSize*t;s<a.length;s++,u++)i[u]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new zt;return function(){for(var t=this.attributes.normal,n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.normalize(),t.setXYZ(n,e.x,e.y,e.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Pn,t=this.index.array,n=this.attributes;for(var r in n){for(var i=n[r],o=i.array,a=i.itemSize,s=new o.constructor(t.length*a),u=0,l=0,c=0,f=t.length;c<f;c++){u=t[c]*a;for(var d=0;d<a;d++)s[l++]=o[u++]}e.addAttribute(r,new yn(s,a))}var h=this.groups;for(c=0,f=h.length;c<f;c++){var p=h[c];e.addGroup(p.start,p.count,p.materialIndex)}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;if(null!==r){var i=Array.prototype.slice.call(r.array);e.data.index={type:r.array.constructor.name,array:i}}var o=this.attributes;for(var n in o){var a=o[n];i=Array.prototype.slice.call(a.array);e.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var u=this.boundingSphere;return null!==u&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e},clone:function(){return(new Pn).copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var u=[],l=s[t];for(n=0,r=l.length;n<r;n++)u.push(l[n].clone());this.morphAttributes[t]=u}var c=e.groups;for(n=0,r=c.length;n<r;n++){var f=c[n];this.addGroup(f.start,f.count,f.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var h=e.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Rn.prototype=Object.create(vn.prototype),Rn.prototype.constructor=Rn,Ln.prototype=Object.create(Pn.prototype),Ln.prototype.constructor=Ln,jn.prototype=Object.create(vn.prototype),jn.prototype.constructor=jn,Dn.prototype=Object.create(Pn.prototype),Dn.prototype.constructor=Dn;var Nn=0;function In(){Object.defineProperty(this,"id",{value:Nn++}),this.uuid=It.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=M,this.side=g,this.flatShading=!1,this.vertexColors=b,this.opacity=1,this.transparent=!1,this.blendSrc=F,this.blendDst=B,this.blendEquation=k,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Y,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Fn(e){In.call(this),this.type="MeshBasicMaterial",this.color=new rn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Bn(e){In.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Un(e,t){this.origin=void 0!==e?e:new zt,this.direction=void 0!==t?t:new zt}function zn(e,t,n){this.a=void 0!==e?e:new zt,this.b=void 0!==t?t:new zt,this.c=void 0!==n?n:new zt}function Vn(e,t){dn.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Pn,this.material=void 0!==t?t:new Fn({color:16777215*Math.random()}),this.drawMode=xt,this.updateMorphTargets()}function Hn(e,t){return Math.abs(t[1])-Math.abs(e[1])}function qn(e,t,n,r,i,o,a,s,u,l){e=void 0!==e?e:[],t=void 0!==t?t:ue,Gt.call(this,e,t,n,r,i,o,a,s,u,l),this.flipY=!1}In.prototype=Object.assign(Object.create(r.prototype),{constructor:In,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]="overdraw"===t?Number(n):n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===y;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==M&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==g&&(n.side=this.side),this.vertexColors!==b&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Fn.prototype=Object.create(In.prototype),Fn.prototype.constructor=Fn,Fn.prototype.isMeshBasicMaterial=!0,Fn.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Bn.prototype=Object.create(In.prototype),Bn.prototype.constructor=Bn,Bn.prototype.isShaderMaterial=!0,Bn.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=tn.clone(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Bn.prototype.toJSON=function(e){var t=In.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(Un.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new zt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new zt;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new zt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new zt;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new zt,t=new zt,n=new zt;return function(r,i,o,a){e.copy(r).add(i).multiplyScalar(.5),t.copy(i).sub(r).normalize(),n.copy(this.origin).sub(e);var s,u,l,c,f=.5*r.distanceTo(i),d=-this.direction.dot(t),h=n.dot(this.direction),p=-n.dot(t),g=n.lengthSq(),m=Math.abs(1-d*d);if(m>0)if(u=d*h-p,c=f*m,(s=d*p-h)>=0)if(u>=-c)if(u<=c){var v=1/m;l=(s*=v)*(s+d*(u*=v)+2*h)+u*(d*s+u+2*p)+g}else u=f,l=-(s=Math.max(0,-(d*u+h)))*s+u*(u+2*p)+g;else u=-f,l=-(s=Math.max(0,-(d*u+h)))*s+u*(u+2*p)+g;else u<=-c?l=-(s=Math.max(0,-(-d*f+h)))*s+(u=s>0?-f:Math.min(Math.max(-f,-p),f))*(u+2*p)+g:u<=c?(s=0,l=(u=Math.min(Math.max(-f,-p),f))*(u+2*p)+g):l=-(s=Math.max(0,-(d*f+h)))*s+(u=s>0?f:Math.min(Math.max(-f,-p),f))*(u+2*p)+g;else u=d>0?-f:f,l=-(s=Math.max(0,-(d*u+h)))*s+u*(u+2*p)+g;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(t).multiplyScalar(u).add(e),l}}(),intersectSphere:function(){var e=new zt;return function(t,n){e.subVectors(t.center,this.origin);var r=e.dot(this.direction),i=e.dot(e)-r*r,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=r-a,u=r+a;return s<0&&u<0?null:s<0?this.at(u,n):this.at(s,n)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,o,a,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,f=this.origin;return u>=0?(n=(e.min.x-f.x)*u,r=(e.max.x-f.x)*u):(n=(e.max.x-f.x)*u,r=(e.min.x-f.x)*u),l>=0?(i=(e.min.y-f.y)*l,o=(e.max.y-f.y)*l):(i=(e.max.y-f.y)*l,o=(e.min.y-f.y)*l),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),c>=0?(a=(e.min.z-f.z)*c,s=(e.max.z-f.z)*c):(a=(e.max.z-f.z)*c,s=(e.min.z-f.z)*c),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},intersectsBox:function(){var e=new zt;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new zt,t=new zt,n=new zt,r=new zt;return function(i,o,a,s,u){t.subVectors(o,i),n.subVectors(a,i),r.crossVectors(t,n);var l,c=this.direction.dot(r);if(c>0){if(s)return null;l=1}else{if(!(c<0))return null;l=-1,c=-c}e.subVectors(this.origin,i);var f=l*this.direction.dot(n.crossVectors(e,n));if(f<0)return null;var d=l*this.direction.dot(t.cross(e));if(d<0)return null;if(f+d>c)return null;var h=-l*e.dot(r);return h<0?null:this.at(h/c,u)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(zn,{getNormal:function(){var e=new zt;return function(t,n,r,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new zt),i.subVectors(r,n),e.subVectors(t,n),i.cross(e);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}}(),getBarycoord:function(){var e=new zt,t=new zt,n=new zt;return function(r,i,o,a,s){e.subVectors(a,i),t.subVectors(o,i),n.subVectors(r,i);var u=e.dot(e),l=e.dot(t),c=e.dot(n),f=t.dot(t),d=t.dot(n),h=u*f-l*l;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new zt),0===h)return s.set(-2,-1,-1);var p=1/h,g=(f*c-l*d)*p,m=(u*d-l*c)*p;return s.set(1-g-m,m,g)}}(),containsPoint:function(){var e=new zt;return function(t,n,r,i){return zn.getBarycoord(t,n,r,i,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}()}),Object.assign(zn.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new zt,t=new zt;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new zt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return zn.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new zt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return zn.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return zn.containsPoint(e,this.a,this.b,this.c)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var e=new zt,t=new zt,n=new zt,r=new zt,i=new zt,o=new zt;return function(a,s){void 0===s&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),s=new zt);var u,l,c=this.a,f=this.b,d=this.c;e.subVectors(f,c),t.subVectors(d,c),r.subVectors(a,c);var h=e.dot(r),p=t.dot(r);if(h<=0&&p<=0)return s.copy(c);i.subVectors(a,f);var g=e.dot(i),m=t.dot(i);if(g>=0&&m<=g)return s.copy(f);var v=h*m-g*p;if(v<=0&&h>=0&&g<=0)return u=h/(h-g),s.copy(c).addScaledVector(e,u);o.subVectors(a,d);var y=e.dot(o),_=t.dot(o);if(_>=0&&y<=_)return s.copy(d);var b=y*p-h*_;if(b<=0&&p>=0&&_<=0)return l=p/(p-_),s.copy(c).addScaledVector(t,l);var w=g*_-y*m;if(w<=0&&m-g>=0&&y-_>=0)return n.subVectors(d,f),l=(m-g)/(m-g+(y-_)),s.copy(f).addScaledVector(n,l);var x=1/(w+b+v);return u=b*x,l=v*x,s.copy(c).addScaledVector(e,u).addScaledVector(t,l)}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Vn.prototype=Object.assign(Object.create(dn.prototype),{constructor:Vn,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return dn.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)n=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}},raycast:function(){var e=new Bt,t=new Un,n=new Zt,r=new zt,i=new zt,o=new zt,a=new zt,s=new zt,u=new zt,l=new Ft,c=new Ft,f=new Ft,d=new zt,h=new zt,p=new zt;function g(e,t,n,r,i,o,a){return zn.getBarycoord(e,t,n,r,d),i.multiplyScalar(d.x),o.multiplyScalar(d.y),a.multiplyScalar(d.z),i.add(o).add(a),i.clone()}function y(e,t,n,r,i,o,a,s){if(null===(t.side===m?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,t.side!==v,s)))return null;p.copy(s),p.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(p);return u<n.near||u>n.far?null:{distance:u,point:p.clone(),object:e}}function _(e,t,n,a,s,u,d,p,m){r.fromBufferAttribute(s,d),i.fromBufferAttribute(s,p),o.fromBufferAttribute(s,m);var v=y(e,t,n,a,r,i,o,h);if(v){u&&(l.fromBufferAttribute(u,d),c.fromBufferAttribute(u,p),f.fromBufferAttribute(u,m),v.uv=g(h,r,i,o,l,c,f));var _=new gn(d,p,m);zn.getNormal(r,i,o,_.normal),v.face=_}return v}return function(d,p){var m,v=this.geometry,b=this.material,w=this.matrixWorld;if(void 0!==b&&(null===v.boundingSphere&&v.computeBoundingSphere(),n.copy(v.boundingSphere),n.applyMatrix4(w),!1!==d.ray.intersectsSphere(n)&&(e.getInverse(w),t.copy(d.ray).applyMatrix4(e),null===v.boundingBox||!1!==t.intersectsBox(v.boundingBox))))if(v.isBufferGeometry){var x,E,M,C,T,S,O,k,A,P=v.index,R=v.attributes.position,L=v.attributes.uv,j=v.groups,D=v.drawRange;if(null!==P)if(Array.isArray(b))for(C=0,S=j.length;C<S;C++)for(A=b[(k=j[C]).materialIndex],T=Math.max(k.start,D.start),O=Math.min(k.start+k.count,D.start+D.count);T<O;T+=3)x=P.getX(T),E=P.getX(T+1),M=P.getX(T+2),(m=_(this,A,d,t,R,L,x,E,M))&&(m.faceIndex=Math.floor(T/3),p.push(m));else for(C=Math.max(0,D.start),S=Math.min(P.count,D.start+D.count);C<S;C+=3)x=P.getX(C),E=P.getX(C+1),M=P.getX(C+2),(m=_(this,b,d,t,R,L,x,E,M))&&(m.faceIndex=Math.floor(C/3),p.push(m));else if(void 0!==R)if(Array.isArray(b))for(C=0,S=j.length;C<S;C++)for(A=b[(k=j[C]).materialIndex],T=Math.max(k.start,D.start),O=Math.min(k.start+k.count,D.start+D.count);T<O;T+=3)(m=_(this,A,d,t,R,L,x=T,E=T+1,M=T+2))&&(m.faceIndex=Math.floor(T/3),p.push(m));else for(C=Math.max(0,D.start),S=Math.min(R.count,D.start+D.count);C<S;C+=3)(m=_(this,b,d,t,R,L,x=C,E=C+1,M=C+2))&&(m.faceIndex=Math.floor(C/3),p.push(m))}else if(v.isGeometry){var N,I,F,B,U=Array.isArray(b),z=v.vertices,V=v.faces,H=v.faceVertexUvs[0];H.length>0&&(B=H);for(var q=0,G=V.length;q<G;q++){var W=V[q],X=U?b[W.materialIndex]:b;if(void 0!==X){if(N=z[W.a],I=z[W.b],F=z[W.c],!0===X.morphTargets){var Y=v.morphTargets,$=this.morphTargetInfluences;r.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var J=0,Z=Y.length;J<Z;J++){var K=$[J];if(0!==K){var Q=Y[J].vertices;r.addScaledVector(a.subVectors(Q[W.a],N),K),i.addScaledVector(s.subVectors(Q[W.b],I),K),o.addScaledVector(u.subVectors(Q[W.c],F),K)}}r.add(N),i.add(I),o.add(F),N=r,I=i,F=o}if(m=y(this,X,d,t,N,I,F,h)){if(B&&B[q]){var ee=B[q];l.copy(ee[0]),c.copy(ee[1]),f.copy(ee[2]),m.uv=g(h,N,I,F,l,c,f)}m.face=W,m.faceIndex=q,p.push(m)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),qn.prototype=Object.create(Gt.prototype),qn.prototype.constructor=qn,qn.prototype.isCubeTexture=!0,Object.defineProperty(qn.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Gn=new Gt,Wn=new qn;function Xn(){this.seq=[],this.map={}}var Yn=[],$n=[],Jn=new Float32Array(16),Zn=new Float32Array(9),Kn=new Float32Array(4);function Qn(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,o=Yn[i];if(void 0===o&&(o=new Float32Array(i),Yn[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function er(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function tr(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function nr(e,t){var n=$n[t];void 0===n&&(n=new Int32Array(t),$n[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocTextureUnit();return n}function rr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function ir(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function or(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(er(n,t))return;e.uniform2fv(this.addr,t),tr(n,t)}}function ar(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(er(n,t))return;e.uniform3fv(this.addr,t),tr(n,t)}}function sr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(er(n,t))return;e.uniform4fv(this.addr,t),tr(n,t)}}function ur(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(er(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),tr(n,t)}else{if(er(n,r))return;Kn.set(r),e.uniformMatrix2fv(this.addr,!1,Kn),tr(n,r)}}function lr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(er(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),tr(n,t)}else{if(er(n,r))return;Zn.set(r),e.uniformMatrix3fv(this.addr,!1,Zn),tr(n,r)}}function cr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(er(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),tr(n,t)}else{if(er(n,r))return;Jn.set(r),e.uniformMatrix4fv(this.addr,!1,Jn),tr(n,r)}}function fr(e,t,n){var r=this.cache,i=n.allocTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||Gn,i)}function dr(e,t,n){var r=this.cache,i=n.allocTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||Wn,i)}function hr(e,t){var n=this.cache;er(n,t)||(e.uniform2iv(this.addr,t),tr(n,t))}function pr(e,t){var n=this.cache;er(n,t)||(e.uniform3iv(this.addr,t),tr(n,t))}function gr(e,t){var n=this.cache;er(n,t)||(e.uniform4iv(this.addr,t),tr(n,t))}function mr(e,t){var n=this.cache;er(n,t)||(e.uniform1fv(this.addr,t),tr(n,t))}function vr(e,t){var n=this.cache;er(n,t)||(e.uniform1iv(this.addr,t),tr(n,t))}function yr(e,t){var n=this.cache,r=Qn(t,this.size,2);er(n,r)||(e.uniform2fv(this.addr,r),this.updateCache(r))}function _r(e,t){var n=this.cache,r=Qn(t,this.size,3);er(n,r)||(e.uniform3fv(this.addr,r),this.updateCache(r))}function br(e,t){var n=this.cache,r=Qn(t,this.size,4);er(n,r)||(e.uniform4fv(this.addr,r),this.updateCache(r))}function wr(e,t){var n=this.cache,r=Qn(t,this.size,4);er(n,r)||(e.uniformMatrix2fv(this.addr,!1,r),this.updateCache(r))}function xr(e,t){var n=this.cache,r=Qn(t,this.size,9);er(n,r)||(e.uniformMatrix3fv(this.addr,!1,r),this.updateCache(r))}function Er(e,t){var n=this.cache,r=Qn(t,this.size,16);er(n,r)||(e.uniformMatrix4fv(this.addr,!1,r),this.updateCache(r))}function Mr(e,t,n){var r=this.cache,i=t.length,o=nr(n,i);!1===er(r,o)&&(e.uniform1iv(this.addr,o),tr(r,o));for(var a=0;a!==i;++a)n.setTexture2D(t[a]||Gn,o[a])}function Cr(e,t,n){var r=this.cache,i=t.length,o=nr(n,i);!1===er(r,o)&&(e.uniform1iv(this.addr,o),tr(r,o));for(var a=0;a!==i;++a)n.setTextureCube(t[a]||Wn,o[a])}function Tr(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return rr;case 35664:return or;case 35665:return ar;case 35666:return sr;case 35674:return ur;case 35675:return lr;case 35676:return cr;case 35678:case 36198:return fr;case 35680:return dr;case 5124:case 35670:return ir;case 35667:case 35671:return hr;case 35668:case 35672:return pr;case 35669:case 35673:return gr}}(t.type)}function Sr(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return mr;case 35664:return yr;case 35665:return _r;case 35666:return br;case 35674:return wr;case 35675:return xr;case 35676:return Er;case 35678:return Mr;case 35680:return Cr;case 5124:case 35670:return vr;case 35667:case 35671:return hr;case 35668:case 35672:return pr;case 35669:case 35673:return gr}}(t.type)}function Or(e){this.id=e,Xn.call(this)}Sr.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),tr(t,e)},Or.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(e,t[a.id],n)}};var kr=/([\w\d_]+)(\])?(\[|\.)?/g;function Ar(e,t){e.seq.push(t),e.map[t.id]=t}function Pr(e,t,n){var r=e.name,i=r.length;for(kr.lastIndex=0;;){var o=kr.exec(r),a=kr.lastIndex,s=o[1],u="]"===o[2],l=o[3];if(u&&(s|=0),void 0===l||"["===l&&a+2===i){Ar(n,void 0===l?new Tr(s,e,t):new Sr(s,e,t));break}var c=n.map[s];void 0===c&&Ar(n,c=new Or(s)),n=c}}function Rr(e,t,n){Xn.call(this),this.renderer=n;for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=e.getActiveUniform(t,i);Pr(o,e.getUniformLocation(t,o.name),this)}}function Lr(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),!1===e.getShaderParameter(r,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(r),function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(n)),r}Rr.prototype.setValue=function(e,t,n){var r=this.map[t];void 0!==r&&r.setValue(e,n,this.renderer)},Rr.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Rr.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},Rr.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var jr=0;function Dr(e){switch(e){case Ct:return["Linear","( value )"];case Tt:return["sRGB","( value )"];case Ot:return["RGBE","( value )"];case At:return["RGBM","( value, 7.0 )"];case Pt:return["RGBM","( value, 16.0 )"];case Rt:return["RGBD","( value, 256.0 )"];case St:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Nr(e,t){var n=Dr(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Ir(e){return""!==e}function Fr(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Br(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function Ur(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(e,t){var n=en[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Ur(n)})}function zr(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,n,r){for(var i="",o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function Vr(e,t,n,r,i,o,a){var s=e.context,u=r.defines,l=i.vertexShader,c=i.fragmentShader,f="SHADOWMAP_TYPE_BASIC";o.shadowMapType===h?f="SHADOWMAP_TYPE_PCF":o.shadowMapType===p&&(f="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",g="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case ue:case le:d="ENVMAP_TYPE_CUBE";break;case he:case pe:d="ENVMAP_TYPE_CUBE_UV";break;case ce:case fe:d="ENVMAP_TYPE_EQUIREC";break;case de:d="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case le:case fe:g="ENVMAP_MODE_REFRACTION"}switch(r.combine){case Q:m="ENVMAP_BLENDING_MULTIPLY";break;case ee:m="ENVMAP_BLENDING_MIX";break;case te:m="ENVMAP_BLENDING_ADD"}}var v,y,_=e.gammaFactor>0?e.gammaFactor:1,b=a.isWebGL2?"":function(e,t,n){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ir).join("\n")}(r.extensions,o,t),w=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(u),x=s.createProgram();if(r.isRawShaderMaterial?((v=[w].filter(Ir).join("\n")).length>0&&(v+="\n"),(y=[b,w].filter(Ir).join("\n")).length>0&&(y+="\n")):(v=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,w,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+_,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+g:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+f:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ir).join("\n"),y=[b,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,w,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+_,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.envMap?"#define "+g:"",o.envMap?"#define "+m:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+f:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==ne?"#define TONE_MAPPING":"",o.toneMapping!==ne?en.tonemapping_pars_fragment:"",o.toneMapping!==ne?function(e,t){var n;switch(t){case re:n="Linear";break;case ie:n="Reinhard";break;case oe:n="Uncharted2";break;case ae:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?en.encodings_pars_fragment:"",o.mapEncoding?Nr("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?Nr("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Nr("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?function(e,t){var n=Dr(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Ir).join("\n")),l=Br(l=Fr(l=Ur(l),o),o),c=Br(c=Fr(c=Ur(c),o),o),l=zr(l),c=zr(c),a.isWebGL2&&!r.isRawShaderMaterial){var E=!1,M=/^\s*#version\s+300\s+es\s*\n/;r.isShaderMaterial&&null!==l.match(M)&&null!==c.match(M)&&(E=!0,l=l.replace(M,""),c=c.replace(M,"")),v=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,y=["#version 300 es\n","#define varying in",E?"":"out highp vec4 pc_fragColor;",E?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y}var C=v+l,T=y+c,S=Lr(s,s.VERTEX_SHADER,C),O=Lr(s,s.FRAGMENT_SHADER,T);s.attachShader(x,S),s.attachShader(x,O),void 0!==r.index0AttributeName?s.bindAttribLocation(x,0,r.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(x,0,"position"),s.linkProgram(x);var k,A,P=s.getProgramInfoLog(x).trim(),R=s.getShaderInfoLog(S).trim(),L=s.getShaderInfoLog(O).trim(),j=!0,D=!0;return!1===s.getProgramParameter(x,s.LINK_STATUS)?(j=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(x,s.VALIDATE_STATUS),"gl.getProgramInfoLog",P,R,L)):""!==P?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",P):""!==R&&""!==L||(D=!1),D&&(this.diagnostics={runnable:j,material:r,programLog:P,vertexShader:{log:R,prefix:v},fragmentShader:{log:L,prefix:y}}),s.deleteShader(S),s.deleteShader(O),this.getUniforms=function(){return void 0===k&&(k=new Rr(s,x,e)),k},this.getAttributes=function(){return void 0===A&&(A=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=e.getActiveAttrib(t,i).name;n[o]=e.getAttribLocation(t,o)}return n}(s,x)),A},this.destroy=function(){s.deleteProgram(x),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=jr++,this.code=n,this.usedTimes=1,this.program=x,this.vertexShader=S,this.fragmentShader=O,this}function Hr(e,t,n){var r=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function a(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=Ct,n===Ct&&t&&(n=St),n}this.getParameters=function(t,r,o,s,u,l,c){var f=i[t.type],d=c.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),o=Math.min(i,t.length);return o<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+o+"."),0):o}(c):0,h=n.precision;null!==t.precision&&(h=n.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",h,"instead.");var p=e.getRenderTarget();return{shaderID:f,precision:h,supportsVertexTextures:n.vertexTextures,outputEncoding:a(p?p.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:a(t.map,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:a(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===he||t.envMap.mapping===pe),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:a(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===Nt,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!s,useFog:t.fog,fogExp:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:t.skinning&&d>0,maxBones:d,useVertexTexture:n.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:u,numClipIntersection:l,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.receiveShadow&&o.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===v,flipSided:t.side===m,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)r.push(i),r.push(t.defines[i]);for(var a=0;a<o.length;a++)r.push(n[o[a]]);return r.push(t.onBeforeCompile.toString()),r.push(e.gammaOutput),r.join()},this.acquireProgram=function(i,o,a,s){for(var u,l=0,c=r.length;l<c;l++){var f=r[l];if(f.code===s){++(u=f).usedTimes;break}}return void 0===u&&(u=new Vr(e,t,s,i,o,a,n),r.push(u)),u},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=r.indexOf(e);r[t]=r[r.length-1],r.pop(),e.destroy()}},this.programs=r}function qr(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Gr(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Wr(){var e={};return{get:function(t,n){var r=t.id+","+n.id,i=e[r];return void 0===i&&(i=new function(){var e=[],t=0,n=[],r=[];return{opaque:n,transparent:r,init:function(){t=0,n.length=0,r.length=0},push:function(i,o,a,s,u){var l=e[t];void 0===l?(l={id:i.id,object:i,geometry:o,material:a,program:a.program,renderOrder:i.renderOrder,z:s,group:u},e[t]=l):(l.id=i.id,l.object=i,l.geometry=o,l.material=a,l.program=a.program,l.renderOrder=i.renderOrder,l.z=s,l.group=u),(!0===a.transparent?r:n).push(l),t++},sort:function(){n.length>1&&n.sort(qr),r.length>1&&r.sort(Gr)}}},e[r]=i),i},dispose:function(){e={}}}}var Xr,Yr=0;function $r(){var e=new function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new zt,color:new rn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ft};break;case"SpotLight":n={position:new zt,direction:new zt,color:new rn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ft};break;case"PointLight":n={position:new zt,color:new rn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ft,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new zt,skyColor:new rn,groundColor:new rn};break;case"RectAreaLight":n={color:new rn,position:new zt,halfWidth:new zt,halfHeight:new zt}}return e[t.id]=n,n}}},t={id:Yr++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new zt,r=new Bt,i=new Bt;return{setup:function(o,a,s){for(var u=0,l=0,c=0,f=0,d=0,h=0,p=0,g=0,m=s.matrixWorldInverse,v=0,y=o.length;v<y;v++){var _=o[v],b=_.color,w=_.intensity,x=_.distance,E=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)u+=b.r*w,l+=b.g*w,c+=b.b*w;else if(_.isDirectionalLight){if((C=e.get(_)).color.copy(_.color).multiplyScalar(_.intensity),C.direction.setFromMatrixPosition(_.matrixWorld),n.setFromMatrixPosition(_.target.matrixWorld),C.direction.sub(n),C.direction.transformDirection(m),C.shadow=_.castShadow,_.castShadow){var M=_.shadow;C.shadowBias=M.bias,C.shadowRadius=M.radius,C.shadowMapSize=M.mapSize}t.directionalShadowMap[f]=E,t.directionalShadowMatrix[f]=_.shadow.matrix,t.directional[f]=C,f++}else if(_.isSpotLight)(C=e.get(_)).position.setFromMatrixPosition(_.matrixWorld),C.position.applyMatrix4(m),C.color.copy(b).multiplyScalar(w),C.distance=x,C.direction.setFromMatrixPosition(_.matrixWorld),n.setFromMatrixPosition(_.target.matrixWorld),C.direction.sub(n),C.direction.transformDirection(m),C.coneCos=Math.cos(_.angle),C.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),C.decay=0===_.distance?0:_.decay,C.shadow=_.castShadow,_.castShadow&&(M=_.shadow,C.shadowBias=M.bias,C.shadowRadius=M.radius,C.shadowMapSize=M.mapSize),t.spotShadowMap[h]=E,t.spotShadowMatrix[h]=_.shadow.matrix,t.spot[h]=C,h++;else if(_.isRectAreaLight)(C=e.get(_)).color.copy(b).multiplyScalar(w),C.position.setFromMatrixPosition(_.matrixWorld),C.position.applyMatrix4(m),i.identity(),r.copy(_.matrixWorld),r.premultiply(m),i.extractRotation(r),C.halfWidth.set(.5*_.width,0,0),C.halfHeight.set(0,.5*_.height,0),C.halfWidth.applyMatrix4(i),C.halfHeight.applyMatrix4(i),t.rectArea[p]=C,p++;else if(_.isPointLight)(C=e.get(_)).position.setFromMatrixPosition(_.matrixWorld),C.position.applyMatrix4(m),C.color.copy(_.color).multiplyScalar(_.intensity),C.distance=_.distance,C.decay=0===_.distance?0:_.decay,C.shadow=_.castShadow,_.castShadow&&(M=_.shadow,C.shadowBias=M.bias,C.shadowRadius=M.radius,C.shadowMapSize=M.mapSize,C.shadowCameraNear=M.camera.near,C.shadowCameraFar=M.camera.far),t.pointShadowMap[d]=E,t.pointShadowMatrix[d]=_.shadow.matrix,t.point[d]=C,d++;else if(_.isHemisphereLight){var C;(C=e.get(_)).direction.setFromMatrixPosition(_.matrixWorld),C.direction.transformDirection(m),C.direction.normalize(),C.skyColor.copy(_.color).multiplyScalar(w),C.groundColor.copy(_.groundColor).multiplyScalar(w),t.hemi[g]=C,g++}}t.ambient[0]=u,t.ambient[1]=l,t.ambient[2]=c,t.directional.length=f,t.spot.length=h,t.rectArea.length=p,t.point.length=d,t.hemi.length=g,t.hash.stateID=t.id,t.hash.directionalLength=f,t.hash.pointLength=d,t.hash.spotLength=h,t.hash.rectAreaLength=p,t.hash.hemiLength=g,t.hash.shadowsLength=a.length},state:t}}function Jr(){var e=new $r,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function Zr(e){In.call(this),this.type="MeshDepthMaterial",this.depthPacking=Lt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function Kr(e){In.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new zt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Qr(e,t,n){for(var r=new Qt,i=new Bt,o=new Ft,a=new Ft(n,n),s=new zt,u=new zt,l=1,c=2,f=1+(l|c),d=new Array(f),p=new Array(f),y={},_={0:m,1:g,2:v},b=[new zt(1,0,0),new zt(-1,0,0),new zt(0,0,1),new zt(0,0,-1),new zt(0,1,0),new zt(0,-1,0)],w=[new zt(0,1,0),new zt(0,1,0),new zt(0,1,0),new zt(0,1,0),new zt(0,0,1),new zt(0,0,-1)],x=[new Wt,new Wt,new Wt,new Wt,new Wt,new Wt],E=0;E!==f;++E){var M=0!=(E&l),C=0!=(E&c),T=new Zr({depthPacking:jt,morphTargets:M,skinning:C});d[E]=T;var S=new Kr({morphTargets:M,skinning:C});p[E]=S}var O=this;function k(t,n,r,i,o,a){var s=t.geometry,u=null,f=d,h=t.customDepthMaterial;if(r&&(f=p,h=t.customDistanceMaterial),h)u=h;else{var g=!1;n.morphTargets&&(s&&s.isBufferGeometry?g=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(g=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var m=t.isSkinnedMesh&&n.skinning,v=0;g&&(v|=l),m&&(v|=c),u=f[v]}if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var b=u.uuid,w=n.uuid,x=y[b];void 0===x&&(x={},y[b]=x);var E=x[w];void 0===E&&(E=u.clone(),x[w]=E),u=E}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=null!=n.shadowSide?n.shadowSide:_[n.side],u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,r&&u.isMeshDistanceMaterial&&(u.referencePosition.copy(i),u.nearDistance=o,u.farDistance=a),u}function A(n,i,o,a){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var s=t.update(n),l=n.material;if(Array.isArray(l))for(var c=s.groups,f=0,d=c.length;f<d;f++){var h=c[f],p=l[h.materialIndex];if(p&&p.visible){var g=k(n,p,a,u,o.near,o.far);e.renderBufferDirect(o,null,s,g,n,h)}}else if(l.visible){g=k(n,l,a,u,o.near,o.far);e.renderBufferDirect(o,null,s,g,n,null)}}for(var m=n.children,v=0,y=m.length;v<y;v++)A(m[v],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=h,this.render=function(t,n,l){if(!1!==O.enabled&&(!1!==O.autoUpdate||!1!==O.needsUpdate)&&0!==t.length){var c,f=e.context,d=e.state;d.disable(f.BLEND),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var h=0,p=t.length;h<p;h++){var g=t[h],m=g.shadow,v=g&&g.isPointLight;if(void 0!==m){var y=m.camera;if(o.copy(m.mapSize),o.min(a),v){var _=o.x,E=o.y;x[0].set(2*_,E,_,E),x[1].set(0,E,_,E),x[2].set(3*_,E,_,E),x[3].set(_,E,_,E),x[4].set(3*_,0,_,E),x[5].set(_,0,_,E),o.x*=4,o.y*=2}if(null===m.map){var M={minFilter:ye,magFilter:ye,format:Fe};m.map=new Xt(o.x,o.y,M),m.map.texture.name=g.name+".shadowMap",y.updateProjectionMatrix()}m.isSpotLightShadow&&m.update(g);var C=m.map,T=m.matrix;u.setFromMatrixPosition(g.matrixWorld),y.position.copy(u),v?(c=6,T.makeTranslation(-u.x,-u.y,-u.z)):(c=1,s.setFromMatrixPosition(g.target.matrixWorld),y.lookAt(s),y.updateMatrixWorld(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(y.projectionMatrix),T.multiply(y.matrixWorldInverse)),e.setRenderTarget(C),e.clear();for(var S=0;S<c;S++){if(v){s.copy(y.position),s.add(b[S]),y.up.copy(w[S]),y.lookAt(s),y.updateMatrixWorld();var k=x[S];d.viewport(k)}i.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),r.setFromMatrix(i),A(n,l,y,v)}}else console.warn("THREE.WebGLShadowMap:",g,"has no shadow.")}O.needsUpdate=!1}}}function ei(e,t,n,r,i,o,a){var s,u={};function l(e,t){if(e.width>t||e.height>t){if("data"in e)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+e.width+"x"+e.height+").");var n=t/Math.max(e.width,e.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.width=Math.floor(e.width*n),r.height=Math.floor(e.height*n),r.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+r.width+"x"+r.height),r}return e}function c(e){return It.isPowerOfTwo(e.width)&&It.isPowerOfTwo(e.height)}function f(e,t){return e.generateMipmaps&&t&&e.minFilter!==ye&&e.minFilter!==we}function d(t,n,i,o){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function h(t,n){if(!i.isWebGL2)return t;if(t===e.RGB){if(n===e.FLOAT)return e.RGB32F;if(n===e.HALF_FLOAT)return e.RGB16F;if(n===e.UNSIGNED_BYTE)return e.RGB8}if(t===e.RGBA){if(n===e.FLOAT)return e.RGBA32F;if(n===e.HALF_FLOAT)return e.RGBA16F;if(n===e.UNSIGNED_BYTE)return e.RGBA8}return t}function p(t){return t===ye||t===_e||t===be?e.NEAREST:e.LINEAR}function g(t){var n=t.target;n.removeEventListener("dispose",g),function(t){var n=r.get(t);if(t.image&&n.__image__webglTextureCube)e.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture)}r.remove(t)}(n),n.isVideoTexture&&delete u[n.id],a.memory.textures--}function m(t){var n=t.target;n.removeEventListener("dispose",m),function(t){var n=r.get(t),i=r.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[o]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(t.texture),r.remove(t)}(n),a.memory.textures--}function v(t,p){var m=r.get(t);if(t.isVideoTexture&&function(e){var t=e.id,n=a.render.frame;u[t]!==n&&(u[t]=n,e.update())}(t),t.version>0&&m.__version!==t.version){var v=t.image;if(void 0===v)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==v.complete)return void function(t,r,u){void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",g),t.__webglTexture=e.createTexture(),a.memory.textures++);n.activeTexture(e.TEXTURE0+u),n.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,r.unpackAlignment);var p=l(r.image,i.maxTextureSize);(function(e){return!i.isWebGL2&&(e.wrapS!==me||e.wrapT!==me||e.minFilter!==ye&&e.minFilter!==we)})(r)&&!1===c(p)&&(p=function(e){return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap?(void 0===s&&(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),s.width=It.floorPowerOfTwo(e.width),s.height=It.floorPowerOfTwo(e.height),s.getContext("2d").drawImage(e,0,0,s.width,s.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+s.width+"x"+s.height),s):e}(p));var m=c(p),v=o.convert(r.format),_=o.convert(r.type),b=h(v,_);y(e.TEXTURE_2D,r,m);var w,x=r.mipmaps;if(r.isDepthTexture){if(b=e.DEPTH_COMPONENT,r.type===Ae){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");b=e.DEPTH_COMPONENT32F}else i.isWebGL2&&(b=e.DEPTH_COMPONENT16);r.format===Ve&&b===e.DEPTH_COMPONENT&&r.type!==Se&&r.type!==ke&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Se,_=o.convert(r.type)),r.format===He&&(b=e.DEPTH_STENCIL,r.type!==De&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=De,_=o.convert(r.type))),n.texImage2D(e.TEXTURE_2D,0,b,p.width,p.height,0,v,_,null)}else if(r.isDataTexture)if(x.length>0&&m){for(var E=0,M=x.length;E<M;E++)w=x[E],n.texImage2D(e.TEXTURE_2D,E,b,w.width,w.height,0,v,_,w.data);r.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else n.texImage2D(e.TEXTURE_2D,0,b,p.width,p.height,0,v,_,p.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var E=0,M=x.length;E<M;E++)w=x[E],r.format!==Fe&&r.format!==Ie?n.getCompressedTextureFormats().indexOf(v)>-1?n.compressedTexImage2D(e.TEXTURE_2D,E,b,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,E,b,w.width,w.height,0,v,_,w.data);t.__maxMipLevel=x.length-1}else if(x.length>0&&m){for(var E=0,M=x.length;E<M;E++)w=x[E],n.texImage2D(e.TEXTURE_2D,E,b,v,_,w);r.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else n.texImage2D(e.TEXTURE_2D,0,b,v,_,p),t.__maxMipLevel=0;f(r,m)&&d(e.TEXTURE_2D,r,p.width,p.height);t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(m,t,p);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(e.TEXTURE0+p),n.bindTexture(e.TEXTURE_2D,m.__webglTexture)}function y(n,a,s){var u;if(s?(e.texParameteri(n,e.TEXTURE_WRAP_S,o.convert(a.wrapS)),e.texParameteri(n,e.TEXTURE_WRAP_T,o.convert(a.wrapT)),e.texParameteri(n,e.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),a.wrapS===me&&a.wrapT===me||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,p(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,p(a.minFilter)),a.minFilter!==ye&&a.minFilter!==we&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),u=t.get("EXT_texture_filter_anisotropic")){if(a.type===Ae&&null===t.get("OES_texture_float_linear"))return;if(a.type===Pe&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function _(t,i,a,s){var u=o.convert(i.texture.format),l=o.convert(i.texture.type),c=h(u,l);n.texImage2D(s,0,c,i.width,i.height,0,u,l,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function b(t,n){e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):n.depthBuffer&&n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,n.width,n.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function w(t){var n=r.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),v(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Ve)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(n.depthTexture.format!==He)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=e.createRenderbuffer(),b(n.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),b(n.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=v,this.setTextureCube=function(t,s){var u=r.get(t);if(6===t.image.length)if(t.version>0&&u.__version!==t.version){u.__image__webglTextureCube||(t.addEventListener("dispose",g),u.__image__webglTextureCube=e.createTexture(),a.memory.textures++),n.activeTexture(e.TEXTURE0+s),n.bindTexture(e.TEXTURE_CUBE_MAP,u.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var p=t&&t.isCompressedTexture,m=t.image[0]&&t.image[0].isDataTexture,v=[],_=0;_<6;_++)v[_]=p||m?m?t.image[_].image:t.image[_]:l(t.image[_],i.maxCubemapSize);var b=v[0],w=c(b),x=o.convert(t.format),E=o.convert(t.type),M=h(x,E);for(y(e.TEXTURE_CUBE_MAP,t,w),_=0;_<6;_++)if(p)for(var C,T=v[_].mipmaps,S=0,O=T.length;S<O;S++)C=T[S],t.format!==Fe&&t.format!==Ie?n.getCompressedTextureFormats().indexOf(x)>-1?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,S,M,C.width,C.height,0,C.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,S,M,C.width,C.height,0,x,E,C.data);else m?n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,M,v[_].width,v[_].height,0,x,E,v[_].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,M,x,E,v[_]);u.__maxMipLevel=p?T.length-1:0,f(t,w)&&d(e.TEXTURE_CUBE_MAP,t,b.width,b.height),u.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(e.TEXTURE0+s),n.bindTexture(e.TEXTURE_CUBE_MAP,u.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,i){n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,r.get(t).__webglTexture)},this.setupRenderTarget=function(t){var i=r.get(t),o=r.get(t.texture);t.addEventListener("dispose",m),o.__webglTexture=e.createTexture(),a.memory.textures++;var s=!0===t.isWebGLRenderTargetCube,u=c(t);if(s){i.__webglFramebuffer=[];for(var l=0;l<6;l++)i.__webglFramebuffer[l]=e.createFramebuffer()}else i.__webglFramebuffer=e.createFramebuffer();if(s){for(n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture),y(e.TEXTURE_CUBE_MAP,t.texture,u),l=0;l<6;l++)_(i.__webglFramebuffer[l],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+l);f(t.texture,u)&&d(e.TEXTURE_CUBE_MAP,t.texture,t.width,t.height),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else n.bindTexture(e.TEXTURE_2D,o.__webglTexture),y(e.TEXTURE_2D,t.texture,u),_(i.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),f(t.texture,u)&&d(e.TEXTURE_2D,t.texture,t.width,t.height),n.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&w(t)},this.updateRenderTargetMipmap=function(t){var i=t.texture;if(f(i,c(t))){var o=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=r.get(i).__webglTexture;n.bindTexture(o,a),d(o,i,t.width,t.height),n.bindTexture(o,null)}}}function ti(e,t,n){return{convert:function(r){var i;if(r===ge)return e.REPEAT;if(r===me)return e.CLAMP_TO_EDGE;if(r===ve)return e.MIRRORED_REPEAT;if(r===ye)return e.NEAREST;if(r===_e)return e.NEAREST_MIPMAP_NEAREST;if(r===be)return e.NEAREST_MIPMAP_LINEAR;if(r===we)return e.LINEAR;if(r===xe)return e.LINEAR_MIPMAP_NEAREST;if(r===Ee)return e.LINEAR_MIPMAP_LINEAR;if(r===Me)return e.UNSIGNED_BYTE;if(r===Re)return e.UNSIGNED_SHORT_4_4_4_4;if(r===Le)return e.UNSIGNED_SHORT_5_5_5_1;if(r===je)return e.UNSIGNED_SHORT_5_6_5;if(r===Ce)return e.BYTE;if(r===Te)return e.SHORT;if(r===Se)return e.UNSIGNED_SHORT;if(r===Oe)return e.INT;if(r===ke)return e.UNSIGNED_INT;if(r===Ae)return e.FLOAT;if(r===Pe){if(n.isWebGL2)return e.HALF_FLOAT;if(null!==(i=t.get("OES_texture_half_float")))return i.HALF_FLOAT_OES}if(r===Ne)return e.ALPHA;if(r===Ie)return e.RGB;if(r===Fe)return e.RGBA;if(r===Be)return e.LUMINANCE;if(r===Ue)return e.LUMINANCE_ALPHA;if(r===Ve)return e.DEPTH_COMPONENT;if(r===He)return e.DEPTH_STENCIL;if(r===k)return e.FUNC_ADD;if(r===A)return e.FUNC_SUBTRACT;if(r===P)return e.FUNC_REVERSE_SUBTRACT;if(r===j)return e.ZERO;if(r===D)return e.ONE;if(r===N)return e.SRC_COLOR;if(r===I)return e.ONE_MINUS_SRC_COLOR;if(r===F)return e.SRC_ALPHA;if(r===B)return e.ONE_MINUS_SRC_ALPHA;if(r===U)return e.DST_ALPHA;if(r===z)return e.ONE_MINUS_DST_ALPHA;if(r===V)return e.DST_COLOR;if(r===H)return e.ONE_MINUS_DST_COLOR;if(r===q)return e.SRC_ALPHA_SATURATE;if((r===qe||r===Ge||r===We||r===Xe)&&null!==(i=t.get("WEBGL_compressed_texture_s3tc"))){if(r===qe)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===Ge)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===We)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Xe)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((r===Ye||r===$e||r===Je||r===Ze)&&null!==(i=t.get("WEBGL_compressed_texture_pvrtc"))){if(r===Ye)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===$e)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Je)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Ze)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===Ke&&null!==(i=t.get("WEBGL_compressed_texture_etc1")))return i.COMPRESSED_RGB_ETC1_WEBGL;if((r===Qe||r===et||r===tt||r===nt||r===rt||r===it||r===ot||r===at||r===st||r===ut||r===lt||r===ct||r===ft||r===dt)&&null!==(i=t.get("WEBGL_compressed_texture_astc")))return r;if(r===R||r===L){if(n.isWebGL2){if(r===R)return e.MIN;if(r===L)return e.MAX}if(null!==(i=t.get("EXT_blend_minmax"))){if(r===R)return i.MIN_EXT;if(r===L)return i.MAX_EXT}}if(r===De){if(n.isWebGL2)return e.UNSIGNED_INT_24_8;if(null!==(i=t.get("WEBGL_depth_texture")))return i.UNSIGNED_INT_24_8_WEBGL}return 0}}}function ni(){dn.call(this),this.type="Group"}function ri(e,t,n,r){hn.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ii(e){ri.call(this),this.cameras=e||[]}function oi(e){var t=this,n=null,r=null,i=null,o=[],a=new Bt,s=new Bt;"undefined"!=typeof window&&"VRFrameData"in window&&(r=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",v,!1));var u=new Bt,l=new Ut,c=new zt,f=new ri;f.bounds=new Wt(0,0,.5,1),f.layers.enable(1);var d=new ri;d.bounds=new Wt(.5,0,.5,1),d.layers.enable(2);var h,p,g=new ii([f,d]);function m(){return null!==n&&!0===n.isPresenting}function v(){if(m()){var r=n.getEyeParameters("left"),i=r.renderWidth,o=r.renderHeight;p=e.getPixelRatio(),h=e.getSize(),e.setDrawingBufferSize(2*i,o,1),b.start()}else t.enabled&&(e.setDrawingBufferSize(h.width,h.height,p),b.stop())}g.layers.enable(1),g.layers.enable(2);var y=[];function _(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),n=0,r=0,i=t.length;n<i;n++){var o=t[n];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("Spatial Controller"))){if(r===e)return o;r++}}}this.enabled=!1,this.userHeight=1.6,this.getController=function(e){var t=o[e];return void 0===t&&((t=new ni).matrixAutoUpdate=!1,t.visible=!1,o[e]=t),t},this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e),b.setContext(e)},this.setPoseTarget=function(e){void 0!==e&&(i=e)},this.getCamera=function(e){if(null===n)return e.position.set(0,t.userHeight,0),e;n.depthNear=e.near,n.depthFar=e.far,n.getFrameData(r);var h=n.stageParameters;h?a.fromArray(h.sittingToStandingTransform):a.makeTranslation(0,t.userHeight,0);var p=r.pose,m=null!==i?i:e;if(m.matrix.copy(a),m.matrix.decompose(m.position,m.quaternion,m.scale),null!==p.orientation&&(l.fromArray(p.orientation),m.quaternion.multiply(l)),null!==p.position&&(l.setFromRotationMatrix(a),c.fromArray(p.position),c.applyQuaternion(l),m.position.add(c)),m.updateMatrixWorld(),!1===n.isPresenting)return e;f.near=e.near,d.near=e.near,f.far=e.far,d.far=e.far,g.matrixWorld.copy(e.matrixWorld),g.matrixWorldInverse.copy(e.matrixWorldInverse),f.matrixWorldInverse.fromArray(r.leftViewMatrix),d.matrixWorldInverse.fromArray(r.rightViewMatrix),s.getInverse(a),f.matrixWorldInverse.multiply(s),d.matrixWorldInverse.multiply(s);var v=m.parent;null!==v&&(u.getInverse(v.matrixWorld),f.matrixWorldInverse.multiply(u),d.matrixWorldInverse.multiply(u)),f.matrixWorld.getInverse(f.matrixWorldInverse),d.matrixWorld.getInverse(d.matrixWorldInverse),f.projectionMatrix.fromArray(r.leftProjectionMatrix),d.projectionMatrix.fromArray(r.rightProjectionMatrix),g.projectionMatrix.copy(f.projectionMatrix);var b=n.getLayers();if(b.length){var w=b[0];null!==w.leftBounds&&4===w.leftBounds.length&&f.bounds.fromArray(w.leftBounds),null!==w.rightBounds&&4===w.rightBounds.length&&d.bounds.fromArray(w.rightBounds)}return function(){for(var e=0;e<o.length;e++){var t=o[e],n=_(e);if(void 0!==n&&void 0!==n.pose){if(null===n.pose)return;var r=n.pose;!1===r.hasPosition&&t.position.set(.2,-.6,-.05),null!==r.position&&t.position.fromArray(r.position),null!==r.orientation&&t.quaternion.fromArray(r.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(a),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var i="Daydream Controller"===n.id?0:1;y[e]!==n.buttons[i].pressed&&(y[e]=n.buttons[i].pressed,!0===y[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),g},this.getStandingMatrix=function(){return a},this.isPresenting=m;var b=new sn;this.setAnimationLoop=function(e){b.setAnimationLoop(e)},this.submitFrame=function(){m()&&n.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",v)}}function ai(e){console.log("THREE.WebGLRenderer",i);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,o=void 0===e.depth||e.depth,l=void 0===e.stencil||e.stencil,c=void 0!==e.antialias&&e.antialias,f=void 0===e.premultipliedAlpha||e.premultipliedAlpha,d=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,h=void 0!==e.powerPreference?e.powerPreference:"default",p=null,g=null;this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=re,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var y,_,b,w,x,k,A,P,R,L,j,D,N,I,F,B,U,z,V=this,H=!1,q=null,Q=null,ee=null,te=-1,ne={geometry:null,program:null,wireframe:!1},ie=null,oe=null,ae=new Wt,se=new Wt,ue=null,le=0,ce=t.width,fe=t.height,de=1,he=new Wt(0,0,ce,fe),pe=new Wt(0,0,ce,fe),ge=!1,me=new Qt,ve=new function(){var e=this,t=null,n=0,r=!1,i=!1,o=new Kt,a=new Vt,s={value:null,needsUpdate:!1};function u(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function l(t,n,r,i){var u=null!==t?t.length:0,l=null;if(0!==u){if(l=s.value,!0!==i||null===l){var c=r+4*u,f=n.matrixWorldInverse;a.getNormalMatrix(f),(null===l||l.length<c)&&(l=new Float32Array(c));for(var d=0,h=r;d!==u;++d,h+=4)o.copy(t[d]).applyMatrix4(f,a),o.normal.toArray(l,h),l[h+3]=o.constant}s.value=l,s.needsUpdate=!0}return e.numPlanes=u,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,o){var a=0!==e.length||i||0!==n||r;return r=i,t=l(e,o,0),n=e.length,a},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,u()},this.setState=function(e,o,a,c,f,d){if(!r||null===e||0===e.length||i&&!a)i?l(null):u();else{var h=i?0:n,p=4*h,g=f.clippingState||null;s.value=g,g=l(e,c,p,d);for(var m=0;m!==p;++m)g[m]=t[m];f.clippingState=g,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=h}}},ye=!1,_e=!1,be=new Bt,we=new zt;function xe(){return null===Q?de:1}try{var Ee={alpha:r,depth:o,stencil:l,antialias:c,premultipliedAlpha:f,preserveDrawingBuffer:d,powerPreference:h};if(t.addEventListener("webglcontextlost",Oe,!1),t.addEventListener("webglcontextrestored",ke,!1),null===(y=n||t.getContext("webgl",Ee)||t.getContext("experimental-webgl",Ee)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===y.getShaderPrecisionFormat&&(y.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("THREE.WebGLRenderer: "+e.message)}function Ce(){_=new function(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=r,r}}}(y),(b=new function(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var u=!0===n.logarithmicDepthBuffer,l=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),c=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),h=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),g=e.getParameter(e.MAX_VARYING_VECTORS),m=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),v=c>0,y=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:l,maxVertexTextures:c,maxTextureSize:f,maxCubemapSize:d,maxAttributes:h,maxVertexUniforms:p,maxVaryings:g,maxFragmentUniforms:m,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y}}(y,_,e)).isWebGL2||(_.get("WEBGL_depth_texture"),_.get("OES_texture_float"),_.get("OES_texture_half_float"),_.get("OES_texture_half_float_linear"),_.get("OES_standard_derivatives"),_.get("OES_element_index_uint"),_.get("ANGLE_instanced_arrays")),_.get("OES_texture_float_linear"),z=new ti(y,_,b),(w=new function(e,t,n,r){var i=new function(){var t=!1,n=new Wt,r=null,i=new Wt(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,a,s){!0===s&&(t*=a,r*=a,o*=a),n.set(t,r,o,a),!1===i.equals(n)&&(e.clearColor(t,r,o,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(t){t?re(e.DEPTH_TEST):ie(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case G:e.depthFunc(e.NEVER);break;case W:e.depthFunc(e.ALWAYS);break;case X:e.depthFunc(e.LESS);break;case Y:e.depthFunc(e.LEQUAL);break;case $:e.depthFunc(e.EQUAL);break;case J:e.depthFunc(e.GEQUAL);break;case Z:e.depthFunc(e.GREATER);break;case K:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},l=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null;return{setTest:function(t){t?re(e.STENCIL_TEST):ie(e.STENCIL_TEST)},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&u===r||(e.stencilOp(t,n,r),a=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null}}},c=e.getParameter(e.MAX_VERTEX_ATTRIBS),f=new Uint8Array(c),d=new Uint8Array(c),h=new Uint8Array(c),p={},g=null,y=null,_=null,b=null,w=null,x=null,k=null,A=null,P=null,R=!1,L=null,j=null,D=null,N=null,I=null,F=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),B=!1,U=0,z=e.getParameter(e.VERSION);-1!==z.indexOf("WebGL")?(U=parseFloat(/^WebGL\ ([0-9])/.exec(z)[1]),B=U>=1):-1!==z.indexOf("OpenGL ES")&&(U=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(z)[1]),B=U>=2);var V=null,H={},q=new Wt,Q=new Wt;function ee(t,n,r){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var a=0;a<r;a++)e.texImage2D(n+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}var te={};function ne(n,i){f[n]=1,0===d[n]&&(e.enableVertexAttribArray(n),d[n]=1),h[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),h[n]=i)}function re(t){!0!==p[t]&&(e.enable(t),p[t]=!0)}function ie(t){!1!==p[t]&&(e.disable(t),p[t]=!1)}function oe(t,r,i,o,a,s,u,l){if(t!==E?re(e.BLEND):ie(e.BLEND),t!==O){if(t!==_||l!==R)switch(t){case C:l?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE));break;case T:l?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR));break;case S:l?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR));break;default:l?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA))}b=null,w=null,x=null,k=null,A=null,P=null}else a=a||r,s=s||i,u=u||o,r===b&&a===k||(e.blendEquationSeparate(n.convert(r),n.convert(a)),b=r,k=a),i===w&&o===x&&s===A&&u===P||(e.blendFuncSeparate(n.convert(i),n.convert(o),n.convert(s),n.convert(u)),w=i,x=o,A=s,P=u);_=t,R=l}function ae(t){L!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),L=t)}function se(t){t!==a?(re(e.CULL_FACE),t!==j&&(t===s?e.cullFace(e.BACK):t===u?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):ie(e.CULL_FACE),j=t}function ue(t,n,r){t?(re(e.POLYGON_OFFSET_FILL),N===n&&I===r||(e.polygonOffset(n,r),N=n,I=r)):ie(e.POLYGON_OFFSET_FILL)}function le(t){void 0===t&&(t=e.TEXTURE0+F-1),V!==t&&(e.activeTexture(t),V=t)}return te[e.TEXTURE_2D]=ee(e.TEXTURE_2D,e.TEXTURE_2D,1),te[e.TEXTURE_CUBE_MAP]=ee(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),i.setClear(0,0,0,1),o.setClear(1),l.setClear(0),re(e.DEPTH_TEST),o.setFunc(Y),ae(!1),se(s),re(e.CULL_FACE),re(e.BLEND),oe(M),{buffers:{color:i,depth:o,stencil:l},initAttributes:function(){for(var e=0,t=f.length;e<t;e++)f[e]=0},enableAttribute:function(e){ne(e,0)},enableAttributeAndDivisor:ne,disableUnusedAttributes:function(){for(var t=0,n=d.length;t!==n;++t)d[t]!==f[t]&&(e.disableVertexAttribArray(t),d[t]=0)},enable:re,disable:ie,getCompressedTextureFormats:function(){if(null===g&&(g=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var n=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)g.push(n[r]);return g},useProgram:function(t){return y!==t&&(e.useProgram(t),y=t,!0)},setBlending:oe,setMaterial:function(t,n){t.side===v?ie(e.CULL_FACE):re(e.CULL_FACE);var r=t.side===m;n&&(r=!r),ae(r),t.blending===M&&!1===t.transparent?oe(E):oe(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite),ue(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:ae,setCullFace:se,setLineWidth:function(t){t!==D&&(B&&e.lineWidth(t),D=t)},setPolygonOffset:ue,setScissorTest:function(t){t?re(e.SCISSOR_TEST):ie(e.SCISSOR_TEST)},activeTexture:le,bindTexture:function(t,n){null===V&&le();var r=H[V];void 0===r&&(r={type:void 0,texture:void 0},H[V]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||te[t]),r.type=t,r.texture=n)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===q.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),q.copy(t))},viewport:function(t){!1===Q.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),Q.copy(t))},reset:function(){for(var t=0;t<d.length;t++)1===d[t]&&(e.disableVertexAttribArray(t),d[t]=0);p={},g=null,V=null,H={},y=null,_=null,L=null,j=null,i.reset(),o.reset(),l.reset()}}}(y,_,z,b)).scissor(se.copy(pe).multiplyScalar(de)),w.viewport(ae.copy(he).multiplyScalar(de)),x=new function(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(i=i||1,t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.TRIANGLE_STRIP:case e.TRIANGLE_FAN:t.triangles+=i*(n-2);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}(y),k=new function(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}},A=new ei(y,_,w,k,b,z,x),P=new un(y),R=new function(e,t,n){var r={},i={};function o(e){var a=e.target,s=r[a.id];for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);a.removeEventListener("dispose",o),delete r[a.id];var l=i[s.id];l&&(t.remove(l),delete i[s.id]),n.memory.geometries--}return{get:function(e,t){var i=r[t.id];return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Pn).setFromObject(e)),i=t._bufferGeometry),r[t.id]=i,n.memory.geometries++,i)},update:function(n){var r=n.index,i=n.attributes;for(var o in null!==r&&t.update(r,e.ELEMENT_ARRAY_BUFFER),i)t.update(i[o],e.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],u=0,l=s.length;u<l;u++)t.update(s[u],e.ARRAY_BUFFER)},getWireframeAttribute:function(n){var r=i[n.id];if(r)return r;var o,a=[],s=n.index,u=n.attributes;if(null!==s)for(var l=0,c=(o=s.array).length;l<c;l+=3){var f=o[l+0],d=o[l+1],h=o[l+2];a.push(f,d,d,h,h,f)}else for(l=0,c=(o=u.position.array).length/3-1;l<c;l+=3)f=l+0,d=l+1,h=l+2,a.push(f,d,d,h,h,f);return r=new(kn(a)>65535?Cn:En)(a,1),t.update(r,e.ELEMENT_ARRAY_BUFFER),i[n.id]=r,r}}}(y,P,x),L=new function(e,t){var n={};return{update:function(r){var i=t.render.frame,o=r.geometry,a=e.get(r,o);return n[a.id]!==i&&(o.isGeometry&&a.updateFromObject(r),e.update(a),n[a.id]=i),a},dispose:function(){n={}}}}(R,x),F=new function(e){var t={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,u=s.length,l=t[i.id];if(void 0===l){l=[];for(var c=0;c<u;c++)l[c]=[c,0];t[i.id]=l}var f=o.morphTargets&&i.morphAttributes.position,d=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<u;c++)0!==(h=l[c])[1]&&(f&&i.removeAttribute("morphTarget"+c),d&&i.removeAttribute("morphNormal"+c));for(c=0;c<u;c++)(h=l[c])[0]=c,h[1]=s[c];for(l.sort(Hn),c=0;c<8;c++){var h;if(h=l[c]){var p=h[0],g=h[1];if(g){f&&i.addAttribute("morphTarget"+c,f[p]),d&&i.addAttribute("morphNormal"+c,d[p]),n[c]=g;continue}}n[c]=0}a.getUniforms().setValue(e,"morphTargetInfluences",n)}}}(y),j=new Hr(V,_,b),D=new Wr,N=new function(){var e={};return{get:function(t,n){var r;return void 0===e[t.id]?(r=new Jr,e[t.id]={},e[t.id][n.id]=r):void 0===e[t.id][n.id]?(r=new Jr,e[t.id][n.id]=r):r=e[t.id][n.id],r},dispose:function(){e={}}}},I=new function(e,t,n,r){var i,o,a,s=new rn(0),u=0;function l(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return s},setClearColor:function(e,t){s.set(e),l(s,u=void 0!==t?t:1)},getClearAlpha:function(){return u},setClearAlpha:function(e){l(s,u=e)},render:function(t,r,c,f){var d=r.background;null===d?l(s,u):d&&d.isColor&&(l(d,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),d&&d.isCubeTexture?(void 0===a&&((a=new Vn(new Ln(1,1,1),new Bn({uniforms:an.cube.uniforms,vertexShader:an.cube.vertexShader,fragmentShader:an.cube.fragmentShader,side:m,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(a)),a.material.uniforms.tCube.value=d,t.push(a,a.geometry,a.material,0,null)):d&&d.isTexture&&(void 0===i&&(i=new pn(-1,1,1,-1,0,1),o=new Vn(new Dn(2,2),new Fn({depthTest:!1,depthWrite:!1,fog:!1})),n.update(o)),o.material.map=d,e.renderBufferDirect(i,null,o.geometry,o.material,o,null))}}}(V,w,L,f),B=new function(e,t,n,r){var i;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i)},this.renderInstances=function(o,a,s){var u;if(r.isWebGL2)u=e;else if(null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[r.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,a,s,o.maxInstancedCount),n.update(s,i,o.maxInstancedCount)}}(y,_,x,b),U=new function(e,t,n,r){var i,o,a;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,o,t*a),n.update(r,i)},this.renderInstances=function(s,u,l){var c;if(r.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[r.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,l,o,u*a,s.maxInstancedCount),n.update(l,i,s.maxInstancedCount)}}(y,_,x,b),x.programs=j.programs,V.context=y,V.capabilities=b,V.extensions=_,V.properties=k,V.renderLists=D,V.state=w,V.info=x}Ce();var Te="xr"in navigator?new function(e){var t=e.context,n=null,r=null,i=null,o=null,a=[],s=[];function u(){return null!==r&&null!==i}var l=new ri;l.layers.enable(1),l.viewport=new Wt;var c=new ri;c.layers.enable(2),c.viewport=new Wt;var f=new ii([l,c]);function d(e){var t=a[s.indexOf(e.inputSource)];t&&t.dispatchEvent({type:e.type})}function h(){e.setFramebuffer(null),m.stop()}function p(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}f.layers.enable(1),f.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=a[e];return void 0===t&&((t=new ni).matrixAutoUpdate=!1,t.visible=!1,a[e]=t),t},this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e),e instanceof XRDevice&&t.setCompatibleXRDevice(e)},this.setSession=function(n,o){null!==(r=n)&&(r.addEventListener("select",d),r.addEventListener("selectstart",d),r.addEventListener("selectend",d),r.addEventListener("end",h),r.baseLayer=new XRWebGLLayer(r,t),r.requestFrameOfReference(o.frameOfReferenceType).then(function(t){i=t,e.setFramebuffer(r.baseLayer.framebuffer),m.setContext(r),m.start()}),s=r.getInputSources(),r.addEventListener("inputsourceschange",function(){s=r.getInputSources(),console.log(s)}))},this.getCamera=function(e){if(u()){var t=e.parent,n=f.cameras;p(f,t);for(var r=0;r<n.length;r++)p(n[r],t);e.matrixWorld.copy(f.matrixWorld);for(var i=e.children,o=(r=0,i.length);r<o;r++)i[r].updateMatrixWorld(!0);return f}return e},this.isPresenting=u;var g=null,m=new sn;m.setAnimationLoop(function(e,t){if(null!==(o=t.getDevicePose(i)))for(var n=r.baseLayer,u=t.views,l=0;l<u.length;l++){var c=u[l],d=n.getViewport(c),h=o.getViewMatrix(c),p=f.cameras[l];p.matrix.fromArray(h).getInverse(p.matrix),p.projectionMatrix.fromArray(c.projectionMatrix),p.viewport.set(d.x,d.y,d.width,d.height),0===l&&(f.matrix.copy(p.matrix),f.projectionMatrix.copy(p.projectionMatrix))}for(l=0;l<a.length;l++){var m=a[l],v=s[l];if(v){var y=t.getInputPose(v,i);if(null!==y){m.matrix.elements=y.pointerMatrix,m.matrix.decompose(m.position,m.rotation,m.scale),m.visible=!0;continue}}m.visible=!1}g&&g(e)}),this.setAnimationLoop=function(e){g=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new THREE.Matrix4},this.submitFrame=function(){}}(V):new oi(V);this.vr=Te;var Se=new Qr(V,L,b.maxTextureSize);function Oe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function ke(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1,Ce()}function Re(e){var t=e.target;t.removeEventListener("dispose",Re),function(e){Le(e),k.remove(e)}(t)}function Le(e){var t=k.get(e).program;e.program=void 0,void 0!==t&&j.releaseProgram(t)}this.shadowMap=Se,this.getContext=function(){return y},this.getContextAttributes=function(){return y.getContextAttributes()},this.forceContextLoss=function(){var e=_.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=_.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return de},this.setPixelRatio=function(e){void 0!==e&&(de=e,this.setSize(ce,fe,!1))},this.getSize=function(){return{width:ce,height:fe}},this.setSize=function(e,n,r){Te.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ce=e,fe=n,t.width=e*de,t.height=n*de,!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(){return{width:ce*de,height:fe*de}},this.setDrawingBufferSize=function(e,n,r){ce=e,fe=n,de=r,t.width=e*r,t.height=n*r,this.setViewport(0,0,e,n)},this.getCurrentViewport=function(){return ae},this.setViewport=function(e,t,n,r){he.set(e,fe-t-r,n,r),w.viewport(ae.copy(he).multiplyScalar(de))},this.setScissor=function(e,t,n,r){pe.set(e,fe-t-r,n,r),w.scissor(se.copy(pe).multiplyScalar(de))},this.setScissorTest=function(e){w.setScissorTest(ge=e)},this.getClearColor=function(){return I.getClearColor()},this.setClearColor=function(){I.setClearColor.apply(I,arguments)},this.getClearAlpha=function(){return I.getClearAlpha()},this.setClearAlpha=function(){I.setClearAlpha.apply(I,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=y.COLOR_BUFFER_BIT),(void 0===t||t)&&(r|=y.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=y.STENCIL_BUFFER_BIT),y.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,n,r){this.setRenderTarget(e),this.clear(t,n,r)},this.dispose=function(){t.removeEventListener("webglcontextlost",Oe,!1),t.removeEventListener("webglcontextrestored",ke,!1),D.dispose(),N.dispose(),k.dispose(),L.dispose(),Te.dispose(),De.stop()},this.renderBufferImmediate=function(e,t){w.initAttributes();var n=k.get(e);e.hasPositions&&!n.position&&(n.position=y.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=y.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=y.createBuffer()),e.hasColors&&!n.color&&(n.color=y.createBuffer());var r=t.getAttributes();e.hasPositions&&(y.bindBuffer(y.ARRAY_BUFFER,n.position),y.bufferData(y.ARRAY_BUFFER,e.positionArray,y.DYNAMIC_DRAW),w.enableAttribute(r.position),y.vertexAttribPointer(r.position,3,y.FLOAT,!1,0,0)),e.hasNormals&&(y.bindBuffer(y.ARRAY_BUFFER,n.normal),y.bufferData(y.ARRAY_BUFFER,e.normalArray,y.DYNAMIC_DRAW),w.enableAttribute(r.normal),y.vertexAttribPointer(r.normal,3,y.FLOAT,!1,0,0)),e.hasUvs&&(y.bindBuffer(y.ARRAY_BUFFER,n.uv),y.bufferData(y.ARRAY_BUFFER,e.uvArray,y.DYNAMIC_DRAW),w.enableAttribute(r.uv),y.vertexAttribPointer(r.uv,2,y.FLOAT,!1,0,0)),e.hasColors&&(y.bindBuffer(y.ARRAY_BUFFER,n.color),y.bufferData(y.ARRAY_BUFFER,e.colorArray,y.DYNAMIC_DRAW),w.enableAttribute(r.color),y.vertexAttribPointer(r.color,3,y.FLOAT,!1,0,0)),w.disableUnusedAttributes(),y.drawArrays(y.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,o){var a=i.isMesh&&i.normalMatrix.determinant()<0;w.setMaterial(r,a);var s=Ue(e,t,r,i),u=!1;ne.geometry===n.id&&ne.program===s.id&&ne.wireframe===(!0===r.wireframe)||(ne.geometry=n.id,ne.program=s.id,ne.wireframe=!0===r.wireframe,u=!0),i.morphTargetInfluences&&(F.update(i,n,r,s),u=!0);var l,c=n.index,f=n.attributes.position,d=1;!0===r.wireframe&&(c=R.getWireframeAttribute(n),d=2);var h=B;null!==c&&(l=P.get(c),(h=U).setIndex(l)),u&&(!function(e,t,n){if(n&&n.isInstancedBufferGeometry&!b.isWebGL2&&null===_.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");w.initAttributes();var r=n.attributes,i=t.getAttributes(),o=e.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var u=r[a];if(void 0!==u){var l=u.normalized,c=u.itemSize,f=P.get(u);if(void 0===f)continue;var d=f.buffer,h=f.type,p=f.bytesPerElement;if(u.isInterleavedBufferAttribute){var g=u.data,m=g.stride,v=u.offset;g&&g.isInstancedInterleavedBuffer?(w.enableAttributeAndDivisor(s,g.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=g.meshPerAttribute*g.count)):w.enableAttribute(s),y.bindBuffer(y.ARRAY_BUFFER,d),y.vertexAttribPointer(s,c,h,l,m*p,v*p)}else u.isInstancedBufferAttribute?(w.enableAttributeAndDivisor(s,u.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):w.enableAttribute(s),y.bindBuffer(y.ARRAY_BUFFER,d),y.vertexAttribPointer(s,c,h,l,0,0)}else if(void 0!==o){var x=o[a];if(void 0!==x)switch(x.length){case 2:y.vertexAttrib2fv(s,x);break;case 3:y.vertexAttrib3fv(s,x);break;case 4:y.vertexAttrib4fv(s,x);break;default:y.vertexAttrib1fv(s,x)}}}}w.disableUnusedAttributes()}(r,s,n),null!==c&&y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,l.buffer));var p=1/0;null!==c?p=c.count:void 0!==f&&(p=f.count);var g=n.drawRange.start*d,m=n.drawRange.count*d,v=null!==o?o.start*d:0,x=null!==o?o.count*d:1/0,E=Math.max(g,v),M=Math.min(p,g+m,v+x)-1,C=Math.max(0,M-E+1);if(0!==C){if(i.isMesh)if(!0===r.wireframe)w.setLineWidth(r.wireframeLinewidth*xe()),h.setMode(y.LINES);else switch(i.drawMode){case xt:h.setMode(y.TRIANGLES);break;case Et:h.setMode(y.TRIANGLE_STRIP);break;case Mt:h.setMode(y.TRIANGLE_FAN)}else if(i.isLine){var T=r.linewidth;void 0===T&&(T=1),w.setLineWidth(T*xe()),i.isLineSegments?h.setMode(y.LINES):i.isLineLoop?h.setMode(y.LINE_LOOP):h.setMode(y.LINE_STRIP)}else i.isPoints?h.setMode(y.POINTS):i.isSprite&&h.setMode(y.TRIANGLES);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&h.renderInstances(n,E,C):h.render(E,C)}},this.compile=function(e,t){(g=N.get(e,t)).init(),e.traverse(function(e){e.isLight&&(g.pushLight(e),e.castShadow&&g.pushShadow(e))}),g.setupLights(t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var n=0;n<t.material.length;n++)Be(t.material[n],e.fog,t);else Be(t.material,e.fog,t)})};var je=null;var De=new sn;function Ne(e,t,n,r){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,u=a.geometry,l=void 0===r?a.material:r,c=a.group;if(n.isArrayCamera){oe=n;for(var f=n.cameras,d=0,h=f.length;d<h;d++){var p=f[d];if(s.layers.test(p.layers)){if("viewport"in p)w.viewport(ae.copy(p.viewport));else{var g=p.bounds,m=g.x*ce,v=g.y*fe,y=g.z*ce,_=g.w*fe;w.viewport(ae.set(m,v,y,_).multiplyScalar(de))}Ie(s,t,p,u,l,c)}}}else oe=null,Ie(s,t,n,u,l,c)}}function Ie(e,t,n,r,i,o){if(e.onBeforeRender(V,t,n,r,i,o),g=N.get(t,oe||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){w.setMaterial(i);var a=Ue(n,t.fog,i,e);ne.geometry=null,ne.program=null,ne.wireframe=!1,function(e,t){e.render(function(e){V.renderBufferImmediate(e,t)})}(e,a)}else V.renderBufferDirect(n,t.fog,r,i,e,o);e.onAfterRender(V,t,n,r,i,o),g=N.get(t,oe||n)}function Be(e,t,n){var r=k.get(e),i=g.state.lights,o=g.state.shadowsArray,a=r.lightsHash,s=i.state.hash,u=j.getParameters(e,i.state,o,t,ve.numPlanes,ve.numIntersection,n),l=j.getProgramCode(e,u),c=r.program,f=!0;if(void 0===c)e.addEventListener("dispose",Re);else if(c.code!==l)Le(e);else if(a.stateID!==s.stateID||a.directionalLength!==s.directionalLength||a.pointLength!==s.pointLength||a.spotLength!==s.spotLength||a.rectAreaLength!==s.rectAreaLength||a.hemiLength!==s.hemiLength||a.shadowsLength!==s.shadowsLength)a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,f=!1;else{if(void 0!==u.shaderID)return;f=!1}if(f){if(u.shaderID){var d=an[u.shaderID];r.shader={name:e.type,uniforms:tn.clone(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}}else r.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(r.shader,V),l=j.getProgramCode(e,u),c=j.acquireProgram(e,r.shader,u,l),r.program=c,e.program=c}var h=c.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var p=0;p<V.maxMorphTargets;p++)h["morphTarget"+p]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(p=0;p<V.maxMorphNormals;p++)h["morphNormal"+p]>=0&&e.numSupportedMorphNormals++}var m=r.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=ve.numPlanes,r.numIntersection=ve.numIntersection,m.clippingPlanes=ve.uniform),r.fog=t,void 0===a&&(r.lightsHash=a={}),a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,e.lights&&(m.ambientLightColor.value=i.state.ambient,m.directionalLights.value=i.state.directional,m.spotLights.value=i.state.spot,m.rectAreaLights.value=i.state.rectArea,m.pointLights.value=i.state.point,m.hemisphereLights.value=i.state.hemi,m.directionalShadowMap.value=i.state.directionalShadowMap,m.directionalShadowMatrix.value=i.state.directionalShadowMatrix,m.spotShadowMap.value=i.state.spotShadowMap,m.spotShadowMatrix.value=i.state.spotShadowMatrix,m.pointShadowMap.value=i.state.pointShadowMap,m.pointShadowMatrix.value=i.state.pointShadowMatrix);var v=r.program.getUniforms(),y=Rr.seqWithValue(v.seq,m);r.uniformsList=y}function Ue(e,t,n,r){le=0;var i=k.get(n),o=g.state.lights,a=i.lightsHash,s=o.state.hash;if(ye&&(_e||e!==ie)){var u=e===ie&&n.id===te;ve.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,i,u)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==t?n.needsUpdate=!0:(!n.lights||a.stateID===s.stateID&&a.directionalLength===s.directionalLength&&a.pointLength===s.pointLength&&a.spotLength===s.spotLength&&a.rectAreaLength===s.rectAreaLength&&a.hemiLength===s.hemiLength&&a.shadowsLength===s.shadowsLength)&&(void 0===i.numClippingPlanes||i.numClippingPlanes===ve.numPlanes&&i.numIntersection===ve.numIntersection)||(n.needsUpdate=!0)),n.needsUpdate&&(Be(n,t,r),n.needsUpdate=!1);var l=!1,c=!1,f=!1,d=i.program,h=d.getUniforms(),p=i.shader.uniforms;if(w.useProgram(d.program)&&(l=!0,c=!0,f=!0),n.id!==te&&(te=n.id,c=!0),l||e!==ie){if(h.setValue(y,"projectionMatrix",e.projectionMatrix),b.logarithmicDepthBuffer&&h.setValue(y,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),ie!==(oe||e)&&(ie=oe||e,c=!0,f=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var v=h.map.cameraPosition;void 0!==v&&v.setValue(y,we.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&h.setValue(y,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){h.setOptional(y,r,"bindMatrix"),h.setOptional(y,r,"bindMatrixInverse");var _=r.skeleton;if(_){var x=_.bones;if(b.floatVertexTextures){if(void 0===_.boneTexture){var E=Math.sqrt(4*x.length);E=It.ceilPowerOfTwo(E),E=Math.max(E,4);var M=new Float32Array(E*E*4);M.set(_.boneMatrices);var C=new $t(M,E,E,Fe,Ae);C.needsUpdate=!0,_.boneMatrices=M,_.boneTexture=C,_.boneTextureSize=E}h.setValue(y,"boneTexture",_.boneTexture),h.setValue(y,"boneTextureSize",_.boneTextureSize)}else h.setOptional(y,_,"boneMatrices")}}return c&&(h.setValue(y,"toneMappingExposure",V.toneMappingExposure),h.setValue(y,"toneMappingWhitePoint",V.toneMappingWhitePoint),n.lights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(p,f),t&&n.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(p,t),n.isMeshBasicMaterial?ze(p,n):n.isMeshLambertMaterial?(ze(p,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(p,n)):n.isMeshPhongMaterial?(ze(p,n),n.isMeshToonMaterial?function(e,t){Ve(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(p,n):Ve(p,n)):n.isMeshStandardMaterial?(ze(p,n),n.isMeshPhysicalMaterial?function(e,t){He(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(p,n):He(p,n)):n.isMeshDepthMaterial?(ze(p,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,n)):n.isMeshDistanceMaterial?(ze(p,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(p,n)):n.isMeshNormalMaterial?(ze(p,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(p,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(p,n)):n.isPointsMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*de,e.scale.value=.5*fe,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(p,n):n.isSpriteMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(p,n):n.isShadowMaterial&&(p.color.value=n.color,p.opacity.value=n.opacity),void 0!==p.ltc_1&&(p.ltc_1.value=on.LTC_1),void 0!==p.ltc_2&&(p.ltc_2.value=on.LTC_2),Rr.upload(y,i.uniformsList,p,V)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Rr.upload(y,i.uniformsList,p,V),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&h.setValue(y,"center",r.center),h.setValue(y,"modelViewMatrix",r.modelViewMatrix),h.setValue(y,"normalMatrix",r.normalMatrix),h.setValue(y,"modelMatrix",r.matrixWorld),d}function ze(e,t){var n;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=k.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function Ve(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function He(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}De.setAnimationLoop(function(e){Te.isPresenting()||je&&je(e)}),"undefined"!=typeof window&&De.setContext(window),this.setAnimationLoop=function(e){je=e,Te.setAnimationLoop(e),De.start()},this.render=function(e,t,n,r){if(t&&t.isCamera){if(!H){ne.geometry=null,ne.program=null,ne.wireframe=!1,te=-1,ie=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),Te.enabled&&(t=Te.getCamera(t)),(g=N.get(e,t)).init(),e.onBeforeRender(V,e,t,n),be.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),me.setFromMatrix(be),_e=this.localClippingEnabled,ye=ve.init(this.clippingPlanes,_e,t),(p=D.get(e,t)).init(),function e(t,n,r){if(!1===t.visible)return;var i=t.layers.test(n.layers);if(i)if(t.isLight)g.pushLight(t),t.castShadow&&g.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||me.intersectsSprite(t)){r&&we.setFromMatrixPosition(t.matrixWorld).applyMatrix4(be);var o=L.update(t),a=t.material;p.push(t,o,a,we.z,null)}}else if(t.isImmediateRenderObject)r&&we.setFromMatrixPosition(t.matrixWorld).applyMatrix4(be),p.push(t,null,t.material,we.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||me.intersectsObject(t))){r&&we.setFromMatrixPosition(t.matrixWorld).applyMatrix4(be);var o=L.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,u=0,l=s.length;u<l;u++){var c=s[u],f=a[c.materialIndex];f&&f.visible&&p.push(t,o,f,we.z,c)}else a.visible&&p.push(t,o,a,we.z,null)}var d=t.children;for(var u=0,l=d.length;u<l;u++)e(d[u],n,r)}(e,t,V.sortObjects),!0===V.sortObjects&&p.sort(),ye&&ve.beginShadows();var i=g.state.shadowsArray;Se.render(i,e,t),g.setupLights(t),ye&&ve.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),I.render(p,e,t,r);var o=p.opaque,a=p.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&Ne(o,e,t,s),a.length&&Ne(a,e,t,s)}else o.length&&Ne(o,e,t),a.length&&Ne(a,e,t);n&&A.updateRenderTargetMipmap(n),w.buffers.depth.setTest(!0),w.buffers.depth.setMask(!0),w.buffers.color.setMask(!0),w.setPolygonOffset(!1),e.onAfterRender(V,e,t),Te.enabled&&Te.submitFrame(),p=null,g=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var e=le;return e>=b.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+b.maxTextures),le+=1,e},this.setTexture2D=function(){var e=!1;return function(t,n){t&&t.isWebGLRenderTarget&&(e||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),A.setTexture2D(t,n)}}(),this.setTexture=function(){var e=!1;return function(t,n){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),A.setTexture2D(t,n)}}(),this.setTextureCube=function(){var e=!1;return function(t,n){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?A.setTextureCube(t,n):A.setTextureCubeDynamic(t,n)}}(),this.setFramebuffer=function(e){q=e},this.getRenderTarget=function(){return Q},this.setRenderTarget=function(e){Q=e,e&&void 0===k.get(e).__webglFramebuffer&&A.setupRenderTarget(e);var t=q,n=!1;if(e){var r=k.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=r[e.activeCubeFace],n=!0):t=r,ae.copy(e.viewport),se.copy(e.scissor),ue=e.scissorTest}else ae.copy(he).multiplyScalar(de),se.copy(pe).multiplyScalar(de),ue=ge;if(ee!==t&&(y.bindFramebuffer(y.FRAMEBUFFER,t),ee=t),w.viewport(ae),w.scissor(se),w.setScissorTest(ue),n){var i=k.get(e.texture);y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,i.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,n,r,i,o){if(e&&e.isWebGLRenderTarget){var a=k.get(e).__webglFramebuffer;if(a){var s=!1;a!==ee&&(y.bindFramebuffer(y.FRAMEBUFFER,a),s=!0);try{var u=e.texture,l=u.format,c=u.type;if(l!==Fe&&z.convert(l)!==y.getParameter(y.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===Me||z.convert(c)===y.getParameter(y.IMPLEMENTATION_COLOR_READ_TYPE)||c===Ae&&(b.isWebGL2||_.get("OES_texture_float")||_.get("WEBGL_color_buffer_float"))||c===Pe&&(b.isWebGL2?_.get("EXT_color_buffer_float"):_.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");y.checkFramebufferStatus(y.FRAMEBUFFER)===y.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&y.readPixels(t,n,r,i,z.convert(l),z.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&y.bindFramebuffer(y.FRAMEBUFFER,ee)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var r=t.image.width,i=t.image.height,o=z.convert(t.format);this.setTexture2D(t,0),y.copyTexImage2D(y.TEXTURE_2D,n||0,o,e.x,e.y,r,i,0)},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,o=t.image.height,a=z.convert(n.format),s=z.convert(n.type);this.setTexture2D(n,0),t.isDataTexture?y.texSubImage2D(y.TEXTURE_2D,r||0,e.x,e.y,i,o,a,s,t.image.data):y.texSubImage2D(y.TEXTURE_2D,r||0,e.x,e.y,a,s,t.image)}}function si(e,t){this.name="",this.color=new rn(e),this.density=void 0!==t?t:25e-5}function ui(e,t,n){this.name="",this.color=new rn(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function li(){dn.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function ci(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function fi(e,t,n,r){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function di(e){In.call(this),this.type="SpriteMaterial",this.color=new rn(16777215),this.map=null,this.rotation=0,this.lights=!1,this.transparent=!0,this.setValues(e)}function hi(e){if(dn.call(this),this.type="Sprite",void 0===Xr){Xr=new Pn;var t=new ci(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Xr.setIndex([0,1,2,0,2,3]),Xr.addAttribute("position",new fi(t,3,0,!1)),Xr.addAttribute("uv",new fi(t,2,3,!1))}this.geometry=Xr,this.material=void 0!==e?e:new di,this.center=new Ft(.5,.5)}function pi(){dn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function gi(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Bt)}}function mi(){dn.call(this),this.type="Bone"}function vi(e,t){Vn.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Bt,this.bindMatrixInverse=new Bt;var n=new gi(this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function yi(e){In.call(this),this.type="LineBasicMaterial",this.color=new rn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function _i(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),dn.call(this),this.type="Line",this.geometry=void 0!==e?e:new Pn,this.material=void 0!==t?t:new yi({color:16777215*Math.random()})}function bi(e,t){_i.call(this,e,t),this.type="LineSegments"}function wi(e,t){_i.call(this,e,t),this.type="LineLoop"}function xi(e){In.call(this),this.type="PointsMaterial",this.color=new rn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Ei(e,t){dn.call(this),this.type="Points",this.geometry=void 0!==e?e:new Pn,this.material=void 0!==t?t:new xi({color:16777215*Math.random()})}function Mi(e,t,n,r,i,o,a,s,u){Gt.call(this,e,t,n,r,i,o,a,s,u),this.generateMipmaps=!1}function Ci(e,t,n,r,i,o,a,s,u,l,c,f){Gt.call(this,null,o,a,s,u,l,r,i,c,f),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Ti(e,t,n,r,i,o,a,s,u){Gt.call(this,e,t,n,r,i,o,a,s,u),this.needsUpdate=!0}function Si(e,t,n,r,i,o,a,s,u,l){if((l=void 0!==l?l:Ve)!==Ve&&l!==He)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===Ve&&(n=Se),void 0===n&&l===He&&(n=De),Gt.call(this,null,r,i,o,a,s,l,n,u),this.image={width:e,height:t},this.magFilter=void 0!==a?a:ye,this.minFilter=void 0!==s?s:ye,this.flipY=!1,this.generateMipmaps=!1}function Oi(e){Pn.call(this),this.type="WireframeGeometry";var t,n,r,i,o,a,s,u,l,c,f=[],d=[0,0],h={},p=["a","b","c"];if(e&&e.isGeometry){var g=e.faces;for(t=0,r=g.length;t<r;t++){var m=g[t];for(n=0;n<3;n++)s=m[p[n]],u=m[p[(n+1)%3]],d[0]=Math.min(s,u),d[1]=Math.max(s,u),void 0===h[l=d[0]+","+d[1]]&&(h[l]={index1:d[0],index2:d[1]})}for(l in h)a=h[l],c=e.vertices[a.index1],f.push(c.x,c.y,c.z),c=e.vertices[a.index2],f.push(c.x,c.y,c.z)}else if(e&&e.isBufferGeometry){var v,y,_,b,w,x,E;if(c=new zt,null!==e.index){for(v=e.attributes.position,y=e.index,0===(_=e.groups).length&&(_=[{start:0,count:y.count,materialIndex:0}]),i=0,o=_.length;i<o;++i)for(t=w=(b=_[i]).start,r=w+b.count;t<r;t+=3)for(n=0;n<3;n++)s=y.getX(t+n),u=y.getX(t+(n+1)%3),d[0]=Math.min(s,u),d[1]=Math.max(s,u),void 0===h[l=d[0]+","+d[1]]&&(h[l]={index1:d[0],index2:d[1]});for(l in h)a=h[l],c.fromBufferAttribute(v,a.index1),f.push(c.x,c.y,c.z),c.fromBufferAttribute(v,a.index2),f.push(c.x,c.y,c.z)}else for(t=0,r=(v=e.attributes.position).count/3;t<r;t++)for(n=0;n<3;n++)x=3*t+n,c.fromBufferAttribute(v,x),f.push(c.x,c.y,c.z),E=3*t+(n+1)%3,c.fromBufferAttribute(v,E),f.push(c.x,c.y,c.z)}this.addAttribute("position",new Tn(f,3))}function ki(e,t,n){vn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Ai(e,t,n)),this.mergeVertices()}function Ai(e,t,n){Pn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r,i,o=[],a=[],s=[],u=[],l=new zt,c=new zt,f=new zt,d=new zt,h=new zt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var p=t+1;for(r=0;r<=n;r++){var g=r/n;for(i=0;i<=t;i++){var m=i/t;e(m,g,c),a.push(c.x,c.y,c.z),m-1e-5>=0?(e(m-1e-5,g,f),d.subVectors(c,f)):(e(m+1e-5,g,f),d.subVectors(f,c)),g-1e-5>=0?(e(m,g-1e-5,f),h.subVectors(c,f)):(e(m,g+1e-5,f),h.subVectors(f,c)),l.crossVectors(d,h).normalize(),s.push(l.x,l.y,l.z),u.push(m,g)}}for(r=0;r<n;r++)for(i=0;i<t;i++){var v=r*p+i,y=r*p+i+1,_=(r+1)*p+i+1,b=(r+1)*p+i;o.push(v,y,b),o.push(y,_,b)}this.setIndex(o),this.addAttribute("position",new Tn(a,3)),this.addAttribute("normal",new Tn(s,3)),this.addAttribute("uv",new Tn(u,2))}function Pi(e,t,n,r){vn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new Ri(e,t,n,r)),this.mergeVertices()}function Ri(e,t,n,r){Pn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1;var i=[],o=[];function a(e,t,n,r){var i,o,a=Math.pow(2,r),u=[];for(i=0;i<=a;i++){u[i]=[];var l=e.clone().lerp(n,i/a),c=t.clone().lerp(n,i/a),f=a-i;for(o=0;o<=f;o++)u[i][o]=0===o&&i===a?l:l.clone().lerp(c,o/f)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var d=Math.floor(o/2);o%2==0?(s(u[i][d+1]),s(u[i+1][d]),s(u[i][d])):(s(u[i][d+1]),s(u[i+1][d+1]),s(u[i+1][d]))}}function s(e){i.push(e.x,e.y,e.z)}function u(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function l(e,t,n,r){r<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=r/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}function f(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){for(var n=new zt,r=new zt,i=new zt,o=0;o<t.length;o+=3)u(t[o+0],n),u(t[o+1],r),u(t[o+2],i),a(n,r,i,e)}(r=r||0),function(e){for(var t=new zt,n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){for(var e=new zt,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var n=c(e)/2/Math.PI+.5,r=f(e)/Math.PI+.5;o.push(n,1-r)}(function(){for(var e=new zt,t=new zt,n=new zt,r=new zt,a=new Ft,s=new Ft,u=new Ft,f=0,d=0;f<i.length;f+=9,d+=6){e.set(i[f+0],i[f+1],i[f+2]),t.set(i[f+3],i[f+4],i[f+5]),n.set(i[f+6],i[f+7],i[f+8]),a.set(o[d+0],o[d+1]),s.set(o[d+2],o[d+3]),u.set(o[d+4],o[d+5]),r.copy(e).add(t).add(n).divideScalar(3);var h=c(r);l(a,d+0,e,h),l(s,d+2,t,h),l(u,d+4,n,h)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],n=o[e+2],r=o[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(o[e+0]+=1),n<.2&&(o[e+2]+=1),r<.2&&(o[e+4]+=1))}}()}(),this.addAttribute("position",new Tn(i,3)),this.addAttribute("normal",new Tn(i.slice(),3)),this.addAttribute("uv",new Tn(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Li(e,t){vn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ji(e,t)),this.mergeVertices()}function ji(e,t){Ri.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Di(e,t){vn.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ni(e,t)),this.mergeVertices()}function Ni(e,t){Ri.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ii(e,t){vn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Fi(e,t)),this.mergeVertices()}function Fi(e,t){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Ri.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Bi(e,t){vn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ui(e,t)),this.mergeVertices()}function Ui(e,t){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Ri.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function zi(e,t,n,r,i,o){vn.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Vi(e,t,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Vi(e,t,n,r,i){Pn.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},t=t||64,n=n||1,r=r||8,i=i||!1;var o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,u=new zt,l=new zt,c=new Ft,f=new zt,d=[],h=[],p=[],g=[];function m(i){f=e.getPointAt(i/t,f);var a=o.normals[i],c=o.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,g=Math.sin(p),m=-Math.cos(p);l.x=m*a.x+g*c.x,l.y=m*a.y+g*c.y,l.z=m*a.z+g*c.z,l.normalize(),h.push(l.x,l.y,l.z),u.x=f.x+n*l.x,u.y=f.y+n*l.y,u.z=f.z+n*l.z,d.push(u.x,u.y,u.z)}}!function(){for(a=0;a<t;a++)m(a);m(!1===i?t:0),function(){for(a=0;a<=t;a++)for(s=0;s<=r;s++)c.x=a/t,c.y=s/r,p.push(c.x,c.y)}(),function(){for(s=1;s<=t;s++)for(a=1;a<=r;a++){var e=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;g.push(e,n,o),g.push(n,i,o)}}()}(),this.setIndex(g),this.addAttribute("position",new Tn(d,3)),this.addAttribute("normal",new Tn(h,3)),this.addAttribute("uv",new Tn(p,2))}function Hi(e,t,n,r,i,o,a){vn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new qi(e,t,n,r,i,o)),this.mergeVertices()}function qi(e,t,n,r,i,o){Pn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,u=[],l=[],c=[],f=[],d=new zt,h=new zt,p=new zt,g=new zt,m=new zt,v=new zt,y=new zt;for(a=0;a<=n;++a){var _=a/n*i*Math.PI*2;for(S(_,i,o,e,p),S(_+.01,i,o,e,g),v.subVectors(g,p),y.addVectors(g,p),m.crossVectors(v,y),y.crossVectors(m,v),m.normalize(),y.normalize(),s=0;s<=r;++s){var b=s/r*Math.PI*2,w=-t*Math.cos(b),x=t*Math.sin(b);d.x=p.x+(w*y.x+x*m.x),d.y=p.y+(w*y.y+x*m.y),d.z=p.z+(w*y.z+x*m.z),l.push(d.x,d.y,d.z),h.subVectors(d,p).normalize(),c.push(h.x,h.y,h.z),f.push(a/n),f.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var E=(r+1)*(s-1)+(a-1),M=(r+1)*s+(a-1),C=(r+1)*s+a,T=(r+1)*(s-1)+a;u.push(E,M,T),u.push(M,C,T)}function S(e,t,n,r,i){var o=Math.cos(e),a=Math.sin(e),s=n/t*e,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(u),this.addAttribute("position",new Tn(l,3)),this.addAttribute("normal",new Tn(c,3)),this.addAttribute("uv",new Tn(f,2))}function Gi(e,t,n,r,i){vn.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Wi(e,t,n,r,i)),this.mergeVertices()}function Wi(e,t,n,r,i){Pn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],u=[],l=[],c=[],f=new zt,d=new zt,h=new zt;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var p=a/r*i,g=o/n*Math.PI*2;d.x=(e+t*Math.cos(g))*Math.cos(p),d.y=(e+t*Math.cos(g))*Math.sin(p),d.z=t*Math.sin(g),u.push(d.x,d.y,d.z),f.x=e*Math.cos(p),f.y=e*Math.sin(p),h.subVectors(d,f).normalize(),l.push(h.x,h.y,h.z),c.push(a/r),c.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var m=(r+1)*o+a-1,v=(r+1)*(o-1)+a-1,y=(r+1)*(o-1)+a,_=(r+1)*o+a;s.push(m,v,_),s.push(v,y,_)}this.setIndex(s),this.addAttribute("position",new Tn(u,3)),this.addAttribute("normal",new Tn(l,3)),this.addAttribute("uv",new Tn(c,2))}Zr.prototype=Object.create(In.prototype),Zr.prototype.constructor=Zr,Zr.prototype.isMeshDepthMaterial=!0,Zr.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Kr.prototype=Object.create(In.prototype),Kr.prototype.constructor=Kr,Kr.prototype.isMeshDistanceMaterial=!0,Kr.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},ni.prototype=Object.assign(Object.create(dn.prototype),{constructor:ni,isGroup:!0}),ri.prototype=Object.assign(Object.create(hn.prototype),{constructor:ri,isPerspectiveCamera:!0,copy:function(e,t){return hn.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*It.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*It.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*It.RAD2DEG*Math.atan(Math.tan(.5*It.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*It.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,t-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far)},toJSON:function(e){var t=dn.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),ii.prototype=Object.assign(Object.create(ri.prototype),{constructor:ii,isArrayCamera:!0}),si.prototype.isFogExp2=!0,si.prototype.clone=function(){return new si(this.color,this.density)},si.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},ui.prototype.isFog=!0,ui.prototype.clone=function(){return new ui(this.color,this.near,this.far)},ui.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},li.prototype=Object.assign(Object.create(dn.prototype),{constructor:li,copy:function(e,t){return dn.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=dn.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),Object.defineProperty(ci.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ci.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(fi.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(fi.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),di.prototype=Object.create(In.prototype),di.prototype.constructor=di,di.prototype.isSpriteMaterial=!0,di.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},hi.prototype=Object.assign(Object.create(dn.prototype),{constructor:hi,isSprite:!0,raycast:function(){var e=new zt,t=new zt,n=new zt,r=new Ft,i=new Ft,o=new Bt,a=new zt,s=new zt,u=new zt;function l(e,t,n,a,s,u){r.subVectors(e,n).addScalar(.5).multiply(a),void 0!==s?(i.x=u*r.x-s*r.y,i.y=s*r.x+u*r.y):i.copy(r),e.copy(t),e.x+=i.x,e.y+=i.y,e.applyMatrix4(o)}return function(r,i){t.setFromMatrixScale(this.matrixWorld),o.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),n.setFromMatrixPosition(this.modelViewMatrix);var c,f,d=this.material.rotation;0!==d&&(f=Math.cos(d),c=Math.sin(d));var h=this.center;l(a.set(-.5,-.5,0),n,h,t,c,f),l(s.set(.5,-.5,0),n,h,t,c,f),l(u.set(.5,.5,0),n,h,t,c,f);var p=r.ray.intersectTriangle(a,s,u,!1,e);if(null!==p||(l(s.set(-.5,.5,0),n,h,t,c,f),null!==(p=r.ray.intersectTriangle(a,u,s,!1,e)))){var g=r.ray.origin.distanceTo(e);g<r.near||g>r.far||i.push({distance:g,point:e.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return dn.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),pi.prototype=Object.assign(Object.create(dn.prototype),{constructor:pi,copy:function(e){dn.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);n.splice(r,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object},raycast:function(){var e=new zt;return function(t,n){e.setFromMatrixPosition(this.matrixWorld);var r=t.ray.origin.distanceTo(e);this.getObjectForDistance(r).raycast(t,n)}}(),update:function(){var e=new zt,t=new zt;return function(n){var r=this.levels;if(r.length>1){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);r[0].object.visible=!0;for(var o=1,a=r.length;o<a&&i>=r[o].distance;o++)r[o-1].object.visible=!1,r[o].object.visible=!0;for(;o<a;o++)r[o].object.visible=!1}}}(),toJSON:function(e){var t=dn.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(gi.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Bt;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new Bt,t=new Bt;return function(){for(var n=this.bones,r=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=n.length;a<s;a++){var u=n[a]?n[a].matrixWorld:t;e.multiplyMatrices(u,r[a]),e.toArray(i,16*a)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new gi(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}}),mi.prototype=Object.assign(Object.create(dn.prototype),{constructor:mi,isBone:!0}),vi.prototype=Object.assign(Object.create(Vn.prototype),{constructor:vi,isSkinnedMesh:!0,initBones:function(){var e,t,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)t=this.geometry.bones[n],e=new mi,i.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)-1!==(t=this.geometry.bones[n]).parent&&null!==t.parent&&void 0!==i[t.parent]?i[t.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var n=this.geometry.skinWeights[t];(e=1/n.manhattanLength())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new Wt,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++)r.x=i.getX(t),r.y=i.getY(t),r.z=i.getZ(t),r.w=i.getW(t),(e=1/r.manhattanLength())!==1/0?r.multiplyScalar(e):r.set(1,0,0,0),i.setXYZW(t,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(e){Vn.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),yi.prototype=Object.create(In.prototype),yi.prototype.constructor=yi,yi.prototype.isLineBasicMaterial=!0,yi.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},_i.prototype=Object.assign(Object.create(dn.prototype),{constructor:_i,isLine:!0,computeLineDistances:function(){var e=new zt,t=new zt;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[0],o=1,a=r.count;o<a;o++)e.fromBufferAttribute(r,o-1),t.fromBufferAttribute(r,o),i[o]=i[o-1],i[o]+=e.distanceTo(t);n.addAttribute("lineDistance",new Tn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;(i=n.lineDistances)[0]=0;for(o=1,a=s.length;o<a;o++)i[o]=i[o-1],i[o]+=s[o-1].distanceTo(s[o])}return this}}(),raycast:function(){var e=new Bt,t=new Un,n=new Zt;return function(r,i){var o=r.linePrecision,a=o*o,s=this.geometry,u=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(u),!1!==r.ray.intersectsSphere(n)){e.getInverse(u),t.copy(r.ray).applyMatrix4(e);var l=new zt,c=new zt,f=new zt,d=new zt,h=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var p=s.index,g=s.attributes.position.array;if(null!==p)for(var m=p.array,v=0,y=m.length-1;v<y;v+=h){var _=m[v],b=m[v+1];if(l.fromArray(g,3*_),c.fromArray(g,3*b),!(t.distanceSqToSegment(l,c,d,f)>a))d.applyMatrix4(this.matrixWorld),(E=r.ray.origin.distanceTo(d))<r.near||E>r.far||i.push({distance:E,point:f.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else for(v=0,y=g.length/3-1;v<y;v+=h){if(l.fromArray(g,3*v),c.fromArray(g,3*v+3),!(t.distanceSqToSegment(l,c,d,f)>a))d.applyMatrix4(this.matrixWorld),(E=r.ray.origin.distanceTo(d))<r.near||E>r.far||i.push({distance:E,point:f.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else if(s.isGeometry){var w=s.vertices,x=w.length;for(v=0;v<x-1;v+=h){var E;if(!(t.distanceSqToSegment(w[v],w[v+1],d,f)>a))d.applyMatrix4(this.matrixWorld),(E=r.ray.origin.distanceTo(d))<r.near||E>r.far||i.push({distance:E,point:f.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),bi.prototype=Object.assign(Object.create(_i.prototype),{constructor:bi,isLineSegments:!0,computeLineDistances:function(){var e=new zt,t=new zt;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],o=0,a=r.count;o<a;o+=2)e.fromBufferAttribute(r,o),t.fromBufferAttribute(r,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t);n.addAttribute("lineDistance",new Tn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;for(i=n.lineDistances,o=0,a=s.length;o<a;o+=2)e.copy(s[o]),t.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t)}return this}}()}),wi.prototype=Object.assign(Object.create(_i.prototype),{constructor:wi,isLineLoop:!0}),xi.prototype=Object.create(In.prototype),xi.prototype.constructor=xi,xi.prototype.isPointsMaterial=!0,xi.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Ei.prototype=Object.assign(Object.create(dn.prototype),{constructor:Ei,isPoints:!0,raycast:function(){var e=new Bt,t=new Un,n=new Zt;return function(r,i){var o=this,a=this.geometry,s=this.matrixWorld,u=r.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),n.radius+=u,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var l=u/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,f=new zt,d=new zt;if(a.isBufferGeometry){var h=a.index,p=a.attributes.position.array;if(null!==h)for(var g=h.array,m=0,v=g.length;m<v;m++){var y=g[m];f.fromArray(p,3*y),w(f,y)}else{m=0;for(var _=p.length/3;m<_;m++)f.fromArray(p,3*m),w(f,m)}}else{var b=a.vertices;for(m=0,_=b.length;m<_;m++)w(b[m],m)}}function w(e,n){var a=t.distanceSqToPoint(e);if(a<c){t.closestPointToPoint(e,d),d.applyMatrix4(s);var u=r.ray.origin.distanceTo(d);if(u<r.near||u>r.far)return;i.push({distance:u,distanceToRay:Math.sqrt(a),point:d.clone(),index:n,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Mi.prototype=Object.assign(Object.create(Gt.prototype),{constructor:Mi,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Ci.prototype=Object.create(Gt.prototype),Ci.prototype.constructor=Ci,Ci.prototype.isCompressedTexture=!0,Ti.prototype=Object.create(Gt.prototype),Ti.prototype.constructor=Ti,Ti.prototype.isCanvasTexture=!0,Si.prototype=Object.create(Gt.prototype),Si.prototype.constructor=Si,Si.prototype.isDepthTexture=!0,Oi.prototype=Object.create(Pn.prototype),Oi.prototype.constructor=Oi,ki.prototype=Object.create(vn.prototype),ki.prototype.constructor=ki,Ai.prototype=Object.create(Pn.prototype),Ai.prototype.constructor=Ai,Pi.prototype=Object.create(vn.prototype),Pi.prototype.constructor=Pi,Ri.prototype=Object.create(Pn.prototype),Ri.prototype.constructor=Ri,Li.prototype=Object.create(vn.prototype),Li.prototype.constructor=Li,ji.prototype=Object.create(Ri.prototype),ji.prototype.constructor=ji,Di.prototype=Object.create(vn.prototype),Di.prototype.constructor=Di,Ni.prototype=Object.create(Ri.prototype),Ni.prototype.constructor=Ni,Ii.prototype=Object.create(vn.prototype),Ii.prototype.constructor=Ii,Fi.prototype=Object.create(Ri.prototype),Fi.prototype.constructor=Fi,Bi.prototype=Object.create(vn.prototype),Bi.prototype.constructor=Bi,Ui.prototype=Object.create(Ri.prototype),Ui.prototype.constructor=Ui,zi.prototype=Object.create(vn.prototype),zi.prototype.constructor=zi,Vi.prototype=Object.create(Pn.prototype),Vi.prototype.constructor=Vi,Hi.prototype=Object.create(vn.prototype),Hi.prototype.constructor=Hi,qi.prototype=Object.create(Pn.prototype),qi.prototype.constructor=qi,Gi.prototype=Object.create(vn.prototype),Gi.prototype.constructor=Gi,Wi.prototype=Object.create(Pn.prototype),Wi.prototype.constructor=Wi;var Xi=function(e,t,n){n=n||2;var r,i,o,a,s,u,l,c=t&&t.length,f=c?t[0]*n:e.length,d=Yi(e,0,f,n,!0),h=[];if(!d)return h;if(c&&(d=function(e,t,n,r){var i,o,a,s,u,l=[];for(i=0,o=t.length;i<o;i++)a=t[i]*r,s=i<o-1?t[i+1]*r:e.length,(u=Yi(e,a,s,r,!1))===u.next&&(u.steiner=!0),l.push(io(u));for(l.sort(to),i=0;i<l.length;i++)no(l[i],n),n=$i(n,n.next);return n}(e,t,d,n)),e.length>80*n){r=o=e[0],i=a=e[1];for(var p=n;p<f;p+=n)s=e[p],u=e[p+1],s<r&&(r=s),u<i&&(i=u),s>o&&(o=s),u>a&&(a=u);l=0!==(l=Math.max(o-r,a-i))?1/l:0}return Ji(d,h,n,r,i,l),h};function Yi(e,t,n,r,i){var o,a;if(i===function(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,n,r)>0)for(o=t;o<n;o+=r)a=ho(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=ho(o,e[o],e[o+1],a);return a&&uo(a,a.next)&&(po(a),a=a.next),a}function $i(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!uo(r,r.next)&&0!==so(r.prev,r,r.next))r=r.next;else{if(po(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Ji(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=ro(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,u,l=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ);t++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(a>1)}(i)}(e,r,i,o);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,o?Ki(e,r,i,o):Zi(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),po(e),e=u.next,l=u.next;else if((e=u)===l){a?1===a?Ji(e=Qi(e,t,n),t,n,r,i,o,2):2===a&&eo(e,t,n,r,i,o):Ji($i(e),t,n,r,i,o,1);break}}}function Zi(e){var t=e.prev,n=e,r=e.next;if(so(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(oo(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&so(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Ki(e,t,n,r){var i=e.prev,o=e,a=e.next;if(so(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=ro(s,u,t,n,r),d=ro(l,c,t,n,r),h=e.nextZ;h&&h.z<=d;){if(h!==e.prev&&h!==e.next&&oo(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&so(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(h=e.prevZ;h&&h.z>=f;){if(h!==e.prev&&h!==e.next&&oo(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&so(h.prev,h,h.next)>=0)return!1;h=h.prevZ}return!0}function Qi(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!uo(i,o)&&lo(i,r,r.next,o)&&co(i,o)&&co(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),po(r),po(r.next),r=e=o),r=r.next}while(r!==e);return r}function eo(e,t,n,r,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ao(a,s)){var u=fo(a,s);return a=$i(a,a.next),u=$i(u,u.next),Ji(a,t,n,r,i,o),void Ji(u,t,n,r,i,o)}s=s.next}a=a.next}while(a!==e)}function to(e,t){return e.x-t.x}function no(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n.prev;var u,l=n,c=n.x,f=n.y,d=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=c&&i!==r.x&&oo(o<f?i:a,o,c,f,o<f?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<d||u===d&&r.x>n.x)&&co(r,e)&&(n=r,d=u),r=r.next;return n}(e,t)){var n=fo(t,e);$i(n,n.next)}}function ro(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function io(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function oo(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function ao(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&lo(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&co(e,t)&&co(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)}function so(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function uo(e,t){return e.x===t.x&&e.y===t.y}function lo(e,t,n,r){return!!(uo(e,t)&&uo(n,r)||uo(e,r)&&uo(n,t))||so(e,t,n)>0!=so(e,t,r)>0&&so(n,r,e)>0!=so(n,r,t)>0}function co(e,t){return so(e.prev,e,e.next)<0?so(e,t,e.next)>=0&&so(e,e.prev,t)>=0:so(e,t,e.prev)<0||so(e,e.next,t)<0}function fo(e,t){var n=new go(e.i,e.x,e.y),r=new go(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function ho(e,t,n,r){var i=new go(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function po(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function go(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var mo={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return mo.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];vo(e),yo(n,e);var o=e.length;t.forEach(vo);for(var a=0;a<t.length;a++)r.push(o),o+=t[a].length,yo(n,t[a]);var s=Xi(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function vo(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function yo(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function _o(e,t){vn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new bo(e,t)),this.mergeVertices()}function bo(e,t){Pn.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t};for(var n=this,r=[],i=[],o=0,a=(e=Array.isArray(e)?e:[e]).length;o<a;o++){s(e[o])}function s(e){var o=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,u=void 0!==t.depth?t.depth:100,l=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,f=void 0!==t.bevelSize?t.bevelSize:c-2,d=void 0!==t.bevelSegments?t.bevelSegments:3,h=t.extrudePath,p=void 0!==t.UVGenerator?t.UVGenerator:wo;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=t.amount);var g,m,v,y,_,b,w,x,E=!1;h&&(g=h.getSpacedPoints(s),E=!0,l=!1,m=h.computeFrenetFrames(s,!1),v=new zt,y=new zt,_=new zt),l||(d=0,c=0,f=0);var M=e.extractPoints(a),C=M.shape,T=M.holes;if(!mo.isClockWise(C))for(C=C.reverse(),w=0,x=T.length;w<x;w++)b=T[w],mo.isClockWise(b)&&(T[w]=b.reverse());var S=mo.triangulateShape(C,T),O=C;for(w=0,x=T.length;w<x;w++)b=T[w],C=C.concat(b);function k(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var A,P,R,L,j,D,N=C.length,I=S.length;function F(e,t,n){var r,i,o,a=e.x-t.x,s=e.y-t.y,u=n.x-e.x,l=n.y-e.y,c=a*a+s*s,f=a*l-s*u;if(Math.abs(f)>Number.EPSILON){var d=Math.sqrt(c),h=Math.sqrt(u*u+l*l),p=t.x-s/d,g=t.y+a/d,m=((n.x-l/h-p)*l-(n.y+u/h-g)*u)/(a*l-s*u),v=(r=p+a*m-e.x)*r+(i=g+s*m-e.y)*i;if(v<=2)return new Ft(r,i);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?u>Number.EPSILON&&(y=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=a,o=Math.sqrt(c)):(r=a,i=s,o=Math.sqrt(c/2))}return new Ft(r/o,i/o)}for(var B=[],U=0,z=O.length,V=z-1,H=U+1;U<z;U++,V++,H++)V===z&&(V=0),H===z&&(H=0),B[U]=F(O[U],O[V],O[H]);var q,G,W=[],X=B.concat();for(w=0,x=T.length;w<x;w++){for(b=T[w],q=[],U=0,V=(z=b.length)-1,H=U+1;U<z;U++,V++,H++)V===z&&(V=0),H===z&&(H=0),q[U]=F(b[U],b[V],b[H]);W.push(q),X=X.concat(q)}for(A=0;A<d;A++){for(R=A/d,L=c*Math.cos(R*Math.PI/2),P=f*Math.sin(R*Math.PI/2),U=0,z=O.length;U<z;U++)$((j=k(O[U],B[U],P)).x,j.y,-L);for(w=0,x=T.length;w<x;w++)for(b=T[w],q=W[w],U=0,z=b.length;U<z;U++)$((j=k(b[U],q[U],P)).x,j.y,-L)}for(P=f,U=0;U<N;U++)j=l?k(C[U],X[U],P):C[U],E?(y.copy(m.normals[0]).multiplyScalar(j.x),v.copy(m.binormals[0]).multiplyScalar(j.y),_.copy(g[0]).add(y).add(v),$(_.x,_.y,_.z)):$(j.x,j.y,0);for(G=1;G<=s;G++)for(U=0;U<N;U++)j=l?k(C[U],X[U],P):C[U],E?(y.copy(m.normals[G]).multiplyScalar(j.x),v.copy(m.binormals[G]).multiplyScalar(j.y),_.copy(g[G]).add(y).add(v),$(_.x,_.y,_.z)):$(j.x,j.y,u/s*G);for(A=d-1;A>=0;A--){for(R=A/d,L=c*Math.cos(R*Math.PI/2),P=f*Math.sin(R*Math.PI/2),U=0,z=O.length;U<z;U++)$((j=k(O[U],B[U],P)).x,j.y,u+L);for(w=0,x=T.length;w<x;w++)for(b=T[w],q=W[w],U=0,z=b.length;U<z;U++)j=k(b[U],q[U],P),E?$(j.x,j.y+g[s-1].y,g[s-1].x+L):$(j.x,j.y,u+L)}function Y(e,t){var n,r;for(U=e.length;--U>=0;){n=U,(r=U-1)<0&&(r=e.length-1);var i=0,o=s+2*d;for(i=0;i<o;i++){var a=N*i,u=N*(i+1);Z(t+n+a,t+r+a,t+r+u,t+n+u)}}}function $(e,t,n){o.push(e),o.push(t),o.push(n)}function J(e,t,i){K(e),K(t),K(i);var o=r.length/3,a=p.generateTopUV(n,r,o-3,o-2,o-1);Q(a[0]),Q(a[1]),Q(a[2])}function Z(e,t,i,o){K(e),K(t),K(o),K(t),K(i),K(o);var a=r.length/3,s=p.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);Q(s[0]),Q(s[1]),Q(s[3]),Q(s[1]),Q(s[2]),Q(s[3])}function K(e){r.push(o[3*e+0]),r.push(o[3*e+1]),r.push(o[3*e+2])}function Q(e){i.push(e.x),i.push(e.y)}!function(){var e=r.length/3;if(l){var t=0,i=N*t;for(U=0;U<I;U++)J((D=S[U])[2]+i,D[1]+i,D[0]+i);for(i=N*(t=s+2*d),U=0;U<I;U++)J((D=S[U])[0]+i,D[1]+i,D[2]+i)}else{for(U=0;U<I;U++)J((D=S[U])[2],D[1],D[0]);for(U=0;U<I;U++)J((D=S[U])[0]+N*s,D[1]+N*s,D[2]+N*s)}n.addGroup(e,r.length/3-e,0)}(),function(){var e=r.length/3,t=0;for(Y(O,t),t+=O.length,w=0,x=T.length;w<x;w++)Y(b=T[w],t),t+=b.length;n.addGroup(e,r.length/3-e,1)}()}this.addAttribute("position",new Tn(r,3)),this.addAttribute("uv",new Tn(i,2)),this.computeVertexNormals()}_o.prototype=Object.create(vn.prototype),_o.prototype.constructor=_o,_o.prototype.toJSON=function(){var e=vn.prototype.toJSON.call(this);return xo(this.parameters.shapes,this.parameters.options,e)},bo.prototype=Object.create(Pn.prototype),bo.prototype.constructor=bo,bo.prototype.toJSON=function(){var e=Pn.prototype.toJSON.call(this);return xo(this.parameters.shapes,this.parameters.options,e)};var wo={generateTopUV:function(e,t,n,r,i){var o=t[3*n],a=t[3*n+1],s=t[3*r],u=t[3*r+1],l=t[3*i],c=t[3*i+1];return[new Ft(o,a),new Ft(s,u),new Ft(l,c)]},generateSideWallUV:function(e,t,n,r,i,o){var a=t[3*n],s=t[3*n+1],u=t[3*n+2],l=t[3*r],c=t[3*r+1],f=t[3*r+2],d=t[3*i],h=t[3*i+1],p=t[3*i+2],g=t[3*o],m=t[3*o+1],v=t[3*o+2];return Math.abs(s-c)<.01?[new Ft(a,1-u),new Ft(l,1-f),new Ft(d,1-p),new Ft(g,1-v)]:[new Ft(s,1-u),new Ft(c,1-f),new Ft(h,1-p),new Ft(m,1-v)]}};function xo(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.shapes.push(o.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Eo(e,t){vn.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Mo(e,t)),this.mergeVertices()}function Mo(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new vn;var r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),bo.call(this,r,t),this.type="TextBufferGeometry"}function Co(e,t,n,r,i,o,a){vn.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new To(e,t,n,r,i,o,a)),this.mergeVertices()}function To(e,t,n,r,i,o,a){Pn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var s,u,l=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),c=0,f=[],d=new zt,h=new zt,p=[],g=[],m=[],v=[];for(u=0;u<=n;u++){var y=[],_=u/n;for(s=0;s<=t;s++){var b=s/t;d.x=-e*Math.cos(r+b*i)*Math.sin(o+_*a),d.y=e*Math.cos(o+_*a),d.z=e*Math.sin(r+b*i)*Math.sin(o+_*a),g.push(d.x,d.y,d.z),h.set(d.x,d.y,d.z).normalize(),m.push(h.x,h.y,h.z),v.push(b,1-_),y.push(c++)}f.push(y)}for(u=0;u<n;u++)for(s=0;s<t;s++){var w=f[u][s+1],x=f[u][s],E=f[u+1][s],M=f[u+1][s+1];(0!==u||o>0)&&p.push(w,x,M),(u!==n-1||l<Math.PI)&&p.push(x,E,M)}this.setIndex(p),this.addAttribute("position",new Tn(g,3)),this.addAttribute("normal",new Tn(m,3)),this.addAttribute("uv",new Tn(v,2))}function So(e,t,n,r,i,o){vn.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Oo(e,t,n,r,i,o)),this.mergeVertices()}function Oo(e,t,n,r,i,o){Pn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},e=e||.5,t=t||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,u,l=[],c=[],f=[],d=[],h=e,p=(t-e)/(r=void 0!==r?Math.max(1,r):1),g=new zt,m=new Ft;for(s=0;s<=r;s++){for(u=0;u<=n;u++)a=i+u/n*o,g.x=h*Math.cos(a),g.y=h*Math.sin(a),c.push(g.x,g.y,g.z),f.push(0,0,1),m.x=(g.x/t+1)/2,m.y=(g.y/t+1)/2,d.push(m.x,m.y);h+=p}for(s=0;s<r;s++){var v=s*(n+1);for(u=0;u<n;u++){var y=a=u+v,_=a+n+1,b=a+n+2,w=a+1;l.push(y,_,w),l.push(_,b,w)}}this.setIndex(l),this.addAttribute("position",new Tn(c,3)),this.addAttribute("normal",new Tn(f,3)),this.addAttribute("uv",new Tn(d,2))}function ko(e,t,n,r){vn.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new Ao(e,t,n,r)),this.mergeVertices()}function Ao(e,t,n,r){Pn.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=It.clamp(r,0,2*Math.PI);var i,o,a,s=[],u=[],l=[],c=1/t,f=new zt,d=new Ft;for(o=0;o<=t;o++){var h=n+o*c*r,p=Math.sin(h),g=Math.cos(h);for(a=0;a<=e.length-1;a++)f.x=e[a].x*p,f.y=e[a].y,f.z=e[a].x*g,u.push(f.x,f.y,f.z),d.x=o/t,d.y=a/(e.length-1),l.push(d.x,d.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var m=i=a+o*e.length,v=i+e.length,y=i+e.length+1,_=i+1;s.push(m,v,_),s.push(v,y,_)}if(this.setIndex(s),this.addAttribute("position",new Tn(u,3)),this.addAttribute("uv",new Tn(l,2)),this.computeVertexNormals(),r===2*Math.PI){var b=this.attributes.normal.array,w=new zt,x=new zt,E=new zt;for(i=t*e.length*3,o=0,a=0;o<e.length;o++,a+=3)w.x=b[a+0],w.y=b[a+1],w.z=b[a+2],x.x=b[i+a+0],x.y=b[i+a+1],x.z=b[i+a+2],E.addVectors(w,x).normalize(),b[a+0]=b[i+a+0]=E.x,b[a+1]=b[i+a+1]=E.y,b[a+2]=b[i+a+2]=E.z}}function Po(e,t){vn.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Ro(e,t)),this.mergeVertices()}function Ro(e,t){Pn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(e))l(e);else for(var u=0;u<e.length;u++)l(e[u]),this.addGroup(a,s,u),a+=s,s=0;function l(e){var a,u,l,c=r.length/3,f=e.extractPoints(t),d=f.shape,h=f.holes;if(!1===mo.isClockWise(d))for(d=d.reverse(),a=0,u=h.length;a<u;a++)l=h[a],!0===mo.isClockWise(l)&&(h[a]=l.reverse());var p=mo.triangulateShape(d,h);for(a=0,u=h.length;a<u;a++)l=h[a],d=d.concat(l);for(a=0,u=d.length;a<u;a++){var g=d[a];r.push(g.x,g.y,0),i.push(0,0,1),o.push(g.x,g.y)}for(a=0,u=p.length;a<u;a++){var m=p[a],v=m[0]+c,y=m[1]+c,_=m[2]+c;n.push(v,y,_),s+=3}}this.setIndex(n),this.addAttribute("position",new Tn(r,3)),this.addAttribute("normal",new Tn(i,3)),this.addAttribute("uv",new Tn(o,2))}function Lo(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function jo(e,t){Pn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,r,i,o,a=[],s=Math.cos(It.DEG2RAD*t),u=[0,0],l={},c=["a","b","c"];e.isBufferGeometry?(o=new vn).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var f=o.vertices,d=o.faces,h=0,p=d.length;h<p;h++)for(var g=d[h],m=0;m<3;m++)n=g[c[m]],r=g[c[(m+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),void 0===l[i=u[0]+","+u[1]]?l[i]={index1:u[0],index2:u[1],face1:h,face2:void 0}:l[i].face2=h;for(i in l){var v=l[i];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=f[v.index1];a.push(y.x,y.y,y.z),y=f[v.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new Tn(a,3))}function Do(e,t,n,r,i,o,a,s){vn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new No(e,t,n,r,i,o,a,s)),this.mergeVertices()}function No(e,t,n,r,i,o,a,s){Pn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var u=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l=[],c=[],f=[],d=[],h=0,p=[],g=n/2,m=0;function v(n){var i,o,p,v=new Ft,y=new zt,_=0,b=!0===n?e:t,w=!0===n?1:-1;for(o=h,i=1;i<=r;i++)c.push(0,g*w,0),f.push(0,w,0),d.push(.5,.5),h++;for(p=h,i=0;i<=r;i++){var x=i/r*s+a,E=Math.cos(x),M=Math.sin(x);y.x=b*M,y.y=g*w,y.z=b*E,c.push(y.x,y.y,y.z),f.push(0,w,0),v.x=.5*E+.5,v.y=.5*M*w+.5,d.push(v.x,v.y),h++}for(i=0;i<r;i++){var C=o+i,T=p+i;!0===n?l.push(T,T+1,C):l.push(T+1,T,C),_+=3}u.addGroup(m,_,!0===n?1:2),m+=_}!function(){var o,v,y=new zt,_=new zt,b=0,w=(t-e)/n;for(v=0;v<=i;v++){var x=[],E=v/i,M=E*(t-e)+e;for(o=0;o<=r;o++){var C=o/r,T=C*s+a,S=Math.sin(T),O=Math.cos(T);_.x=M*S,_.y=-E*n+g,_.z=M*O,c.push(_.x,_.y,_.z),y.set(S,w,O).normalize(),f.push(y.x,y.y,y.z),d.push(C,1-E),x.push(h++)}p.push(x)}for(o=0;o<r;o++)for(v=0;v<i;v++){var k=p[v][o],A=p[v+1][o],P=p[v+1][o+1],R=p[v][o+1];l.push(k,A,R),l.push(A,P,R),b+=6}u.addGroup(m,b,0),m+=b}(),!1===o&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(l),this.addAttribute("position",new Tn(c,3)),this.addAttribute("normal",new Tn(f,3)),this.addAttribute("uv",new Tn(d,2))}function Io(e,t,n,r,i,o,a){Do.call(this,0,e,t,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Fo(e,t,n,r,i,o,a){No.call(this,0,e,t,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Bo(e,t,n,r){vn.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Uo(e,t,n,r)),this.mergeVertices()}function Uo(e,t,n,r){Pn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],u=[],l=[],c=new zt,f=new Ft;for(s.push(0,0,0),u.push(0,0,1),l.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var d=n+o/t*r;c.x=e*Math.cos(d),c.y=e*Math.sin(d),s.push(c.x,c.y,c.z),u.push(0,0,1),f.x=(s[i]/e+1)/2,f.y=(s[i+1]/e+1)/2,l.push(f.x,f.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new Tn(s,3)),this.addAttribute("normal",new Tn(u,3)),this.addAttribute("uv",new Tn(l,2))}Eo.prototype=Object.create(vn.prototype),Eo.prototype.constructor=Eo,Mo.prototype=Object.create(bo.prototype),Mo.prototype.constructor=Mo,Co.prototype=Object.create(vn.prototype),Co.prototype.constructor=Co,To.prototype=Object.create(Pn.prototype),To.prototype.constructor=To,So.prototype=Object.create(vn.prototype),So.prototype.constructor=So,Oo.prototype=Object.create(Pn.prototype),Oo.prototype.constructor=Oo,ko.prototype=Object.create(vn.prototype),ko.prototype.constructor=ko,Ao.prototype=Object.create(Pn.prototype),Ao.prototype.constructor=Ao,Po.prototype=Object.create(vn.prototype),Po.prototype.constructor=Po,Po.prototype.toJSON=function(){var e=vn.prototype.toJSON.call(this);return Lo(this.parameters.shapes,e)},Ro.prototype=Object.create(Pn.prototype),Ro.prototype.constructor=Ro,Ro.prototype.toJSON=function(){var e=Pn.prototype.toJSON.call(this);return Lo(this.parameters.shapes,e)},jo.prototype=Object.create(Pn.prototype),jo.prototype.constructor=jo,Do.prototype=Object.create(vn.prototype),Do.prototype.constructor=Do,No.prototype=Object.create(Pn.prototype),No.prototype.constructor=No,Io.prototype=Object.create(Do.prototype),Io.prototype.constructor=Io,Fo.prototype=Object.create(No.prototype),Fo.prototype.constructor=Fo,Bo.prototype=Object.create(vn.prototype),Bo.prototype.constructor=Bo,Uo.prototype=Object.create(Pn.prototype),Uo.prototype.constructor=Uo;var zo=Object.freeze({WireframeGeometry:Oi,ParametricGeometry:ki,ParametricBufferGeometry:Ai,TetrahedronGeometry:Li,TetrahedronBufferGeometry:ji,OctahedronGeometry:Di,OctahedronBufferGeometry:Ni,IcosahedronGeometry:Ii,IcosahedronBufferGeometry:Fi,DodecahedronGeometry:Bi,DodecahedronBufferGeometry:Ui,PolyhedronGeometry:Pi,PolyhedronBufferGeometry:Ri,TubeGeometry:zi,TubeBufferGeometry:Vi,TorusKnotGeometry:Hi,TorusKnotBufferGeometry:qi,TorusGeometry:Gi,TorusBufferGeometry:Wi,TextGeometry:Eo,TextBufferGeometry:Mo,SphereGeometry:Co,SphereBufferGeometry:To,RingGeometry:So,RingBufferGeometry:Oo,PlaneGeometry:jn,PlaneBufferGeometry:Dn,LatheGeometry:ko,LatheBufferGeometry:Ao,ShapeGeometry:Po,ShapeBufferGeometry:Ro,ExtrudeGeometry:_o,ExtrudeBufferGeometry:bo,EdgesGeometry:jo,ConeGeometry:Io,ConeBufferGeometry:Fo,CylinderGeometry:Do,CylinderBufferGeometry:No,CircleGeometry:Bo,CircleBufferGeometry:Uo,BoxGeometry:Rn,BoxBufferGeometry:Ln});function Vo(e){In.call(this),this.type="ShadowMaterial",this.color=new rn(0),this.transparent=!0,this.setValues(e)}function Ho(e){Bn.call(this,e),this.type="RawShaderMaterial"}function qo(e){In.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new rn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new rn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Dt,this.normalScale=new Ft(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Go(e){qo.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function Wo(e){In.call(this),this.type="MeshPhongMaterial",this.color=new rn(16777215),this.specular=new rn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new rn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Dt,this.normalScale=new Ft(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Xo(e){Wo.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Yo(e){In.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Dt,this.normalScale=new Ft(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function $o(e){In.call(this),this.type="MeshLambertMaterial",this.color=new rn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new rn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Jo(e){yi.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Vo.prototype=Object.create(In.prototype),Vo.prototype.constructor=Vo,Vo.prototype.isShadowMaterial=!0,Vo.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.color.copy(e.color),this},Ho.prototype=Object.create(Bn.prototype),Ho.prototype.constructor=Ho,Ho.prototype.isRawShaderMaterial=!0,qo.prototype=Object.create(In.prototype),qo.prototype.constructor=qo,qo.prototype.isMeshStandardMaterial=!0,qo.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Go.prototype=Object.create(qo.prototype),Go.prototype.constructor=Go,Go.prototype.isMeshPhysicalMaterial=!0,Go.prototype.copy=function(e){return qo.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},Wo.prototype=Object.create(In.prototype),Wo.prototype.constructor=Wo,Wo.prototype.isMeshPhongMaterial=!0,Wo.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Xo.prototype=Object.create(Wo.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isMeshToonMaterial=!0,Xo.prototype.copy=function(e){return Wo.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},Yo.prototype=Object.create(In.prototype),Yo.prototype.constructor=Yo,Yo.prototype.isMeshNormalMaterial=!0,Yo.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},$o.prototype=Object.create(In.prototype),$o.prototype.constructor=$o,$o.prototype.isMeshLambertMaterial=!0,$o.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Jo.prototype=Object.create(yi.prototype),Jo.prototype.constructor=Jo,Jo.prototype.isLineDashedMaterial=!0,Jo.prototype.copy=function(e){return yi.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Zo=Object.freeze({ShadowMaterial:Vo,SpriteMaterial:di,RawShaderMaterial:Ho,ShaderMaterial:Bn,PointsMaterial:xi,MeshPhysicalMaterial:Go,MeshStandardMaterial:qo,MeshPhongMaterial:Wo,MeshToonMaterial:Xo,MeshNormalMaterial:Yo,MeshLambertMaterial:$o,MeshDepthMaterial:Zr,MeshDistanceMaterial:Kr,MeshBasicMaterial:Fn,LineDashedMaterial:Jo,LineBasicMaterial:yi,Material:In}),Ko={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Qo(e,t,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===i&&void 0!==r.onStart&&r.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var ea=new Qo,ta={};function na(e){this.manager=void 0!==e?e:ea}function ra(e){this.manager=void 0!==e?e:ea,this._parser=null}function ia(e){this.manager=void 0!==e?e:ea,this._parser=null}function oa(e){this.manager=void 0!==e?e:ea}function aa(e){this.manager=void 0!==e?e:ea}function sa(e){this.manager=void 0!==e?e:ea}function ua(){this.type="Curve",this.arcLengthDivisions=200}function la(e,t,n,r,i,o,a,s){ua.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function ca(e,t,n,r,i,o){la.call(this,e,t,n,n,r,i,o),this.type="ArcCurve"}function fa(){var e=0,t=0,n=0,r=0;function i(i,o,a,s){e=i,t=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,a,s){var u=(t-e)/o-(n-e)/(o+a)+(n-t)/a,l=(n-t)/a-(r-t)/(a+s)+(r-n)/s;i(t,n,u*=a,l*=a)},calc:function(i){var o=i*i;return e+t*i+n*o+r*(o*i)}}}Object.assign(na.prototype,{load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ko.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;if(void 0===ta[e]){var a=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],u=!!a[2],l=a[3];l=window.decodeURIComponent(l),u&&(l=window.atob(l));try{var c,f=(this.responseType||"").toLowerCase();switch(f){case"arraybuffer":case"blob":for(var d=new Uint8Array(l.length),h=0;h<l.length;h++)d[h]=l.charCodeAt(h);c="blob"===f?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var p=new DOMParser;c=p.parseFromString(l,s);break;case"json":c=JSON.parse(l);break;default:c=l}window.setTimeout(function(){t&&t(c),i.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){r&&r(t),i.manager.itemEnd(e),i.manager.itemError(e)},0)}}else{ta[e]=[],ta[e].push({onLoad:t,onProgress:n,onError:r});var g=new XMLHttpRequest;for(var m in g.open("GET",e,!0),g.addEventListener("load",function(t){var n=this.response;Ko.add(e,n);var r=ta[e];if(delete ta[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)}},!1),g.addEventListener("progress",function(t){for(var n=ta[e],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(t)}},!1),g.addEventListener("error",function(t){var n=ta[e];delete ta[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)},!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.overrideMimeType&&g.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)g.setRequestHeader(m,this.requestHeader[m]);g.send(null)}return i.manager.itemStart(e),g}ta[e].push({onLoad:t,onProgress:n,onError:r})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(ra.prototype,{load:function(e,t,n,r){var i=this,o=[],a=new Ci;a.image=o;var s=new na(this.manager);function u(u){s.load(e[u],function(e){var n=i._parser(e,!0);o[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(a.minFilter=we),a.format=n.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,c=0,f=e.length;c<f;++c)u(c);else s.load(e,function(e){var n=i._parser(e,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=we),a.format=n.format,a.needsUpdate=!0,t&&t(a)},n,r);return a},setPath:function(e){return this.path=e,this}}),Object.assign(ia.prototype,{load:function(e,t,n,r){var i=this,o=new $t,a=new na(this.manager);return a.setResponseType("arraybuffer"),a.load(e,function(e){var n=i._parser(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:me,o.wrapT=void 0!==n.wrapT?n.wrapT:me,o.magFilter=void 0!==n.magFilter?n.magFilter:we,o.minFilter=void 0!==n.minFilter?n.minFilter:Ee,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=we),o.needsUpdate=!0,t&&t(o,n))},n,r),o}}),Object.assign(oa.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ko.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),Ko.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),r&&r(t),i.manager.itemEnd(e),i.manager.itemError(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(aa.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new qn,o=new oa(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(e[n],function(e){i.images[n]=e,6===++a&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(var u=0;u<e.length;++u)s(u);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(sa.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new Gt,o=new oa(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(n){i.image=n;var r=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?Ie:Fe,i.needsUpdate=!0,void 0!==t&&t(i)},n,r),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(ua.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=e;n++)o+=(t=this.getPoint(n/e)).distanceTo(i),r.push(o),i=t;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,o=r.length;n=t||e*r[o-1];for(var a,s=0,u=o-1;s<=u;)if((a=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(o-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(o-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),n>1&&(n=1);var r=this.getPoint(t);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,r,i,o=new zt,a=[],s=[],u=[],l=new zt,c=new Bt;for(n=0;n<=e;n++)r=n/e,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new zt,u[0]=new zt;var f=Number.MAX_VALUE,d=Math.abs(a[0].x),h=Math.abs(a[0].y),p=Math.abs(a[0].z);for(d<=f&&(f=d,o.set(1,0,0)),h<=f&&(f=h,o.set(0,1,0)),p<=f&&o.set(0,0,1),l.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],l),u[0].crossVectors(a[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),u[n]=u[n-1].clone(),l.crossVectors(a[n-1],a[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(It.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(l,i))),u[n].crossVectors(a[n],s[n]);if(!0===t)for(i=Math.acos(It.clamp(s[0].dot(s[e]),-1,1)),i/=e,a[0].dot(l.crossVectors(s[0],s[e]))>0&&(i=-i),n=1;n<=e;n++)s[n].applyMatrix4(c.makeRotationAxis(a[n],i*n)),u[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),la.prototype=Object.create(ua.prototype),la.prototype.constructor=la,la.prototype.isEllipseCurve=!0,la.prototype.getPoint=function(e,t){for(var n=t||new Ft,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),f=s-this.aX,d=u-this.aY;s=f*l-d*c+this.aX,u=f*c+d*l+this.aY}return n.set(s,u)},la.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},la.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},la.prototype.fromJSON=function(e){return ua.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ca.prototype=Object.create(la.prototype),ca.prototype.constructor=ca,ca.prototype.isArcCurve=!0;var da=new zt,ha=new fa,pa=new fa,ga=new fa;function ma(e,t,n,r){ua.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function va(e,t,n,r,i){var o=.5*(r-t),a=.5*(i-n),s=e*e;return(2*n-2*r+o+a)*(e*s)+(-3*n+3*r-2*o-a)*s+o*e+n}function ya(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function _a(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function ba(e,t,n,r){ua.call(this),this.type="CubicBezierCurve",this.v0=e||new Ft,this.v1=t||new Ft,this.v2=n||new Ft,this.v3=r||new Ft}function wa(e,t,n,r){ua.call(this),this.type="CubicBezierCurve3",this.v0=e||new zt,this.v1=t||new zt,this.v2=n||new zt,this.v3=r||new zt}function xa(e,t){ua.call(this),this.type="LineCurve",this.v1=e||new Ft,this.v2=t||new Ft}function Ea(e,t){ua.call(this),this.type="LineCurve3",this.v1=e||new zt,this.v2=t||new zt}function Ma(e,t,n){ua.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Ft,this.v1=t||new Ft,this.v2=n||new Ft}function Ca(e,t,n){ua.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new zt,this.v1=t||new zt,this.v2=n||new zt}function Ta(e){ua.call(this),this.type="SplineCurve",this.points=e||[]}ma.prototype=Object.create(ua.prototype),ma.prototype.constructor=ma,ma.prototype.isCatmullRomCurve3=!0,ma.prototype.getPoint=function(e,t){var n,r,i,o,a=t||new zt,s=this.points,u=s.length,l=(u-(this.closed?0:1))*e,c=Math.floor(l),f=l-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/u)+1)*u:0===f&&c===u-1&&(c=u-2,f=1),this.closed||c>0?n=s[(c-1)%u]:(da.subVectors(s[0],s[1]).add(s[0]),n=da),r=s[c%u],i=s[(c+1)%u],this.closed||c+2<u?o=s[(c+2)%u]:(da.subVectors(s[u-1],s[u-2]).add(s[u-1]),o=da),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,h=Math.pow(n.distanceToSquared(r),d),p=Math.pow(r.distanceToSquared(i),d),g=Math.pow(i.distanceToSquared(o),d);p<1e-4&&(p=1),h<1e-4&&(h=p),g<1e-4&&(g=p),ha.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,h,p,g),pa.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,h,p,g),ga.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,h,p,g)}else"catmullrom"===this.curveType&&(ha.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),pa.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),ga.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(ha.calc(f),pa.calc(f),ga.calc(f)),a},ma.prototype.copy=function(e){ua.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ma.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},ma.prototype.fromJSON=function(e){ua.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new zt).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ba.prototype=Object.create(ua.prototype),ba.prototype.constructor=ba,ba.prototype.isCubicBezierCurve=!0,ba.prototype.getPoint=function(e,t){var n=t||new Ft,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(_a(e,r.x,i.x,o.x,a.x),_a(e,r.y,i.y,o.y,a.y)),n},ba.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ba.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ba.prototype.fromJSON=function(e){return ua.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},wa.prototype=Object.create(ua.prototype),wa.prototype.constructor=wa,wa.prototype.isCubicBezierCurve3=!0,wa.prototype.getPoint=function(e,t){var n=t||new zt,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(_a(e,r.x,i.x,o.x,a.x),_a(e,r.y,i.y,o.y,a.y),_a(e,r.z,i.z,o.z,a.z)),n},wa.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},wa.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},wa.prototype.fromJSON=function(e){return ua.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},xa.prototype=Object.create(ua.prototype),xa.prototype.constructor=xa,xa.prototype.isLineCurve=!0,xa.prototype.getPoint=function(e,t){var n=t||new Ft;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},xa.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},xa.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},xa.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},xa.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},xa.prototype.fromJSON=function(e){return ua.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ea.prototype=Object.create(ua.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isLineCurve3=!0,Ea.prototype.getPoint=function(e,t){var n=t||new zt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Ea.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Ea.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ea.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ea.prototype.fromJSON=function(e){return ua.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ma.prototype=Object.create(ua.prototype),Ma.prototype.constructor=Ma,Ma.prototype.isQuadraticBezierCurve=!0,Ma.prototype.getPoint=function(e,t){var n=t||new Ft,r=this.v0,i=this.v1,o=this.v2;return n.set(ya(e,r.x,i.x,o.x),ya(e,r.y,i.y,o.y)),n},Ma.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ma.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ma.prototype.fromJSON=function(e){return ua.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ca.prototype=Object.create(ua.prototype),Ca.prototype.constructor=Ca,Ca.prototype.isQuadraticBezierCurve3=!0,Ca.prototype.getPoint=function(e,t){var n=t||new zt,r=this.v0,i=this.v1,o=this.v2;return n.set(ya(e,r.x,i.x,o.x),ya(e,r.y,i.y,o.y),ya(e,r.z,i.z,o.z)),n},Ca.prototype.copy=function(e){return ua.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ca.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ca.prototype.fromJSON=function(e){return ua.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ta.prototype=Object.create(ua.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isSplineCurve=!0,Ta.prototype.getPoint=function(e,t){var n=t||new Ft,r=this.points,i=(r.length-1)*e,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],l=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return n.set(va(a,s.x,u.x,l.x,c.x),va(a,s.y,u.y,l.y,c.y)),n},Ta.prototype.copy=function(e){ua.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},Ta.prototype.toJSON=function(){var e=ua.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},Ta.prototype.fromJSON=function(e){ua.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Ft).fromArray(r))}return this};var Sa=Object.freeze({ArcCurve:ca,CatmullRomCurve3:ma,CubicBezierCurve:ba,CubicBezierCurve3:wa,EllipseCurve:la,LineCurve:xa,LineCurve3:Ea,QuadraticBezierCurve:Ma,QuadraticBezierCurve3:Ca,SplineCurve:Ta});function Oa(){ua.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ka(e){Oa.call(this),this.type="Path",this.currentPoint=new Ft,e&&this.setFromPoints(e)}function Aa(e){ka.call(this,e),this.uuid=It.generateUUID(),this.type="Shape",this.holes=[]}function Pa(e,t){dn.call(this),this.type="Light",this.color=new rn(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Ra(e,t,n){Pa.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(dn.DefaultUp),this.updateMatrix(),this.groundColor=new rn(t)}function La(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Ft(512,512),this.map=null,this.matrix=new Bt}function ja(){La.call(this,new ri(50,1,.5,500))}function Da(e,t,n,r,i,o){Pa.call(this,e,t),this.type="SpotLight",this.position.copy(dn.DefaultUp),this.updateMatrix(),this.target=new dn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new ja}function Na(e,t,n,r){Pa.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new La(new ri(90,1,.5,500))}function Ia(){La.call(this,new pn(-5,5,5,-5,.5,500))}function Fa(e,t){Pa.call(this,e,t),this.type="DirectionalLight",this.position.copy(dn.DefaultUp),this.updateMatrix(),this.target=new dn,this.shadow=new Ia}function Ba(e,t){Pa.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Ua(e,t,n,r){Pa.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}Oa.prototype=Object.assign(Object.create(ua.prototype),{constructor:Oa,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new xa(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),u=0;u<s.length;u++){var l=s[u];t&&t.equals(l)||(n.push(l),t=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){ua.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=ua.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){ua.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new Sa[r.type]).fromJSON(r))}return this}}),ka.prototype=Object.assign(Object.create(Oa.prototype),{constructor:ka,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new xa(this.currentPoint.clone(),new Ft(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,r){var i=new Ma(this.currentPoint.clone(),new Ft(e,t),new Ft(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(e,t,n,r,i,o){var a=new ba(this.currentPoint.clone(),new Ft(e,t),new Ft(n,r),new Ft(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(e){var t=new Ta([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,n,r,i,o)},absarc:function(e,t,n,r,i,o){this.absellipse(e,t,n,n,r,i,o)},ellipse:function(e,t,n,r,i,o,a,s){var u=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(e+u,t+l,n,r,i,o,a,s)},absellipse:function(e,t,n,r,i,o,a,s){var u=new la(e,t,n,r,i,o,a,s);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var c=u.getPoint(1);this.currentPoint.copy(c)},copy:function(e){return Oa.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Oa.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Oa.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Aa.prototype=Object.assign(Object.create(ka.prototype),{constructor:Aa,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){ka.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=ka.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){ka.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new ka).fromJSON(r))}return this}}),Pa.prototype=Object.assign(Object.create(dn.prototype),{constructor:Pa,isLight:!0,copy:function(e){return dn.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=dn.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Ra.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Ra,isHemisphereLight:!0,copy:function(e){return Pa.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(La.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),ja.prototype=Object.assign(Object.create(La.prototype),{constructor:ja,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*It.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix())}}),Da.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Da,isSpotLight:!0,copy:function(e){return Pa.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Na.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Na,isPointLight:!0,copy:function(e){return Pa.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Ia.prototype=Object.assign(Object.create(La.prototype),{constructor:Ia}),Fa.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Fa,isDirectionalLight:!0,copy:function(e){return Pa.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Ba.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Ba,isAmbientLight:!0}),Ua.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Ua,isRectAreaLight:!0,copy:function(e){return Pa.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Pa.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var za={arraySlice:function(e,t,n){return za.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort(function(t,n){return e[t]-e[n]}),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*t,u=0;u!==t;++u)i[a++]=e[s+u];return i},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(t.push(o.time),n.push.apply(n,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(t.push(o.time),a.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(t.push(o.time),n.push(a)),o=e[i++]}while(void 0!==o)}}};function Va(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Ha(e,t,n,r){Va.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function qa(e,t,n,r){Va.call(this,e,t,n,r)}function Ga(e,t,n,r){Va.call(this,e,t,n,r)}function Wa(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=za.convertArray(t,this.TimeBufferType),this.values=za.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Xa(e,t,n){Wa.call(this,e,t,n)}function Ya(e,t,n,r){Wa.call(this,e,t,n,r)}function $a(e,t,n,r){Wa.call(this,e,t,n,r)}function Ja(e,t,n,r){Va.call(this,e,t,n,r)}function Za(e,t,n,r){Wa.call(this,e,t,n,r)}function Ka(e,t,n,r){Wa.call(this,e,t,n,r)}function Qa(e,t,n,r){Wa.call(this,e,t,n,r)}function es(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=It.generateUUID(),this.duration<0&&this.resetDuration()}function ts(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $a;case"vector":case"vector2":case"vector3":case"vector4":return Qa;case"color":return Ya;case"quaternion":return Za;case"bool":case"boolean":return Xa;case"string":return Ka}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];za.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}function ns(e){this.manager=void 0!==e?e:ea,this.textures={}}function rs(e){this.manager=void 0!==e?e:ea}Object.assign(Va.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var o;n:{r:if(!(e<r)){for(var a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,e<(r=t[++n]))break t}o=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===a)break;if(r=i,e>=(i=t[--n-1]))break t}o=n,n=0}for(;n<o;){var u=n+o>>>1;e<t[u]?o=u:n=u+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,o=0;o!==r;++o)t[o]=n[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Va.prototype,{beforeStart_:Va.prototype.copySampleValue_,afterEnd_:Va.prototype.copySampleValue_}),Ha.prototype=Object.assign(Object.create(Va.prototype),{constructor:Ha,DefaultSettings_:{endingStart:_t,endingEnd:_t},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case bt:i=e,a=2*t-n;break;case wt:a=t+r[i=r.length-2]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case bt:o=e,s=2*n-t;break;case wt:o=1,s=n+r[1]-r[0];break;default:o=e-1,s=t}var u=.5*(n-t),l=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=o*l},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=s-a,l=this._offsetPrev,c=this._offsetNext,f=this._weightPrev,d=this._weightNext,h=(n-t)/(r-t),p=h*h,g=p*h,m=-f*g+2*f*p-f*h,v=(1+f)*g+(-1.5-2*f)*p+(-.5+f)*h+1,y=(-1-d)*g+(1.5+d)*p+.5*h,_=d*g-d*p,b=0;b!==a;++b)i[b]=m*o[l+b]+v*o[u+b]+y*o[s+b]+_*o[c+b];return i}}),qa.prototype=Object.assign(Object.create(Va.prototype),{constructor:qa,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=s-a,l=(n-t)/(r-t),c=1-l,f=0;f!==a;++f)i[f]=o[u+f]*c+o[s+f]*l;return i}}),Ga.prototype=Object.assign(Object.create(Va.prototype),{constructor:Ga,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Wa,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:za.convertArray(e.times,Array),values:za.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(Wa.prototype,{constructor:Wa,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:vt,InterpolantFactoryMethodDiscrete:function(e){return new Ga(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new qa(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ha(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case mt:t=this.InterpolantFactoryMethodDiscrete;break;case vt:t=this.InterpolantFactoryMethodLinear;break;case yt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return mt;case this.InterpolantFactoryMethodLinear:return vt;case this.InterpolantFactoryMethodSmooth:return yt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=za.arraySlice(n,i,o),this.values=za.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==r&&za.isTypedArray(r)){a=0;for(var u=r.length;a!==u;++a){var l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),r=this.getInterpolation()===yt,i=1,o=e.length-1,a=1;a<o;++a){var s=!1,u=e[a];if(u!==e[a+1]&&(1!==a||u!==u[0]))if(r)s=!0;else for(var l=a*n,c=l-n,f=l+n,d=0;d!==n;++d){var h=t[l+d];if(h!==t[c+d]||h!==t[f+d]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];var p=a*n,g=i*n;for(d=0;d!==n;++d)t[g+d]=t[p+d]}++i}}if(o>0){e[i]=e[o];for(p=o*n,g=i*n,d=0;d!==n;++d)t[g+d]=t[p+d];++i}return i!==e.length&&(this.times=za.arraySlice(e,0,i),this.values=za.arraySlice(t,0,i*n)),this}}),Xa.prototype=Object.assign(Object.create(Wa.prototype),{constructor:Xa,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:mt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ya.prototype=Object.assign(Object.create(Wa.prototype),{constructor:Ya,ValueTypeName:"color"}),$a.prototype=Object.assign(Object.create(Wa.prototype),{constructor:$a,ValueTypeName:"number"}),Ja.prototype=Object.assign(Object.create(Va.prototype),{constructor:Ja,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=(n-t)/(r-t),l=s+a;s!==l;s+=4)Ut.slerpFlat(i,0,o,s-a,o,s,u);return i}}),Za.prototype=Object.assign(Object.create(Wa.prototype),{constructor:Za,ValueTypeName:"quaternion",DefaultInterpolation:vt,InterpolantFactoryMethodLinear:function(e){return new Ja(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Ka.prototype=Object.assign(Object.create(Wa.prototype),{constructor:Ka,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:mt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Qa.prototype=Object.assign(Object.create(Wa.prototype),{constructor:Qa,ValueTypeName:"vector"}),Object.assign(es,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,o=n.length;i!==o;++i)t.push(ts(n[i]).scale(r));return new es(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,o=n.length;i!==o;++i)t.push(Wa.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],u=[];s.push((a+i-1)%i,a,(a+1)%i),u.push(0,1,0);var l=za.getKeyframeOrder(s);s=za.sortedArray(s,1,l),u=za.sortedArray(u,1,l),r||0!==s[0]||(s.push(i),u.push(u[0])),o.push(new $a(".morphTargetInfluences["+t[a].name+"]",s,u).scale(1/n))}return new es(e,-1,o)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],u=s.name.match(i);if(u&&u.length>1){var l=r[f=u[1]];l||(r[f]=l=[]),l.push(s)}}var c=[];for(var f in r)c.push(es.CreateFromMorphTargetSequence(f,r[f],t,n));return c},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var o=[],a=[];za.flattenJSON(n,o,a,r),0!==o.length&&i.push(new e(t,o,a))}},r=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],u=0;u<s.length;u++){var l=s[u].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var c={},f=0;f<l.length;f++)if(l[f].morphTargets)for(var d=0;d<l[f].morphTargets.length;d++)c[l[f].morphTargets[d]]=-1;for(var h in c){var p=[],g=[];for(d=0;d!==l[f].morphTargets.length;++d){var m=l[f];p.push(m.time),g.push(m.morphTarget===h?1:0)}r.push(new $a(".morphTargetInfluence["+h+"]",p,g))}o=c.length*(a||1)}else{var v=".bones["+t[u].name+"]";n(Qa,v+".position",l,"pos",r),n(Za,v+".quaternion",l,"rot",r),n(Qa,v+".scale",l,"scl",r)}}return 0===r.length?null:new es(i,o,r)}}),Object.assign(es.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(ns.prototype,{load:function(e,t,n,r){var i=this;new na(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Zo[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearCoat&&(r.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(r.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(r.uniforms=e.uniforms),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(r.vertexColors=e.vertexColors),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap),r.transparent=!0),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var i=e.normalScale;!1===Array.isArray(i)&&(i=[i,i]),r.normalScale=(new Ft).fromArray(i)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),r}}),Object.assign(rs.prototype,{load:function(e,t,n,r){var i=this;new na(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},parse:function(e){var t=new Pn,n=e.data.index;if(void 0!==n){var r=new is[n.type](n.array);t.setIndex(new yn(r,1))}var i=e.data.attributes;for(var o in i){var a=i[o];r=new is[a.type](a.array);t.addAttribute(o,new yn(r,a.itemSize,a.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var u=0,l=s.length;u!==l;++u){var c=s[u];t.addGroup(c.start,c.count,c.materialIndex)}var f=e.data.boundingSphere;if(void 0!==f){var d=new zt;void 0!==f.center&&d.fromArray(f.center),t.boundingSphere=new Zt(d,f.radius)}return t}});var is={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function os(){}os.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,r=t.length;n<r;n+=2){var i=t[n],o=t[n+1];if(i.test(e))return o}return null}},Object.assign(os.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var r=[],i=0;i<e.length;++i)r[i]=this.createMaterial(e[i],t,n);return r},createMaterial:function(){var e={NoBlending:E,NormalBlending:M,AdditiveBlending:C,SubtractiveBlending:T,MultiplyBlending:S,CustomBlending:O},t=new rn,n=new sa,r=new ns;return function(i,o,a){var s={};function u(e,t,r,i,u){var l,c=o+e,f=os.Handlers.get(c);null!==f?l=f.load(c):(n.setCrossOrigin(a),l=n.load(c)),void 0!==t&&(l.repeat.fromArray(t),1!==t[0]&&(l.wrapS=ge),1!==t[1]&&(l.wrapT=ge)),void 0!==r&&l.offset.fromArray(r),void 0!==i&&("repeat"===i[0]&&(l.wrapS=ge),"mirror"===i[0]&&(l.wrapS=ve),"repeat"===i[1]&&(l.wrapT=ge),"mirror"===i[1]&&(l.wrapT=ve)),void 0!==u&&(l.anisotropy=u);var d=It.generateUUID();return s[d]=l,d}var l={uuid:It.generateUUID(),type:"MeshLambertMaterial"};for(var c in i){var f=i[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=f;break;case"blending":l.blending=e[f];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":l.color=t.fromArray(f).getHex();break;case"colorSpecular":l.specular=t.fromArray(f).getHex();break;case"colorEmissive":l.emissive=t.fromArray(f).getHex();break;case"specularCoef":l.shininess=f;break;case"shading":"basic"===f.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===f.toLowerCase()&&(l.type="MeshPhongMaterial"),"standard"===f.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=u(f,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=u(f,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=u(f,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=u(f,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=u(f,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=f;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=u(f,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=f;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=u(f,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=u(f,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=u(f,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=u(f,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=m;break;case"doubleSided":l.side=v;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),l.opacity=f;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[c]=f;break;case"vertexColors":!0===f&&(l.vertexColors=x),"face"===f&&(l.vertexColors=w);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,f)}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,l.opacity<1&&(l.transparent=!0),r.setTextures(s),r.parse(l)}}()});var as={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function ss(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:ea,this.withCredentials=!1}function us(e){this.manager=void 0!==e?e:ea,this.texturePath=""}Object.assign(ss.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:as.extractUrlBase(e),a=new na(this.manager);a.setWithCredentials(this.withCredentials),a.load(e,function(n){var r=JSON.parse(n),a=r.metadata;if(void 0!==a){var s=a.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.")}var u=i.parse(r,o);t(u.geometry,u.materials)},n,r)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setTexturePath:function(e){return this.texturePath=e,this},parse:function(){return function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var n=new vn;return function(e,t){function n(e,t){return e&1<<t}var r,i,o,a,s,u,l,c,f,d,h,p,g,m,v,y,_,b,w,x,E,M,C,T,S,O=e.faces,k=e.vertices,A=e.normals,P=e.colors,R=e.scale,L=0;if(void 0!==e.uvs){for(r=0;r<e.uvs.length;r++)e.uvs[r].length&&L++;for(r=0;r<L;r++)t.faceVertexUvs[r]=[]}for(a=0,s=k.length;a<s;)(b=new zt).x=k[a++]*R,b.y=k[a++]*R,b.z=k[a++]*R,t.vertices.push(b);for(a=0,s=O.length;a<s;)if(h=n(d=O[a++],0),p=n(d,1),g=n(d,3),m=n(d,4),v=n(d,5),y=n(d,6),_=n(d,7),h){if((x=new gn).a=O[a],x.b=O[a+1],x.c=O[a+3],(E=new gn).a=O[a+1],E.b=O[a+2],E.c=O[a+3],a+=4,p&&(f=O[a++],x.materialIndex=f,E.materialIndex=f),o=t.faces.length,g)for(r=0;r<L;r++)for(T=e.uvs[r],t.faceVertexUvs[r][o]=[],t.faceVertexUvs[r][o+1]=[],i=0;i<4;i++)S=new Ft(T[2*(c=O[a++])],T[2*c+1]),2!==i&&t.faceVertexUvs[r][o].push(S),0!==i&&t.faceVertexUvs[r][o+1].push(S);if(m&&(l=3*O[a++],x.normal.set(A[l++],A[l++],A[l]),E.normal.copy(x.normal)),v)for(r=0;r<4;r++)l=3*O[a++],C=new zt(A[l++],A[l++],A[l]),2!==r&&x.vertexNormals.push(C),0!==r&&E.vertexNormals.push(C);if(y&&(M=P[u=O[a++]],x.color.setHex(M),E.color.setHex(M)),_)for(r=0;r<4;r++)M=P[u=O[a++]],2!==r&&x.vertexColors.push(new rn(M)),0!==r&&E.vertexColors.push(new rn(M));t.faces.push(x),t.faces.push(E)}else{if((w=new gn).a=O[a++],w.b=O[a++],w.c=O[a++],p&&(f=O[a++],w.materialIndex=f),o=t.faces.length,g)for(r=0;r<L;r++)for(T=e.uvs[r],t.faceVertexUvs[r][o]=[],i=0;i<3;i++)S=new Ft(T[2*(c=O[a++])],T[2*c+1]),t.faceVertexUvs[r][o].push(S);if(m&&(l=3*O[a++],w.normal.set(A[l++],A[l++],A[l])),v)for(r=0;r<3;r++)l=3*O[a++],C=new zt(A[l++],A[l++],A[l]),w.vertexNormals.push(C);if(y&&(u=O[a++],w.color.setHex(P[u])),_)for(r=0;r<3;r++)u=O[a++],w.vertexColors.push(new rn(P[u]));t.faces.push(w)}}(e,n),function(e,t){var n=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var r=0,i=e.skinWeights.length;r<i;r+=n){var o=e.skinWeights[r],a=n>1?e.skinWeights[r+1]:0,s=n>2?e.skinWeights[r+2]:0,u=n>3?e.skinWeights[r+3]:0;t.skinWeights.push(new Wt(o,a,s,u))}if(e.skinIndices)for(r=0,i=e.skinIndices.length;r<i;r+=n){var l=e.skinIndices[r],c=n>1?e.skinIndices[r+1]:0,f=n>2?e.skinIndices[r+2]:0,d=n>3?e.skinIndices[r+3]:0;t.skinIndices.push(new Wt(l,c,f,d))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,n),function(e,t){var n=e.scale;if(void 0!==e.morphTargets)for(var r=0,i=e.morphTargets.length;r<i;r++){t.morphTargets[r]={},t.morphTargets[r].name=e.morphTargets[r].name,t.morphTargets[r].vertices=[];for(var o=t.morphTargets[r].vertices,a=e.morphTargets[r].vertices,s=0,u=a.length;s<u;s+=3){var l=new zt;l.x=a[s]*n,l.y=a[s+1]*n,l.z=a[s+2]*n,o.push(l)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=t.faces,f=e.morphColors[0].colors;for(r=0,i=c.length;r<i;r++)c[r].color.fromArray(f,3*r)}}(e,n),function(e,t){var n=[],r=[];void 0!==e.animation&&r.push(e.animation),void 0!==e.animations&&(e.animations.length?r=r.concat(e.animations):r.push(e.animations));for(var i=0;i<r.length;i++){var o=es.parseAnimation(r[i],t.bones);o&&n.push(o)}if(t.morphTargets){var a=es.CreateClipsFromMorphTargetSequences(t.morphTargets,10);n=n.concat(a)}n.length>0&&(t.animations=n)}(e,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:n}:{geometry:n,materials:os.prototype.initMaterials(e.materials,t,this.crossOrigin)}}}()}),Object.assign(us.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var i=this;new na(i.manager).load(e,function(n){var o=null;try{o=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.")},n,r)},setTexturePath:function(e){return this.texturePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),o=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,r,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Aa).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var r=new ss,i=new rs,o=0,a=e.length;o<a;o++){var s,u=e[o];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new zo[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new zo[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new zo[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new zo[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new zo[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new zo[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new zo[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new zo[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new zo[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new zo[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new zo[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new zo[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],c=0,f=u.shapes.length;c<f;c++){var d=t[u.shapes[c]];l.push(d)}s=new zo[u.type](l,u.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(l=[],c=0,f=u.shapes.length;c<f;c++){d=t[u.shapes[c]];l.push(d)}var h=u.options.extrudePath;void 0!==h&&(u.options.extrudePath=(new Sa[h.type]).fromJSON(h)),s=new zo[u.type](l,u.options);break;case"BufferGeometry":s=i.parse(u);break;case"Geometry":s=r.parse(u,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}s.uuid=u.uuid,void 0!==u.name&&(s.name=u.name),!0===s.isBufferGeometry&&void 0!==u.userData&&(s.userData=u.userData),n[u.uuid]=s}return n},parseMaterials:function(e,t){var n={};if(void 0!==e){var r=new ns;r.setTextures(t);for(var i=0,o=e.length;i<o;i++){var a=e[i];if("MultiMaterial"===a.type){for(var s=[],u=0;u<a.materials.length;u++)s.push(r.parse(a.materials[u]));n[a.uuid]=s}else n[a.uuid]=r.parse(a)}}return n},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=es.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){var n=this,r={};function i(e){return n.manager.itemStart(e),o.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemEnd(e),n.manager.itemError(e)})}if(void 0!==e&&e.length>0){var o=new oa(new Qo(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var u=e[a],l=u.url;if(Array.isArray(l)){r[u.uuid]=[];for(var c=0,f=l.length;c<f;c++){var d=l[c],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.texturePath+d;r[u.uuid].push(i(h))}}else{h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.texturePath+u.url;r[u.uuid]=i(h)}}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(t[s.image])?new qn(t[s.image]):new Gt(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,cs)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],fs),a.wrapT=n(s.wrap[1],fs)),void 0!==s.format&&(a.format=s.format),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,ds)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,ds)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),r[s.uuid]=a}return r},parseObject:function(e,t,n){var r;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var o=e[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new li,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new rn(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new ui(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new si(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new ri(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new pn(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new Ba(e.color,e.intensity);break;case"DirectionalLight":r=new Fa(e.color,e.intensity);break;case"PointLight":r=new Na(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new Ua(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new Da(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new Ra(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(e.geometry),s=o(e.material);r=a.bones&&a.bones.length>0?new vi(a,s):new Vn(a,s);break;case"LOD":r=new pi;break;case"Line":r=new _i(i(e.geometry),o(e.material),e.mode);break;case"LineLoop":r=new wi(i(e.geometry),o(e.material));break;case"LineSegments":r=new bi(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":r=new Ei(i(e.geometry),o(e.material));break;case"Sprite":r=new hi(o(e.material));break;case"Group":r=new ni;break;default:r=new dn}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var u=e.children,l=0;l<u.length;l++)r.add(this.parseObject(u[l],t,n));if("LOD"===e.type)for(var c=e.levels,f=0;f<c.length;f++){var d=c[f],h=r.getObjectByProperty("uuid",d.object);void 0!==h&&r.addLevel(h,d.distance)}return r}});var ls,cs={UVMapping:se,CubeReflectionMapping:ue,CubeRefractionMapping:le,EquirectangularReflectionMapping:ce,EquirectangularRefractionMapping:fe,SphericalReflectionMapping:de,CubeUVReflectionMapping:he,CubeUVRefractionMapping:pe},fs={RepeatWrapping:ge,ClampToEdgeWrapping:me,MirroredRepeatWrapping:ve},ds={NearestFilter:ye,NearestMipMapNearestFilter:_e,NearestMipMapLinearFilter:be,LinearFilter:we,LinearMipMapNearestFilter:xe,LinearMipMapLinearFilter:Ee};function hs(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:ea,this.options=void 0}function ps(){this.type="ShapePath",this.color=new rn,this.subPaths=[],this.currentPath=null}function gs(e){this.type="Font",this.data=e}function ms(e,t,n,r,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,u,l,c,f,d,h,p=new ps;if(o.o)for(var g=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),m=0,v=g.length;m<v;){switch(g[m++]){case"m":a=g[m++]*t+n,s=g[m++]*t+r,p.moveTo(a,s);break;case"l":a=g[m++]*t+n,s=g[m++]*t+r,p.lineTo(a,s);break;case"q":u=g[m++]*t+n,l=g[m++]*t+r,c=g[m++]*t+n,f=g[m++]*t+r,p.quadraticCurveTo(c,f,u,l);break;case"b":u=g[m++]*t+n,l=g[m++]*t+r,c=g[m++]*t+n,f=g[m++]*t+r,d=g[m++]*t+n,h=g[m++]*t+r,p.bezierCurveTo(c,f,d,h,u,l)}}return{offsetX:o.ha*t,path:p}}}function vs(e){this.manager=void 0!==e?e:ea}hs.prototype={constructor:hs,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ko.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;fetch(e).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,i.options)}).then(function(n){Ko.add(e,n),t&&t(n),i.manager.itemEnd(e)}).catch(function(t){r&&r(t),i.manager.itemEnd(e),i.manager.itemError(e)})},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(ps.prototype,{moveTo:function(e,t){this.currentPath=new ka,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r)},bezierCurveTo:function(e,t,n,r,i,o){this.currentPath.bezierCurveTo(e,t,n,r,i,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=new Aa;o.curves=i.curves,t.push(o)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=t[i],s=t[o],u=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=t[o],u=-u,s=t[i],l=-l),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var c=l*(e.x-a.x)-u*(e.y-a.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return r}var i=mo.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);var a,s,u,l=[];if(1===o.length)return s=o[0],(u=new Aa).curves=s.curves,l.push(u),l;var c=!i(o[0].getPoints());c=e?!c:c;var f,d,h=[],p=[],g=[],m=0;p[m]=void 0,g[m]=[];for(var v=0,y=o.length;v<y;v++)a=i(f=(s=o[v]).getPoints()),(a=e?!a:a)?(!c&&p[m]&&m++,p[m]={s:new Aa,p:f},p[m].s.curves=s.curves,c&&m++,g[m]=[]):g[m].push({h:s,p:f[0]});if(!p[0])return n(o);if(p.length>1){for(var _=!1,b=[],w=0,x=p.length;w<x;w++)h[w]=[];for(w=0,x=p.length;w<x;w++)for(var E=g[w],M=0;M<E.length;M++){for(var C=E[M],T=!0,S=0;S<p.length;S++)r(C.p,p[S].p)&&(w!==S&&b.push({froms:w,tos:S,hole:M}),T?(T=!1,h[S].push(C)):_=!0);T&&h[w].push(C)}b.length>0&&(_||(g=h))}v=0;for(var O=p.length;v<O;v++){u=p[v].s,l.push(u);for(var k=0,A=(d=g[v]).length;k<A;k++)u.holes.push(d[k].h)}return l}}),Object.assign(gs.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,u=0,l=0;l<r.length;l++){var c=r[l];if("\n"===c)s=0,u-=o;else{var f=ms(c,i,s,u,n);s+=f.offsetX,a.push(f.path)}}return a}(e,t,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Object.assign(vs.prototype,{load:function(e,t,n,r){var i=this,o=new na(this.manager);o.setPath(this.path),o.load(e,function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)},n,r)},parse:function(e){return new gs(e)},setPath:function(e){return this.path=e,this}});var ys={getContext:function(){return void 0===ls&&(ls=new(window.AudioContext||window.webkitAudioContext)),ls},setContext:function(e){ls=e}};function _s(e){this.manager=void 0!==e?e:ea}function bs(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ri,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ri,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function ws(e,t,n){dn.call(this),this.type="CubeCamera";var r=new ri(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new zt(1,0,0)),this.add(r);var i=new ri(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new zt(-1,0,0)),this.add(i);var o=new ri(90,1,e,t);o.up.set(0,0,1),o.lookAt(new zt(0,1,0)),this.add(o);var a=new ri(90,1,e,t);a.up.set(0,0,-1),a.lookAt(new zt(0,-1,0)),this.add(a);var s=new ri(90,1,e,t);s.up.set(0,-1,0),s.lookAt(new zt(0,0,1)),this.add(s);var u=new ri(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new zt(0,0,-1)),this.add(u);var l={format:Ie,magFilter:we,minFilter:we};this.renderTarget=new Yt(n,n,l),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,l=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,r,n),n.activeCubeFace=1,e.render(t,i,n),n.activeCubeFace=2,e.render(t,o,n),n.activeCubeFace=3,e.render(t,a,n),n.activeCubeFace=4,e.render(t,s,n),n.texture.generateMipmaps=l,n.activeCubeFace=5,e.render(t,u,n),e.setRenderTarget(null)},this.clear=function(e,t,n,r){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,e.setRenderTarget(i),e.clear(t,n,r);e.setRenderTarget(null)}}function xs(){dn.call(this),this.type="AudioListener",this.context=ys.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Es(e){dn.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ms(e){Es.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Cs(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Ts(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(_s.prototype,{load:function(e,t,n,r){var i=new na(this.manager);i.setResponseType("arraybuffer"),i.load(e,function(e){var n=e.slice(0);ys.getContext().decodeAudioData(n,function(e){t(e)})},n,r)}}),Object.assign(bs.prototype,{update:function(){var e,t,n,r,i,o,a,s,u=new Bt,l=new Bt;return function(c){if(e!==this||t!==c.focus||n!==c.fov||r!==c.aspect*this.aspect||i!==c.near||o!==c.far||a!==c.zoom||s!==this.eyeSep){e=this,t=c.focus,n=c.fov,r=c.aspect*this.aspect,i=c.near,o=c.far,a=c.zoom;var f,d,h=c.projectionMatrix.clone(),p=(s=this.eyeSep/2)*i/t,g=i*Math.tan(It.DEG2RAD*n*.5)/a;l.elements[12]=-s,u.elements[12]=s,f=-g*r+p,d=g*r+p,h.elements[0]=2*i/(d-f),h.elements[8]=(d+f)/(d-f),this.cameraL.projectionMatrix.copy(h),f=-g*r-p,d=g*r-p,h.elements[0]=2*i/(d-f),h.elements[8]=(d+f)/(d-f),this.cameraR.projectionMatrix.copy(h)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(u)}}()}),ws.prototype=Object.create(dn.prototype),ws.prototype.constructor=ws,xs.prototype=Object.assign(Object.create(dn.prototype),{constructor:xs,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new zt,t=new Ut,n=new zt,r=new zt;return function(i){dn.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(e,t,n),r.set(0,0,-1).applyQuaternion(t),o.positionX?(o.positionX.setValueAtTime(e.x,this.context.currentTime),o.positionY.setValueAtTime(e.y,this.context.currentTime),o.positionZ.setValueAtTime(e.z,this.context.currentTime),o.forwardX.setValueAtTime(r.x,this.context.currentTime),o.forwardY.setValueAtTime(r.y,this.context.currentTime),o.forwardZ.setValueAtTime(r.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(e.x,e.y,e.z),o.setOrientation(r.x,r.y,r.z,a.x,a.y,a.z))}}()}),Es.prototype=Object.assign(Object.create(dn.prototype),{constructor:Es,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Ms.prototype=Object.assign(Object.create(Es.prototype),{constructor:Ms,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(){var e=new zt,t=new Ut,n=new zt,r=new zt;return function(i){dn.prototype.updateMatrixWorld.call(this,i);var o=this.panner;this.matrixWorld.decompose(e,t,n),r.set(0,0,1).applyQuaternion(t),o.setPosition(e.x,e.y,e.z),o.setOrientation(r.x,r.y,r.z)}}()}),Object.assign(Cs.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(Ts.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*t;this._mixBufferRegion(n,r,a,1-i,t)}for(var s=t,u=t+t;s!==u;++s)if(n[s]!==n[s+t]){o.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,r){Ut.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*r}}});var Ss,Os;function ks(e,t,n){var r=n||As.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function As(e,t,n){this.path=t,this.parsedPath=n||As.parseTrackName(t),this.node=As.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Ps(){this.uuid=It.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Rs(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,o=new Array(i),a={endingStart:_t,endingEnd:_t},s=0;s!==i;++s){var u=r[s].createInterpolant(null);o[s]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=pt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Ls(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function js(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Ds(){Pn.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Ns(e,t,n){ci.call(this,e,t),this.meshPerAttribute=n||1}function Is(e,t,n){yn.call(this,e,t),this.meshPerAttribute=n||1}function Fs(e,t,n,r){this.ray=new Un(e,t),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Bs(e,t){return e.distance-t.distance}function Us(e,t,n,r){if(!1!==e.visible&&(e.raycast(t,n),!0===r))for(var i=e.children,o=0,a=i.length;o<a;o++)Us(i[o],t,n,!0)}function zs(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Vs(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function Hs(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function qs(e,t){this.min=void 0!==e?e:new Ft(1/0,1/0),this.max=void 0!==t?t:new Ft(-1/0,-1/0)}function Gs(e,t){this.start=void 0!==e?e:new zt,this.end=void 0!==t?t:new zt}function Ws(e){dn.call(this),this.material=e,this.render=function(){}}function Xs(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var u=new Pn,l=new Tn(2*a*3,3);u.addAttribute("position",l),bi.call(this,u,new yi({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ys(e,t){dn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Pn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new Tn(r,3));var u=new yi({fog:!1});this.cone=new bi(n,u),this.add(this.cone),this.update()}function $s(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new Pn,r=[],i=[],o=new rn(0,0,1),a=new rn(0,1,0),s=0;s<t.length;s++){var u=t[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new Tn(r,3)),n.addAttribute("color",new Tn(i,3));var l=new yi({vertexColors:x,depthTest:!1,depthWrite:!1,transparent:!0});bi.call(this,n,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Js(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var r=new To(t,4,2),i=new Fn({wireframe:!0,fog:!1});Vn.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Zs(e,t){dn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var n=new yi({fog:!1}),r=new Pn;r.addAttribute("position",new yn(new Float32Array(15),3)),this.line=new _i(r,n),this.add(this.line),this.update()}function Ks(e,t,n){dn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new Ni(t);r.rotateY(.5*Math.PI),this.material=new Fn({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=x);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new yn(o,3)),this.add(new Vn(r,this.material)),this.update()}function Qs(e,t,n,r){e=e||10,t=t||10,n=new rn(void 0!==n?n:4473924),r=new rn(void 0!==r?r:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],u=[],l=0,c=0,f=-a;l<=t;l++,f+=o){s.push(-a,0,f,a,0,f),s.push(f,0,-a,f,0,a);var d=l===i?n:r;d.toArray(u,c),c+=3,d.toArray(u,c),c+=3,d.toArray(u,c),c+=3,d.toArray(u,c),c+=3}var h=new Pn;h.addAttribute("position",new Tn(s,3)),h.addAttribute("color",new Tn(u,3));var p=new yi({vertexColors:x});bi.call(this,h,p)}function eu(e,t,n,r,i,o){e=e||10,t=t||16,n=n||8,r=r||64,i=new rn(void 0!==i?i:4473924),o=new rn(void 0!==o?o:8947848);var a,s,u,l,c,f,d,h=[],p=[];for(l=0;l<=t;l++)u=l/t*(2*Math.PI),a=Math.sin(u)*e,s=Math.cos(u)*e,h.push(0,0,0),h.push(a,0,s),d=1&l?i:o,p.push(d.r,d.g,d.b),p.push(d.r,d.g,d.b);for(l=0;l<=n;l++)for(d=1&l?i:o,f=e-e/n*l,c=0;c<r;c++)u=c/r*(2*Math.PI),a=Math.sin(u)*f,s=Math.cos(u)*f,h.push(a,0,s),p.push(d.r,d.g,d.b),u=(c+1)/r*(2*Math.PI),a=Math.sin(u)*f,s=Math.cos(u)*f,h.push(a,0,s),p.push(d.r,d.g,d.b);var g=new Pn;g.addAttribute("position",new Tn(h,3)),g.addAttribute("color",new Tn(p,3));var m=new yi({vertexColors:x});bi.call(this,g,m)}function tu(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var u=new Pn,l=new Tn(2*a*3,3);u.addAttribute("position",l),bi.call(this,u,new yi({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function nu(e,t,n){dn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var r=new Pn;r.addAttribute("position",new Tn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new yi({fog:!1});this.lightPlane=new _i(r,i),this.add(this.lightPlane),(r=new Pn).addAttribute("position",new Tn([0,0,0,0,0,1],3)),this.targetLine=new _i(r,i),this.add(this.targetLine),this.update()}function ru(e){var t=new Pn,n=new yi({color:16777215,vertexColors:w}),r=[],i=[],o={},a=new rn(16755200),s=new rn(16711680),u=new rn(43775),l=new rn(16777215),c=new rn(3355443);function f(e,t,n){d(e,n),d(t,n)}function d(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(r.length/3-1)}f("n1","n2",a),f("n2","n4",a),f("n4","n3",a),f("n3","n1",a),f("f1","f2",a),f("f2","f4",a),f("f4","f3",a),f("f3","f1",a),f("n1","f1",a),f("n2","f2",a),f("n3","f3",a),f("n4","f4",a),f("p","n1",s),f("p","n2",s),f("p","n3",s),f("p","n4",s),f("u1","u2",u),f("u2","u3",u),f("u3","u1",u),f("c","t",l),f("p","c",c),f("cn1","cn2",c),f("cn3","cn4",c),f("cf1","cf2",c),f("cf3","cf4",c),t.addAttribute("position",new Tn(r,3)),t.addAttribute("color",new Tn(i,3)),bi.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function iu(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Pn;i.setIndex(new yn(n,1)),i.addAttribute("position",new yn(r,3)),bi.call(this,i,new yi({color:t})),this.matrixAutoUpdate=!1,this.update()}function ou(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Pn;i.setIndex(new yn(r,1)),i.addAttribute("position",new Tn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),bi.call(this,i,new yi({color:n})),this.geometry.computeBoundingSphere()}function au(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var r=void 0!==n?n:16776960,i=new Pn;i.addAttribute("position",new Tn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),_i.call(this,i,new yi({color:r}));var o=new Pn;o.addAttribute("position",new Tn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Vn(o,new Fn({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function su(e,t,n,r,i,o){dn.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===Ss&&((Ss=new Pn).addAttribute("position",new Tn([0,0,0,0,1,0],3)),(Os=new No(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new _i(Ss,new yi({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Vn(Os,new Fn({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,o)}function uu(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Pn;n.addAttribute("position",new Tn(t,3)),n.addAttribute("color",new Tn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new yi({vertexColors:x});bi.call(this,n,r)}function lu(e,t,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new gn(e,t,n,i,o,a)}Object.assign(ks.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(As,{Composite:ks,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new As.Composite(e,t,n):new As(e,t,n)},sanitizeNodeName:function(){var e=new RegExp("[\\[\\]\\.:\\/]","g");return function(t){return t.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var e="[^\\[\\]\\.:\\/]",t="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",n=/((?:WC+[\/:])*)/.source.replace("WC",e),r=/(WCOD+)?/.source.replace("WCOD",t),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e),a=new RegExp("^"+n+r+i+o+"$"),s=["material","materials","bones"];return function(e){var t=a.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==s.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function(e){for(var n=0;n<e.length;n++){var i=e[n];if(i.name===t||i.uuid===t)return i;var o=r(i.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}}),Object.assign(As.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=As.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[r];if(void 0!==s){var u=this.Versioning.None;void 0!==e.needsUpdate?(u=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][u]}else{var c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(As.prototype,{_getValue_unbound:As.prototype.getValue,_setValue_unbound:As.prototype.setValue}),Object.assign(Ps.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,u=void 0,l=0,c=arguments.length;l!==c;++l){var f=arguments[l],d=f.uuid,h=r[d];if(void 0===h){h=t++,r[d]=h,e.push(f);for(var p=0,g=s;p!==g;++p)a[p].push(new As(f,i[p],o[p]))}else if(h<n){u=e[h];var m=--n,v=e[m];r[v.uuid]=h,e[h]=v,r[d]=m,e[m]=f;for(p=0,g=s;p!==g;++p){var y=a[p],_=y[m],b=y[h];y[h]=_,void 0===b&&(b=new As(f,i[p],o[p])),y[m]=b}}else e[h]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,l=n[u];if(void 0!==l&&l>=t){var c=t++,f=e[c];n[f.uuid]=l,e[l]=f,n[u]=c,e[c]=s;for(var d=0,h=i;d!==h;++d){var p=r[d],g=p[c],m=p[l];p[l]=g,p[c]=m}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a].uuid,l=r[u];if(void 0!==l)if(delete r[u],l<n){var c=--n,f=e[c],d=e[v=--t];r[f.uuid]=l,e[l]=f,r[d.uuid]=c,e[c]=d,e.pop();for(var h=0,p=o;h!==p;++h){var g=(y=i[h])[c],m=y[v];y[l]=g,y[c]=m,y.pop()}}else{var v;r[(d=e[v=--t]).uuid]=l,e[l]=d,e.pop();for(h=0,p=o;h!==p;++h){var y;(y=i[h])[l]=y[v],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[e]=r,o.push(e),a.push(t),i.push(c);for(var f=l,d=s.length;f!==d;++f){var h=s[f];c[f]=new As(h,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(Rs.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,o=i/r,a=r/i;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=e/a,u[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var u=this._interpolants,l=this._propertyBindings,c=0,f=u.length;c!==f;++c)u[c].evaluate(a),l[c].accumulate(r,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,r=this.loop,i=this._loopCount,o=r===gt;if(0===e)return-1===i?t:o&&1==(1&i)?n-t:t;if(r===ht){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=n||t<0){var a=Math.floor(t/n);t-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&i))return this.time=t,n-t}return this.time=t,t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=bt,r.endingEnd=bt):(r.endingStart=e?this.zeroSlopeAtStart?bt:_t:wt,r.endingEnd=t?this.zeroSlopeAtEnd?bt:_t:wt)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=n,this}}),Ls.prototype=Object.assign(Object.create(r.prototype),{constructor:Ls,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,u=this._bindingsByRootAndName,l=u[s];void 0===l&&(l={},u[s]=l);for(var c=0;c!==i;++c){var f=r[c],d=f.name,h=l[d];if(void 0!==h)o[c]=h;else{if(void 0!==(h=o[c])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,s,d));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;++(h=new Ts(As.create(n,d,p),f.ValueTypeName,f.getValueSize())).referenceCount,this._addInactiveBinding(h,s,d),o[c]=h}a[c].resultBuffer=h.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],l=e._byClipCacheIndex;u._byClipCacheIndex=l,s[l]=u,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],o=this._bindings;void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete a[i];e:{for(var l in a)break e;delete o[r]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new qa(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?es.findByName(n,e):e,o=null!==i?i.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var u=a.actionByRoot[r];if(void 0!==u)return u;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var l=new Rs(this,i,t);return this._bindAction(l,s),this._addInactiveAction(l,o,r),l},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?es.findByName(n,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a){t[a]._update(r,e,i,o)}var s=this._bindings,u=this._nActiveBindings;for(a=0;a!==u;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var l=u._cacheIndex,c=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=l,t[l]=c,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),js.prototype.clone=function(){return new js(void 0===this.value.clone?this.value:this.value.clone())},Ds.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Ds,isInstancedBufferGeometry:!0,copy:function(e){return Pn.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Ns.prototype=Object.assign(Object.create(ci.prototype),{constructor:Ns,isInstancedInterleavedBuffer:!0,copy:function(e){return ci.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Is.prototype=Object.assign(Object.create(yn.prototype),{constructor:Is,isInstancedBufferAttribute:!0,copy:function(e){return yn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Fs.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var r=n||[];return Us(e,this,r,t),r.sort(Bs),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=e.length;i<o;i++)Us(e[i],this,r,t);return r.sort(Bs),r}}),Object.assign(zs.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(Vs.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(It.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(Hs.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),Object.assign(qs.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Ft;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Ft),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Ft),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Ft),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Ft),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Ft;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Gs.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new zt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new zt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new zt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new zt,t=new zt;return function(n,r){e.subVectors(n,this.start),t.subVectors(this.end,this.start);var i=t.dot(t),o=t.dot(e)/i;return r&&(o=It.clamp(o,0,1)),o}}(),closestPointToPoint:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new zt),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Ws.prototype=Object.create(dn.prototype),Ws.prototype.constructor=Ws,Ws.prototype.isImmediateRenderObject=!0,Xs.prototype=Object.create(bi.prototype),Xs.prototype.constructor=Xs,Xs.prototype.update=function(){var e=new zt,t=new zt,n=new Vt;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,u=a.faces,l=0,c=0,f=u.length;c<f;c++)for(var d=u[c],h=0,p=d.vertexNormals.length;h<p;h++){var g=s[d[r[h]]],m=d.vertexNormals[h];e.copy(g).applyMatrix4(i),t.copy(m).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),o.setXYZ(l,e.x,e.y,e.z),l+=1,o.setXYZ(l,t.x,t.y,t.z),l+=1}else if(a&&a.isBufferGeometry){var v=a.attributes.position,y=a.attributes.normal;for(l=0,h=0,p=v.count;h<p;h++)e.set(v.getX(h),v.getY(h),v.getZ(h)).applyMatrix4(i),t.set(y.getX(h),y.getY(h),y.getZ(h)),t.applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),o.setXYZ(l,e.x,e.y,e.z),l+=1,o.setXYZ(l,t.x,t.y,t.z),l+=1}o.needsUpdate=!0}}(),Ys.prototype=Object.create(dn.prototype),Ys.prototype.constructor=Ys,Ys.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ys.prototype.update=function(){var e=new zt,t=new zt;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),$s.prototype=Object.create(bi.prototype),$s.prototype.constructor=$s,$s.prototype.updateMatrixWorld=function(){var e=new zt,t=new Bt,n=new Bt;return function(r){var i=this.bones,o=this.geometry,a=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,u=0;s<i.length;s++){var l=i[s];l.parent&&l.parent.isBone&&(t.multiplyMatrices(n,l.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(u,e.x,e.y,e.z),t.multiplyMatrices(n,l.parent.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(u+1,e.x,e.y,e.z),u+=2)}o.getAttribute("position").needsUpdate=!0,dn.prototype.updateMatrixWorld.call(this,r)}}(),Js.prototype=Object.create(Vn.prototype),Js.prototype.constructor=Js,Js.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Js.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Zs.prototype=Object.create(dn.prototype),Zs.prototype.constructor=Zs,Zs.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Zs.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=e,r[1]=-t,r[2]=0,r[3]=e,r[4]=t,r[5]=0,r[6]=-e,r[7]=t,r[8]=0,r[9]=-e,r[10]=-t,r[11]=0,r[12]=e,r[13]=-t,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},Ks.prototype=Object.create(dn.prototype),Ks.prototype.constructor=Ks,Ks.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ks.prototype.update=function(){var e=new zt,t=new rn,n=new rn;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");t.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?t:n;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Qs.prototype=Object.create(bi.prototype),Qs.prototype.constructor=Qs,eu.prototype=Object.create(bi.prototype),eu.prototype.constructor=eu,tu.prototype=Object.create(bi.prototype),tu.prototype.constructor=tu,tu.prototype.update=function(){var e=new zt,t=new zt,n=new Vt;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,u=0,l=0,c=s.length;l<c;l++){var f=s[l],d=f.normal;e.copy(a[f.a]).add(a[f.b]).add(a[f.c]).divideScalar(3).applyMatrix4(r),t.copy(d).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),i.setXYZ(u,e.x,e.y,e.z),u+=1,i.setXYZ(u,t.x,t.y,t.z),u+=1}i.needsUpdate=!0}}(),nu.prototype=Object.create(dn.prototype),nu.prototype.constructor=nu,nu.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},nu.prototype.update=function(){var e=new zt,t=new zt,n=new zt;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),ru.prototype=Object.create(bi.prototype),ru.prototype.constructor=ru,ru.prototype.update=function(){var e,t,n=new zt,r=new hn;function i(i,o,a,s){n.set(o,a,s).unproject(r);var u=t[i];if(void 0!==u)for(var l=e.getAttribute("position"),c=0,f=u.length;c<f;c++)l.setXYZ(u[c],n.x,n.y,n.z)}return function(){e=this.geometry,t=this.pointMap;r.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),iu.prototype=Object.create(bi.prototype),iu.prototype.constructor=iu,iu.prototype.update=function(){var e=new Jt;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var n=e.min,r=e.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),iu.prototype.setFromObject=function(e){return this.object=e,this.update(),this},ou.prototype=Object.create(bi.prototype),ou.prototype.constructor=ou,ou.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),dn.prototype.updateMatrixWorld.call(this,e))},au.prototype=Object.create(_i.prototype),au.prototype.constructor=au,au.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?m:g,this.lookAt(this.plane.normal),dn.prototype.updateMatrixWorld.call(this,e)},su.prototype=Object.create(dn.prototype),su.prototype.constructor=su,su.prototype.setDirection=function(){var e,t=new zt;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(n.z,0,-n.x).normalize(),e=Math.acos(n.y),this.quaternion.setFromAxisAngle(t,e))}}(),su.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},su.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},uu.prototype=Object.create(bi.prototype),uu.prototype.constructor=uu;var cu=0,fu=1;function du(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function hu(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function pu(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ei(e,t)}function gu(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new hi(e)}function mu(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ei(e,t)}function vu(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new xi(e)}function yu(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new xi(e)}function _u(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new xi(e)}function bu(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new zt(e,t,n)}function wu(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new yn(e,t).setDynamic(!0)}function xu(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new _n(e,t)}function Eu(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new bn(e,t)}function Mu(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new wn(e,t)}function Cu(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new xn(e,t)}function Tu(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new En(e,t)}function Su(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Mn(e,t)}function Ou(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Cn(e,t)}function ku(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Tn(e,t)}function Au(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Sn(e,t)}function Pu(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ma.call(this,e),this.type="catmullrom",this.closed=!0}function Ru(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ma.call(this,e),this.type="catmullrom"}function Lu(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ma.call(this,e),this.type="catmullrom"}function ju(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new uu(e)}function Du(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new iu(e,t)}function Nu(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new bi(new jo(e.geometry),new yi({color:void 0!==t?t:16777215}))}function Iu(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new bi(new Oi(e.geometry),new yi({color:void 0!==t?t:16777215}))}function Fu(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new na(e)}function Bu(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ia(e)}ua.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(ua.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Oa.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new vn,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new zt(i.x,i.y,i.z||0))}return t}}),Object.assign(ka.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Pu.prototype=Object.create(ma.prototype),Ru.prototype=Object.create(ma.prototype),Lu.prototype=Object.create(ma.prototype),Object.assign(Lu.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Qs.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},$s.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(os.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),as.extractUrlBase(e)}}),Object.assign(qs.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Jt.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Gs.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(It,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),It.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),It.ceilPowerOfTwo(e)}}),Object.assign(Vt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Bt.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new zt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)}}),Kt.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Ut.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Un.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(zn.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(zn,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),zn.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),zn.getNormal(e,t,n,r)}}),Object.assign(Aa.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new _o(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Po(this,e)}}),Object.assign(Ft.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(zt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Wt.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(vn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(dn.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(dn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(pi.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(gi.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(ua.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),ri.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Pa.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(yn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Pn.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Pn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(bo.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(js.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(In.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new rn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===y}}}),Object.defineProperties(Wo.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Bn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(ai.prototype,{animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(ai.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Qr.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Xt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(oi.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Es.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new _s).load(e,function(e){t.setBuffer(e)}),this},Cs.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ws.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var Uu={merge:function(e,t,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};function zu(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Vu(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}Ht.crossOrigin=void 0,Ht.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new sa;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},Ht.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new aa;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},Ht.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ht.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Hu={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function qu(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(e){var r,i=n(275),o=n(65),a=n(281),s=n(282),u=n(283);e&&e.ArrayBuffer&&(r=n(285));var l="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),c="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),f=l||c;t.protocol=3;var d=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},h=i(d),p={type:"error",data:"parser error"},g=n(286);function m(e,t,n){for(var r=new Array(e.length),i=s(e.length,n),o=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},a=0;a<e.length;a++)o(a,e[a],i)}t.encodePacket=function(n,r,i,o){"function"==typeof r&&(o=r,r=!1),"function"==typeof i&&(o=i,i=null);var a=void 0===n.data?void 0:n.data.buffer||n.data;if(e.ArrayBuffer&&a instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,o=new Uint8Array(i),a=new Uint8Array(1+i.byteLength);a[0]=d[e.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return r(a.buffer)}(n,r,o);if(g&&a instanceof e.Blob)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(f)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,n,!0,r)},i.readAsArrayBuffer(e.data)}(e,n,r);var i=new Uint8Array(1);i[0]=d[e.type];var o=new g([i.buffer,e.data]);return r(o)}(n,r,o);if(a&&a.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(n,o);var s=d[n.type];return void 0!==n.data&&(s+=i?u.encode(String(n.data),{strict:!1}):String(n.data)),o(""+s)},t.encodeBase64Packet=function(n,r){var i,o="b"+t.packets[n.type];if(g&&n.data instanceof e.Blob){var a=new FileReader;return a.onload=function(){var e=a.result.split(",")[1];r(o+e)},a.readAsDataURL(n.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var s=new Uint8Array(n.data),u=new Array(s.length),l=0;l<s.length;l++)u[l]=s[l];i=String.fromCharCode.apply(null,u)}return o+=e.btoa(i),r(o)},t.decodePacket=function(e,n,r){if(void 0===e)return p;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=u.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return p;var i=e.charAt(0);return Number(i)==i&&h[i]?e.length>1?{type:h[i],data:e.substring(1)}:{type:h[i]}:p}i=new Uint8Array(e)[0];var o=a(e,1);return g&&"blob"===n&&(o=new g([o])),{type:h[i],data:o}},t.decodeBase64Packet=function(e,t){var n=h[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=r.decode(e.substr(1));return"blob"===t&&g&&(i=new g([i])),{type:n,data:i}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var i=o(e);if(n&&i)return g&&!f?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");m(e,function(e,r){t.encodePacket(e,!!i&&n,!1,function(e){r(null,function(e){return e.length+":"+e}(e))})},function(e,t){return r(t.join(""))})},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===e)return r(p,0,1);for(var o,a,s="",u=0,l=e.length;u<l;u++){var c=e.charAt(u);if(":"===c){if(""===s||s!=(o=Number(s)))return r(p,0,1);if(s!=(a=e.substr(u+1,o)).length)return r(p,0,1);if(a.length){if(i=t.decodePacket(a,n,!1),p.type===i.type&&p.data===i.data)return r(p,0,1);if(!1===r(i,u+o,l))return}u+=o,s=""}else s+=c}return""!==s?r(p,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));m(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var r=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),i=new Uint8Array(r),o=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}i[o++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)i[o++]=parseInt(s[a]);i[o++]=255;for(r=new Uint8Array(n),a=0;a<r.length;a++)i[o++]=r[a]}),n(i.buffer)})},t.encodePayloadAsBlob=function(e,n){m(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)a[i]=parseInt(o[i]);if(a[o.length]=255,g){var s=new g([t.buffer,a.buffer,e]);n(null,s)}})},function(e,t){return n(new g(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[];i.byteLength>0;){for(var s=new Uint8Array(i),u=0===s[0],l="",c=1;255!==s[c];c++){if(l.length>310)return r(p,0,1);l+=s[c]}i=a(i,2+l.length),l=parseInt(l);var f=a(i,0,l);if(u)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(e){var d=new Uint8Array(f);f="";for(c=0;c<d.length;c++)f+=String.fromCharCode(d[c])}o.push(f),i=a(i,l)}var h=o.length;o.forEach(function(e,i){r(t.decodePacket(e,n,!0),i,h)})}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(13)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={modelClass:null,viewClass:null,modelData:{}},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),r=o.default.ensureDefaults(e,s);return r.modelClass&&(n._model=new r.modelClass({data:r.modelData})),r.viewClass&&(n._view=new r.viewClass(n._model)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"view",value:function(){return this._view}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(13)),o=s(n(6)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u={duration:10,loop:!1,currentTime:0,active:!1,source:null,rate:1},l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._model=new o.default({data:e,defaults:u}),a.default.bindMethods(n,["_tick","_onSourceLoop","_onSourceEnd"]),window.requestAnimationFrame(n._tick),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_tick",value:function(){var e=(new Date).getTime();if(this._model.get("active")){var t=!1,n=!1;if(this._model.get("source")){this._model.get("currentTime");this._model.set("currentTime",this._model.get("source").timer_time())}else{var r=this._model.get("currentTime")+this._model.get("rate")*(e-this._model.get("lastTick"))/1e3;r>this._model.get("duration")&&(this._model.get("loop")?(r=a.default.posMod(r,this._model.get("duration")),t=!0):(r=this._model.get("duration"),n=!0)),this._model.set("currentTime",r)}this.dispatchEvent("Timer.Tick",{time:this.time()}),t&&this.dispatchEvent("Timer.Loop",{}),n&&(this._model.set("active",!1),this.dispatchEvent("Timer.End",{}))}this._model.set("lastTick",e),window.requestAnimationFrame(this._tick)}},{key:"start",value:function(){this.time()>=this.duration()&&this.seek(0),this._model.set("active",!0),this._model.get("source")&&this._model.get("source").timer_start(),this.dispatchEvent("Timer.Start",{})}},{key:"stop",value:function(){this.pause(),this.seek(0),this._model.get("source")&&this._model.get("source").timer_stop(),this.dispatchEvent("Timer.Stop",{})}},{key:"pause",value:function(){this._model.set("active",!1),this._model.get("source")&&this._model.get("source").timer_pause(),this.dispatchEvent("Timer.Pause",{})}},{key:"seek",value:function(e){this._model.set("currentTime",Math.max(0,Math.min(this._model.get("duration"),e))),this._model.get("source")&&this._model.get("source").timer_seek(e),this.dispatchEvent("Timer.Seek",{time:this.time()})}},{key:"active",value:function(){return this._model.get("active")}},{key:"time",value:function(){return this._model.get("source")?this._model.get("source").timer_time():this._model.get("currentTime")}},{key:"timeRemaining",value:function(){return this.duration()-this.time()}},{key:"duration",value:function(){return this._model.get("source")?this._model.get("source").timer_duration():this._model.get("duration")}},{key:"setDuration",value:function(e){this.stop(),this._model.set("duration",Math.max(0,e)),this.dispatchEvent("Timer.DurationChange",{duration:this._model.get("duration")})}},{key:"setRate",value:function(e){this._model.set("rate",e),this.dispatchEvent("Timer.RateChange",{rate:e})}},{key:"setSource",value:function(e){if(e){var t=this._model.get("source");t&&(t.removeEventListener("TimerSource.Loop",this._onSourceLoop),t.removeEventListener("TimerSource.End",this._onSourceEnd)),e.addEventListener("TimerSource.Loop",this._onSourceLoop),e.addEventListener("TimerSource.End",this._onSourceEnd)}this._model.set("source",e)}},{key:"_onSourceEnd",value:function(e){this._model.set("active",!1),this.dispatchEvent("Timer.End",{})}},{key:"_onSourceLoop",value:function(e){this.dispatchEvent("Timer.Loop",{})}}]),t}();t.default=l},function(e,t,n){"use strict";function r(){this.__rules__=[],this.__cache__=null}r.prototype.__find__=function(e){for(var t=this.__rules__.length,n=-1;t--;)if(this.__rules__[++n].name===e)return n;return-1},r.prototype.__compile__=function(){var e=this,t=[""];e.__rules__.forEach(function(e){e.enabled&&e.alt.forEach(function(e){t.indexOf(e)<0&&t.push(e)})}),e.__cache__={},t.forEach(function(t){e.__cache__[t]=[],e.__rules__.forEach(function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||e.__cache__[t].push(n.fn))})})},r.prototype.at=function(e,t,n){var r=this.__find__(e),i=n||{};if(-1===r)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=i.alt||[],this.__cache__=null},r.prototype.before=function(e,t,n,r){var i=this.__find__(e),o=r||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i,0,{name:t,enabled:!0,fn:n,alt:o.alt||[]}),this.__cache__=null},r.prototype.after=function(e,t,n,r){var i=this.__find__(e),o=r||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i+1,0,{name:t,enabled:!0,fn:n,alt:o.alt||[]}),this.__cache__=null},r.prototype.push=function(e,t,n){var r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null},r.prototype.enable=function(e,t){e=Array.isArray(e)?e:[e],t&&this.__rules__.forEach(function(e){e.enabled=!1}),e.forEach(function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!0},this),this.__cache__=null},r.prototype.disable=function(e){(e=Array.isArray(e)?e:[e]).forEach(function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!1},this),this.__cache__=null},r.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},e.exports=r},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o=-1,a=e.posMax,s=e.pos,u=e.isInLabel;if(e.isInLabel)return-1;if(e.labelUnmatchedScopes)return e.labelUnmatchedScopes--,-1;for(e.pos=t+1,e.isInLabel=!0,n=1;e.pos<a;){if(91===(i=e.src.charCodeAt(e.pos)))n++;else if(93===i&&0===--n){r=!0;break}e.parser.skipToken(e)}return r?(o=e.pos,e.labelUnmatchedScopes=0):e.labelUnmatchedScopes=n-1,e.pos=s,e.isInLabel=u,o}},function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(267)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(o=++i)}),e.splice(o,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n(35))},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(287)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(o=++i)}),e.splice(o,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n(35))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(21));var a={tubeRadius:1,tubeLength:3.5,baseColor:2237183};function s(e){o.Curve.call(this),this.tubeLength=void 0===e?1:e}s.prototype=Object.create(o.Curve.prototype),s.prototype.constructor=s,s.prototype.getPoint=function(e){var t=e*this.tubeLength-this.tubeLength/2;return new o.Vector3(0,0,t)};var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=i.default.ensureDefaults(t,a),this._body=new o.Object3D,this.tubeCurve=new s(this.config.tubeLength);var n=new o.TubeGeometry(this.tubeCurve,10,this.config.tubeRadius,this.config.tubeSegments,!1),r=new o.SphereGeometry(this.config.tubeRadius,this.config.tubeSegments,this.config.tubeSegments),u=new o.MeshLambertMaterial({color:this.config.baseColor}),l=new o.Mesh(n,u),c=new o.Mesh(r,u),f=new o.Mesh(r,u);c.position.x=this.tubeCurve.getPoint(0).x,c.position.y=this.tubeCurve.getPoint(0).y,c.position.z=this.tubeCurve.getPoint(0).z,f.position.x=this.tubeCurve.getPoint(1).x,f.position.y=this.tubeCurve.getPoint(1).y,f.position.z=this.tubeCurve.getPoint(1).z,this._body.add(l,c,f)}return r(e,[{key:"view",value:function(){return this._body}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e,t,n,r,i){this.src=e,this.env=r,this.options=n,this.parser=t,this.tokens=i,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}r.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""},r.prototype.push=function(e){this.pending&&this.pushPending(),this.tokens.push(e),this.pendingLevel=this.level},r.prototype.cacheSet=function(e,t){for(var n=this.cache.length;n<=e;n++)this.cache.push(0);this.cache[e]=t},r.prototype.cacheGet=function(e){return e<this.cache.length?this.cache[e]:0},e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(7)),o=s(n(252)),a=s(n(253));s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||a.default,e.modelClass=e.modelClass||o.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(e){this.view().render(e)}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,l=[],c=!1,f=-1;function d(){c&&u&&(c=!1,u.length?l=u.concat(l):f=-1,l.length&&h())}function h(){if(!c){var e=s(d);c=!0;for(var t=l.length;t;){for(u=l,l=[];++f<t;)u&&u[f].run();f=-1,t=l.length}u=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n=1e3,r=60*n,i=60*r,o=24*i,a=365.25*o;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*a;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?function(e){return s(e,o,"day")||s(e,i,"hour")||s(e,r,"minute")||s(e,n,"second")||e+" ms"}(e):function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var r=n(268)("socket.io-parser"),i=n(22),o=n(270),a=n(60),s=n(61);function u(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=u,t.Decoder=f;var l=t.ERROR+'"encode error"';function c(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var i=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===i)return l;n+=i}return r("encoded %j as %s",e,n),n}function f(){this.reconstructor=null}function d(e){this.reconPack=e,this.buffers=[]}function h(e){return{type:t.ERROR,data:"parser error: "+e}}u.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){o.removeBlobs(e,function(e){var n=o.deconstructPacket(e),r=c(n.packet),i=n.buffers;i.unshift(r),t(i)})}(e,n):n([c(e)])},i(f.prototype),f.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])return h("unknown packet type "+i.type);if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(var o="";"-"!==e.charAt(++n)&&(o+=e.charAt(n),n!=e.length););if(o!=Number(o)||"-"!==e.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(o)}if("/"===e.charAt(n+1))for(i.nsp="";++n;){var s=e.charAt(n);if(","===s)break;if(i.nsp+=s,n===e.length)break}else i.nsp="/";var u=e.charAt(n+1);if(""!==u&&Number(u)==u){for(i.id="";++n;){var s=e.charAt(n);if(null==s||Number(s)!=s){--n;break}if(i.id+=e.charAt(n),n===e.length)break}i.id=Number(i.id)}if(e.charAt(++n)){var l=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n)),c=!1!==l&&(i.type===t.ERROR||a(l));if(!c)return h("invalid payload");i.data=l}return r("decoded %s as %j",e,i),i}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new d(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},f.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},d.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},d.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){(function(t){var r=n(273);e.exports=function(e){var n=e.xdomain,i=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!i&&o)return new XDomainRequest}catch(e){}if(!n)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(this,n(11))},function(e,t,n){var r=n(23),i=n(22);function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=o,i(o.prototype),o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(u(n(1)),u(n(0))),o=(u(n(2)),u(n(15))),a=u(n(338)),s=u(n(339));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||a.default,e.viewClass=e.viewClass||s.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.default.bindMethods(n,["_onUnitChangeRequest","_onChangeRequest","_onStopDrag"]),n.view().addEventListener("SliderField.UnitChangeRequest",n._onUnitChangeRequest),n.view().addEventListener("SliderField.ChangeRequest",n._onChangeRequest),n.view().addEventListener("SliderField.StopDrag",n._onStopDrag),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onUnitChangeRequest",value:function(e){if(!this._model.get("disabled")){var t=this._model.value();this._model.setUnitValue(e.data.value),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()})}}},{key:"_onChangeRequest",value:function(e){if(!this._model.get("disabled")){var t=this._model.value();this._model.setValue(e.data.value),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()})}}},{key:"_onStopDrag",value:function(e){this.dispatchEvent("Field.StopDrag")}},{key:"setValue",value:function(e){var t=this._model.value();this._model.setValue(e),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()})}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(0)),o=u(n(1)),a=(u(n(2)),u(n(6))),s=u(n(18));function u(e){return e&&e.__esModule?e:{default:e}}var l={id:"aggregate_time",graph_class:"aggregate_time",axis_label:"Aggregate Time",width:500,height:300,margins:{top:20,bottom:40,left:80,right:20}},c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,l),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"update",value:function(e){var t=this,n=Object.values(e),r=!0,i=!0,o=!1,a=void 0;try{for(var u,l=n[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value;if(c!=n[0]&&!s.default.experimentMatch(n[0].get("experiment"),c.get("experiment"))){r=!1;break}}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}if(!r||0==n.length)return this.set("graph",null),void this.dispatchEvent("AggregateGraph.DisableRequest",{id:this.get("id")});this.dispatchEvent("AggregateGraph.EnableRequest",{id:this.get("id")});var f={},d=function(e){e.get("results").forEach(function(n){f[n.get("id")]=t.generateLine(n,e.get("experiment"))})},h=!0,p=!1,g=void 0;try{for(var m,v=n[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){d(m.value)}}catch(e){p=!0,g=e}finally{try{!h&&v.return&&v.return()}finally{if(p)throw g}}this.set("graph",{lines:f,lights:n[0].get("experiment.configuration"),runTime:n[0].get("experiment.configuration").reduce(function(e,t){return e+t.duration},0),maxValue:this.getMaxValue(f),minValue:this.getMinValue(f)})}},{key:"getMinValue",value:function(e){return Object.values(e).reduce(function(e,t){return Math.min(e,t.data.reduce(function(e,t){return Math.min(e,t.value)},0))},0)}},{key:"getMaxValue",value:function(e){return Object.values(e).reduce(function(e,t){return Math.max(e,t.data.reduce(function(e,t){return Math.max(e,t.value)},0))},0)}},{key:"generateLine",value:function(e,t){for(var n=this,r=[],i=0;i<=e.get("numFrames");i++)r.push({frame:i,time:i/e.get("fps"),samples:[]});return e.get("tracks").forEach(function(t){t.samples.forEach(function(t){for(var n=Math.max(1,Math.round(t.time*e.get("fps"))),i=Math.min(e.get("numFrames"),n+Math.round(e.get("fps")*o.default.get("AppConfig.aggregate.timeWindow"))),a=n;a<=i;a++)r[a].samples.push(t)})}),r.forEach(function(e){e.value=n.generateLinePoint(e,t)}),{id:e.get("id"),color:e.get("color"),data:r}}},{key:"generateLinePoint",value:function(e,t){return 0}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(3)),i=o(n(82));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||i.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(7)),o=u(n(103)),a=u(n(104)),s=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"build",value:function(){var e=this,t=[];s.default.invoke("Panel.Contents",t,{id:this._model.get("id")}),t.forEach(function(t,n){e._model.addContent(t)})}},{key:"addContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._model.addContent(e,t)}},{key:"removeContent",value:function(e){this._model.removeContent(e)}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){"use strict";e.exports={Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",GT:">",Gt:"≫",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",LT:"<",Lt:"≪",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}},function(e,t,n){"use strict";var r=n(46),i=n(10).unescapeMd;e.exports=function(e,t){var n,o,a,s=t,u=e.posMax;if(60===e.src.charCodeAt(t)){for(t++;t<u;){if(10===(n=e.src.charCodeAt(t)))return!1;if(62===n)return a=r(i(e.src.slice(s+1,t))),!!e.parser.validateLink(a)&&(e.pos=t+1,e.linkContent=a,!0);92===n&&t+1<u?t+=2:t++}return!1}for(o=0;t<u&&32!==(n=e.src.charCodeAt(t))&&!(n>8&&n<14);)if(92===n&&t+1<u)t+=2;else{if(40===n&&++o>1)break;if(41===n&&--o<0)break;t++}return s!==t&&(a=i(e.src.slice(s,t)),!!e.parser.validateLink(a)&&(e.linkContent=a,e.pos=t,!0))}},function(e,t,n){"use strict";var r=n(10).replaceEntities;e.exports=function(e){var t=r(e);try{t=decodeURI(t)}catch(e){}return encodeURI(t)}},function(e,t,n){"use strict";var r=n(10).unescapeMd;e.exports=function(e,t){var n,i=t,o=e.posMax,a=e.src.charCodeAt(t);if(34!==a&&39!==a&&40!==a)return!1;for(t++,40===a&&(a=41);t<o;){if((n=e.src.charCodeAt(t))===a)return e.pos=t+1,e.linkContent=r(e.src.slice(i+1,t)),!0;92===n&&t+1<o?t+=2:t++}return!1}},function(e,t,n){"use strict";e.exports=function(e){return e.trim().replace(/\s+/g," ").toUpperCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(15)),i=a(n(171)),o=a(n(172));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||o.default,e.modelClass=e.modelClass||i.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();s.create=function(e){return new s({modelData:e})},t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(16)),o=d(n(204)),a=d(n(12)),s=d(n(205)),u=d(n(214)),l=d(n(218)),c=d(n(0)),f=d(n(3));function d(e){return e&&e.__esModule?e:{default:e}}n(224);var h=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||o.default));return c.default.bindMethods(r,["_onOrderChange","_onModelChange"]),r._labelContainer=r.$el.find(".multifield__label"),r._fieldWraps={},r._ddm=new l.default({modelData:{bounds:new f.default(r.$el.find(".multifield__fields")),allowMultiSelect:!0}}),r._ddm.addEventListener("DragDrop.ContainmentChange",r._onOrderChange),r._subfieldContainer=new u.default,r.addChild(r._subfieldContainer.view(),".multifield__fields"),r._ddm.addDropSite(r._subfieldContainer),r.buttons={add:a.default.create({id:"multifield__add",label:e.get("addButtonLabel"),eventName:"MultiField.AddFieldRequest",style:"add"})},r.addChild(r.buttons.add.view(),".multifield__buttons"),r._render(e),r._renderFields(e),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onOrderChange",value:function(e){this.dispatchEvent("MultiField.OrderChangeRequest",{order:this._subfieldContainer.export()})}},{key:"_onModelChange",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onModelChange",this).call(this,e),"locked"==e.data.path?this._handleLockedFields(e.data.value):"fields"==e.data.path?this._renderFields(e.currentTarget):this._render(e.currentTarget)}},{key:"_render",value:function(e){this._labelContainer.html(e.get("label")),this.$el.toggleClass("field__error",e.get("hasError")),e.get("disabled")?(Object.values(this._fieldWraps).forEach(function(e){e.lock()}),this._ddm.disable(),Object.values(this.buttons).forEach(function(e){e.disable()})):(e.get("sortable")?this._ddm.enable():this._ddm.disable(),this._handleLockedFields(e.get("locked")),Object.values(this.buttons).forEach(function(e){e.enable()}))}},{key:"_renderFields",value:function(e){var t=this;this._subfieldContainer.empty(),e.get("fields").forEach(function(n,r){var i=void 0;c.default.exists(!t._fieldWraps[n.id()])?(i=new s.default({modelData:{trigger:e.get("dragTrigger"),field:n,classes:e.get("dragClasses")}}),t._fieldWraps[n.id()]=i,t._ddm.addDragItem(i)):i=t._fieldWraps[n.id()],t._subfieldContainer.receive([i])}),c.default.exists(e.get("max"))&&this._subfieldContainer.count()>=e.get("max")?this.buttons.add.view().hide():this.buttons.add.view().show();if(this._subfieldContainer.count()<=e.get("min")){var n=!0,r=!1,i=void 0;try{for(var o,a=this._subfieldContainer.items()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.hideRemoveButton()}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}else{var u=!0,l=!1,f=void 0;try{for(var d,h=this._subfieldContainer.items()[Symbol.iterator]();!(u=(d=h.next()).done);u=!0)d.value.showRemoveButton()}catch(e){l=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(l)throw f}}}}},{key:"_handleLockedFields",value:function(e){var t=Array.from(e).map(function(e){return e.view()}),n=!0,r=!1,i=void 0;try{for(var o,a=this._subfieldContainer.items()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.includes(s.fieldView())?s.lock():s.unlock()}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}},{key:"focus",value:function(){this._subfieldContainer.items().length&&this._subfieldContainer.items()[0].focus()}}]),t}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(3)),o=a(n(233));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));return r._onModelChange=r._onModelChange.bind(r),e.addEventListener("Model.Change",r._onModelChange),r._fieldViews=[],r.renderModel(e),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){this.renderModel(e.currentTarget)}},{key:"renderModel",value:function(e){for(;this._fieldViews.length;)this.removeChild(this._fieldViews.pop());var t=!0,n=!1,r=void 0;try{for(var i,o=e.get("fields")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this._fieldViews.push(a.view()),this.addChild(a.view(),".fieldgroup__fields")}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"focus",value:function(){this._fieldViews.length&&this._fieldViews[0].focus()}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(16)),o=u(n(235)),a=u(n(0)),s=u(n(237));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||s.default));return a.default.bindMethods(r,["_onFieldChange","_onModelChange"]),r._options={},e.get("color")&&r.$el.find(".selectfield__label").css("color",e.get("color")),e.get("min_width")&&r.$el.find(".selectfield__select").css("min-width",e.get("min_width")),r._render(e),r.$el.find(".selectfield__select").on("change",r._onFieldChange),r.$el.find(".selectfield__select").css({"font-size":"12px"}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onModelChange",this).call(this,e),"disabledOptions"==e.data.path?Object.values(this._options).forEach(function(t){e.data.value.includes(t.id())?(t.disable(),t.hide()):(t.show(),t.enable())}):this._render(e.currentTarget)}},{key:"_onFieldChange",value:function(e){this.dispatchEvent("Field.ValueChange",{value:this.$el.find(".selectfield__select").val()})}},{key:"disable",value:function(){this.$el.find(".selectfield__select").prop("disabled",!0)}},{key:"enable",value:function(){this.$el.find(".selectfield__select").prop("disabled",!1)}},{key:"focus",value:function(){this.$el.find(".selectfield__select").focus()}},{key:"_render",value:function(e){for(var t in this.$el.find(".selectfield__label").html(e.get("label")),this._options)Object.keys(e.get("options")).includes(t)||(this.removeChild(this._options[t]),delete this._options[t]);for(var n in e.get("options")){var r=e.get("options")[n];this._options[n]?this._options[n].select(e.value()==n):(this._options[n]=new o.default({id:n,label:r,selected:e.value()==n}),this.addChild(this._options[n],".selectfield__select")),n.match("default_choice")&&this.$el.find("option[value="+n+"]").prop("disabled",!0)}e.get("disabled")?this.disable():this.enable()}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(7)),o=s(n(257)),a=s(n(258));s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||a.default,e.modelClass=e.modelClass||o.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(e){this.view().render(e)}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t){e.exports=function(e){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t){e.exports="cslib/images/6559a483fb5857b232df16d5b7f84065-bulbs_h_bright.png"},function(e,t){e.exports="cslib/images/ce0506731cc3bd91d7073cdca5c4780e-bulbs_h_dark.png"},function(e,t){e.exports="cslib/images/383f614618f2d62675bdd9fbb2a3d523-bulbs_v_bright.png"},function(e,t){e.exports="cslib/images/93f319617e225ef673f2d8ae07f4a029-bulbs_v_dark.png"},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var a=n.exec(e||""),s={},u=14;u--;)s[r[u]]=a[u]||"";return-1!=i&&-1!=o&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(t){e.exports=function(e){return n&&t.Buffer.isBuffer(e)||r&&(e instanceof t.ArrayBuffer||i(e))};var n="function"==typeof t.Buffer&&"function"==typeof t.Buffer.isBuffer,r="function"==typeof t.ArrayBuffer,i=r&&"function"==typeof t.ArrayBuffer.isView?t.ArrayBuffer.isView:function(e){return e.buffer instanceof t.ArrayBuffer}}).call(this,n(11))},function(e,t,n){var r=n(271),i=n(68),o=n(22),a=n(37),s=n(69),u=n(70),l=n(28)("socket.io-client:manager"),c=n(67),f=n(292),d=Object.prototype.hasOwnProperty;function h(e,t){if(!(this instanceof h))return new h(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||a;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=h,h.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)d.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},h.prototype.updateSocketIds=function(){for(var e in this.nsps)d.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},h.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},o(h.prototype),h.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},h.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},h.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},h.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},h.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},h.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},h.prototype.open=h.prototype.connect=function(e,t){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=s(n,"open",function(){i.onopen(),e&&e()}),a=s(n,"error",function(t){if(l("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var u=this._timeout;l("connect attempt will timeout after %d",u);var c=setTimeout(function(){l("connect attempt timed out after %d",u),o.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",u)},u);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(o),this.subs.push(a),this},h.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",u(this,"ondata"))),this.subs.push(s(e,"ping",u(this,"onping"))),this.subs.push(s(e,"pong",u(this,"onpong"))),this.subs.push(s(e,"error",u(this,"onerror"))),this.subs.push(s(e,"close",u(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",u(this,"ondecoded")))},h.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},h.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},h.prototype.ondata=function(e){this.decoder.add(e)},h.prototype.ondecoded=function(e){this.emit("packet",e)},h.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},h.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new i(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",o),n.on("connect",function(){n.id=r.generateId(e)}),this.autoConnect&&o()}function o(){~c(r.connecting,n)||r.connecting.push(n)}return n},h.prototype.destroy=function(e){var t=c(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},h.prototype.packet=function(e){l("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},h.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},h.prototype.cleanup=function(){l("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},h.prototype.close=h.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},h.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},h.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},h.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){(function(e){var r=n(38),i=n(274),o=n(288),a=n(289);t.polling=function(t){var n=!1,a=!1,s=!1!==t.jsonp;if(e.location){var u="https:"===location.protocol,l=location.port;l||(l=u?443:80),n=t.hostname!==location.hostname||l!==t.port,a=t.secure!==u}if(t.xdomain=n,t.xscheme=a,"open"in new r(t)&&!t.forceJSONP)return new i(t);if(!s)throw new Error("JSONP disabled");return new o(t)},t.websocket=a}).call(this,n(11))},function(e,t,n){var r=n(39),i=n(29),o=n(23),a=n(30),s=n(66),u=n(31)("engine.io-client:polling");e.exports=c;var l=null!=new(n(38))({xdomain:!1}).responseType;function c(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),r.call(this,e)}a(c,r),c.prototype.name="polling",c.prototype.doOpen=function(){this.poll()},c.prototype.pause=function(e){var t=this;function n(){u("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){u("pre-pause polling complete"),--r||n()})),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",function(){u("pre-pause writing complete"),--r||n()}))}else n()},c.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},c.prototype.onData=function(e){var t=this;u("polling got data %s",e);o.decodePayload(e,this.socket.binaryType,function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},c.prototype.doClose=function(){var e=this;function t(){u("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t))},c.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},c.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){(function(t){var r=n(280),i=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,s=n.length;i<s;i++)if(e(n[i]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||o&&n instanceof Blob||a&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var u in n)if(Object.prototype.hasOwnProperty.call(n,u)&&e(n[u]))return!0;return!1}}).call(this,n(276).Buffer)},function(e,t,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,a={},s=0,u=0;function l(e){var t="";do{t=i[e%o]+t,e=Math.floor(e/o)}while(e>0);return t}function c(){var e=l(+new Date);return e!==r?(s=0,r=e):e+"."+l(s++)}for(;u<o;u++)a[i[u]]=u;c.encode=l,c.decode=function(e){var t=0;for(u=0;u<e.length;u++)t=t*o+a[e.charAt(u)];return t},e.exports=c},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(37),i=n(22),o=n(291),a=n(69),s=n(70),u=n(28)("socket.io-client:socket"),l=n(29),c=n(65);e.exports=h;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},d=i.prototype.emit;function h(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}i(h.prototype),h.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]}},h.prototype.open=h.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},h.prototype.send=function(){var e=o(arguments);return e.unshift("message"),this.emit.apply(this,e),this},h.prototype.emit=function(e){if(f.hasOwnProperty(e))return d.apply(this,arguments),this;var t=o(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:c(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},h.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},h.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?l.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},h.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},h.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},h.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?d.apply(this,t):this.receiveBuffer.push(t)},h.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var i=o(arguments);u("sending ack %j",i),t.packet({type:c(i)?r.BINARY_ACK:r.ACK,id:e,data:i})}}},h.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},h.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},h.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)d.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},h.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},h.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},h.prototype.close=h.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},h.prototype.compress=function(e){return this.flags.compress=e,this},h.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={sensorConfig_1:{id:"1Sensor_BackLeft",config:{sensor_1:{sensorPosition:{z:-1,y:-1},sensorOrientation:Math.PI,sensorField:Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_2:{id:"1Sensor_BackRight",config:{sensor_1:{sensorPosition:{z:-1,y:1},sensorOrientation:0,sensorField:Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_3:{id:"1Sensor_FrontLeft",config:{sensor_1:{sensorPosition:{z:1,y:-1},sensorOrientation:Math.PI,sensorField:Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_4:{id:"1Sensor_FrontRight",config:{sensor_1:{sensorPosition:{z:1,y:1},sensorOrientation:0,sensorField:Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_5:{id:"1OmniSensor_BackLeft",config:{sensor_1:{sensorPosition:{z:-1,y:-1},sensorOrientation:0,sensorField:2*Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_6:{id:"1OmniSensor_BackRight",config:{sensor_1:{sensorPosition:{z:-1,y:1},sensorOrientation:0,sensorField:2*Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_7:{id:"1OmniSensor_FrontLeft",config:{sensor_1:{sensorPosition:{z:1,y:-1},sensorOrientation:0,sensorField:2*Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_8:{id:"1OmniSensor_FrontRight",config:{sensor_1:{sensorPosition:{z:1,y:1},sensorOrientation:0,sensorField:2*Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_9:{id:"1OmniSensor_FrontCenter",config:{sensor_1:{sensorPosition:{z:1,y:0},sensorOrientation:0,sensorField:2*Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_10:{id:"1OmniSensor_FrontCenter_Shield_Left",config:{sensor_1:{sensorPosition:{z:1,y:0},sensorOrientation:0,sensorField:2*Math.PI},spotPositions:[{z:1,y:-1}],motorConnection:!0}},sensorConfig_11:{id:"1OmniSensor_FrontCenter_Shield_Right",config:{sensor_1:{sensorPosition:{z:1,y:0},sensorOrientation:0,sensorField:2*Math.PI},spotPositions:[{z:1,y:1}],motorConnection:!0}},sensorConfig_12:{id:"2Sensors_Back",config:{sensor_1:{sensorPosition:{z:-1,y:-1},sensorOrientation:Math.PI,sensorField:Math.PI},sensor_2:{sensorPosition:{z:-1,y:1},sensorOrientation:0,sensorField:Math.PI},spotPositions:[],motorConnection:!0}},sensorConfig_13:{id:"2Sensors_Front",config:{sensor_1:{sensorPosition:{z:1,y:-1},sensorOrientation:Math.PI,sensorField:Math.PI},sensor_2:{sensorPosition:{z:1,y:1},sensorOrientation:0,sensorField:Math.PI},spotPositions:[],motorConnection:!0}}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(u(n(1)),u(n(0))),o=(u(n(2)),u(n(15))),a=u(n(377)),s=u(n(378));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||a.default,e.viewClass=e.viewClass||s.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.default.bindMethods(n,["_onChangeRequest","_onUnitChangeRequest"]),n.view().addEventListener("SymSliderField.UnitChangeRequest",n._onUnitChangeRequest),n.view().addEventListener("SymSliderField.ChangeRequest",n._onChangeRequest),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onUnitChangeRequest",value:function(e){if(!this._model.get("disabled")){var t=this._model.get("value");switch(e.data.property){case"delta":e.data.value?this._model.setDeltaUnitValue(e.data.value):this._model.setDeltaUnitValue(Math.abs(this._model.get("unitValue")-e.data.offset));break;case"base":this._model.setUnitValue(e.data.value)}this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()})}}},{key:"_onChangeRequest",value:function(e){if(!this._model.get("disabled")){var t=this._model.get("value");switch(e.data.property){case"delta":this._model.setDeltaValue(e.data.value);break;case"base":this._model.setBaseValue(e.data.value)}this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()})}}},{key:"setValue",value:function(e){var t=this._model.get("value");this._model.setBaseValue(e.base),this._model.setDeltaValue(e.delta),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()})}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["#FFB300","#803E75","#A6BDD7","#C10020","#CEA262","#817066","#FF6800","#000000","#007D34","#F6768E","#00538A","#FF7A5C","#53377A","#FF8E00","#B32851","#F4C800","#7F180D","#93AA00","#593315","#F13A13","#232C16"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(0)),o=(u(n(1)),u(n(2)),u(n(7))),a=u(n(41)),s=u(n(412));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||a.default,e.viewClass=e.viewClass||s.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.default.bindMethods(n,["_onEnableRequest","_onDisableRequest"]),n._model.addEventListener("AggregateGraph.EnableRequest",n._onEnableRequest),n._model.addEventListener("AggregateGraph.DisableRequest",n._onDisableRequest),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onEnableRequest",value:function(e){this.dispatchEvent(e)}},{key:"_onDisableRequest",value:function(e){this.dispatchEvent(e)}},{key:"update",value:function(e){this._model.update(e)}},{key:"label",value:function(){return this._model.get("label")}},{key:"id",value:function(){return this._model.get("id")}},{key:"toggleResult",value:function(e,t){this.view().toggleResult(e,t)}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){var r=n(444);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";var r=i(n(8));function i(e){return e&&e.__esModule?e:{default:e}}var o=new(i(n(77)).default)((0,r.default)("body"));o.load().then(function(){return o.init()}).then(function(){return o.run()}).then(function(){return(0,r.default)(".loader").remove()}),window.App=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=M(n(78)),o=M(n(2)),a=M(n(1)),s=M(n(83)),u=M(n(100)),l=M(n(101)),c=M(n(102)),f=M(n(106)),d=M(n(107)),h=M(n(166)),p=M(n(178)),g=M(n(199)),m=M(n(301)),v=M(n(358)),y=M(n(360)),_=M(n(376)),b=M(n(383)),w=M(n(385)),x=M(n(401)),E=(M(n(439)),M(n(442)));function M(e){return e&&e.__esModule?e:{default:e}}n(75);var C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.default.set("AppConfig",window.EuglenaConfig),o.default.hook("Application.Modules",function(e){return e.add(s.default),e.add(l.default),e.add(v.default),e.add(f.default),e.add(c.default),e.add(h.default),e.add(d.default),e.add(p.default),e.add(g.default),e.add(m.default),e.add(y.default),e.add(_.default),e.add(b.default),e.add(w.default),e.add(x.default),e.add(u.default),e}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"viewClass",value:function(){return E.default}}]),t}();t.default=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(8)),o=l(n(13)),a=(l(n(0)),l(n(2))),s=l(n(1)),u=l(n(42));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._domRoot=(0,i.default)(e),s.default.set("App",n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_buildModuleRequirements",value:function(e,t){var n=this;e.requires&&e.requires.length&&e.requires.forEach(function(e){t.has(e)||(t.add(e),n._buildModuleRequirements(e,t))})}},{key:"load",value:function(){var e=this,t=void 0,n=void 0;return t=[],n=a.default.invoke("Application.Modules",new Set),Array.from(n).forEach(function(t){e._buildModuleRequirements(t,n)}),this._modules=[],n.forEach(function(n){var r=new n;e._modules.push(r),t.push(r.load())}),t.push(this.buildView()),Promise.all(t)}},{key:"viewClass",value:function(){return u.default}},{key:"buildView",value:function(){var e=this.viewClass();this.view=new e,this._domRoot.append(this.view.$dom()),this.dispatchEvent("Application.ViewReady",{}),Promise.resolve(this.view)}},{key:"init",value:function(){return Promise.all(this._modules.map(function(e){return e.init()}))}},{key:"run",value:function(){this._modules.forEach(function(e){return e.run()}),this.dispatchEvent("Application.Run",{})}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.data=n,this.bubbles=r,this.target=null,this.currentTarget=null}return r(e,[{key:"stopPropagation",value:function(){this.bubbles=!1}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(81));var i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(13));var o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._children=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addChild",value:function(e){return this._children.includes(e)||(e.parent&&e.parent.removeChild(e),e.parent=this,e.addEventListener("*",this.bubbleEvent.bind(this)),this._children.push(e),this.dispatchEvent("Parent.ChildAdded",{child:e},!0)),this}},{key:"removeChild",value:function(e){return this._children.includes(e)&&(e.parent=null,e.removeEventListener("*",this.bubbleEvent.bind(this)),this._children.splice(this._children.indexOf(e),1),this.dispatchEvent("Parent.ChildRemoved",{child:e},!0)),this}}]),t}();t.default=o},function(e,t,n){"use strict";n.r(t),t.default='<div class="app">\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),o=(l(n(2)),l(n(0))),a=l(n(9)),s=l(n(84)),u=l(n(87));function l(e){return e&&e.__esModule?e:{default:e}}n(98);var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.bindMethods(e,["_onAddRequest","_onRemoveRequest","_onClearRequest"]),e._center=s.default.create({}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"init",value:function(){i.default.get("Relay").addEventListener("Notifications.Add",this._onAddRequest),i.default.get("Relay").addEventListener("Notifications.Remove",this._onRemoveRequest),i.default.get("Relay").addEventListener("Notifications.Clear",this._onClearRequest)}},{key:"run",value:function(){i.default.get("App.view").addChild(this._center.view())}},{key:"_onAddRequest",value:function(e){this._center.addNote(u.default.create(e.data))}},{key:"_onRemoveRequest",value:function(e){this._center.removeNote(e.data.noteId)}},{key:"_onClearRequest",value:function(e){this._center.clear()}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(s(n(1)),s(n(2)),s(n(0)),s(n(7))),o=s(n(85)),a=s(n(86));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addNote",value:function(e){this._model.addNote(e)}},{key:"removeNote",value:function(e){this._model.removeNote(e)}},{key:"clear",value:function(){this._model.clear()}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(a(n(1)),a(n(2)),a(n(0))),o=a(n(6));function a(e){return e&&e.__esModule?e:{default:e}}var s={notes:[]},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.default.bindMethods(n,["_onNoteExpiration"]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"addNote",value:function(e){e.addEventListener("Note.Expired",this._onNoteExpiration);var t=this.get("notes");t.push(e),this.set("notes",t),this.dispatchEvent("NotificationCenter.NoteAdded",{note:e}),setTimeout(function(){e.live()},1)}},{key:"removeNote",value:function(e){var t=void 0,n=!0,r=!1,i=void 0;try{for(var o,a=this.get("notes")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.id()==e){t=s;break}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}t&&t.expire()}},{key:"clear",value:function(){this.get("notes").forEach(function(e){e.expire()})}},{key:"_onNoteExpiration",value:function(e){var t=e.currentTarget;t.removeEventListener("Note.Expired",this._onNoteExpiration);var n=this.get("notes");n.splice(n.indexOf(t),1),this.set("notes",n),this.dispatchEvent("NotificationCenter.NoteExpired",{note:t})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(a(n(1)),a(n(2)),a(n(0))),o=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}var s='<div class="notification__center"></div>',u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||s));return i.default.bindMethods(r,["_onNoteAdded","_onNoteExpired"]),e.addEventListener("NotificationCenter.NoteAdded",r._onNoteAdded),e.addEventListener("NotificationCenter.NoteExpired",r._onNoteExpired),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onNoteAdded",value:function(e){this.addChild(e.data.note.view(),null,0)}},{key:"_onNoteExpired",value:function(e){this.removeChild(e.data.note.view())}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(u(n(1)),u(n(2)),u(n(0))),o=u(n(7)),a=u(n(88)),s=u(n(89));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||a.default,e.viewClass=e.viewClass||s.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.default.bindMethods(n,["_onExpirationRequest","_onExpired"]),n.view().addEventListener("Note.ExpirationRequest",n._onExpirationRequest),n.view().addEventListener("Note.Expired",n._onExpired),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"live",value:function(){this._model.set("alive",!0)}},{key:"expire",value:function(){this.view().expire()}},{key:"_onExpirationRequest",value:function(e){this._model.set("alive",!1)}},{key:"_onExpired",value:function(e){this.dispatchEvent(e)}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(n(1)),o(n(2));var r=o(n(0)),i=o(n(6));function o(e){return e&&e.__esModule?e:{default:e}}var a={id:null,alive:!1,type:"note",message:"",autoExpire:null,expireLabel:"OK",classes:[]},s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=r.default.ensureDefaults(e.defaults,a);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.get("id")||n.set("id",r.default.guid4()),n.get("classes").push("note__"+n.get("type")),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(u(n(1)),u(n(2)),u(n(0))),o=u(n(3)),a=u(n(12)),s=u(n(25));function u(e){return e&&e.__esModule?e:{default:e}}var l='<div class="notification__note"></div>',c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||l));return i.default.bindMethods(r,["_onModelChange","_onAutoExpire"]),r.$el.addClass(e.get("classes").join(" ")),r.$el.attr("id","note__"+e.get("id")),null!==e.get("autoExpire")&&(r._timer=new s.default({duration:e.get("autoExpire")}),r._timer.addEventListener("Timer.End",r._onAutoExpire)),e.get("expireLabel")&&(r._button=a.default.create({style:"link",label:e.get("expireLabel"),eventName:"Note.ExpirationRequest"}),r.addChild(r._button.view())),r.addChild(new o.default('<div class="note__message">'+e.get("message")+"</div>")),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onModelChange",value:function(e){switch(e.data.path){case"alive":e.data.value?this.live():this.expire()}}},{key:"_onAutoExpire",value:function(e){this.dispatchEvent("Note.ExpirationRequest",{})}},{key:"live",value:function(){var e=this;this.$el.addClass("note__alive"),setTimeout(function(){e._timer&&e._timer.start()},500)}},{key:"expire",value:function(){var e=this;this.$el.removeClass("note__alive"),setTimeout(function(){e.dispatchEvent("Note.Expired")},500)}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var i={exists:function(e,t){return i._validate(t,!r.default.isEmpty(e))},email:function(e,t){return t.re=/@/,i.regex(e,t)},regex:function(e,t){return i._validate(t,t.re.test(e))},lessThan:function(e,t){return i._validate(t,e<t.comparitor)},lt:function(e,t){return i.lessThan(e,t)},lessThanEqual:function(e,t){return i._validate(t,e<=t.comparitor)},lte:function(e,t){return i.lessThanEqual(e,t)},greaterThan:function(e,t){return i._validate(t,e>t.comparitor)},gt:function(e,t){return i.greaterThan(e,t)},greaterThanEqual:function(e,t){return i._validate(t,e>=t.comparitor)},gte:function(e,t){return i.greaterThanEqual(e,t)},minLength:function(e,t){return i._validate(t,e.length>=t.length)},maxLength:function(e,t){return i._validate(t,e.length<=t.length)},numeric:function(e,t){return i._validate(t,r.default.isNumeric(e))},custom:function(e,t){return t.fn(e,t).then(function(e){return i._validate(t,e)})},_validate:function(e,t){return Promise.resolve({isValid:t,error:t?null:e.errorMessage})}};t.default=i},function(e,t,n){"use strict";n.r(t),t.default='<div class="field">\n  <label class="label"></label>\n  <input type="text"/>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(16)),o=u(n(93)),a=u(n(0)),s=u(n(1));function u(e){return e&&e.__esModule?e:{default:e}}n(94);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||o.default));return a.default.bindMethods(r,["_onModelChange","_onClick","focus"]),r.$el.find(".button").html(e.get("label")),r._eventName=e.get("eventName"),r._eventData=e.get("eventData"),e.get("eventStyle")&&(r._eventStyle=e.get("eventStyle")),r.$el.find(".button").on("click",r._onClick),r._killNative=e.get("killNativeEvent"),"button"!=e.get("style")&&r.$el.addClass(e.get("style")),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"focus",value:function(){this.$el.find(".button").focus()}},{key:"enable",value:function(){this.$el.find(".button").prop("disabled",!1)}},{key:"disable",value:function(){this.$el.find(".button").prop("disabled",!0)}},{key:"_onClick",value:function(e){if(this._eventStyle?s.default.get("Relay").dispatchEvent(this._eventName,this._eventData,!0):this.dispatchEvent(this._eventName,this._eventData,!0),this._killNative)return!1}},{key:"_onModelChange",value:function(e){switch(e.data.path){case"label":this.$el.find(".button").html(e.data.value);break;case"disabled":e.data.value?this.disable():this.enable()}}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__button">\n  <button class="button"></button>\n</div>'},function(e,t,n){var r=n(95);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__button {\n  display: inline-block;\n  margin: 0 0.5em; }\n  .component__button .button {\n    background: #f9f9f9;\n    border: 1px solid #d9d9d9;\n    border-radius: 5px;\n    padding: 10px 20px;\n    cursor: pointer;\n    font-weight: bold;\n    font-size: 14px; }\n    .component__button .button:hover {\n      background: #d9d9d9;\n      border-color: #282828;\n      color: #f9f9f9; }\n  .component__button.link .button {\n    background: transparent;\n    border: none;\n    padding: inherit;\n    font-weight: normal;\n    display: inline-block;\n    color: inherit; }\n    .component__button.link .button:hover {\n      background: inherit;\n      border-color: transparent;\n      color: inherit;\n      text-decoration: underline; }\n",""])},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(14)),i=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a={id:null,label:"",eventName:"Button.Pressed",eventData:{},style:"button",killNativeEvent:!0},s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){var r=n(99);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,'.notification__center {\n  position: fixed;\n  top: 0;\n  width: 100%;\n  margin: 0 auto;\n  z-index: 1000; }\n\n.notification__note {\n  margin: 0 auto 0.5rem;\n  padding: 0.5rem 1rem;\n  width: 50%;\n  border: 0.1rem solid #282828;\n  background: #f9f9f9;\n  display: block;\n  opacity: 0;\n  margin-top: 0;\n  transition: 0.3s all linear; }\n  .notification__note:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .notification__note .component__button {\n    float: right;\n    text-decoration: underline;\n    color: #30a; }\n  .notification__note.note__alive {\n    margin-top: 0.5rem;\n    opacity: 1; }\n  .notification__note.note__error {\n    background: #ffcccc;\n    border-color: #330000; }\n',""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(9)),o=a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"run",value:function(){o.default.get("Relay").dispatchEvent("AppPhase.Change",{phase:"login"})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(9)),o=s(n(1)),a=s(n(2));s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.set("Layout",e),e._panels={},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"run",value:function(){var e=this,t=[];a.default.invoke("Layout.Panels",t),t.sort(function(e,t){return e.weight-t.weight}),t.forEach(function(t,n){var r=t.panel;e._panels[r.id()]=r,o.default.get("App.view").addChild(r.view())})}},{key:"getPanel",value:function(e){return this._panels[e]}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(9)),o=u(n(0)),a=(u(n(1)),u(n(2))),s=u(n(43));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.bindMethods(e,["_hookLayoutPanels"]),e.panel=s.default.create({id:"result"}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"init",value:function(){return a.default.hook("Layout.Panels",this._hookLayoutPanels),Promise.resolve(!0)}},{key:"_hookLayoutPanels",value:function(e,t){return e.push({weight:0,panel:this.panel}),e}},{key:"run",value:function(){this.panel.build()}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(6)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={contents:[]},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,s),e.data.id||(e.data.id=o.default.guid4()),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.get("contents");null===t||t>=n.length?n.push(e):n.splice(t,0,e),this.set("contents",n)}},{key:"removeContent",value:function(e){var t=this.get("contents");t.includes(e)&&(t.splice(t.indexOf(e),1),this.set("contents",t))}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(0)),a=s(n(105));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));return o.default.bindMethods(r,["_onModelChange"]),r.$el.addClass("panel__"+e.get("id")),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){"contents"==e.data.path&&this._render(e.currentTarget)}},{key:"_render",value:function(e){for(var t=this;this._children.length;)this.removeChild(this._children[0]);e.get("contents").forEach(function(e,n){t.addChild(e)})}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__panel panel"></div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(9)),o=u(n(2)),a=u(n(0)),s=u(n(43));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.default.bindMethods(e,["_hookLayoutPanels"]),e.panel=s.default.create({id:"interactive"}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"init",value:function(){return o.default.hook("Layout.Panels",this._hookLayoutPanels),Promise.resolve(!0)}},{key:"_hookLayoutPanels",value:function(e,t){return e.push({weight:0,panel:this.panel}),e}},{key:"run",value:function(){this.panel.build()}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(9)),o=s(n(108)),a=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.help=new o.default,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"run",value:function(){a.default.get("Layout").getPanel("result").addContent(this.help.view())}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(24)),o=u(n(109)),a=u(n(110)),s=u(n(1));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.default.get("Relay").addEventListener("Help.Show",n._onShowRequest.bind(n)),s.default.get("Relay").addEventListener("Help.Hide",n._onHideRequest.bind(n)),n.view().addEventListener("Help.ToggleOpen",n._onToggleRequest.bind(n)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onShowRequest",value:function(e){this._model.show()}},{key:"_onHideRequest",value:function(e){this._model.hide()}},{key:"_onToggleRequest",value:function(e){this._model.toggle(),this._view.toggle(this._model.get("open"))}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(6)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={open:!1,contents:""},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.default.ensureDefaults(e,s)))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"show",value:function(){this.set("open",!0)}},{key:"hide",value:function(){this.set("open",!1)}},{key:"toggle",value:function(){this.set("open",!this.get("open"))}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(111)),a=s(n(112));function s(e){return e&&e.__esModule?e:{default:e}}n(164);var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));if(e.addEventListener("Model.Change",r._onModelChange.bind(r)),r.$dom().find(".help__markdown").length){var i=r.$dom().find(".help__markdown").html(),s=new a.default;r.$dom().find(".help__content").html(s.render(i))}return r.$dom().find(".help__tab").click(r._onTabClick.bind(r)),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){switch(e.data.path){case"open":this.$dom().toggleClass("help__open",e.data.value)}}},{key:"_onTabClick",value:function(e){this.dispatchEvent("Help.ToggleOpen",{})}},{key:"toggle",value:function(e){e?(this.$el.find("#selectHelp").removeClass("notflippedY"),this.$el.find("#selectHelp").addClass("flippedY")):(this.$el.find("#selectHelp").removeClass("flippedY"),this.$el.find("#selectHelp").addClass("notflippedY"))}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="help">\n  <div class="help__tab"> <img id=\'selectHelp\' class = \'notflippedY\' src="/cslib/module/euglena/help/arrow.png"> Help</div>\n  <div class="help__content"></div>\n  <script class="help__markdown" type="text/markdown">\n# Help\n\n## Your group name: [Animal Name on the table][Period number]@jls.edu\n## Example: If the animal name on your table is panda, and your period is 2: panda2@jls.edu \n\n  <\/script>\n</div>\n'},function(e,t,n){"use strict";e.exports=n(113)},function(e,t,n){"use strict";var r=n(10).assign,i=n(114),o=n(116),a=n(127),s=n(142),u=n(26),l={default:n(161),full:n(162),commonmark:n(163)};function c(e,t,n){this.src=t,this.env=n,this.options=e.options,this.tokens=[],this.inlineMode=!1,this.inline=e.inline,this.block=e.block,this.renderer=e.renderer,this.typographer=e.typographer}function f(e,t){"string"!=typeof e&&(t=e,e="default"),this.inline=new s,this.block=new a,this.core=new o,this.renderer=new i,this.ruler=new u,this.options={},this.configure(l[e]),this.set(t||{})}f.prototype.set=function(e){r(this.options,e)},f.prototype.configure=function(e){var t=this;if(!e)throw new Error("Wrong `remarkable` preset, check name/content");e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enable(e.components[n].rules,!0)})},f.prototype.use=function(e,t){return e(this,t),this},f.prototype.parse=function(e,t){var n=new c(this,e,t);return this.core.process(n),n.tokens},f.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},f.prototype.parseInline=function(e,t){var n=new c(this,e,t);return n.inlineMode=!0,this.core.process(n),n.tokens},f.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)},e.exports=f,e.exports.utils=n(10)},function(e,t,n){"use strict";var r=n(10),i=n(115);function o(){this.rules=r.assign({},i),this.getBreak=i.getBreak}e.exports=o,o.prototype.renderInline=function(e,t,n){for(var r=this.rules,i=e.length,o=0,a="";i--;)a+=r[e[o].type](e,o++,t,n,this);return a},o.prototype.render=function(e,t,n){for(var r=this.rules,i=e.length,o=-1,a="";++o<i;)"inline"===e[o].type?a+=this.renderInline(e[o].children,t,n):a+=r[e[o].type](e,o,t,n,this);return a}},function(e,t,n){"use strict";var r=n(10).has,i=n(10).unescapeMd,o=n(10).replaceEntities,a=n(10).escapeHtml,s={};s.blockquote_open=function(){return"<blockquote>\n"},s.blockquote_close=function(e,t){return"</blockquote>"+u(e,t)},s.code=function(e,t){return e[t].block?"<pre><code>"+a(e[t].content)+"</code></pre>"+u(e,t):"<code>"+a(e[t].content)+"</code>"},s.fence=function(e,t,n,s,l){var c,f,d=e[t],h="",p=n.langPrefix;if(d.params){if(f=(c=d.params.split(/\s+/g)).join(" "),r(l.rules.fence_custom,c[0]))return l.rules.fence_custom[c[0]](e,t,n,s,l);h=' class="'+p+a(o(i(f)))+'"'}return"<pre><code"+h+">"+(n.highlight&&n.highlight.apply(n.highlight,[d.content].concat(c))||a(d.content))+"</code></pre>"+u(e,t)},s.fence_custom={},s.heading_open=function(e,t){return"<h"+e[t].hLevel+">"},s.heading_close=function(e,t){return"</h"+e[t].hLevel+">\n"},s.hr=function(e,t,n){return(n.xhtmlOut?"<hr />":"<hr>")+u(e,t)},s.bullet_list_open=function(){return"<ul>\n"},s.bullet_list_close=function(e,t){return"</ul>"+u(e,t)},s.list_item_open=function(){return"<li>"},s.list_item_close=function(){return"</li>\n"},s.ordered_list_open=function(e,t){var n=e[t];return"<ol"+(n.order>1?' start="'+n.order+'"':"")+">\n"},s.ordered_list_close=function(e,t){return"</ol>"+u(e,t)},s.paragraph_open=function(e,t){return e[t].tight?"":"<p>"},s.paragraph_close=function(e,t){var n=!(e[t].tight&&t&&"inline"===e[t-1].type&&!e[t-1].content);return(e[t].tight?"":"</p>")+(n?u(e,t):"")},s.link_open=function(e,t,n){var r=e[t].title?' title="'+a(o(e[t].title))+'"':"",i=n.linkTarget?' target="'+n.linkTarget+'"':"";return'<a href="'+a(e[t].href)+'"'+r+i+">"},s.link_close=function(){return"</a>"},s.image=function(e,t,n){var r=' src="'+a(e[t].src)+'"',s=e[t].title?' title="'+a(o(e[t].title))+'"':"";return"<img"+r+(' alt="'+(e[t].alt?a(o(i(e[t].alt))):"")+'"')+s+(n.xhtmlOut?" /":"")+">"},s.table_open=function(){return"<table>\n"},s.table_close=function(){return"</table>\n"},s.thead_open=function(){return"<thead>\n"},s.thead_close=function(){return"</thead>\n"},s.tbody_open=function(){return"<tbody>\n"},s.tbody_close=function(){return"</tbody>\n"},s.tr_open=function(){return"<tr>"},s.tr_close=function(){return"</tr>\n"},s.th_open=function(e,t){var n=e[t];return"<th"+(n.align?' style="text-align:'+n.align+'"':"")+">"},s.th_close=function(){return"</th>"},s.td_open=function(e,t){var n=e[t];return"<td"+(n.align?' style="text-align:'+n.align+'"':"")+">"},s.td_close=function(){return"</td>"},s.strong_open=function(){return"<strong>"},s.strong_close=function(){return"</strong>"},s.em_open=function(){return"<em>"},s.em_close=function(){return"</em>"},s.del_open=function(){return"<del>"},s.del_close=function(){return"</del>"},s.ins_open=function(){return"<ins>"},s.ins_close=function(){return"</ins>"},s.mark_open=function(){return"<mark>"},s.mark_close=function(){return"</mark>"},s.sub=function(e,t){return"<sub>"+a(e[t].content)+"</sub>"},s.sup=function(e,t){return"<sup>"+a(e[t].content)+"</sup>"},s.hardbreak=function(e,t,n){return n.xhtmlOut?"<br />\n":"<br>\n"},s.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},s.text=function(e,t){return a(e[t].content)},s.htmlblock=function(e,t){return e[t].content},s.htmltag=function(e,t){return e[t].content},s.abbr_open=function(e,t){return'<abbr title="'+a(o(e[t].title))+'">'},s.abbr_close=function(){return"</abbr>"},s.footnote_ref=function(e,t){var n=Number(e[t].id+1).toString(),r="fnref"+n;return e[t].subId>0&&(r+=":"+e[t].subId),'<sup class="footnote-ref"><a href="#fn'+n+'" id="'+r+'">['+n+"]</a></sup>"},s.footnote_block_open=function(e,t,n){return(n.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'},s.footnote_block_close=function(){return"</ol>\n</section>\n"},s.footnote_open=function(e,t){return'<li id="fn'+Number(e[t].id+1).toString()+'"  class="footnote-item">'},s.footnote_close=function(){return"</li>\n"},s.footnote_anchor=function(e,t){var n="fnref"+Number(e[t].id+1).toString();return e[t].subId>0&&(n+=":"+e[t].subId),' <a href="#'+n+'" class="footnote-backref">↩</a>'},s.dl_open=function(){return"<dl>\n"},s.dt_open=function(){return"<dt>"},s.dd_open=function(){return"<dd>"},s.dl_close=function(){return"</dl>\n"},s.dt_close=function(){return"</dt>\n"},s.dd_close=function(){return"</dd>\n"};var u=s.getBreak=function(e,t){return(t=function e(t,n){return++n>=t.length-2?n:"paragraph_open"===t[n].type&&t[n].tight&&"inline"===t[n+1].type&&0===t[n+1].content.length&&"paragraph_close"===t[n+2].type&&t[n+2].tight?e(t,n+2):n}(e,t))<e.length&&"list_item_close"===e[t].type?"":"\n"};e.exports=s},function(e,t,n){"use strict";var r=n(26),i=[["block",n(117)],["abbr",n(118)],["references",n(119)],["inline",n(120)],["footnote_tail",n(121)],["abbr2",n(122)],["replacements",n(123)],["smartquotes",n(124)],["linkify",n(125)]];function o(){this.options={},this.ruler=new r;for(var e=0;e<i.length;e++)this.ruler.push(i[e][0],i[e][1])}o.prototype.process=function(e){var t,n,r;for(t=0,n=(r=this.ruler.getRules("")).length;t<n;t++)r[t](e)},e.exports=o},function(e,t,n){"use strict";e.exports=function(e){e.inlineMode?e.tokens.push({type:"inline",content:e.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):e.block.parse(e.src,e.options,e.env,e.tokens)}},function(e,t,n){"use strict";var r=n(33),i=n(27);function o(e,t,n,o){var a,s,u,l,c,f;if(42!==e.charCodeAt(0))return-1;if(91!==e.charCodeAt(1))return-1;if(-1===e.indexOf("]:"))return-1;if(a=new r(e,t,n,o,[]),(s=i(a,1))<0||58!==e.charCodeAt(s+1))return-1;for(l=a.posMax,u=s+2;u<l&&10!==a.src.charCodeAt(u);u++);return c=e.slice(2,s),0===(f=e.slice(s+2,u).trim()).length?-1:(o.abbreviations||(o.abbreviations={}),void 0===o.abbreviations[":"+c]&&(o.abbreviations[":"+c]=f),u)}e.exports=function(e){var t,n,r,i,a=e.tokens;if(!e.inlineMode)for(t=1,n=a.length-1;t<n;t++)if("paragraph_open"===a[t-1].type&&"inline"===a[t].type&&"paragraph_close"===a[t+1].type){for(r=a[t].content;r.length&&!((i=o(r,e.inline,e.options,e.env))<0);)r=r.slice(i).trim();a[t].content=r,r.length||(a[t-1].tight=!0,a[t+1].tight=!0)}}},function(e,t,n){"use strict";var r=n(33),i=n(27),o=n(45),a=n(47),s=n(48);function u(e,t,n,u){var l,c,f,d,h,p,g,m,v;if(91!==e.charCodeAt(0))return-1;if(-1===e.indexOf("]:"))return-1;if(l=new r(e,t,n,u,[]),(c=i(l,0))<0||58!==e.charCodeAt(c+1))return-1;for(d=l.posMax,f=c+2;f<d&&(32===(h=l.src.charCodeAt(f))||10===h);f++);if(!o(l,f))return-1;for(g=l.linkContent,p=f=l.pos,f+=1;f<d&&(32===(h=l.src.charCodeAt(f))||10===h);f++);for(f<d&&p!==f&&a(l,f)?(m=l.linkContent,f=l.pos):(m="",f=p);f<d&&32===l.src.charCodeAt(f);)f++;return f<d&&10!==l.src.charCodeAt(f)?-1:(v=s(e.slice(1,c)),void 0===u.references[v]&&(u.references[v]={title:m,href:g}),f)}e.exports=function(e){var t,n,r,i,o=e.tokens;if(e.env.references=e.env.references||{},!e.inlineMode)for(t=1,n=o.length-1;t<n;t++)if("inline"===o[t].type&&"paragraph_open"===o[t-1].type&&"paragraph_close"===o[t+1].type){for(r=o[t].content;r.length&&!((i=u(r,e.inline,e.options,e.env))<0);)r=r.slice(i).trim();o[t].content=r,r.length||(o[t-1].tight=!0,o[t+1].tight=!0)}}},function(e,t,n){"use strict";e.exports=function(e){var t,n,r,i=e.tokens;for(n=0,r=i.length;n<r;n++)"inline"===(t=i[n]).type&&e.inline.parse(t.content,e.options,e.env,t.children)}},function(e,t,n){"use strict";e.exports=function(e){var t,n,r,i,o,a,s,u,l,c=0,f=!1,d={};if(e.env.footnotes&&(e.tokens=e.tokens.filter(function(e){return"footnote_reference_open"===e.type?(f=!0,u=[],l=e.label,!1):"footnote_reference_close"===e.type?(f=!1,d[":"+l]=u,!1):(f&&u.push(e),!f)}),e.env.footnotes.list)){for(a=e.env.footnotes.list,e.tokens.push({type:"footnote_block_open",level:c++}),t=0,n=a.length;t<n;t++){for(e.tokens.push({type:"footnote_open",id:t,level:c++}),a[t].tokens?((s=[]).push({type:"paragraph_open",tight:!1,level:c++}),s.push({type:"inline",content:"",level:c,children:a[t].tokens}),s.push({type:"paragraph_close",tight:!1,level:--c})):a[t].label&&(s=d[":"+a[t].label]),e.tokens=e.tokens.concat(s),o="paragraph_close"===e.tokens[e.tokens.length-1].type?e.tokens.pop():null,i=a[t].count>0?a[t].count:1,r=0;r<i;r++)e.tokens.push({type:"footnote_anchor",id:t,subId:r,level:c});o&&e.tokens.push(o),e.tokens.push({type:"footnote_close",level:--c})}e.tokens.push({type:"footnote_block_close",level:--c})}}},function(e,t,n){"use strict";function r(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}e.exports=function(e){var t,n,i,o,a,s,u,l,c,f,d,h,p=e.tokens;if(e.env.abbreviations)for(e.env.abbrRegExp||(h="(^|["+" \n()[]'\".,!?-".split("").map(r).join("")+"])("+Object.keys(e.env.abbreviations).map(function(e){return e.substr(1)}).sort(function(e,t){return t.length-e.length}).map(r).join("|")+")($|["+" \n()[]'\".,!?-".split("").map(r).join("")+"])",e.env.abbrRegExp=new RegExp(h,"g")),f=e.env.abbrRegExp,n=0,i=p.length;n<i;n++)if("inline"===p[n].type)for(t=(o=p[n].children).length-1;t>=0;t--)if("text"===(a=o[t]).type){for(l=0,s=a.content,f.lastIndex=0,c=a.level,u=[];d=f.exec(s);)f.lastIndex>l&&u.push({type:"text",content:s.slice(l,d.index+d[1].length),level:c}),u.push({type:"abbr_open",title:e.env.abbreviations[":"+d[2]],level:c++}),u.push({type:"text",content:d[2],level:c}),u.push({type:"abbr_close",level:--c}),l=f.lastIndex-d[3].length;u.length&&(l<s.length&&u.push({type:"text",content:s.slice(l),level:c}),p[n].children=o=[].concat(o.slice(0,t),u,o.slice(t+1)))}}},function(e,t,n){"use strict";var r=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,i=/\((c|tm|r|p)\)/gi,o={c:"©",r:"®",p:"§",tm:"™"};function a(e){return e.indexOf("(")<0?e:e.replace(i,function(e,t){return o[t.toLowerCase()]})}e.exports=function(e){var t,n,i,o,s;if(e.options.typographer)for(s=e.tokens.length-1;s>=0;s--)if("inline"===e.tokens[s].type)for(t=(o=e.tokens[s].children).length-1;t>=0;t--)"text"===(n=o[t]).type&&(i=a(i=n.content),r.test(i)&&(i=i.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1—$2").replace(/(^|\s)--(\s|$)/gm,"$1–$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1–$2")),n.content=i)}},function(e,t,n){"use strict";var r=/['"]/,i=/['"]/g,o=/[-\s()\[\]]/;function a(e,t){return!(t<0||t>=e.length)&&!o.test(e[t])}function s(e,t,n){return e.substr(0,t)+n+e.substr(t+1)}e.exports=function(e){var t,n,o,u,l,c,f,d,h,p,g,m,v,y,_,b,w;if(e.options.typographer)for(w=[],_=e.tokens.length-1;_>=0;_--)if("inline"===e.tokens[_].type)for(b=e.tokens[_].children,w.length=0,t=0;t<b.length;t++)if("text"===(n=b[t]).type&&!r.test(n.text)){for(f=b[t].level,v=w.length-1;v>=0&&!(w[v].level<=f);v--);w.length=v+1,l=0,c=(o=n.content).length;e:for(;l<c&&(i.lastIndex=l,u=i.exec(o));)if(d=!a(o,u.index-1),l=u.index+1,y="'"===u[0],(h=!a(o,l))||d){if(g=!h,m=!d)for(v=w.length-1;v>=0&&(p=w[v],!(w[v].level<f));v--)if(p.single===y&&w[v].level===f){p=w[v],y?(b[p.token].content=s(b[p.token].content,p.pos,e.options.quotes[2]),n.content=s(n.content,u.index,e.options.quotes[3])):(b[p.token].content=s(b[p.token].content,p.pos,e.options.quotes[0]),n.content=s(n.content,u.index,e.options.quotes[1])),w.length=v;continue e}g?w.push({token:t,pos:u.index,single:y,level:f}):m&&y&&(n.content=s(n.content,u.index,"’"))}else y&&(n.content=s(n.content,u.index,"’"))}}},function(e,t,n){"use strict";var r=n(126),i=/www|@|\:\/\//;function o(e){return/^<a[>\s]/i.test(e)}function a(e){return/^<\/a\s*>/i.test(e)}function s(){var e=[],t=new r({stripPrefix:!1,url:!0,email:!0,twitter:!1,replaceFn:function(t,n){switch(n.getType()){case"url":e.push({text:n.matchedText,url:n.getUrl()});break;case"email":e.push({text:n.matchedText,url:"mailto:"+n.getEmail().replace(/^mailto:/i,"")})}return!1}});return{links:e,autolinker:t}}e.exports=function(e){var t,n,r,u,l,c,f,d,h,p,g,m,v,y=e.tokens,_=null;if(e.options.linkify)for(n=0,r=y.length;n<r;n++)if("inline"===y[n].type)for(g=0,t=(u=y[n].children).length-1;t>=0;t--)if("link_close"!==(l=u[t]).type){if("htmltag"===l.type&&(o(l.content)&&g>0&&g--,a(l.content)&&g++),!(g>0)&&"text"===l.type&&i.test(l.content)){if(_||(m=(_=s()).links,v=_.autolinker),c=l.content,m.length=0,v.link(c),!m.length)continue;for(f=[],p=l.level,d=0;d<m.length;d++)e.inline.validateLink(m[d].url)&&((h=c.indexOf(m[d].text))&&(p=p,f.push({type:"text",content:c.slice(0,h),level:p})),f.push({type:"link_open",href:m[d].url,title:"",level:p++}),f.push({type:"text",content:m[d].text,level:p}),f.push({type:"link_close",level:--p}),c=c.slice(h+m[d].text.length));c.length&&f.push({type:"text",content:c,level:p}),y[n].children=u=[].concat(u.slice(0,t),f,u.slice(t+1))}}else for(t--;u[t].level!==l.level&&"link_open"!==u[t].type;)t--}},function(e,t,n){var r;!function(n,i){void 0===(r=function(){return n.Autolinker=function(){
/*!
 * Autolinker.js
 * 0.15.3
 *
 * Copyright(c) 2015 Gregory Jacobs <greg@greg-jacobs.com>
 * MIT Licensed. http://www.opensource.org/licenses/mit-license.php
 *
 * https://github.com/gregjacobs/Autolinker.js
 */
var e=function(t){e.Util.assign(this,t)};return e.prototype={constructor:e,urls:!0,email:!0,twitter:!0,newWindow:!0,stripPrefix:!0,truncate:void 0,className:"",htmlParser:void 0,matchParser:void 0,tagBuilder:void 0,link:function(e){for(var t=this.getHtmlParser().parse(e),n=0,r=[],i=0,o=t.length;i<o;i++){var a=t[i],s=a.getType(),u=a.getText();if("element"===s)"a"===a.getTagName()&&(a.isClosing()?n=Math.max(n-1,0):n++),r.push(u);else if("entity"===s)r.push(u);else if(0===n){var l=this.linkifyStr(u);r.push(l)}else r.push(u)}return r.join("")},linkifyStr:function(e){return this.getMatchParser().replace(e,this.createMatchReturnVal,this)},createMatchReturnVal:function(t){var n;return this.replaceFn&&(n=this.replaceFn.call(this,this,t)),"string"==typeof n?n:!1===n?t.getMatchedText():n instanceof e.HtmlTag?n.toString():this.getTagBuilder().build(t).toString()},getHtmlParser:function(){var t=this.htmlParser;return t||(t=this.htmlParser=new e.htmlParser.HtmlParser),t},getMatchParser:function(){var t=this.matchParser;return t||(t=this.matchParser=new e.matchParser.MatchParser({urls:this.urls,email:this.email,twitter:this.twitter,stripPrefix:this.stripPrefix})),t},getTagBuilder:function(){var t=this.tagBuilder;return t||(t=this.tagBuilder=new e.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),t}},e.link=function(t,n){return new e(n).link(t)},e.match={},e.htmlParser={},e.matchParser={},e.Util={abstractMethod:function(){throw"abstract"},assign:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},extend:function(t,n){var r,i=t.prototype,o=function(){};o.prototype=i;var a=(r=n.hasOwnProperty("constructor")?n.constructor:function(){i.constructor.apply(this,arguments)}).prototype=new o;return a.constructor=r,a.superclass=i,delete n.constructor,e.Util.assign(a,n),r},ellipsis:function(e,t,n){return e.length>t&&(n=null==n?"..":n,e=e.substring(0,t-n.length)+n),e},indexOf:function(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},splitAndCapture:function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var n,r=[],i=0;n=t.exec(e);)r.push(e.substring(i,n.index)),r.push(n[0]),i=n.index+n[0].length;return r.push(e.substring(i)),r}},e.HtmlTag=e.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(t){e.Util.assign(this,t),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(e){return this.tagName=e,this},getTagName:function(){return this.tagName||""},setAttr:function(e,t){return this.getAttrs()[e]=t,this},getAttr:function(e){return this.getAttrs()[e]},setAttrs:function(t){var n=this.getAttrs();return e.Util.assign(n,t),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(e){return this.setAttr("class",e)},addClass:function(t){for(var n,r=this.getClass(),i=this.whitespaceRegex,o=e.Util.indexOf,a=r?r.split(i):[],s=t.split(i);n=s.shift();)-1===o(a,n)&&a.push(n);return this.getAttrs().class=a.join(" "),this},removeClass:function(t){for(var n,r=this.getClass(),i=this.whitespaceRegex,o=e.Util.indexOf,a=r?r.split(i):[],s=t.split(i);a.length&&(n=s.shift());){var u=o(a,n);-1!==u&&a.splice(u,1)}return this.getAttrs().class=a.join(" "),this},getClass:function(){return this.getAttrs().class||""},hasClass:function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},setInnerHtml:function(e){return this.innerHtml=e,this},getInnerHtml:function(){return this.innerHtml||""},toString:function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+'="'+e[n]+'"');return t.join(" ")}}),e.AnchorTagBuilder=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},build:function(t){return new e.HtmlTag({tagName:"a",attrs:this.createAttrs(t.getType(),t.getAnchorHref()),innerHtml:this.processAnchorText(t.getAnchorText())})},createAttrs:function(e,t){var n={href:t},r=this.createCssClass(e);return r&&(n.class=r),this.newWindow&&(n.target="_blank"),n},createCssClass:function(e){var t=this.className;return t?t+" "+t+"-"+e:""},processAnchorText:function(e){return e=this.doTruncate(e)},doTruncate:function(t){return e.Util.ellipsis(t,this.truncate||Number.POSITIVE_INFINITY)}}),e.htmlParser.HtmlParser=e.Util.extend(Object,{htmlRegex:function(){var e=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/,t=/[^\s\0"'>\/=\x01-\x1F\x7F]+/.source+"(?:\\s*=\\s*"+e.source+")?";return new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",t,"|",e.source+")",")*",">",")","|","(?:","<(/)?","("+/[0-9a-zA-Z][0-9a-zA-Z:]*/.source+")","(?:","\\s+",t,")*","\\s*/?",">",")"].join(""),"gi")}(),htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,parse:function(e){for(var t,n,r=this.htmlRegex,i=0,o=[];null!==(t=r.exec(e));){var a=t[0],s=t[1]||t[3],u=!!t[2],l=e.substring(i,t.index);l&&(n=this.parseTextAndEntityNodes(l),o.push.apply(o,n)),o.push(this.createElementNode(a,s,u)),i=t.index+a.length}if(i<e.length){var c=e.substring(i);c&&(n=this.parseTextAndEntityNodes(c),o.push.apply(o,n))}return o},parseTextAndEntityNodes:function(t){for(var n=[],r=e.Util.splitAndCapture(t,this.htmlCharacterEntitiesRegex),i=0,o=r.length;i<o;i+=2){var a=r[i],s=r[i+1];a&&n.push(this.createTextNode(a)),s&&n.push(this.createEntityNode(s))}return n},createElementNode:function(t,n,r){return new e.htmlParser.ElementNode({text:t,tagName:n.toLowerCase(),closing:r})},createEntityNode:function(t){return new e.htmlParser.EntityNode({text:t})},createTextNode:function(t){return new e.htmlParser.TextNode({text:t})}}),e.htmlParser.HtmlNode=e.Util.extend(Object,{text:"",constructor:function(t){e.Util.assign(this,t)},getType:e.Util.abstractMethod,getText:function(){return this.text}}),e.htmlParser.ElementNode=e.Util.extend(e.htmlParser.HtmlNode,{tagName:"",closing:!1,getType:function(){return"element"},getTagName:function(){return this.tagName},isClosing:function(){return this.closing}}),e.htmlParser.EntityNode=e.Util.extend(e.htmlParser.HtmlNode,{getType:function(){return"entity"}}),e.htmlParser.TextNode=e.Util.extend(e.htmlParser.HtmlNode,{getType:function(){return"text"}}),e.matchParser.MatchParser=e.Util.extend(Object,{urls:!0,email:!0,twitter:!0,stripPrefix:!0,matcherRegex:function(){var e=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,t=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/;return new RegExp(["(",/(^|[^\w])@(\w{1,15})/.source,")","|","(",/(?:[\-;:&=\+\$,\w\.]+@)/.source,e.source,t.source,")","|","(","(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]+:(?![A-Za-z][-.+A-Za-z0-9]+:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,e.source,")","|","(?:","(.?//)?",/(?:www\.)/.source,e.source,")","|","(?:","(.?//)?",e.source,t.source,")",")","(?:"+/[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]?!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]]/.source+")?",")"].join(""),"gi")}(),charBeforeProtocolRelMatchRegex:/^(.)?\/\//,constructor:function(t){e.Util.assign(this,t),this.matchValidator=new e.MatchValidator},replace:function(e,t,n){var r=this;return e.replace(this.matcherRegex,function(e,i,o,a,s,u,l,c,f){var d=r.processCandidateMatch(e,i,o,a,s,u,l,c,f);if(d){var h=t.call(n,d.match);return d.prefixStr+h+d.suffixStr}return e})},processCandidateMatch:function(t,n,r,i,o,a,s,u,l){var c,f=u||l,d="",h="";if(n&&!this.twitter||o&&!this.email||a&&!this.urls||!this.matchValidator.isValidMatch(a,s,f))return null;if(this.matchHasUnbalancedClosingParen(t)&&(t=t.substr(0,t.length-1),h=")"),o)c=new e.match.Email({matchedText:t,email:o});else if(n)r&&(d=r,t=t.slice(1)),c=new e.match.Twitter({matchedText:t,twitterHandle:i});else{if(f){var p=f.match(this.charBeforeProtocolRelMatchRegex)[1]||"";p&&(d=p,t=t.slice(1))}c=new e.match.Url({matchedText:t,url:t,protocolUrlMatch:!!s,protocolRelativeMatch:!!f,stripPrefix:this.stripPrefix})}return{prefixStr:d,suffixStr:h,match:c}},matchHasUnbalancedClosingParen:function(e){if(")"===e.charAt(e.length-1)){var t=e.match(/\(/g),n=e.match(/\)/g);if((t&&t.length||0)<(n&&n.length||0))return!0}return!1}}),e.MatchValidator=e.Util.extend(Object,{invalidProtocolRelMatchRegex:/^[\w]\/\//,hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]+:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]+:/,hasWordCharAfterProtocolRegex:/:[^\s]*?[A-Za-z]/,isValidMatch:function(e,t,n){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)||this.isInvalidProtocolRelativeMatch(n))},isValidUriScheme:function(e){var t=e.match(this.uriSchemeRegex)[0].toLowerCase();return"javascript:"!==t&&"vbscript:"!==t},urlMatchDoesNotHaveProtocolOrDot:function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},urlMatchDoesNotHaveAtLeastOneWordChar:function(e,t){return!(!e||!t||this.hasWordCharAfterProtocolRegex.test(e))},isInvalidProtocolRelativeMatch:function(e){return!!e&&this.invalidProtocolRelMatchRegex.test(e)}}),e.match.Match=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},getType:e.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:e.Util.abstractMethod,getAnchorText:e.Util.abstractMethod}),e.match.Email=e.Util.extend(e.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),e.match.Twitter=e.Util.extend(e.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}}),e.match.Url=e.Util.extend(e.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:!1,getType:function(){return"url"},getUrl:function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},getAnchorHref:function(){return this.getUrl().replace(/&amp;/g,"&")},getAnchorText:function(){var e=this.getUrl();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix&&(e=this.stripUrlPrefix(e)),e=this.removeTrailingSlash(e)},stripUrlPrefix:function(e){return e.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(e){return e.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}}),e}()}.apply(t,[]))||(e.exports=r)}(this)},function(e,t,n){"use strict";var r=n(26),i=n(128),o=[["code",n(129)],["fences",n(130),["paragraph","blockquote","list"]],["blockquote",n(131),["paragraph","blockquote","list"]],["hr",n(132),["paragraph","blockquote","list"]],["list",n(133),["paragraph","blockquote"]],["footnote",n(134),["paragraph"]],["heading",n(135),["paragraph","blockquote"]],["lheading",n(136)],["htmlblock",n(137),["paragraph","blockquote"]],["table",n(139),["paragraph"]],["deflist",n(140),["paragraph"]],["paragraph",n(141)]];function a(){this.ruler=new r;for(var e=0;e<o.length;e++)this.ruler.push(o[e][0],o[e][1],{alt:(o[e][2]||[]).slice()})}a.prototype.tokenize=function(e,t,n){for(var r,i=this.ruler.getRules(""),o=i.length,a=t,s=!1;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n))&&!(e.tShift[a]<e.blkIndent);){for(r=0;r<o&&!i[r](e,a,n,!1);r++);if(e.tight=!s,e.isEmpty(e.line-1)&&(s=!0),(a=e.line)<n&&e.isEmpty(a)){if(s=!0,++a<n&&"list"===e.parentType&&e.isEmpty(a))break;e.line=a}}};var s=/[\n\t]/g,u=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,l=/\u00a0/g;a.prototype.parse=function(e,t,n,r){var o,a=0,c=0;if(!e)return[];(e=(e=e.replace(l," ")).replace(u,"\n")).indexOf("\t")>=0&&(e=e.replace(s,function(t,n){var r;return 10===e.charCodeAt(n)?(a=n+1,c=0,t):(r="    ".slice((n-a-c)%4),c=n-a+1,r)})),o=new i(e,this,t,n,r),this.tokenize(o,o.line,o.lineMax)},e.exports=a},function(e,t,n){"use strict";function r(e,t,n,r,i){var o,a,s,u,l,c,f;for(this.src=e,this.parser=t,this.options=n,this.env=r,this.tokens=i,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",c=0,f=!1,s=u=c=0,l=(a=this.src).length;u<l;u++){if(o=a.charCodeAt(u),!f){if(32===o){c++;continue}f=!0}10!==o&&u!==l-1||(10!==o&&u++,this.bMarks.push(s),this.eMarks.push(u),this.tShift.push(c),f=!1,c=0,s=u+1)}this.bMarks.push(a.length),this.eMarks.push(a.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}r.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},r.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},r.prototype.skipSpaces=function(e){for(var t=this.src.length;e<t&&32===this.src.charCodeAt(e);e++);return e},r.prototype.skipChars=function(e,t){for(var n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e},r.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e},r.prototype.getLines=function(e,t,n,r){var i,o,a,s,u,l=e;if(e>=t)return"";if(l+1===t)return o=this.bMarks[l]+Math.min(this.tShift[l],n),a=r?this.eMarks[l]+1:this.eMarks[l],this.src.slice(o,a);for(s=new Array(t-e),i=0;l<t;l++,i++)(u=this.tShift[l])>n&&(u=n),u<0&&(u=0),o=this.bMarks[l]+u,a=l+1<t||r?this.eMarks[l]+1:this.eMarks[l],s[i]=this.src.slice(o,a);return s.join("")},e.exports=r},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,i;if(e.tShift[t]-e.blkIndent<4)return!1;for(i=r=t+1;r<n;)if(e.isEmpty(r))r++;else{if(!(e.tShift[r]-e.blkIndent>=4))break;i=++r}return e.line=r,e.tokens.push({type:"code",content:e.getLines(t,i,4+e.blkIndent,!0),block:!0,lines:[t,e.line],level:e.level}),!0}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var i,o,a,s,u,l=!1,c=e.bMarks[t]+e.tShift[t],f=e.eMarks[t];if(c+3>f)return!1;if(126!==(i=e.src.charCodeAt(c))&&96!==i)return!1;if(u=c,(o=(c=e.skipChars(c,i))-u)<3)return!1;if((a=e.src.slice(c,f).trim()).indexOf("`")>=0)return!1;if(r)return!0;for(s=t;!(++s>=n)&&!((c=u=e.bMarks[s]+e.tShift[s])<(f=e.eMarks[s])&&e.tShift[s]<e.blkIndent);)if(e.src.charCodeAt(c)===i&&!(e.tShift[s]-e.blkIndent>=4||(c=e.skipChars(c,i))-u<o||(c=e.skipSpaces(c))<f)){l=!0;break}return o=e.tShift[t],e.line=s+(l?1:0),e.tokens.push({type:"fence",params:a,content:e.getLines(t+1,s,o,!0),lines:[t,e.line],level:e.level}),!0}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var i,o,a,s,u,l,c,f,d,h,p,g=e.bMarks[t]+e.tShift[t],m=e.eMarks[t];if(g>m)return!1;if(62!==e.src.charCodeAt(g++))return!1;if(e.level>=e.options.maxNesting)return!1;if(r)return!0;for(32===e.src.charCodeAt(g)&&g++,u=e.blkIndent,e.blkIndent=0,s=[e.bMarks[t]],e.bMarks[t]=g,o=(g=g<m?e.skipSpaces(g):g)>=m,a=[e.tShift[t]],e.tShift[t]=g-e.bMarks[t],f=e.parser.ruler.getRules("blockquote"),i=t+1;i<n&&!((g=e.bMarks[i]+e.tShift[i])>=(m=e.eMarks[i]));i++)if(62!==e.src.charCodeAt(g++)){if(o)break;for(p=!1,d=0,h=f.length;d<h;d++)if(f[d](e,i,n,!0)){p=!0;break}if(p)break;s.push(e.bMarks[i]),a.push(e.tShift[i]),e.tShift[i]=-1337}else 32===e.src.charCodeAt(g)&&g++,s.push(e.bMarks[i]),e.bMarks[i]=g,o=(g=g<m?e.skipSpaces(g):g)>=m,a.push(e.tShift[i]),e.tShift[i]=g-e.bMarks[i];for(l=e.parentType,e.parentType="blockquote",e.tokens.push({type:"blockquote_open",lines:c=[t,0],level:e.level++}),e.parser.tokenize(e,t,i),e.tokens.push({type:"blockquote_close",level:--e.level}),e.parentType=l,c[1]=e.line,d=0;d<a.length;d++)e.bMarks[d+t]=s[d],e.tShift[d+t]=a[d];return e.blkIndent=u,!0}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var i,o,a,s=e.bMarks[t],u=e.eMarks[t];if((s+=e.tShift[t])>u)return!1;if(42!==(i=e.src.charCodeAt(s++))&&45!==i&&95!==i)return!1;for(o=1;s<u;){if((a=e.src.charCodeAt(s++))!==i&&32!==a)return!1;a===i&&o++}return!(o<3)&&(!!r||(e.line=t+1,e.tokens.push({type:"hr",lines:[t,e.line],level:e.level}),!0))}},function(e,t,n){"use strict";function r(e,t){var n,r,i;return(r=e.bMarks[t]+e.tShift[t])>=(i=e.eMarks[t])?-1:42!==(n=e.src.charCodeAt(r++))&&45!==n&&43!==n?-1:r<i&&32!==e.src.charCodeAt(r)?-1:r}function i(e,t){var n,r=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(r+1>=i)return-1;if((n=e.src.charCodeAt(r++))<48||n>57)return-1;for(;;){if(r>=i)return-1;if(!((n=e.src.charCodeAt(r++))>=48&&n<=57)){if(41===n||46===n)break;return-1}}return r<i&&32!==e.src.charCodeAt(r)?-1:r}e.exports=function(e,t,n,o){var a,s,u,l,c,f,d,h,p,g,m,v,y,_,b,w,x,E,M,C,T,S=!0;if((h=i(e,t))>=0)v=!0;else{if(!((h=r(e,t))>=0))return!1;v=!1}if(e.level>=e.options.maxNesting)return!1;if(m=e.src.charCodeAt(h-1),o)return!0;for(_=e.tokens.length,v?(d=e.bMarks[t]+e.tShift[t],g=Number(e.src.substr(d,h-d-1)),e.tokens.push({type:"ordered_list_open",order:g,lines:w=[t,0],level:e.level++})):e.tokens.push({type:"bullet_list_open",lines:w=[t,0],level:e.level++}),a=t,b=!1,E=e.parser.ruler.getRules("list");!(!(a<n)||((p=(y=e.skipSpaces(h))>=e.eMarks[a]?1:y-h)>4&&(p=1),p<1&&(p=1),s=h-e.bMarks[a]+p,e.tokens.push({type:"list_item_open",lines:x=[t,0],level:e.level++}),l=e.blkIndent,c=e.tight,u=e.tShift[t],f=e.parentType,e.tShift[t]=y-e.bMarks[t],e.blkIndent=s,e.tight=!0,e.parentType="list",e.parser.tokenize(e,t,n,!0),e.tight&&!b||(S=!1),b=e.line-t>1&&e.isEmpty(e.line-1),e.blkIndent=l,e.tShift[t]=u,e.tight=c,e.parentType=f,e.tokens.push({type:"list_item_close",level:--e.level}),a=t=e.line,x[1]=a,y=e.bMarks[t],a>=n)||e.isEmpty(a)||e.tShift[a]<e.blkIndent);){for(T=!1,M=0,C=E.length;M<C;M++)if(E[M](e,a,n,!0)){T=!0;break}if(T)break;if(v){if((h=i(e,a))<0)break}else if((h=r(e,a))<0)break;if(m!==e.src.charCodeAt(h-1))break}return e.tokens.push({type:v?"ordered_list_close":"bullet_list_close",level:--e.level}),w[1]=a,e.line=a,S&&function(e,t){var n,r,i=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===i&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,_),!0}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var i,o,a,s,u,l=e.bMarks[t]+e.tShift[t],c=e.eMarks[t];if(l+4>c)return!1;if(91!==e.src.charCodeAt(l))return!1;if(94!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;for(s=l+2;s<c;s++){if(32===e.src.charCodeAt(s))return!1;if(93===e.src.charCodeAt(s))break}return s!==l+2&&(!(s+1>=c||58!==e.src.charCodeAt(++s))&&(!!r||(s++,e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.refs||(e.env.footnotes.refs={}),u=e.src.slice(l+2,s-2),e.env.footnotes.refs[":"+u]=-1,e.tokens.push({type:"footnote_reference_open",label:u,level:e.level++}),i=e.bMarks[t],o=e.tShift[t],a=e.parentType,e.tShift[t]=e.skipSpaces(s)-s,e.bMarks[t]=s,e.blkIndent+=4,e.parentType="footnote",e.tShift[t]<e.blkIndent&&(e.tShift[t]+=e.blkIndent,e.bMarks[t]-=e.blkIndent),e.parser.tokenize(e,t,n,!0),e.parentType=a,e.blkIndent-=4,e.tShift[t]=o,e.bMarks[t]=i,e.tokens.push({type:"footnote_reference_close",level:--e.level}),!0)))}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var i,o,a,s=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(s>=u)return!1;if(35!==(i=e.src.charCodeAt(s))||s>=u)return!1;for(o=1,i=e.src.charCodeAt(++s);35===i&&s<u&&o<=6;)o++,i=e.src.charCodeAt(++s);return!(o>6||s<u&&32!==i)&&(!!r||(u=e.skipCharsBack(u,32,s),(a=e.skipCharsBack(u,35,s))>s&&32===e.src.charCodeAt(a-1)&&(u=a),e.line=t+1,e.tokens.push({type:"heading_open",hLevel:o,lines:[t,e.line],level:e.level}),s<u&&e.tokens.push({type:"inline",content:e.src.slice(s,u).trim(),level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"heading_close",hLevel:o,level:e.level}),!0))}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,i,o,a=t+1;return!(a>=n)&&(!(e.tShift[a]<e.blkIndent)&&(!(e.tShift[a]-e.blkIndent>3)&&(!((i=e.bMarks[a]+e.tShift[a])>=(o=e.eMarks[a]))&&((45===(r=e.src.charCodeAt(i))||61===r)&&(i=e.skipChars(i,r),!((i=e.skipSpaces(i))<o)&&(i=e.bMarks[t]+e.tShift[t],e.line=a+1,e.tokens.push({type:"heading_open",hLevel:61===r?1:2,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:e.src.slice(i,e.eMarks[t]).trim(),level:e.level+1,lines:[t,e.line-1],children:[]}),e.tokens.push({type:"heading_close",hLevel:61===r?1:2,level:e.level}),!0))))))}},function(e,t,n){"use strict";var r=n(138),i=/^<([a-zA-Z]{1,15})[\s\/>]/,o=/^<\/([a-zA-Z]{1,15})[\s>]/;e.exports=function(e,t,n,a){var s,u,l,c=e.bMarks[t],f=e.eMarks[t],d=e.tShift[t];if(c+=d,!e.options.html)return!1;if(d>3||c+2>=f)return!1;if(60!==e.src.charCodeAt(c))return!1;if(33===(s=e.src.charCodeAt(c+1))||63===s){if(a)return!0}else{if(47!==s&&!function(e){var t=32|e;return t>=97&&t<=122}(s))return!1;if(47===s){if(!(u=e.src.slice(c,f).match(o)))return!1}else if(!(u=e.src.slice(c,f).match(i)))return!1;if(!0!==r[u[1].toLowerCase()])return!1;if(a)return!0}for(l=t+1;l<e.lineMax&&!e.isEmpty(l);)l++;return e.line=l,e.tokens.push({type:"htmlblock",level:e.level,lines:[t,e.line],content:e.getLines(t,l,0,!0)}),!0}},function(e,t,n){"use strict";var r={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach(function(e){r[e]=!0}),e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=e.bMarks[t]+e.blkIndent,r=e.eMarks[t];return e.src.substr(n,r-n)}e.exports=function(e,t,n,i){var o,a,s,u,l,c,f,d,h,p,g;if(t+2>n)return!1;if(l=t+1,e.tShift[l]<e.blkIndent)return!1;if((s=e.bMarks[l]+e.tShift[l])>=e.eMarks[l])return!1;if(124!==(o=e.src.charCodeAt(s))&&45!==o&&58!==o)return!1;if(a=r(e,t+1),!/^[-:| ]+$/.test(a))return!1;if((c=a.split("|"))<=2)return!1;for(d=[],u=0;u<c.length;u++){if(!(h=c[u].trim())){if(0===u||u===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(h))return!1;58===h.charCodeAt(h.length-1)?d.push(58===h.charCodeAt(0)?"center":"right"):58===h.charCodeAt(0)?d.push("left"):d.push("")}if(-1===(a=r(e,t).trim()).indexOf("|"))return!1;if(c=a.replace(/^\||\|$/g,"").split("|"),d.length!==c.length)return!1;if(i)return!0;for(e.tokens.push({type:"table_open",lines:p=[t,0],level:e.level++}),e.tokens.push({type:"thead_open",lines:[t,t+1],level:e.level++}),e.tokens.push({type:"tr_open",lines:[t,t+1],level:e.level++}),u=0;u<c.length;u++)e.tokens.push({type:"th_open",align:d[u],lines:[t,t+1],level:e.level++}),e.tokens.push({type:"inline",content:c[u].trim(),lines:[t,t+1],level:e.level,children:[]}),e.tokens.push({type:"th_close",level:--e.level});for(e.tokens.push({type:"tr_close",level:--e.level}),e.tokens.push({type:"thead_close",level:--e.level}),e.tokens.push({type:"tbody_open",lines:g=[t+2,0],level:e.level++}),l=t+2;l<n&&!(e.tShift[l]<e.blkIndent)&&-1!==(a=r(e,l).trim()).indexOf("|");l++){for(c=a.replace(/^\||\|$/g,"").split("|"),e.tokens.push({type:"tr_open",level:e.level++}),u=0;u<c.length;u++)e.tokens.push({type:"td_open",align:d[u],level:e.level++}),f=c[u].substring(124===c[u].charCodeAt(0)?1:0,124===c[u].charCodeAt(c[u].length-1)?c[u].length-1:c[u].length).trim(),e.tokens.push({type:"inline",content:f,level:e.level,children:[]}),e.tokens.push({type:"td_close",level:--e.level});e.tokens.push({type:"tr_close",level:--e.level})}return e.tokens.push({type:"tbody_close",level:--e.level}),e.tokens.push({type:"table_close",level:--e.level}),p[1]=g[1]=l,e.line=l,!0}},function(e,t,n){"use strict";function r(e,t){var n,r,i=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];return i>=o?-1:126!==(r=e.src.charCodeAt(i++))&&58!==r?-1:i===(n=e.skipSpaces(i))?-1:n>=o?-1:n}e.exports=function(e,t,n,i){var o,a,s,u,l,c,f,d,h,p,g,m,v,y;if(i)return!(e.ddIndent<0)&&r(e,t)>=0;if(f=t+1,e.isEmpty(f)&&++f>n)return!1;if(e.tShift[f]<e.blkIndent)return!1;if((o=r(e,f))<0)return!1;if(e.level>=e.options.maxNesting)return!1;c=e.tokens.length,e.tokens.push({type:"dl_open",lines:l=[t,0],level:e.level++}),s=t,a=f;e:for(;;){for(y=!0,v=!1,e.tokens.push({type:"dt_open",lines:[s,s],level:e.level++}),e.tokens.push({type:"inline",content:e.getLines(s,s+1,e.blkIndent,!1).trim(),level:e.level+1,lines:[s,s],children:[]}),e.tokens.push({type:"dt_close",level:--e.level});;){if(e.tokens.push({type:"dd_open",lines:u=[f,0],level:e.level++}),m=e.tight,h=e.ddIndent,d=e.blkIndent,g=e.tShift[a],p=e.parentType,e.blkIndent=e.ddIndent=e.tShift[a]+2,e.tShift[a]=o-e.bMarks[a],e.tight=!0,e.parentType="deflist",e.parser.tokenize(e,a,n,!0),e.tight&&!v||(y=!1),v=e.line-a>1&&e.isEmpty(e.line-1),e.tShift[a]=g,e.tight=m,e.parentType=p,e.blkIndent=d,e.ddIndent=h,e.tokens.push({type:"dd_close",level:--e.level}),u[1]=f=e.line,f>=n)break e;if(e.tShift[f]<e.blkIndent)break e;if((o=r(e,f))<0)break;a=f}if(f>=n)break;if(s=f,e.isEmpty(s))break;if(e.tShift[s]<e.blkIndent)break;if((a=s+1)>=n)break;if(e.isEmpty(a)&&a++,a>=n)break;if(e.tShift[a]<e.blkIndent)break;if((o=r(e,a))<0)break}return e.tokens.push({type:"dl_close",level:--e.level}),l[1]=f,e.line=f,y&&function(e,t){var n,r,i=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===i&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,c),!0}},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,a,s,u=t+1;if(u<(n=e.lineMax)&&!e.isEmpty(u))for(s=e.parser.ruler.getRules("paragraph");u<n&&!e.isEmpty(u);u++)if(!(e.tShift[u]-e.blkIndent>3)){for(i=!1,o=0,a=s.length;o<a;o++)if(s[o](e,u,n,!0)){i=!0;break}if(i)break}return r=e.getLines(t,u,e.blkIndent,!1).trim(),e.line=u,r.length&&(e.tokens.push({type:"paragraph_open",tight:!1,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:r,level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"paragraph_close",tight:!1,level:e.level})),!0}},function(e,t,n){"use strict";var r=n(26),i=n(33),o=n(10),a=[["text",n(143)],["newline",n(144)],["escape",n(145)],["backticks",n(146)],["del",n(147)],["ins",n(148)],["mark",n(149)],["emphasis",n(150)],["sub",n(151)],["sup",n(152)],["links",n(153)],["footnote_inline",n(154)],["footnote_ref",n(155)],["autolink",n(156)],["htmltag",n(158)],["entity",n(160)]];function s(){this.ruler=new r;for(var e=0;e<a.length;e++)this.ruler.push(a[e][0],a[e][1]);this.validateLink=u}function u(e){var t=e.trim().toLowerCase();return-1===(t=o.replaceEntities(t)).indexOf(":")||-1===["vbscript","javascript","file","data"].indexOf(t.split(":")[0])}s.prototype.skipToken=function(e){var t,n,r=this.ruler.getRules(""),i=r.length,o=e.pos;if((n=e.cacheGet(o))>0)e.pos=n;else{for(t=0;t<i;t++)if(r[t](e,!0))return void e.cacheSet(o,e.pos);e.pos++,e.cacheSet(o,e.pos)}},s.prototype.tokenize=function(e){for(var t,n,r=this.ruler.getRules(""),i=r.length,o=e.posMax;e.pos<o;){for(n=0;n<i&&!(t=r[n](e,!1));n++);if(t){if(e.pos>=o)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},s.prototype.parse=function(e,t,n,r){var o=new i(e,this,t,n,r);this.tokenize(o)},e.exports=s},function(e,t,n){"use strict";function r(e){switch(e){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}e.exports=function(e,t){for(var n=e.pos;n<e.posMax&&!r(e.src.charCodeAt(n));)n++;return n!==e.pos&&(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i=e.pos;if(10!==e.src.charCodeAt(i))return!1;if(n=e.pending.length-1,r=e.posMax,!t)if(n>=0&&32===e.pending.charCodeAt(n))if(n>=1&&32===e.pending.charCodeAt(n-1)){for(var o=n-2;o>=0;o--)if(32!==e.pending.charCodeAt(o)){e.pending=e.pending.substring(0,o+1);break}e.push({type:"hardbreak",level:e.level})}else e.pending=e.pending.slice(0,-1),e.push({type:"softbreak",level:e.level});else e.push({type:"softbreak",level:e.level});for(i++;i<r&&32===e.src.charCodeAt(i);)i++;return e.pos=i,!0}},function(e,t,n){"use strict";for(var r=[],i=0;i<256;i++)r.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){r[e.charCodeAt(0)]=1}),e.exports=function(e,t){var n,i=e.pos,o=e.posMax;if(92!==e.src.charCodeAt(i))return!1;if(++i<o){if((n=e.src.charCodeAt(i))<256&&0!==r[n])return t||(e.pending+=e.src[i]),e.pos+=2,!0;if(10===n){for(t||e.push({type:"hardbreak",level:e.level}),i++;i<o&&32===e.src.charCodeAt(i);)i++;return e.pos=i,!0}}return t||(e.pending+="\\"),e.pos++,!0}},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,a,s=e.pos;if(96!==e.src.charCodeAt(s))return!1;for(n=s,s++,r=e.posMax;s<r&&96===e.src.charCodeAt(s);)s++;for(i=e.src.slice(n,s),o=a=s;-1!==(o=e.src.indexOf("`",a));){for(a=o+1;a<r&&96===e.src.charCodeAt(a);)a++;if(a-o===i.length)return t||e.push({type:"code",content:e.src.slice(s,o).replace(/[ \n]+/g," ").trim(),block:!1,level:e.level}),e.pos=a,!0}return t||(e.pending+=i),e.pos+=i.length,!0}},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,a,s=e.posMax,u=e.pos;if(126!==e.src.charCodeAt(u))return!1;if(t)return!1;if(u+4>=s)return!1;if(126!==e.src.charCodeAt(u+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=u>0?e.src.charCodeAt(u-1):-1,a=e.src.charCodeAt(u+2),126===o)return!1;if(126===a)return!1;if(32===a||10===a)return!1;for(r=u+2;r<s&&126===e.src.charCodeAt(r);)r++;if(r>u+3)return e.pos+=r-u,t||(e.pending+=e.src.slice(u,r)),!0;for(e.pos=u+2,i=1;e.pos+1<s;){if(126===e.src.charCodeAt(e.pos)&&126===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),126!==(a=e.pos+2<s?e.src.charCodeAt(e.pos+2):-1)&&126!==o&&(32!==o&&10!==o?i--:32!==a&&10!==a&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=u+2,t||(e.push({type:"del_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"del_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=s,!0):(e.pos=u,!1)}},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,a,s=e.posMax,u=e.pos;if(43!==e.src.charCodeAt(u))return!1;if(t)return!1;if(u+4>=s)return!1;if(43!==e.src.charCodeAt(u+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=u>0?e.src.charCodeAt(u-1):-1,a=e.src.charCodeAt(u+2),43===o)return!1;if(43===a)return!1;if(32===a||10===a)return!1;for(r=u+2;r<s&&43===e.src.charCodeAt(r);)r++;if(r!==u+2)return e.pos+=r-u,t||(e.pending+=e.src.slice(u,r)),!0;for(e.pos=u+2,i=1;e.pos+1<s;){if(43===e.src.charCodeAt(e.pos)&&43===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),43!==(a=e.pos+2<s?e.src.charCodeAt(e.pos+2):-1)&&43!==o&&(32!==o&&10!==o?i--:32!==a&&10!==a&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=u+2,t||(e.push({type:"ins_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"ins_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=s,!0):(e.pos=u,!1)}},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,a,s=e.posMax,u=e.pos;if(61!==e.src.charCodeAt(u))return!1;if(t)return!1;if(u+4>=s)return!1;if(61!==e.src.charCodeAt(u+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=u>0?e.src.charCodeAt(u-1):-1,a=e.src.charCodeAt(u+2),61===o)return!1;if(61===a)return!1;if(32===a||10===a)return!1;for(r=u+2;r<s&&61===e.src.charCodeAt(r);)r++;if(r!==u+2)return e.pos+=r-u,t||(e.pending+=e.src.slice(u,r)),!0;for(e.pos=u+2,i=1;e.pos+1<s;){if(61===e.src.charCodeAt(e.pos)&&61===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),61!==(a=e.pos+2<s?e.src.charCodeAt(e.pos+2):-1)&&61!==o&&(32!==o&&10!==o?i--:32!==a&&10!==a&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=u+2,t||(e.push({type:"mark_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"mark_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=s,!0):(e.pos=u,!1)}},function(e,t,n){"use strict";function r(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122}function i(e,t){var n,i,o,a=t,s=!0,u=!0,l=e.posMax,c=e.src.charCodeAt(t);for(n=t>0?e.src.charCodeAt(t-1):-1;a<l&&e.src.charCodeAt(a)===c;)a++;return a>=l&&(s=!1),(o=a-t)>=4?s=u=!1:(32!==(i=a<l?e.src.charCodeAt(a):-1)&&10!==i||(s=!1),32!==n&&10!==n||(u=!1),95===c&&(r(n)&&(s=!1),r(i)&&(u=!1))),{can_open:s,can_close:u,delims:o}}e.exports=function(e,t){var n,r,o,a,s,u,l,c=e.posMax,f=e.pos,d=e.src.charCodeAt(f);if(95!==d&&42!==d)return!1;if(t)return!1;if(n=(l=i(e,f)).delims,!l.can_open)return e.pos+=n,t||(e.pending+=e.src.slice(f,e.pos)),!0;if(e.level>=e.options.maxNesting)return!1;for(e.pos=f+n,u=[n];e.pos<c;)if(e.src.charCodeAt(e.pos)!==d)e.parser.skipToken(e);else{if(r=(l=i(e,e.pos)).delims,l.can_close){for(a=u.pop(),s=r;a!==s;){if(s<a){u.push(a-s);break}if(s-=a,0===u.length)break;e.pos+=a,a=u.pop()}if(0===u.length){n=a,o=!0;break}e.pos+=r;continue}l.can_open&&u.push(r),e.pos+=r}return o?(e.posMax=e.pos,e.pos=f+n,t||(2!==n&&3!==n||e.push({type:"strong_open",level:e.level++}),1!==n&&3!==n||e.push({type:"em_open",level:e.level++}),e.parser.tokenize(e),1!==n&&3!==n||e.push({type:"em_close",level:--e.level}),2!==n&&3!==n||e.push({type:"strong_close",level:--e.level})),e.pos=e.posMax+n,e.posMax=c,!0):(e.pos=f,!1)}},function(e,t,n){"use strict";var r=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;e.exports=function(e,t){var n,i,o=e.posMax,a=e.pos;if(126!==e.src.charCodeAt(a))return!1;if(t)return!1;if(a+2>=o)return!1;if(e.level>=e.options.maxNesting)return!1;for(e.pos=a+1;e.pos<o;){if(126===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return n&&a+1!==e.pos?(i=e.src.slice(a+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=a,!1):(e.posMax=e.pos,e.pos=a+1,t||e.push({type:"sub",level:e.level,content:i.replace(r,"$1")}),e.pos=e.posMax+1,e.posMax=o,!0):(e.pos=a,!1)}},function(e,t,n){"use strict";var r=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;e.exports=function(e,t){var n,i,o=e.posMax,a=e.pos;if(94!==e.src.charCodeAt(a))return!1;if(t)return!1;if(a+2>=o)return!1;if(e.level>=e.options.maxNesting)return!1;for(e.pos=a+1;e.pos<o;){if(94===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return n&&a+1!==e.pos?(i=e.src.slice(a+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=a,!1):(e.posMax=e.pos,e.pos=a+1,t||e.push({type:"sup",level:e.level,content:i.replace(r,"$1")}),e.pos=e.posMax+1,e.posMax=o,!0):(e.pos=a,!1)}},function(e,t,n){"use strict";var r=n(27),i=n(45),o=n(47),a=n(48);e.exports=function(e,t){var n,s,u,l,c,f,d,h,p=!1,g=e.pos,m=e.posMax,v=e.pos,y=e.src.charCodeAt(v);if(33===y&&(p=!0,y=e.src.charCodeAt(++v)),91!==y)return!1;if(e.level>=e.options.maxNesting)return!1;if(n=v+1,(s=r(e,v))<0)return!1;if((f=s+1)<m&&40===e.src.charCodeAt(f)){for(f++;f<m&&(32===(h=e.src.charCodeAt(f))||10===h);f++);if(f>=m)return!1;for(v=f,i(e,f)?(l=e.linkContent,f=e.pos):l="",v=f;f<m&&(32===(h=e.src.charCodeAt(f))||10===h);f++);if(f<m&&v!==f&&o(e,f))for(c=e.linkContent,f=e.pos;f<m&&(32===(h=e.src.charCodeAt(f))||10===h);f++);else c="";if(f>=m||41!==e.src.charCodeAt(f))return e.pos=g,!1;f++}else{if(e.linkLevel>0)return!1;for(;f<m&&(32===(h=e.src.charCodeAt(f))||10===h);f++);if(f<m&&91===e.src.charCodeAt(f)&&(v=f+1,(f=r(e,f))>=0?u=e.src.slice(v,f++):f=v-1),u||(void 0===u&&(f=s+1),u=e.src.slice(n,s)),!(d=e.env.references[a(u)]))return e.pos=g,!1;l=d.href,c=d.title}return t||(e.pos=n,e.posMax=s,p?e.push({type:"image",src:l,title:c,alt:e.src.substr(n,s-n),level:e.level}):(e.push({type:"link_open",href:l,title:c,level:e.level++}),e.linkLevel++,e.parser.tokenize(e),e.linkLevel--,e.push({type:"link_close",level:--e.level}))),e.pos=f,e.posMax=m,!0}},function(e,t,n){"use strict";var r=n(27);e.exports=function(e,t){var n,i,o,a,s=e.posMax,u=e.pos;return!(u+2>=s)&&(94===e.src.charCodeAt(u)&&(91===e.src.charCodeAt(u+1)&&(!(e.level>=e.options.maxNesting)&&(n=u+2,!((i=r(e,u+1))<0)&&(t||(e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.list||(e.env.footnotes.list=[]),o=e.env.footnotes.list.length,e.pos=n,e.posMax=i,e.push({type:"footnote_ref",id:o,level:e.level}),e.linkLevel++,a=e.tokens.length,e.parser.tokenize(e),e.env.footnotes.list[o]={tokens:e.tokens.splice(a)},e.linkLevel--),e.pos=i+1,e.posMax=s,!0)))))}},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,a=e.posMax,s=e.pos;if(s+3>a)return!1;if(!e.env.footnotes||!e.env.footnotes.refs)return!1;if(91!==e.src.charCodeAt(s))return!1;if(94!==e.src.charCodeAt(s+1))return!1;if(e.level>=e.options.maxNesting)return!1;for(r=s+2;r<a;r++){if(32===e.src.charCodeAt(r))return!1;if(10===e.src.charCodeAt(r))return!1;if(93===e.src.charCodeAt(r))break}return r!==s+2&&(!(r>=a)&&(r++,n=e.src.slice(s+2,r-1),void 0!==e.env.footnotes.refs[":"+n]&&(t||(e.env.footnotes.list||(e.env.footnotes.list=[]),e.env.footnotes.refs[":"+n]<0?(i=e.env.footnotes.list.length,e.env.footnotes.list[i]={label:n,count:0},e.env.footnotes.refs[":"+n]=i):i=e.env.footnotes.refs[":"+n],o=e.env.footnotes.list[i].count,e.env.footnotes.list[i].count++,e.push({type:"footnote_ref",id:i,subId:o,level:e.level})),e.pos=r,e.posMax=a,!0)))}},function(e,t,n){"use strict";var r=n(157),i=n(46),o=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,a=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;e.exports=function(e,t){var n,s,u,l,c,f=e.pos;return 60===e.src.charCodeAt(f)&&(!((n=e.src.slice(f)).indexOf(">")<0)&&((s=n.match(a))?!(r.indexOf(s[1].toLowerCase())<0)&&(l=s[0].slice(1,-1),c=i(l),!!e.parser.validateLink(l)&&(t||(e.push({type:"link_open",href:c,level:e.level}),e.push({type:"text",content:l,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=s[0].length,!0)):!!(u=n.match(o))&&(l=u[0].slice(1,-1),c=i("mailto:"+l),!!e.parser.validateLink(c)&&(t||(e.push({type:"link_open",href:c,level:e.level}),e.push({type:"text",content:l,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=u[0].length,!0))))}},function(e,t,n){"use strict";e.exports=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"]},function(e,t,n){"use strict";var r=n(159).HTML_TAG_RE;e.exports=function(e,t){var n,i,o,a=e.pos;return!!e.options.html&&(o=e.posMax,!(60!==e.src.charCodeAt(a)||a+2>=o)&&(!(33!==(n=e.src.charCodeAt(a+1))&&63!==n&&47!==n&&!function(e){var t=32|e;return t>=97&&t<=122}(n))&&(!!(i=e.src.slice(a).match(r))&&(t||e.push({type:"htmltag",content:e.src.slice(a,a+i[0].length),level:e.level}),e.pos+=i[0].length,!0))))}},function(e,t,n){"use strict";function r(e,t){return e=e.source,t=t||"",function n(r,i){return r?(i=i.source||i,e=e.replace(r,i),n):new RegExp(e,t)}}var i=r(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",/[^"'=<>`\x00-\x20]+/)("single_quoted",/'[^']*'/)("double_quoted",/"[^"]*"/)(),o=r(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",/[a-zA-Z_:][a-zA-Z0-9:._-]*/)("attr_value",i)(),a=r(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",o)(),s=r(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",a)("close_tag",/<\/[A-Za-z][A-Za-z0-9]*\s*>/)("comment",/<!--([^-]+|[-][^-]+)*-->/)("processing",/<[?].*?[?]>/)("declaration",/<![A-Z]+\s+[^>]*>/)("cdata",/<!\[CDATA\[([^\]]+|\][^\]]|\]\][^>])*\]\]>/)();e.exports.HTML_TAG_RE=s},function(e,t,n){"use strict";var r=n(44),i=n(10).has,o=n(10).isValidEntityCode,a=n(10).fromCodePoint,s=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,u=/^&([a-z][a-z0-9]{1,31});/i;e.exports=function(e,t){var n,l,c=e.pos,f=e.posMax;if(38!==e.src.charCodeAt(c))return!1;if(c+1<f)if(35===e.src.charCodeAt(c+1)){if(l=e.src.slice(c).match(s))return t||(n="x"===l[1][0].toLowerCase()?parseInt(l[1].slice(1),16):parseInt(l[1],10),e.pending+=o(n)?a(n):a(65533)),e.pos+=l[0].length,!0}else if((l=e.src.slice(c).match(u))&&i(r,l[1]))return t||(e.pending+=r[l[1]]),e.pos+=l[0].length,!0;return t||(e.pending+="&"),e.pos++,!0}},function(e,t,n){"use strict";e.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","linkify","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}}},function(e,t,n){"use strict";e.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}}},function(e,t,n){"use strict";e.exports={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}}},function(e,t,n){var r=n(165);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".help {\n  position: absolute;\n  z-index: 100;\n  right: -100%;\n  width: 100%;\n  height: 98%;\n  top: 1%;\n  border: 1px solid #282828;\n  background: #f9f9f9;\n  padding-right: 4rem;\n  transition: 0.5s ease right; }\n  .help.help__open {\n    right: -4rem;\n    z-index: 110; }\n  .help__content {\n    padding: 2rem;\n    overflow: auto; }\n  .help__tab {\n    font-size: 1.5rem;\n    line-height: 2rem;\n    border: 1px solid #282828;\n    background: #f9f9f9;\n    position: absolute;\n    top: calc(40% + 19.5rem);\n    left: calc(-4.7rem - 2px);\n    border-bottom: none;\n    padding: 0.5rem 1rem;\n    transform: rotate(-90deg);\n    cursor: pointer;\n    width: 7rem;\n    text-align: center; }\n    .help__tab #selectHelp.flippedY {\n      height: 20px;\n      transform: scaleY(-1); }\n    .help__tab #selectHelp.notflippedY {\n      height: 20px;\n      transform: scaleY(1); }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(9)),o=d(n(1)),a=d(n(2)),s=d(n(167)),u=d(n(0)),l=d(n(25)),c=d(n(176)),f=d(n(8));function d(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return u.default.bindMethods(e,["_beforeWindowClose"]),e._onPhaseChange=e._onPhaseChange.bind(e),e._onLoginSubmit=e._onLoginSubmit.bind(e),e._onLogout=e._onLogout.bind(e),o.default.get("Relay").addEventListener("AppPhase.Change",e._onPhaseChange),e.form=new s.default,e.form.view().addEventListener("Login.Submit",e._onLoginSubmit),e.profile=new c.default,e.profile.addEventListener("Login.Logout",e._onLogout),window.addEventListener("beforeunload",e._beforeWindowClose),e._timer=new l.default({duration:o.default.get("AppConfig.system.maxLoginTime")}),e._timer.addEventListener("Timer.End",e._onLogout),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"init",value:function(){var e=this;return a.default.hook("Panel.Contents",function(t,n){return"interactive"==n.id&&t.push(e.profile),t},10),function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"_onPhaseChange",value:function(e){var t=this;if("login"==e.data.phase){var n=u.default.urlParam("uid");n?u.default.promiseAjax("/api/v1/Students/login",{data:{source_id:n,source:"mook",lab:o.default.get("AppConfig.lab")},method:"POST"}).then(function(e){!o.default.get("AppConfig.system.maxLoginTime")||e.disabled_login!=o.default.get("AppConfig.lab")&&"true"!=e.disabled_login?(o.default.set("user",e.source_id),o.default.set("student_id",e.student_id),o.default.set("login_time",new Date(e.last_login.$data)),o.default.get("Relay").dispatchEvent("AppPhase.Change",{phase:"experiment"}),o.default.get("Relay").dispatchEvent("Help.Hide",{}),t.form.clear(),o.default.get("Logger").log({type:"login",category:"app",data:{}})):(o.default.get("Logger").log({type:"login",category:"app",data:"attempted login",studentId:e.student_id}),o.default.get("Relay").dispatchEvent("AppPhase.Change",{phase:"login_attempted"}))}):(o.default.get("Relay").dispatchEvent("Help.Show",{}),o.default.get("Layout").getPanel("interactive").addContent(this.form.view()))}else"experiment"==e.data.phase?(o.default.get("AppConfig.system.maxLoginTime")&&(this._timer.setSource(null),this._timer.start()),o.default.get("Layout").getPanel("interactive").removeContent(this.form.view())):"login_attempted"==e.data.phase&&(window.history.pushState({},(0,f.default)("title").text(),window.location.href.split("?")[0]),o.default.get("Relay").dispatchEvent("Notifications.Add",{id:"attempted_login",type:"notice",message:"You ran out of time."}),o.default.set("user",null),o.default.set("student_id",null),o.default.set("login_time",null),o.default.get("Relay").dispatchEvent("Help.Show",{}),this.form.hide(),o.default.get("Layout").getPanel("interactive").addContent(this.form.view()))}},{key:"_onLoginSubmit",value:function(e){var t=this;this.form.validate().then(function(e){e.isValid&&u.default.promiseAjax("/api/v1/Students/login",{data:{source_id:t.form.export().email,source:"webapp",lab:o.default.get("AppConfig.lab")},method:"POST"}).then(function(e){!o.default.get("AppConfig.system.maxLoginTime")||e.disabled_login!=o.default.get("AppConfig.lab")&&"true"!=e.disabled_login?(o.default.set("student_id",e.student_id),o.default.set("user",e.source_id),o.default.set("login_time",new Date(e.last_login.$data)),o.default.get("Relay").dispatchEvent("AppPhase.Change",{phase:"experiment"}),o.default.get("Relay").dispatchEvent("Help.Hide",{}),t.form.clear(),o.default.get("Logger").log({type:"login",category:"app",data:{}})):(o.default.get("Logger").log({type:"login",category:"app",data:"attempted login",studentId:e.student_id}),o.default.get("Relay").dispatchEvent("AppPhase.Change",{phase:"login_attempted"}))})})}},{key:"_onLogout",value:function(e){this._timer.stop(),this._timer.seek(0);var t=(new Date).getTime()-o.default.get("login_time").getTime(),n=!1;o.default.get("AppConfig.system.maxLoginTime")&&t/1e3>=o.default.get("AppConfig.system.maxLoginTime")-.1&&(n=!o.default.get("AppConfig.lab")||o.default.get("AppConfig.lab")),u.default.promiseAjax("/api/v1/Students/logout",{data:{source_id:o.default.get("user"),student_id:o.default.get("student_id"),disabled_login:n},method:"POST"}).then(function(e){window.history.pushState({},(0,f.default)("title").text(),window.location.href.split("?")[0]),o.default.get("Logger").log({type:"logout",category:"app",data:n}),o.default.set("user",null),o.default.set("student_id",null),o.default.set("last_login",null),o.default.get("AppConfig.system.maxLoginTime")&&t/1e3>=o.default.get("AppConfig.system.maxLoginTime")-.1?o.default.get("Relay").dispatchEvent("AppPhase.Change",{phase:"login_attempted"}):o.default.get("Relay").dispatchEvent("AppPhase.Change",{phase:"login"})})}},{key:"_beforeWindowClose",value:function(e){this.profile.dispatchEvent("Login.Logout",{})}}]),t}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(20)),i=a(n(49)),o=a(n(12));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{modelData:{id:"login",classes:["form__login"],title:"Sign In",fields:[i.default.create({id:"email",placeholder:"Group Name",changeEvents:"change blur",validation:{exists:{errorMessage:"Correct group name address required"},email:{errorMessage:"Not a valid group name"}}})],buttons:[o.default.create({id:"submit",label:"Sign In",eventName:"Login.Submit"})]}}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(6)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={id:"",title:null,help:null,regions:{},buttons:[],classes:[],errors:[]},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.data.fields&&(e.data.regions=e.data.regions||{},e.data.regions.default=e.data.fields,delete e.data.fields),e.defaults=o.default.ensureDefaults(e.defaults,s);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n._onFieldChanged=n._onFieldChanged.bind(n);var r=!0,i=!1,a=void 0;try{for(var u,l=n.getFields()[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){u.value.addEventListener("Field.Change",n._onFieldChanged)}}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}return n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"validate",value:function(){var e=this;return Promise.all(this.getFields().map(function(e){return e.validate()})).then(function(t){var n={id:e.get("id"),isValid:!0,children:t,errors:[]},r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.isValid||(n.isValid=!1,n.errors=n.errors.concat(u.errors))}}catch(l){i=!0,o=l}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}if(n.isValid)return n;var l=new Error("Validation failed");return l.validation=n,Promise.reject(l)})}},{key:"addField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=this.get("regions");n[t]=n[t]||[],n[t].push(e),e.addEventListener("Field.Change",this._onFieldChanged),this.set("regions",n),this.dispatchEvent("Form.FieldAdded",{added:e,region:t})}},{key:"removeField",value:function(e){var t,n=void 0,r=void 0,i=void 0;for(n in t=this.get("regions"))if((i=t[n]).includes(e)){r=n;break}r&&((i=t[r]).splice(i.indexOf(e),1),e.removeEventListener("Field.Change",this._onFieldChanged),this.set("regions",t),this.dispatchEvent("Form.FieldRemoved",{removed:e,region:r}))}},{key:"getFields",value:function(){var e=void 0,t=void 0,n=void 0,r=void 0;for(n in e=[],t=this.get("regions")){var i=!0,o=!1,a=void 0;try{for(var s,u=t[n][Symbol.iterator]();!(i=(s=u.next()).done);i=!0)r=s.value,e.push(r)}catch(e){o=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}}return e}},{key:"addButton",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.get("buttons").map(function(e){return e.id()}).includes(e.id())){var n=this.get("buttons");t?n.splice(t,0,e):n.push(e),this.set("buttons",n)}}},{key:"removeButton",value:function(e){var t=this,n=void 0,r=void 0;(r=this.get("buttons").filter(function(t){return t.id()===e}).map(function(e){return t.get("buttons").indexOf(e)})).length&&(r=r[0],(n=this.get("buttons")).splice(r,1),this.set("buttons",n))}},{key:"getButton",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.get("buttons")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.id()==e)return a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return null}},{key:"_onFieldChanged",value:function(e){this.dispatchEvent("Form.FieldChanged",{field:e.currentTarget,delta:e.data})}},{key:"clear",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.getFields()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;e.push(a.clear())}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return Promise.all(e)}},{key:"enable",value:function(){this.getFields().forEach(function(e){e.enable()}),this.get("buttons").forEach(function(e){e.enable()})}},{key:"disable",value:function(){this.getFields().forEach(function(e){e.disable()}),this.get("buttons").forEach(function(e){e.disable()})}},{key:"disableFields",value:function(){this.getFields().forEach(function(e){e.disable()})}},{key:"partiallyDisableFields",value:function(e){this.getFields().forEach(function(t){var n=!1,r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(t.id()==u){n=!0;break}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}n?t.enable():t.disable()})}},{key:"hide",value:function(){this.getFields().forEach(function(e){e.hide()}),this.get("buttons").forEach(function(e){e.hide()})}},{key:"hideFields",value:function(){this.getFields().forEach(function(e){e.hide()})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(3)),o=a(n(170));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));return r._onFieldAdded=r._onFieldAdded.bind(r),r._onFieldRemoved=r._onFieldRemoved.bind(r),r._onChange=r._onChange.bind(r),r._fieldViews=[],r._buttonViews=[],r.render(e),e.addEventListener("Form.FieldAdded",r._onFieldAdded),e.addEventListener("Form.FieldRemoved",r._onFieldRemoved),e.addEventListener("Model.Change",r._onChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onChange",value:function(e){switch(e.data.path){case"buttons":this._renderButtons(e.currentTarget);break;case"title":this._renderHeader(e.currentTarget);break;case"errors":this._renderErrors(e.currentTarget)}}},{key:"render",value:function(e){e.get("classes")&&this.$el.addClass(e.get("classes").join(" ")),this._renderHeader(e),this._renderFields(e),this._renderButtons(e),this._renderErrors(e),this._renderHelp(e)}},{key:"_onFieldAdded",value:function(e){this._renderFields(e.currentTarget)}},{key:"_onFieldRemoved",value:function(e){this._renderFields(e.currentTarget)}},{key:"_renderHeader",value:function(e){e.get("title")?(this._title&&this.removeChild(this._title),this._title=new i.default(e.get("title")),this.addChild(this._title,".form__header"),this.$el.find(".form__header").show()):this.$el.find(".form__header").hide()}},{key:"_renderFields",value:function(e){for(;this._fieldViews.length;)this.removeChild(this._fieldViews.pop());for(var t in e.get("regions")){var n=this._mapRegion(t),r=!0,i=!1,o=void 0;try{for(var a,s=e.get("regions")[t][Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this._fieldViews.push(u.view()),this.addChild(u.view(),n)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}}},{key:"_renderErrors",value:function(e){var t=e.get("errors").map(function(e){return'<p class="form__error">'+e+"</p>"}).join("");this.$el.find(".form__errors").html(t)}},{key:"_mapRegion",value:function(e){return".form__fields"}},{key:"_renderButtons",value:function(e){for(;this._buttonViews.length;)this.removeChild(this._buttonViews.pop());var t=!0,n=!1,r=void 0;try{for(var i,o=e.get("buttons")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this._buttonViews.push(a.view()),this.addChild(a.view(),".form__buttons")}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_renderHelp",value:function(e){this.$el.find(".form__help").html(e.get("help"))}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__form">\n  <div class="form">\n    <div class="form__header"></div>\n    <div class="form__errors"></div>\n    <div class="form__fields"></div>\n    <div class="form__buttons"></div>\n    <div class="form__help"></div>\n  </div>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(14)),i=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a={placeholder:null,password:!1,changeEvents:"change blur"},s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(16)),o=a(n(173));function a(e){return e&&e.__esModule?e:{default:e}}n(174);var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||o.default));return r._onModelChange=r._onModelChange.bind(r),r._onFieldChange=r._onFieldChange.bind(r),r._onKeyup=r._onKeyup.bind(r),r.render(e),r.$el.find(".textfield__field").on(e.get("changeEvents"),r._onFieldChange),r.$el.find(".textfield__field").on("keyup",r._onKeyup),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onModelChange",this).call(this,e),this.render(e.currentTarget)}},{key:"_onFieldChange",value:function(e){this.dispatchEvent("Field.ValueChange",{value:this.$el.find(".textfield__field").val()})}},{key:"_onKeyup",value:function(e){13==e.keyCode&&this.dispatchEvent("Form.SubmitRequest",{},!0)}},{key:"disable",value:function(){this.$el.find(".textfield__field").prop("disabled",!0)}},{key:"enable",value:function(){this.$el.find(".textfield__field").prop("disabled",!1)}},{key:"focus",value:function(){this.$el.find(".textfield__field").focus()}},{key:"render",value:function(e){this.$el.find(".textfield__field").attr("id",e.get("id")),this.$el.find(".textfield__field").val(e.value()),e.get("password")&&this.$el.find(".textfield__field").attr("type","password"),e.get("placeholder")&&this.$el.find(".textfield__field").attr("placeholder",e.get("placeholder")),e.get("disabled")&&this.$el.find(".textfield__field").prop("disabled",e.get("disabled")),e.get("label")&&this.$el.find(".textfield__label").html(e.get("label")),e.get("help")&&this.$el.find(".textfield__help").html(e.get("help"));var t=e.get("errors");if(t.length){var n=t.map(function(e){return'<p class="field__error">'+e+"</p>"}).join("");this.$el.find(".field__errors").html(n).show(),this.$el.addClass("component__field__error")}else this.$el.removeClass("component__field__error"),this.$el.find(".field__errors").html("").hide()}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__textfield component__field">\n  <label class="field__label textfield__label"></label>\n  <div class="field__wrap">\n    <input type="text" class="textfield__field"/>\n  </div>\n  <span class="textfield__help"></span>\n  <div class="field__errors"></div>\n</div>'},function(e,t,n){var r=n(175);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(4)(!1)).push([e.i,".component__textfield {\n  margin-bottom: 0.5em; }\n  .component__textfield .textfield__field {\n    display: inline-block; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(3)),o=u(n(1)),a=u(n(177)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.default));return e._onPhaseChange=e._onPhaseChange.bind(e),e._onLogoutClick=e._onLogoutClick.bind(e),o.default.get("Relay").addEventListener("AppPhase.Change",e._onPhaseChange),e.$dom().find(".logout").on("click",e._onLogoutClick),s.default.urlParam("uid")&&e.$dom().find(".logout").hide(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onPhaseChange",value:function(e){o.default.get("user")?(this.$dom().find(".user").html(o.default.get("user")),this.$dom().addClass("profile__open")):(this.$dom().find(".user").html(""),this.$dom().removeClass("profile__open"))}},{key:"_onLogoutClick",value:function(e){return this.dispatchEvent("Login.Logout",{}),e.preventDefault(),!1}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="profile">\n  <span class="user"></span>\n  <a href="#" class="logout">Log out</a>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(9)),o=c(n(2)),a=c(n(179)),s=c(n(0)),u=c(n(1)),l=c(n(191));function c(e){return e&&e.__esModule?e:{default:e}}n(197);var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.default.bindMethods(e,["_onPhaseChange","_onTabRequest","_onDisableRequest","_onEnableRequest","_toggleTabs"]),e._tabs=a.default.create({}),e._tabs.addEventListener("Tab.Change",e._onTabChange),e._modal=l.default.create({}),u.default.set("InteractiveModal",e._modal),u.default.get("Relay").addEventListener("AppPhase.Change",e._onPhaseChange),u.default.get("Relay").addEventListener("InteractiveTabs.TabRequest",e._onTabRequest),u.default.get("Relay").addEventListener("InteractiveTabs.DisableRequest",e._onDisableRequest),u.default.get("Relay").addEventListener("InteractiveTabs.EnableRequest",e._onEnableRequest),u.default.get("Relay").addEventListener("ModelingTab.ToggleRequest",e._onTabRequest),u.default.get("Relay").addEventListener("Notifications.Add",e._onDisableRequest),u.default.get("Relay").addEventListener("Notifications.Remove",e._onEnableRequest),u.default.get("Relay").addEventListener("InteractiveTabs.Toggle",e._toggleTabs),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"init",value:function(){return Promise.resolve(!0)}},{key:"run",value:function(){var e=this;o.default.invoke("InteractiveTabs.ListTabs",[]).forEach(function(t,n){e._tabs.buildTab(t)}),u.default.get("Layout").getPanel("interactive").addContent(this._modal.view())}},{key:"_onPhaseChange",value:function(e){"login"!=e.data.phase&&"login_attempted"!=e.data.phase?u.default.get("Layout").getPanel("interactive").addContent(this._tabs.view(),0):(u.default.get("Layout").getPanel("interactive").removeContent(this._tabs.view()),this._tabs.selectTab(this._tabs.getTabs()[0].id()))}},{key:"_onTabChange",value:function(e){u.default.get("Logger").log({type:"tab_change",category:"app",data:{tab:e.data.tab.id()}})}},{key:"_onTabRequest",value:function(e){if(e.data.tabType){var t=this._tabs._model._data.tabs.filter(function(t){return t._model._data.tabType==e.data.tabType})[0];this._tabs.selectTab(t._model._data.id)}else this._tabs.selectTab(e.data.tabId)}},{key:"_onDisableRequest",value:function(e){this._tabs.disableTab(e.data.tabId)}},{key:"_onEnableRequest",value:function(e){this._tabs.enableTab(e.data.tabId)}},{key:"_toggleTabs",value:function(e){e.data.hideTab?document.getElementsByClassName("panel__interactive")[0].style.display="none":document.getElementsByClassName("panel__interactive")[0].style.display="block"}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(7)),o=c(n(180)),a=c(n(181)),s=c(n(0)),u=c(n(1)),l=c(n(185));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.default.bindMethods(n,["_onTabSelected","_onModelChange"]),n.view().addEventListener("Tab.Selected",n._onTabSelected),n._model.addEventListener("Model.Change",n._onModelChange),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addTab",value:function(e){this._model.addTab(e)}},{key:"buildTab",value:function(e){this.addTab(l.default.create(e))}},{key:"removeTab",value:function(e){this._model.removeTab(e)}},{key:"selectTab",value:function(e){this._model.selectTab(e)}},{key:"getTabs",value:function(){return this._model.get("tabs")}},{key:"disableTab",value:function(e){this._model.disableTab(e)}},{key:"enableTab",value:function(e){this._model.enableTab(e)}},{key:"_onTabSelected",value:function(e){var t=this.getTabs().filter(function(t){return t._model._data.id==e.data.id})[0];t!=this._model.currentTab()&&u.default.get("Relay").dispatchEvent("Tab.Change",{tabId:e.data.id,tabType:t._model._data.tabType}),this._active&&this._model.selectTab(e.data.id)}},{key:"_onModelChange",value:function(e){"currentIndex"==e.data.path&&this.dispatchEvent("Tab.Change",{tab:this._model.currentTab()})}}]),t}();f.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new f({modelData:e})},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(6)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={currentIndex:null,tabs:[]},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addTab",value:function(e){var t=this.get("tabs");t.push(e),this.set("tabs",t),1==t.length&&this.selectTab(e.id())}},{key:"removeTab",value:function(e){var t=this.get("tabs"),n=t.filter(function(t){return t.id==e});if(0==n.length)throw new Error("Cannot remove tab with ID "+e+"; tab not found.");var r=t.indexOf(n[0]);t.splice(r,1),this.set("tabs",t),0!=t.length?this.get("currentIndex")>=r&&(r>=t.length&&(r-=1),this.selectTab(t[r].id())):this.set("currentIndex",0)}},{key:"selectTab",value:function(e){var t=this.getTabById(e);if(t&&t.isActive()){var n=0;this.get("tabs").forEach(function(t,r){t.select(t.id()==e),t.id()==e&&(n=r)}),this.set("currentIndex",n)}}},{key:"currentTab",value:function(){return this.get("currentIndex")<this.get("tabs").length?this.get("tabs")[this.get("currentIndex")]:null}},{key:"disableTab",value:function(e){var t=this.getTabById(e);t&&t.disable()}},{key:"enableTab",value:function(e){var t=this.getTabById(e);t&&t.enable()}},{key:"getTabById",value:function(e){var t=this.get("tabs").filter(function(t){return t.id()==e});return 0==t.length?null:t[0]}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(0)),a=s(n(182));function s(e){return e&&e.__esModule?e:{default:e}}n(183);var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));return o.default.bindMethods(r,["_onModelChange"]),r._tabs=[],r._page=null,r._renderTabs(e),r._renderPage(e),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){var t=e.currentTarget;"currentIndex"==e.data.path?this._renderPage(t):"tabs"==e.data.path&&(this._renderTabs(t),this._renderPage(t))}},{key:"_renderTabs",value:function(e){for(var t=this;this._tabs.length;)this.removeChild(this._tabs.pop());e.get("tabs").forEach(function(e,n){var r=e.tab();t._tabs.push(r),t.addChild(r,".tabs__tabs")})}},{key:"_renderPage",value:function(e){this._page&&this.removeChild(this._page),e.currentTab()&&(this._page=e.currentTab().view(),this.addChild(this._page,".tabs__page"))}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__tabs">\n  <ul class="tabs__tabs"></ul>\n  <div class="tabs__page"></div>\n</div>'},function(e,t,n){var r=n(184);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__tabs .tabs__tabs {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  border-bottom: 1px solid #d9d9d9; }\n  .component__tabs .tabs__tabs li {\n    display: inline-block;\n    border-right: 1px solid #d9d9d9;\n    border-top: 1px solid #d9d9d9; }\n    .component__tabs .tabs__tabs li:first-child {\n      border-left: 1px solid #d9d9d9;\n      border-top-left-radius: 4px; }\n    .component__tabs .tabs__tabs li:last-child {\n      border-top-right-radius: 4px; }\n\n.component__tabs .tab__label {\n  display: inline-block;\n  padding: 0.5em;\n  cursor: pointer; }\n  .component__tabs .tab__label:hover {\n    background: #efefef; }\n\n.component__tabs .tab {\n  background: #d9d9d9; }\n\n.component__tabs .tab__selected {\n  font-weight: bold;\n  background: #efefef; }\n\n.component__tabs .tab__disabled {\n  opacity: 0.5; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},o=l(n(7)),a=l(n(186)),s=l(n(187)),u=l(n(189));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||a.default,e.viewClass=e.viewClass||s.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._tab=new u.default(n._model),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"title",value:function(){return this._model.get("title")}},{key:"id",value:function(){return this._model.get("id")}},{key:"tab",value:function(){return this._tab}},{key:"select",value:function(e){this._model.set("selected",e)}},{key:"disable",value:function(){this._model.set("disabled",!0),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"enable",value:function(){this._model.set("disabled",!1),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)}}]),t}();c.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new c({modelData:e})},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(6)),i=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a={id:null,title:"",content:null,selected:!1,disabled:!1},s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,a),e.data.id||(e.data.id=i.default.guid4()),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(3)),i=(o(n(0)),o(n(188)));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||i.default));return r.addChild(e.get("content")),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__tab__page"></div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(0)),a=s(n(190));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));return o.default.bindMethods(r,["_onChange","_onTabClick"]),r._id=e.get("id"),r._render(e),e.addEventListener("Model.Change",r._onChange),r.$el.find(".tab__label").click(r._onTabClick),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onTabClick",value:function(e){return this.dispatchEvent("Tab.Selected",{id:this._id},!0),!1}},{key:"_render",value:function(e){this.$el.find(".tab__label").html(e.get("title")),this.$el.toggleClass("tab__selected",e.get("selected")),this.$el.toggleClass("tab__disabled",e.get("disabled"))}},{key:"_onChange",value:function(e){this._render(e.currentTarget)}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<li class="tab"><a class="tab__label"></a></li>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(s(n(0)),s(n(1)),s(n(2)),s(n(7))),o=s(n(192)),a=s(n(193));function s(e){return e&&e.__esModule?e:{default:e}}n(195);var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"display",value:function(e){return this.clear(),this.push(e),this.show()}},{key:"push",value:function(e){this._model.push(e)}},{key:"pop",value:function(){this._model.pop()}},{key:"clear",value:function(){this._model.clear()}},{key:"show",value:function(){var e=this;return new Promise(function(t,n){e.view().addEventListener("LocalModal.ShowComplete",function(){e.view().removeAllListeners("LocalModal.ShowComplete"),t(!0)}),e._model.set("display",!0)})}},{key:"hide",value:function(){var e=this;return new Promise(function(t,n){e.view().addEventListener("LocalModal.HideComplete",function(){e.view().removeAllListeners("LocalModal.HideComplete"),t(!0)}),e._model.set("display",!1)})}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(0)),o=(a(n(1)),a(n(2)),a(n(6)));function a(e){return e&&e.__esModule?e:{default:e}}var s={cards:[],display:!1},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"push",value:function(e){var t=this.get("cards");t.push(e),this.set("cards",t),this.dispatchEvent("LocalModal.CardAdded",{card:e})}},{key:"pop",value:function(){var e=this.get("cards"),t=e.pop();this.set("cards",e),this.dispatchEvent("LocalModal.CardRemoved",{card:t})}},{key:"clear",value:function(){this.set("cards",[]),this.dispatchEvent("LocalModal.CardsCleared",{})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(0)),o=(s(n(1)),s(n(2)),s(n(3))),a=s(n(194));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));return i.default.bindMethods(r,["_onModelChange","_onCardAdded","_onCardRemoved","_onCardsCleared"]),r._cards=[],e.addEventListener("Model.Change",r._onModelChange),e.addEventListener("LocalModal.CardAdded",r._onCardAdded),e.addEventListener("LocalModal.CardRemoved",r._onCardRemoved),e.addEventListener("LocalModal.CardsCleared",r._onCardsCleared),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onModelChange",value:function(e){var t=this;switch(e.data.path){case"display":e.data.value?this.$el.fadeIn({complete:function(){t.dispatchEvent("LocalModal.ShowComplete")}}):this.$el.fadeOut({complete:function(){t.dispatchEvent("LocalModal.HideComplete")}})}}},{key:"_onCardAdded",value:function(e){var t=this,n=e.data.card,r=new o.default("<div class='localmodal__content'></div>");r.addChild(n),r.$dom().css({left:this._cards.length+3+"rem",opacity:0}),this.addChild(r),r.$dom().animate({left:this._cards.length+"rem",opacity:1},{duration:500,complete:function(){t.dispatchEvent("LocalModal.ShowComplete",{})}}),this._cards.push(r)}},{key:"_onCardRemoved",value:function(e){var t=this,n=this._cards.pop();n.$dom().animate({left:this._cards.length+2+"rem",opacity:0},{duration:500,complete:function(){t.removeChild(n)}})}},{key:"_onCardsCleared",value:function(e){for(;this._cards.length;)this.removeChild(this._cards.pop())}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__localmodal"></div>'},function(e,t,n){var r=n(196);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__localmodal {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: none;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 900; }\n\n.localmodal__content {\n  margin: auto;\n  padding: 0;\n  background: #f9f9f9;\n  overflow: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  width: calc(100% - 4rem);\n  height: 20rem;\n  overflow: auto;\n  box-shadow: 0 0 0.5rem #101010;\n  z-index: 1; }\n",""])},function(e,t,n){var r=n(198);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".panel__interactive .component__tabs {\n  height: calc(100% - 5rem);\n  position: relative; }\n  .panel__interactive .component__tabs .tab {\n    border-bottom: 1px solid transparent;\n    margin-bottom: -1px; }\n    .panel__interactive .component__tabs .tab__selected {\n      border-bottom-color: #efefef; }\n  .panel__interactive .component__tabs .tabs__page {\n    height: calc(100% - 3rem);\n    overflow-y: auto; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(9)),o=y(n(1)),a=y(n(2)),s=y(n(200)),u=y(n(246)),l=y(n(0)),c=y(n(34)),f=y(n(53)),d=y(n(262)),h=y(n(3)),p=y(n(263)),g=y(n(25)),m=y(n(18)),v=y(n(294));function y(e){return e&&e.__esModule?e:{default:e}}n(299);var _=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return l.default.bindMethods(e,["_hookInteractiveTabs","_onRunRequest","_onGlobalsChange","_onHistorySelectionChange","_onDryRunRequest","_onDryRunTick","_onConfigChange","_onNewExperimentRequest","_onAggregateRequest","_hookPanelContents","_onServerUpdate","_onServerResults","_onServerFailure","_onResultsDontSend","_onResultsSend","_onPhaseChange","_onDisableRequest","_onEnableRequest"]),o.default.get("Relay").addEventListener("AppPhase.Change",e._onPhaseChange),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"init",value:function(){var e=this;if(o.default.get("AppConfig.experiment")){return("demo"==o.default.get("AppConfig.experiment.euglenaServerMode")?this._loadDemoHistory():Promise.resolve(!0)).then(function(){var t=o.default.get("AppConfig.system.experimentModality");if(o.default.set("State.experiment.allowNew",!!t.match("create")),e._history=new d.default,e._history.addEventListener("Form.FieldChanged",e._onHistorySelectionChange),e._tabView=new h.default("<div class='tab__experiment'></div>"),e._tabView.addChild(e._history.view()),e._tabView.addChild(new h.default("<div id='expProtocol__title'> Experiment Menu: </div>")),"table"==o.default.get("AppConfig.experiment.experimentForm"))e._configForm=new s.default,e._configForm.addEventListener("Form.FieldChanged",e._onConfigChange),e._configForm.view().addEventListener("Experiment.DryRun",e._onDryRunRequest),e._configForm.view().addEventListener("Experiment.Submit",e._onRunRequest),e._configForm.view().addEventListener("Experiment.NewRequest",e._onNewExperimentRequest),e._configForm.view().addEventListener("Experiment.AddToAggregate",e._onAggregateRequest),e._tabView.addChild(e._configForm.view()),e._dryRunLights=c.default.create({width:200,height:150}),e._dryRunBulbs=f.default.create({width:200,height:150}),e._drTimeDisplay=new h.default('<span class="dry_run__time"></span>'),e._dryRunLights.view().$dom().on("click",e._onDryRunRequest),e._dryRunBulbs.view().$dom().on("click",e._onDryRunRequest),e._dryRunLights.view().addChild(e._drTimeDisplay,".light-display__content"),e._timer=new g.default({duration:o.default.get("AppConfig.experiment.maxDuration"),loop:!1,rate:4}),e._timer.addEventListener("Timer.Tick",e._onDryRunTick),e._resetDryRun(),e._dryRunView=new h.default("<div class='dry_run'></div>"),e._dryRunView.addChild(e._dryRunLights.view()),e._dryRunView.addChild(e._dryRunBulbs.view()),e._tabView.addChild(e._dryRunView);else if("narrative"==o.default.get("AppConfig.experiment.experimentForm")){e._configForm=new u.default,e._configForm.addEventListener("Form.FieldChanged",e._onConfigChange),e._configForm.view().addEventListener("Experiment.Submit",e._onRunRequest),e._configForm.view().addEventListener("Experiment.NewRequest",e._onNewExperimentRequest),e._configForm.view().addEventListener("Experiment.AddToAggregate",e._onAggregateRequest),e._tabView.addChild(e._configForm.view()),e._expVizLights=[];for(var n=0;n<4;n++){var r=c.default.create({width:40,height:40});r.render({top:0,bottom:0,left:0,right:0});var i=new h.default("<div>"+(n+1)+".<br>"+o.default.get("AppConfig.experiment.maxDuration")/4+" sec </div>"),l=new h.default("<div id='exp_viz__brightness'> Light </div>");r.view().addChild(i,".light-display__content"),r.view().addChild(l,".light-display__content"),e._expVizLights.push(r)}e._expViz=new h.default("<div class='exp_viz'><span id='title'>Visual Representation of the Experiment:</span></div>"),e._expViz.addChild(new h.default("<div class='exp_viz__container'></div>")),e._expVizLights.forEach(function(t){e._expViz._children[0].addChild(t.view())},e),e._expViz.addChild(new h.default("<span> Total duration is "+o.default.get("AppConfig.experiment.maxDuration")+" seconds. </div>")),e._tabView.addChild(e._expViz)}e._reporter=new v.default,e._reporter.addEventListener("ExperimentReporter.Send",e._onResultsSend),e._reporter.addEventListener("ExperimentReporter.DontSend",e._onResultsDontSend),e._reporter.hide(),e._setExperimentModality(),a.default.hook("Panel.Contents",e._hookPanelContents,9),a.default.hook("InteractiveTabs.ListTabs",e._hookInteractiveTabs,10),o.default.addEventListener("Model.Change",e._onGlobalsChange),o.default.get("Relay").addEventListener("ExperimentServer.Update",e._onServerUpdate),o.default.get("Relay").addEventListener("ExperimentServer.Results",e._onServerResults),o.default.get("Relay").addEventListener("ExperimentServer.Failure",e._onServerFailure),o.default.get("Relay").addEventListener("Notifications.Add",e._onDisableRequest),o.default.get("Relay").addEventListener("Notifications.Remove",e._onEnableRequest)})}return function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"_onDisableRequest",value:function(e){e.data.message.match("Loading")&&(this._configForm.disableNew(),this._history.disable())}},{key:"_onEnableRequest",value:function(e){o.default.get("AppConfig.system.experimentModality").toLowerCase().match("create")?(this._configForm.enableNew(),this._history.enable()):this._history.enable()}},{key:"_setExperimentModality",value:function(){if(o.default.get("AppConfig.system.experimentModality"))switch(o.default.get("AppConfig.system.experimentModality").toLowerCase()){case"observe":this._configForm.hideFields(),o.default.set("State.experiment.allowNew",!1);break;case"explore":this._configForm.disableFields(),o.default.set("State.experiment.allowNew",!1);break;case"create":case"createandhistory":o.default.set("State.experiment.allowNew",!0)}}},{key:"_hookPanelContents",value:function(e,t){return"interactive"==t.id&&e.push(this._reporter),e}},{key:"_onGlobalsChange",value:function(e){var t=this;"student_id"==e.data.path?this._history.update().then(function(){var e=t._history.getHistory();return!e.length||t._history.import({exp_history_id:e[e.length-1]})}).then(function(){t._loadExperimentInForm(t._history.export().exp_history_id)}):"euglenaServerMode"==e.data.path&&"demo"==e.data.value&&(this._loadDemoHistory(),o.default.set("State.experiment.allowNew",!1),this._history.update())}},{key:"_loadDemoHistory",value:function(){return o.default.get("AppConfig.experiment.experimentHistory")?Promise.resolve(!0):l.default.promiseAjax("/api/v1/Experiments",{data:{filter:{where:{demo:!0}}}}).then(function(e){o.default.set("AppConfig.experiment.experimentHistory",e.map(function(e){return e.id}))})}},{key:"_onHistorySelectionChange",value:function(e){this._loadExperimentInForm(e.currentTarget.export().exp_history_id)}},{key:"_loadExperimentInForm",value:function(e){var t=this;e&&(this._currExpId!=("_new"==e?null:e)&&("_new"==e?(this._currExpId=null,this._configForm.import({lights:[{left:100,duration:15},{top:100,duration:15},{bottom:100,duration:15},{right:100,duration:15}]}).then(function(){t._configForm.setState("new"),t._dryRunView&&(t._dryRunLights.view().show(),t._dryRunBulbs.view().show()),o.default.get("Relay").dispatchEvent("Experiment.Loaded",{experiment:{id:"_new"}})})):(this._currExpId=e,l.default.promiseAjax("/api/v1/Experiments/"+e).then(function(e){return t._configForm.import(Object.assign({},e.expForm,{lights:e.configuration})),e}).then(function(e){t._configForm.setState("historical"),t._dryRunView&&(t._dryRunLights.view().hide(),t._dryRunBulbs.view().hide()),o.default.get("Relay").dispatchEvent("Experiment.Loaded",{experiment:e}),o.default.set("currentExperiment",e)})),o.default.get("Logger").log({type:"load",category:"experiment",data:{experimentId:e}})))}},{key:"_hookInteractiveTabs",value:function(e,t){return e.push({id:"experiment",title:"Experiment",tabType:"experiment",content:this._tabView}),e}},{key:"_onConfigChange",value:function(e){if("table"==o.default.get("AppConfig.experiment.experimentForm"))this._resetDryRun(),this._firstDryRun=!0;else if("narrative"==o.default.get("AppConfig.experiment.experimentForm"))for(var t=this._configForm.getLightConfiguration(),n={"-1":"",0:"off",25:"dim",50:"medium",75:"bright",100:"v. bright"},r=0;r<4;r++)this._expViz._children[0]._children[r].render(t.lights[r]),this._expViz._children[0]._children[r].$el.find("#exp_viz__brightness").html(n[t.brightness[r]])}},{key:"_onRunRequest",value:function(e){var t=this;this._dryRunLights&this._dryRunBulbs&&this._resetDryRun(),this._configForm.validate().then(function(e){t._reporter.reset(),t._reporter.setFullscreen(0==t._history.historyCount()),t._reporter.show(),o.default.get("Relay").dispatchEvent("ExperimentServer.ExperimentRequest",t._configForm.export()),o.default.get("Logger").log({type:"experiment_submission",category:"experiment",data:{configuration:t._configForm.export()}}),t._history.revertToLastHistory(),t._configForm.disableNew(),t._history.disableNew()}).catch(function(e){o.default.get("Relay").dispatchEvent("Notifications.Add",{id:"experiment_form_error",type:"error",message:e.validation.errors.join("<br/>"),autoExpire:10,expireLabel:"Got it"})})}},{key:"_onNewExperimentRequest",value:function(e){this._history.import({exp_history_id:"_new"})}},{key:"_onAggregateRequest",value:function(e){m.default.getLiveResults(this._history.export().exp_history_id).then(function(e){o.default.get("Relay").dispatchEvent("AggregateData.AddRequest",{data:e})}),o.default.get("Logger").log({type:"add_aggregate",category:"experiment",data:{experimentId:this._history.export().exp_history_id}})}},{key:"_onDryRunRequest",value:function(e){this._firstDryRun?(this._dryRunData=this._configForm.export().lights,this._resetDryRun(),this._timer.start(),this._firstDryRun=!1):this._timer.active()?this._timer.pause():this._timer.start()}},{key:"_resetDryRun",value:function(){this._timer.stop(),this._dryRunLights.render({top:0,bottom:0,left:0,right:0}),this._dryRunBulbs.render({top:0,bottom:0,left:0,right:0}),this._drTimeDisplay.$dom().html("")}},{key:"_onDryRunTick",value:function(e){var t=this._timer.time();this._dryRunLights.render(m.default.getLightState(this._dryRunData,t)),this._dryRunBulbs.render(m.default.getLightState(this._dryRunData,t)),this._drTimeDisplay.$dom().html(l.default.secondsToTimeString(t))}},{key:"_onServerUpdate",value:function(e){this._reporter.update(e.data)}},{key:"_onServerResults",value:function(e){var t=this;this._history.update().then(function(){1==t._history.getHistory().length?t._onResultsSend({currentTarget:{results:e.data}}):t._reporter.update({status:"complete",results:e.data})})}},{key:"_onServerFailure",value:function(e){this._resultCleanup()}},{key:"_onResultsSend",value:function(e){var t=e.currentTarget.results;e.currentTarget.results=null,this._history.import({exp_history_id:t.experimentId}),this._resultCleanup(),o.default.get("Logger").log({type:"send_result",category:"experiment",data:{experimentId:t.experimentId,resultId:t.id}})}},{key:"_resultCleanup",value:function(){this._reporter.hide(),this._configForm.enableNew(),this._history.enableNew()}},{key:"_onResultsDontSend",value:function(e){var t=e.currentTarget.results;this._resultCleanup(),o.default.get("Logger").log({type:"dont_send_result",category:"experiment",data:{experimentId:t.experimentId,resultId:t.id}})}},{key:"_onPhaseChange",value:function(e){"login"!=e.data.phase&&"login_attempted"!=e.data.phase||this._history.import({exp_history_id:"_new"})}}]),t}();_.requires=[p.default],t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),o=u(n(20)),a=u(n(12)),s=u(n(201));u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=i.default.get("State.experiment.allowNew")?[{left:100,duration:15},{top:100,duration:15},{bottom:100,duration:15},{right:100,duration:15}]:[],n=[a.default.create({id:"dry_run",label:"Dry Run",classes:["form__experiment__dry_run"],eventName:"Experiment.DryRun"}),a.default.create({id:"submit",label:"Submit",classes:["form__experiment__submit"],eventName:"Experiment.Submit"}),a.default.create({id:"aggregate",label:"Add Results to Aggregate",classes:["form__experiment__aggregate"],eventName:"Experiment.AddToAggregate"})];i.default.get("State.experiment.allowNew")&&n.splice(2,0,a.default.create({id:"new",label:"New Experiment",classes:["form__experiment__new"],eventName:"Experiment.NewRequest"}));var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{modelData:{id:"experiment",classes:["form__experiment"],fields:[s.default.create({id:"lights",value:e,validation:{custom:{test:"custom",fn:function(e){var t=e.map(function(e){return e.duration?e.duration:0}).reduce(function(e,t,n,r){return e+t},0);return Promise.resolve(t==i.default.get("AppConfig.experiment.maxDuration"))},errorMessage:"Total experiment duration must be exactly "+i.default.get("AppConfig.experiment.maxDuration")+" seconds."}}})],buttons:n}}));return r.setState("new"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"setState",value:function(e){switch(e){case"historical":switch(i.default.get("AppConfig.system.experimentModality").toLowerCase()){case"observe":case"explore":this.getField("lights").disable(),this.getButton("dry_run").view().hide(),this.getButton("submit").view().hide(),i.default.get("State.experiment.allowNew")&&this.getButton("new").view().hide(),this.getButton("aggregate").view().hide();break;case"create":case"createandhistory":this.getField("lights").disable(),this.getButton("dry_run").view().hide(),this.getButton("submit").view().hide(),i.default.get("State.experiment.allowNew")&&this.getButton("new").view().show(),i.default.get("AppConfig.aggregate")?this.getButton("aggregate").view().show():this.getButton("aggregate").view().hide()}break;case"new":this.getField("lights").enable(),this.getButton("dry_run").view().show(),this.getButton("submit").view().show(),i.default.get("State.experiment.allowNew")&&this.getButton("new").view().hide(),this.getButton("aggregate").view().hide()}}},{key:"disableNew",value:function(){var e=this.getButton("new");e&&e.disable()}},{key:"enableNew",value:function(){var e=this.getButton("new");e&&e.enable()}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(202)),o=l(n(226)),a=l(n(230)),s=l(n(0)),u=l(n(1));function l(e){return e&&e.__esModule?e:{default:e}}var c={childClass:a.default,childSettings:{value:{top:0,left:0,bottom:0,right:0,duration:5}},min:1,sortable:!1,addButtonLabel:"+"},f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelData=s.default.ensureDefaults(e.modelData,c),e.viewClass=e.viewClass||o.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.default.bindMethods(n,["_onModelChange"]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onModelChange",this).call(this,e);var n=this.value().map(function(e){return e.duration?e.duration:0}).reduce(function(e,t,n,r){return e+t},0);this.view().updateTotals(n,u.default.get("AppConfig.experiment.maxDuration")-n)}}]),t}();f.create=function(e){return new f({modelData:e})},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(15)),o=u(n(203)),a=u(n(50)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.default.bindMethods(n,["_onAddRequest","_onRemoveRequest","_onOrderChange","_onModelChange"]),n.view().addEventListener("MultiField.AddFieldRequest",n._onAddRequest),n.view().addEventListener("MultiField.RemoveFieldRequest",n._onRemoveRequest),n.view().addEventListener("MultiField.OrderChangeRequest",n._onOrderChange),n._model.addEventListener("Model.Change",n._onModelChange),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onAddRequest",value:function(e){e.stopPropagation(),this._model.createField()}},{key:"_onRemoveRequest",value:function(e){e.stopPropagation(),this._model.removeField(e.data.id)}},{key:"_onOrderChange",value:function(e){e.stopPropagation(),this._model.updateOrder(e.data.order)}},{key:"_onModelChange",value:function(e){"value"==e.data.path&&this.dispatchEvent("Field.Change",{value:this.value()})}},{key:"setChildMeta",value:function(e,t){this._model.setChildMeta(e,t)}},{key:"lockField",value:function(e){this._model.lockField(e)}},{key:"unlockField",value:function(e){this._model.unlockField(e)}},{key:"getFields",value:function(){this._model.get("fields")}},{key:"setValue",value:function(e){var t=this;this._model.setValue(e).then(function(){t.dispatchEvent("Field.Change",{value:t.value()})})}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},o=s(n(14)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u={childClass:null,childSettings:{},childFactory:null,fields:[],locked:null,defaultValue:[],min:0,max:null,sortable:!0,dragTrigger:".dragitem__grip",dragClasses:[],addButtonLabel:"add",addEvent:!0},l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.data.value=e.data.value||[],e.defaults=a.default.ensureDefaults(e.defaults,u),e.defaults.locked=e.defaults.locked||new Set;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._onFieldChange=n._onFieldChange.bind(n),n._onFieldAdded=n._onFieldAdded.bind(n),n.setValue(e.data.value),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"setValue",value:function(e){var t=this;return this.set("fields",[]),Promise.all(e.map(function(e){return t.createField(e)})).then(function(){if(a.default.exists(t.get("childClass"))&&t.get("fields").length<t.get("min")){for(var e=[],n=t.get("fields").length;n<t.get("min");n++)e.push(t.createField(null));return Promise.all(e)}})}},{key:"createField",value:function(e){var t=this,n=void 0,r=void 0;if(a.default.exists(this.get("max"))&&this.get("fields").length>=this.get("max"))return Promise.resolve(null);if(n=this.get("childFactory"))r=n({id:a.default.guid4(),value:e});else{var i=this.get("childClass"),o=this.get("childSettings");r=Promise.resolve(new i({modelData:a.default.ensureDefaults({id:a.default.guid4(),value:e},o)}))}return r.then(function(e){if(e){e.addEventListener("Field.Change",t._onFieldChange);var n=t.get("fields");n.push(e),t.set("fields",n),t._onFieldAdded()}}).catch(function(e){t._handleChildError(e)})}},{key:"_handleChildError",value:function(e){console.log(e)}},{key:"removeField",value:function(e){if(!(this.get("fields").length<=this.get("min"))){for(var t=this.get("fields"),n=void 0,r=0;r<t.length;r++)if(t[r].id()==e){n=r;break}var i=t[n];this.get("locked").has(i)||(i.removeEventListener("Field.Change",this._onFieldChange),t.splice(n,1),this.set("fields",t),this._onFieldChange())}}},{key:"_onFieldChange",value:function(e){this.set("value",this.get("fields").map(function(e){return e.value()}))}},{key:"_onFieldAdded",value:function(e){this.get("addEvent")&&this._onFieldChange()}},{key:"setChildMeta",value:function(e,t){this.set("childClass",e),this.set("childDefaults",t),this.reset()}},{key:"reset",value:function(){for(this.set("fields",[]);this.get("fields").length<this.get("min");)this.createField(null)}},{key:"lockField",value:function(e){var t=this.get("locked");t.add(this.get("fields")[e]),this.set("locked",t)}},{key:"unlockField",value:function(e){var t=this.get("locked");t.delete(this.get("fields")[e]),this.set("locked",t)}},{key:"validate",value:function(){return Promise.all([i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"validate",this).call(this),Promise.all(this.get("fields").filter(function(e){return!a.default.isEmpty(e.value())}).map(function(e){return e.validate()}))]).then(function(e){var t=e[0];t.children=e[1];var n=!0,r=!1,i=void 0;try{for(var o,a=t.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.isValid||(t.isValid=!1,t.errors=t.errors.concat(s.errors))}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t})}},{key:"updateOrder",value:function(e){var t=this.get("fields").map(function(e){return e.id()});if(e.length!=this.get("fields").length||e.filter(function(e){return!t.includes(e)}).length)throw new Error("Attempt to change order also adds or removes content.");var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,l=!0,c=!1,f=void 0;try{for(var d,h=this.get("fields")[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var p=d.value;if(p.id()==u){n.push(p);break}}}catch(e){c=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(c)throw f}}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}this.set("fields",n),this._onFieldChange()}},{key:"enable",value:function(){this.get("fields").forEach(function(e){e.enable()}),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)}},{key:"disable",value:function(){this.get("fields").forEach(function(e){e.disable()}),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__field component__multifield">\n  <label class="field__label multifield__label"></label>\n  <div class="field__errors"></div>\n  <div class="multifield__fields"></div>\n  <div class="multifield__buttons"></div>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(206)),o=a(n(212));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelData=e.modelData||{},e.modelData.contents=new o.default({field:e.modelData.field,classes:e.modelData.classes}),e.modelData.id=e.modelData.id||e.modelData.field.id(),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){this._model.get("field").id()}},{key:"lock",value:function(){this._model.get("contents").lock()}},{key:"unlock",value:function(){this._model.get("contents").unlock()}},{key:"fieldView",value:function(){this._model.get("contents").subview}},{key:"hideRemoveButton",value:function(){this._model.get("contents").hideRemoveButton()}},{key:"showRemoveButton",value:function(){this._model.get("contents").showRemoveButton()}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(7)),o=u(n(207)),a=u(n(208)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.default.bindMethods(n,["_passEvent"]),n._view.addEventListener("DragItem.RequestSelect",n._passEvent),n._view.addEventListener("DragItem.RequestMultiSelect",n._passEvent),n._view.addEventListener("DragItem.RequestDrag",n._passEvent),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"select",value:function(){this._model.set("selected",!0)}},{key:"deselect",value:function(){this._model.set("selected",!1)}},{key:"_passEvent",value:function(e){this.dispatchEvent(e)}},{key:"handleReception",value:function(e){this._model.set("container",e)}},{key:"handleDrag",value:function(){this._view.handleDrag()}},{key:"endDrag",value:function(){this._view.endDrag()}},{key:"container",value:function(){return this._model.get("container")}},{key:"export",value:function(){return this._model.get("id")}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(6)),i=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a={id:0,selected:!1,trigger:".dragitem__grip"},s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.data.id=e.data.id||i.default.guid4(),e.defaults=i.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(3)),o=u(n(209)),a=u(n(8)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}n(210);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));return s.default.bindMethods(r,["_onChange","_onMouseDown","_onMouseUp","_dragStart"]),".dragitem__grip"!=e.get("trigger")&&r.$el.find(".dragitem__grip").detach(),r._render(e),r.addChild(e.get("contents"),".dragitem__contents"),s.default.exists(e.get("trigger"))?r._trigger=r.$el.find(e.get("trigger")).first():r._trigger=r.$el,r._trigger.addClass("dragitem__trigger"),e.addEventListener("Model.Change",r._onChange),r._trigger.on("mousedown touchstart",r._onMouseDown),r._trigger.on("mouseup touchend",r._onMouseUp),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onChange",value:function(e){this._render(e.currentTarget)}},{key:"_render",value:function(e){this.$el.toggleClass("dragitem__selected",e.get("selected"))}},{key:"_onMouseDown",value:function(e){if(["input","textarea","a","button"].includes(e.target.tagName.toLowerCase()))return!0;if((0,a.default)(e.target).parentsUntil(this.$el,".component__dragitem").length)return e.stopImmediatePropagation(),!0;this._moveReference={left:e.pageX,top:e.pageY,timestamp:Date.now()};var t="DragItem.RequestSelect";e.shiftKey&&(t="DragItem.RequestMultiSelect",s.default.clearTextSelection()),this.dispatchEvent(t,{}),this._dragRef={left:e.pageX,top:e.pageY},this._dragStartTimeout=setTimeout(this._dragStart,100)}},{key:"_dragStart",value:function(){s.default.exists(this._moveReference)&&(this.dispatchEvent("DragItem.RequestDrag",this._dragRef),this._dragRef=null)}},{key:"_onMouseUp",value:function(e){this._moveReference=null}},{key:"handleDrag",value:function(){this.$el.addClass("dragitem__dragging")}},{key:"endDrag",value:function(){this.$el.removeClass("dragitem__dragging")}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__dragitem">\n  <div class="dragitem__grip"></div>\n  <div class="dragitem__contents"></div>\n</div>'},function(e,t,n){var r=n(211);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,'.component__dragitem {\n  position: relative;\n  border: 1px solid transparent; }\n  .component__dragitem .dragitem__grip {\n    position: absolute;\n    height: 100%;\n    left: 0;\n    top: 0;\n    width: 8px;\n    background: #282828; }\n  .component__dragitem.dragitem__trigger, .component__dragitem .dragitem__trigger {\n    cursor: -webkit-grab;\n    cursor: -moz-grab; }\n  .component__dragitem .dragitem__contents {\n    padding-left: 8px; }\n    .component__dragitem .dragitem__contents:after {\n      content: "";\n      display: table;\n      clear: both; }\n  .component__dragitem.dragitem__selected {\n    border: 1px solid #282828; }\n  .component__dragitem.dragitem__dragging {\n    display: none; }\n',""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(213)),a=s(n(12));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.default));return n._btnContainer=n.$el.find(".multifield__field__remove"),n.subfield=e.field,n.subview=n.subfield.view(),n.addChild(n.subview,".multifield__field"),e.classes&&n.$el.addClass(e.classes.join(" ")),n.closeBtn=a.default.create({id:"field__close",label:"&times;",eventName:"MultiField.RemoveFieldRequest",eventData:{id:n.subfield.id()}}),n.addChild(n.closeBtn.view(),n._btnContainer),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"lock",value:function(){this.removeChild(this.closeBtn.view()),this.subfield.disable()}},{key:"unlock",value:function(){this.addChild(this.closeBtn.view(),this._btnContainer),this.subfield.enable()}},{key:"hideRemoveButton",value:function(){this.closeBtn.view().hide()}},{key:"showRemoveButton",value:function(){this.closeBtn.view().show()}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="multifield__fieldwrap">\n  <div class="multifield__field__remove"></div>\n  <div class="multifield__field"></div>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(7)),o=u(n(215)),a=u(n(216)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"accepts",value:function(e){return!0}},{key:"receive",value:function(e,t){var n=this;s.default.isArray(e)||(e=[e]);var r=e;this._model.get("sortable")||(r=e.filter(function(e){return!n.contains(e)})),this._model.receive(r,t);var i=!0,o=!1,a=void 0;try{for(var u,l=e[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){u.value.handleReception(this)}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}this._view.clearCursor()}},{key:"remove",value:function(e){this._model.remove(e)}},{key:"empty",value:function(){this._model.empty()}},{key:"checkOverlap",value:function(e,t){if(this._view.checkOverlap(e,t,this._model)){var n=this._view.sortPosition(e,t,this._model);this.dispatchEvent("DropSite.NominateDropCandidate",{position:n})}else this.dispatchEvent("DropSite.RevokeDropCandidacy",{})}},{key:"handleCandidacy",value:function(e){this._view.handleCandidacy(e)}},{key:"handleLostCandidacy",value:function(){this._view.clearCursor()}},{key:"count",value:function(){return this._model.get("items").length}},{key:"items",value:function(){return this._model.get("items")}},{key:"export",value:function(){return this._model.export()}},{key:"contains",value:function(e){return this._model.contains(e)}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(6)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={id:0,items:[],sortable:!0,overlapType:"mouse",style:"list"},u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.data=o.default.ensureDefaults(e.data,{id:o.default.guid4()}),e.defaults=o.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"receive",value:function(e,t){var n=this.get("items"),r=!0,i=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;l.container()&&(o.default.exists(t)&&this.get("items").indexOf(l)<t&&(t=Math.max(0,t-1)),l.container().remove(l))}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}if(o.default.exists(t)&&this.get("sortable")){var c=e.slice(0);c.unshift(t,0),Array.prototype.splice.apply(n,c)}else n=n.concat(e);this.set("items",n),this.dispatchEvent("DropSite.ItemAdded",{items:e,index:t})}},{key:"remove",value:function(e){var t=this.get("items");-1!=t.indexOf(e)&&(t.splice(t.indexOf(e),1),this.set("items",t),this.dispatchEvent("DropSite.ItemRemoved",{item:e}))}},{key:"empty",value:function(){for(;this.get("items").length;)this.remove(this.get("items")[0])}},{key:"count",value:function(){return this.get("items").length}},{key:"export",value:function(){return this.get("items").map(function(e){return e.export()})}},{key:"contains",value:function(e){return this.get("items").includes(e)}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(217)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));return a.default.bindMethods(r,["_onChange"]),r._cursor=r.$el.find(".dropsite__sort__cursor"),r._cursor.detach(),r._itemViews=[],r._render(e),e.addEventListener("DropSite.ItemAdded",r._onChange),e.addEventListener("DropSite.ItemRemoved",r._onChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onChange",value:function(e){this._render(e.currentTarget,!0)}},{key:"_render",value:function(e){var t=this;for(this.$el.removeClass("dropsite__list dropsite__inline").addClass("dropsite__"+e.get("style"));this._itemViews.length;)this.removeChild(this._itemViews.pop());e.get("items").forEach(function(e){t.addChild(e.view(),".dropsite__contents"),t._itemViews.push(e.view())})}},{key:"sortPosition",value:function(e,t,n){if(n.get("sortable")){var r=0,i=this.$el.find(".dropsite__contents").offset();i.width=0,i.height=0;var o=!0,a=!1,s=void 0;try{for(var u,l=this._itemViews[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;if(i=c.$dom().is(":visible")?c.bounds():{top:i.top+i.height,left:i.left+i.width,width:0,height:0},"list"==n.get("style")){if(t.y<t.top)break;t.y>i.top+i.height/2&&(r+=1)}else if("inline"==n.get("style")){if(t.x<i.left||i.top>t.y)break;t.x>i.left+i.width/2&&(r+=1)}else r+=1}}catch(e){a=!0,s=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}return r}return n.count()}},{key:"checkOverlap",value:function(e,t,n){var r=n.get("overlap");return this.hasOwnProperty("_checkOverlap_"+r)?this["_checkOverlap_"+r](e,t,n):this._checkOverlap_mouse(e,t)}},{key:"_checkOverlap_mouse",value:function(e,t,n){var r=this.bounds();return r.left<=t.x<=r.left+r.width&&r.top<=t.y<=r.top+r.height}},{key:"_checkOverlap_minkowski",value:function(e,t,n){var r=this.bounds(),i=e.bounds(),o=r.left-i.width,a=r.top-i.height,s=r.width+i.width,u=r.height+i.height;return o<=i.left<=o+s&&a<=i.top<=a+u}},{key:"handleCandidacy",value:function(e){0==e?this._cursor.insertBefore(this._itemViews[0].$dom()):this._cursor.insertAfter(this._itemViews[e-1].$dom())}},{key:"clearCursor",value:function(){this._cursor.detach()}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__dropsite">\n  <div class="dropsite__header"></div>\n  <div class="dropsite__contents">\n    <div class="dropsite__sort__cursor"></div>\n  </div>\n  <div class="dropsite__footer"></div>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(7)),o=l(n(8)),a=l(n(219)),s=l(n(220)),u=l(n(0));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||a.default,e.modelData=e.modelData||{},e.modelData.proxyView=e.modelData.proxyView||s.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return u.default.bindMethods(n,["_onRelease","_onMove","_onDragRequest","_onSelectRequest","_onMultiSelectRequest","_onDropCandidate","_onDropRevoke","_onProxyRemovalRequest","_onItemSelected","_onItemDeselected"]),["relative","absolute"].includes(n._model.get("bounds").$dom().css("position"))||n._model.get("bounds").$dom().css("position","relative"),window.addEventListener("mouseup",n._onRelease),window.addEventListener("touchend",n._onRelease),window.addEventListener("mousemove",n._onMove),window.addEventListener("touchmove",n._onMove),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addDragItem",value:function(e){this._model.addDragItem(e),e.addEventListener("DragItem.RequestDrag",this._onDragRequest),e.addEventListener("DragItem.RequestSelect",this._onSelectRequest),e.addEventListener("DragItem.RequestMultiSelect",this._onMultiSelectRequest)}},{key:"removeDragItem",value:function(e){this._model.removeDragItem(e),e.removeEventListener("DragItem.RequestDrag",this._onDragRequest),e.removeEventListener("DragItem.RequestSelect",this._onSelectRequest),e.removeEventListener("DragItem.RequestMultiSelect",this._onMultiSelectRequest)}},{key:"removeAllDragItems",value:function(){for(var e in this._model.get("dragItems"))this.removeDragItem(this._model.get("dragItems")[e]);this._model.set("dragItems",{})}},{key:"addDropSite",value:function(e){this._model.addDropSite(e),e.addEventListener("DropSite.NominateDropCandidate",this._onDropCandidate),e.addEventListener("DropSite.RevokeDropCandidacy",this._onDropRevoke)}},{key:"removeDropSite",value:function(e){this._model.removeDropSite(e),e.removeEventListener("DropSite.NominateDropCandidate",this._onDropCandidate),e.removeEventListener("DropSite.RevokeDropCandidacy",this._onDropRevoke)}},{key:"_onDropCandidate",value:function(e){this._model.get("dragging")&&(this._dropCandidate&&this._dropCandidate!=e.currentTarget&&this._dropCandidate.handleLostCandidacy(),this._dropCandidate=e.currentTarget,this._dropPosition=e.data.position,this._dropCandidate.handleCandidacy(this._dropPosition))}},{key:"_onDropRevoke",value:function(e){this._dropCandidate==e.currentTarget&&(this._dropCandidate.handleLostCandidacy(),this._dropCandidate=null,this._dropPosition=null)}},{key:"_onDragRequest",value:function(e){if(this.isActive()){(0,o.default)("body").addClass("dragdrop__dragging"),this._model.set("dragging",!0);var t=this._model.get("proxyView");this._dragProxy=new t({selected:this._model.get("selected"),referencePosition:e.data,boundsPosition:this._model.get("bounds").$dom().offset()}),this._model.get("selected").forEach(function(e){e.handleDrag()}),this._dragProxy.addEventListener("DragProxy.RequestRemoval",this._onProxyRemovalRequest),this._model.get("bounds").addChild(this._dragProxy),this._dragProxy.reveal(),this._dragProxy.updatePosition({left:e.data.left-this._model.get("bounds").$dom().offset().left,top:e.data.top-this._model.get("bounds").$dom().offset().top,maxWidth:this._model.get("bounds").$dom().outerWidth(),maxHeight:this._model.get("bounds").$dom().outerHeight()})}}},{key:"_onProxyRemovalRequest",value:function(e){this._model.get("bounds").removeChild(e.currentTarget)}},{key:"_onRelease",value:function(e){if(this.isActive()&&this._model.get("dragging"))(0,o.default)("body").removeClass("dragdrop__dragging"),this._model.set("dragging",!1),this._model.get("selected").forEach(function(e){e.endDrag()}),this._dropCandidate?(this._dropCandidate.receive(Array.from(this._model.get("selected")),this._dropPosition),this._dragProxy.enter(this._dropCandidate),this._dropCandidate=null,this._model.clearSelection(),this.dispatchEvent("DragDrop.ContainmentChange",{sites:this._model.get("dropSites"),items:this._model.get("dragItems")})):this._dragProxy.revert();else if(!this._model.get("dragging")){var t=!1,n=(0,o.default)(e.target).parents().toArray();for(var r in this._model.get("dragItems")){var i=this._model.get("dragItems")[r];if(n.includes(i.view().dom())){t=!0;break}}t&&this._model.clearSelection()}}},{key:"_onMove",value:function(e){if(this._model.get("dragging"))for(var t in this._dragProxy.updatePosition({left:e.pageX-this._model.get("bounds").$dom().offset().left,top:e.pageY-this._model.get("bounds").$dom().offset().top,maxWidth:this._model.get("bounds").$dom().outerWidth(),maxHeight:this._model.get("bounds").$dom().outerHeight()}),this._model.get("dropSites")){this._model.get("dropSites")[t].checkOverlap(this._dragProxy,{x:e.pageX,y:e.pageY})}}},{key:"_onSelectRequest",value:function(e){this.isActive()&&!this._model.get("selected").has(e.currentTarget)&&this._model.select(e.currentTarget)}},{key:"_onMultiSelectRequest",value:function(e){this.isActive()&&this._model.multiselect(e.currentTarget)}},{key:"_onItemSelected",value:function(e){e.data.element.select()}},{key:"_onItemDeselected",value:function(e){e.data.element.deselect()}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(6)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={bounds:"body",dragItems:{},dropSites:{},proxyView:null,allowMultiSelect:!1,selected:null},u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.data=e.data||{},e.data.selected=e.data.selected||new Set,e.defaults=o.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addDropSite",value:function(e){this.set("dropSites."+e.id(),e)}},{key:"removeDropsite",value:function(e){this.get("selected").has(drag)&&this._deselect(drag),this.set("dropSites."+e.id(),null)}},{key:"addDragItem",value:function(e){this.set("dragItems."+e.id(),e)}},{key:"removeDragItem",value:function(e){this.set("dragItems."+e.id(),null)}},{key:"select",value:function(e){this.clearSelection(),this._select(e)}},{key:"_select",value:function(e){this.get("selected").add(e),e.select()}},{key:"_deselect",value:function(e){this.get("selected").remove(e),e.deselect()}},{key:"multiselect",value:function(e){this.get("allowMultiSelect")?this.get("selected").contains(e)?this._deselect(e):this._select(e):this.select(e)}},{key:"clearSelection",value:function(){this.get("selected").forEach(function(e){e.deselect()}),this.get("selected").clear()}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(3)),o=a(n(221));function a(e){return e&&e.__esModule?e:{default:e}}n(222);var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.default));return n._data=e,n.$el.find(".dragdrop__selected__count").text(n._data.selected.size),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"updatePosition",value:function(e){this.$el.css({left:Math.min(e.maxWidth-this.$el.outerWidth(),Math.max(0,e.left-this.$el.outerWidth()/2)),top:Math.min(e.maxHeight-this.$el.outerHeight(),Math.max(0,e.top-this.$el.outerHeight()/2))})}},{key:"reveal",value:function(){}},{key:"enter",value:function(e){this.dispatchEvent("DragProxy.RequestRemoval")}},{key:"revert",value:function(){var e=this;this.$el.animate({top:this._data.referencePosition.top-this._data.boundsPosition.top-this.$el.outerHeight()/2,left:this._data.referencePosition.left-this._data.boundsPosition.left-this.$el.outerWidth()/2,opacity:0},{duration:300,complete:function(){e.dispatchEvent("DragProxy.RequestRemoval")}})}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),t.default='<div class="dragdrop__dragproxy">\n  <div class="dragdrop__badge dragdrop__selected__count"></div>\n</div>'},function(e,t,n){var r=n(223);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".dragdrop__dragproxy {\n  position: absolute;\n  width: 4em;\n  height: 4em;\n  background: #f9f9f9;\n  border: 1px solid #282828;\n  border-radius: 1em;\n  opacity: 0.5; }\n  .dragdrop__dragproxy .dragdrop__selected__count {\n    background: #282828;\n    width: 2em;\n    height: 2em;\n    border-radius: 1em;\n    text-align: center;\n    line-height: 2em;\n    font-weight: bold;\n    color: #f9f9f9;\n    position: absolute;\n    bottom: -1px;\n    right: -1px; }\n\n.dropsite__sort__cursor {\n  border: 1px solid #282828; }\n\n.dropsite__list .component__dragitem {\n  display: block; }\n\n.dropsite__inline .component__dragitem {\n  display: inline-block; }\n\n.dropsite__inline .dropsite__sort-cursor {\n  display: inline-block;\n  height: 1em; }\n\n.dragdrop__dragging {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing; }\n",""])},function(e,t,n){var r=n(225);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,'.component__multifield {\n  position: relative;\n  min-height: 2rem;\n  margin: 1rem 0; }\n  .component__multifield:after {\n    content: "";\n    display: table;\n    clear: both; }\n  .component__multifield .multifield__fields {\n    position: relative; }\n  .component__multifield .multifield__fieldwrap {\n    margin-left: 2rem;\n    border-bottom: 1px solid #d9d9d9; }\n    .component__multifield .multifield__fieldwrap:after {\n      content: "";\n      display: table;\n      clear: both; }\n    .component__multifield .multifield__fieldwrap:last-child {\n      border-bottom: none; }\n    .component__multifield .multifield__fieldwrap > .multifield__field {\n      padding-right: 3rem; }\n    .component__multifield .multifield__fieldwrap .multifield__field > .component__field {\n      padding-left: 0px; }\n  .component__multifield .multifield__field__remove {\n    float: right; }\n    .component__multifield .multifield__field__remove .button {\n      border: none;\n      padding: 0.5rem; }\n  .component__multifield.field__error .field__label {\n    color: #330000; }\n',""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(50)),o=a(n(227));function a(e){return e&&e.__esModule?e:{default:e}}n(228);var s=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||o.default))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"updateTotals",value:function(e,t){this.$el.find(".light-matrix__footer__total .light-matrix__footer__value").text(e),this.$el.find(".light-matrix__footer__remaining .light-matrix__footer__value").text(t)}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__field component__multifield component__light-matrix">\n  <label class="field__label multifield__label"></label>\n  <div class="field__errors"></div>\n  <div class="light-matrix__header">\n    <div class="light-matrix__header__item">Left</div>\n    <div class="light-matrix__header__item">Top</div>\n    <div class="light-matrix__header__item">Bottom</div>\n    <div class="light-matrix__header__item">Right</div>\n    <div class="light-matrix__header__item">Duration</div>\n    <div class="multifield__buttons"></div>\n  </div>\n  <div class="multifield__fields"></div>\n  <div class="light-matrix__footer">\n    <div class="light-matrix__footer__count light-matrix__footer__total">\n      <div class="light-matrix__footer__label">Total Duration</div>\n      <div class="light-matrix__footer__value"></div>\n    </div>\n    <div class="light-matrix__footer__count light-matrix__footer__remaining">\n      <div class="light-matrix__footer__label">Remaining Duration</div>\n      <div class="light-matrix__footer__value"></div>\n    </div>\n  </div>\n</div>'},function(e,t,n){var r=n(229);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__light-matrix .component__dragitem {\n  border: none;\n  background: #f9f9f9;\n  border-bottom: 1px solid #d9d9d9; }\n  .component__light-matrix .component__dragitem:last-child {\n    border-bottom: none; }\n  .component__light-matrix .component__dragitem .dragitem__grip {\n    display: none; }\n  .component__light-matrix .component__dragitem .dragitem__contents {\n    padding-left: 0; }\n  .component__light-matrix .component__dragitem:nth-child(2n) {\n    background: #efefef; }\n\n.component__light-matrix .component__field {\n  border-right: 1px solid #d9d9d9; }\n\n.component__light-matrix.component__multifield .multifield__fields {\n  border: 1px solid #d9d9d9;\n  border-top: none;\n  text-align: center; }\n\n.component__light-matrix.component__multifield .multifield__fieldwrap {\n  margin-left: 0; }\n\n.component__light-matrix.component__multifield .multifield__field__remove {\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 0.5rem 0; }\n  .component__light-matrix.component__multifield .multifield__field__remove .button {\n    background: transparent; }\n    .component__light-matrix.component__multifield .multifield__field__remove .button:hover {\n      background: #282828; }\n\n.component__light-matrix.component__multifield .multifield__buttons {\n  position: absolute;\n  top: calc(0.25rem + 1px);\n  right: calc(0.25rem + 1px); }\n\n.component__light-matrix .light-matrix__header {\n  display: flex;\n  padding-right: 3rem;\n  background: #d9d9d9;\n  border: 1px solid #282828; }\n  .component__light-matrix .light-matrix__header__item {\n    flex: 1;\n    text-align: center;\n    font-weight: 700;\n    font-size: 1.2rem;\n    padding: 0.5rem;\n    border-right: 1px solid #282828; }\n  .component__light-matrix .light-matrix__header .component__button {\n    margin: 0; }\n    .component__light-matrix .light-matrix__header .component__button .button {\n      padding: 0.5rem 0;\n      width: 2.5rem;\n      border: none;\n      background: transparent; }\n      .component__light-matrix .light-matrix__header .component__button .button:hover {\n        background: #282828; }\n\n.component__light-matrix .light-matrix__footer {\n  padding-right: 3rem;\n  position: relative;\n  border: 1px solid transparent;\n  border-width: 0 1px; }\n  .component__light-matrix .light-matrix__footer__count {\n    display: flex;\n    text-align: right; }\n  .component__light-matrix .light-matrix__footer__label {\n    flex: 4;\n    font-weight: 700;\n    padding: 0.5rem 0.5rem 0.5rem 3.5rem;\n    font-size: 1.2rem;\n    border-right: 1px solid #d9d9d9; }\n  .component__light-matrix .light-matrix__footer__value {\n    flex: 1;\n    padding: 0.5rem;\n    background: #d9d9d9;\n    text-align: center; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(231)),o=l(n(17)),a=l(n(238)),s=l(n(242)),u=l(n(0));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||s.default,e.modelData=e.modelData||{},e.modelData.value=e.modelData.value||{},e.modelData=u.default.ensureDefaults(e.modelData,{fields:[o.default.create({id:"left",options:{0:0,25:25,50:50,75:75,100:100},defaultValue:0,value:e.modelData.value.left}),o.default.create({id:"top",options:{0:0,25:25,50:50,75:75,100:100},defaultValue:0,value:e.modelData.value.top}),o.default.create({id:"bottom",options:{0:0,25:25,50:50,75:75,100:100},defaultValue:0,value:e.modelData.value.bottom}),o.default.create({id:"right",options:{0:0,25:25,50:50,75:75,100:100},defaultValue:0,value:e.modelData.value.right}),a.default.create({id:"duration",min:0,changeEvents:"change blur",defaultValue:0,value:e.modelData.value.duration})]}),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"value",value:function(){var e=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"value",this).call(this);return["left","top","bottom","right","duration"].forEach(function(t){e[t]=parseFloat(e[t])}),e}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(15)),o=u(n(232)),a=u(n(51)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));s.default.bindMethods(n,["_onSubFieldChange"]);var r=!0,i=!1,u=void 0;try{for(var l,c=n._model.get("fields")[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){l.value.addEventListener("Field.Change",n._onSubFieldChange)}}catch(e){i=!0,u=e}finally{try{!r&&c.return&&c.return()}finally{if(i)throw u}}return n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onSubFieldChange",value:function(e){this.dispatchEvent("Field.Change",{value:this.value()})}},{key:"getSubField",value:function(e){this._model.getSubField(e)}},{key:"addField",value:function(e){this._model.addField(e),e.addEventListener("Field.Change",this._onSubFieldChange)}},{key:"removeField",value:function(e){this.getSubField(e)&&this.getSubField(e).removeEventListener("Field.Change",this._onSubFieldChange),this._model.removeField(e)}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},o=s(n(14)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u={fields:[]},l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=a.default.ensureDefaults(e.defaults,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"set",value:function(e,n){"value"==e&&a.default.exists(n)&&this._setValue(n),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"set",this).call(this,e,n)}},{key:"_setValue",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.get("fields")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;Object.keys(e).includes(a.id())?a.setValue(e[a.id()]):a.setValue(null)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"value",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var i,o=this.get("fields")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;e[a.id()]=a.value()}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e}},{key:"getSubField",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.get("fields")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.id()==e)return a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return null}},{key:"addField",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.get("fields")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){if(i.value.id()==e.id())throw new Error("Field ID already exists in group")}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.get("fields").push(e),this.set("fields",this.get("fields"))}},{key:"removeField",value:function(e){var t=null,n=!0,r=!1,i=void 0;try{for(var o,s=this.get("fields")[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;if(u.id()==e){t=this.get("fields").indexOf(u);break}}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}a.default.exists(t)&&(this.get("fields").splice(t,1),this.set("fields",this.get("fields")))}},{key:"validate",value:function(){var e=this.get("fields").filter(function(e){return!a.default.isEmpty(e.value())}).map(function(e){return e.validate()});return Promise.all([i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"validate",this).call(this),Promise.all(e)]).then(function(e){var t=e[0];t.children=e[1];var n=!0,r=!1,i=void 0;try{for(var o,a=t.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.isValid||(t.isValid=!1,t.errors=t.errors.concat(s.errors))}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t})}},{key:"enable",value:function(){this.get("fields").forEach(function(e){e.enable()}),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)}},{key:"disable",value:function(){this.get("fields").forEach(function(e){e.disable()}),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__fieldgroup">\n  <div class="fieldgroup__fields"></div>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(14)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={options:{},disabledOptions:[]},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,s);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.default.exists(n.get("value"))||n.set("value",Object.keys(n.get("options"))[0]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addOption",value:function(e){var t=this.get("options");t[e.value]=e.label,this.set("options",t,!0)}},{key:"removeOption",value:function(e){var t=this.get("options");delete t[e],this.set("options",t,!0)}},{key:"clearOptions",value:function(){this.set("options",{},!0),this.set("value",null)}},{key:"disableOption",value:function(e){var t=this.get("options"),n=this.get("disabledOptions");void 0===t[e]||n.includes(e)||(n.push(e),this.set("disabledOptions",n))}},{key:"enableOption",value:function(e){var t=this.get("options"),n=this.get("disabledOptions");void 0!==t[e]&&n.includes(e)&&(n.splice(n.indexOf(e),1),this.set("disabledOptions",n))}},{key:"listAbleOptions",value:function(){var e=Object.keys(this.get("options")),t=this.get("disabledOptions"),n=[];return e.forEach(function(e){t.includes(e)||n.push(e)}),n}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(3)),o=a(n(236));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.default));return n.$el.attr("value",e.id),n.$el.html(e.label),n.select(e.selected),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this.$el.attr("value")}},{key:"select",value:function(e){this.$el.prop("selected",e)}},{key:"disable",value:function(){this.$el.prop("disabled",!0)}},{key:"enable",value:function(){this.$el.prop("disabled",!1)}},{key:"hide",value:function(){this.$el.css("display","none")}},{key:"show",value:function(){this.$el.css("display","block")}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),t.default="<option></option>"},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__selectfield component__field">\n  <label class="field__label selectfield__label"></label>\n  <select class="selectfield__select"></select>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(15)),i=a(n(239)),o=a(n(240));a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||o.default,e.modelClass=e.modelClass||i.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();s.create=function(e){return new s({modelData:e})},t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(14)),i=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a={prefix:"",postfix:"",min:null,max:null,placeholder:null,type:"float",changeEvents:"change blur",validation:{_number:{test:"numeric",errorMessage:"Please provide a valid number"}}},s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(16)),o=s(n(241)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||o.default));return a.default.bindMethods(r,["_onFieldChange","_onModelChange"]),r.renderModel(e),r.$el.find(".numberfield__field").on(e.get("changeEvents"),r._onFieldChange),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"renderModel",value:function(e){this.$el.find(".numberfield__field").attr("id",e.get("id")),this.$el.find(".numberfield__field").attr("value",e.value()),e.get("placeholder")&&this.$el.find(".numberfield__field").attr("placeholder",e.get("placeholder")),this.$el.find(".numberfield__field").prop("disabled",e.get("disabled")),e.get("min")&&this.$el.find(".numberfield__field").prop("min",e.get("min")),e.get("max")&&this.$el.find(".numberfield__field").prop("max",e.get("max")),e.get("label")&&this.$el.find(".numberfield__label").html(e.get("label")),e.get("help")&&this.$el.find(".numberfield__help").html(e.get("help"))}},{key:"_onModelChange",value:function(e){this.renderModel(e.currentTarget)}},{key:"_onFieldChange",value:function(e){this.dispatchEvent("Field.ValueChange",{value:parseFloat(this.$el.find(".numberfield__field").val())})}},{key:"focus",value:function(){this.$el.find(".numberfield__field").focus()}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__numberfield component__field">\n  <label class="field__label numberfield__label"></label>\n  <input type="number" class="numberfield__field"/> \n  <span class="numberfield__help"></span>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(51)),i=(o(n(0)),o(n(243)));function o(e){return e&&e.__esModule?e:{default:e}}n(244);var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||i.default))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__fieldgroup component__experiment-row">\n  <div class="fieldgroup__fields"></div>\n</div>'},function(e,t,n){var r=n(245);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__experiment-row .fieldgroup__fields {\n  display: flex; }\n\n.component__experiment-row .component__field {\n  flex: 1;\n  padding: 0.5rem; }\n\n.component__experiment-row .numberfield__field {\n  width: 100%;\n  text-align: center; }\n\n.component__experiment-row .selectfield__select {\n  width: 100%; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),o=l(n(20)),a=l(n(12)),s=l(n(247)),u=l(n(0));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[a.default.create({id:"submit",label:"Submit",classes:["form__experiment__submit"],eventName:"Experiment.Submit"}),a.default.create({id:"aggregate",label:"Add Results to Aggregate",classes:["form__experiment__aggregate"],eventName:"Experiment.AddToAggregate"})];i.default.get("AppConfig.system.experimentModality").match("create")&&e.splice(2,0,a.default.create({id:"new",label:"New Experiment",classes:["form__experiment__new"],eventName:"Experiment.NewRequest"}));var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{modelData:{id:"experiment",classes:["form__experiment"],fields:[s.default.create({id:"exp_category",description:"1. Variable to be changed:",label:"",defaultValue:"direction_brightness_default_choice",classes:[],options:{direction_brightness_default_choice:"please choose one",no_light:"Show no light",brightness:"Brightness of the light",direction:"Direction of the light"},validation:{}}),s.default.create({id:"exp_procedure",description:{default_choice:"2. Decide on the previous questions first.",brightness:"2. Procedure for changing the brightness:",direction:"2. Procedure for changing the direction:"},label:"",defaultValue:"direction_brightness_default_choice",classes:[],options:{direction_brightness_default_choice:"please choose one",brightness_increase:"Gradually increase the brightness",brightness_decrease:"Gradually decrease the brightness",direction_around:"Make the light go around",direction_hold:"Keep one direction",direction_alternate:"Alternate between two directions",direction_special:"Special directions"},validation:{}}),s.default.create({id:"exp_holdconstant",description:{default_choice:"3. Decide on the previous questions first.",brightness:"3. Fix the direction of light to:",direction:"3. Fix the brightness of light to:"},label:"",defaultValue:"direction_brightness_default_choice",classes:[],options:"complete"==i.default.get("AppConfig.experiment.formOptions")?{direction_brightness_default_choice:"please choose one",direction_25:"dim",direction_50:"medium",direction_100:"bright",brightness_alldir:"from all directions",brightness_left:"from the left",brightness_top:"from the top",brightness_right:"from the right",brightness_bottom:"from the bottom"}:{direction_brightness_default_choice:"please choose one",direction_25:"dim",direction_50:"medium",direction_100:"bright",brightness_left:"from the left",brightness_top:"from the top",brightness_right:"from the right",brightness_bottom:"from the bottom"},validation:{}}),s.default.create({id:"exp_firstlight",description:{default_choice:"4. Decide on the previous questions first.",brightness:"4. Brightness start setting:",direction:"4. Direction start setting:"},label:"",defaultValue:"direction_brightness_default_choice",classes:[],options:"complete"==i.default.get("AppConfig.experiment.formOptions")?{direction_brightness_default_choice:"please choose one",brightness_25:"dim",brightness_50:"medium",brightness_100:"bright",direction_special_alldir:"from all directions",direction_left:"from the left",direction_special_topleft:"from the top-left",direction_special_leftright:"from the left and right",direction_top:"from the top",direction_right:"from the right",direction_bottom:"from the bottom"}:{direction_brightness_default_choice:"please choose one",brightness_25:"dim",brightness_50:"medium",brightness_100:"bright",direction_left:"from the left",direction_top:"from the top",direction_right:"from the right",direction_bottom:"from the bottom"},validation:{}}),s.default.create({id:"exp_secondlight",description:{default_choice:"5. Decide on the previous questions first.",brightness:"5. Brightness second setting:",direction:"5. Direction second setting:"},label:"",defaultValue:"direction_brightness_default_choice",classes:[],options:"complete"==i.default.get("AppConfig.experiment.formOptions")?{direction_brightness_default_choice:"please choose one",direction_brightness_0:"no light",brightness_25:"dim",brightness_50:"medium",brightness_100:"bright",direction_special_alldir:"from all directions",direction_left:"from the left",direction_top:"from the top",direction_right:"from the right",direction_bottom:"from the bottom",direction_special_topbottom:"from the top and bottom",direction_special_bottomright:"from the bottom-right"}:{direction_brightness_default_choice:"please choose one",direction_brightness_0:"no light",brightness_25:"dim",brightness_50:"medium",brightness_100:"bright",direction_left:"from the left",direction_top:"from the top",direction_right:"from the right",direction_bottom:"from the bottom"},validation:{}}),s.default.create({id:"exp_lightduration",description:{default_choice:"6. Decide on the previous questions first.",brightness:"6. Time per setting:",direction:"6. Time per setting:"},label:"",defaultValue:"direction_brightness_default_choice",classes:[],options:{direction_brightness_default_choice:"please choose one",brightness_direction_15on:"alternate 15 seconds on"},validation:{}})],buttons:e}}));return n.chainOfActivation={fullChainOfActivation:{exp_category:"exp_procedure",exp_procedure:"exp_holdconstant",exp_holdconstant:"exp_firstlight",exp_firstlight:"exp_secondlight",exp_secondlight:"exp_lightduration"},partialChainOfActivation:{exp_category:"exp_procedure",exp_procedure:"exp_holdconstant",exp_holdconstant:"exp_firstlight"}},n.chainState="fullChainOfActivation",u.default.bindMethods(n,["_updateFormViews","setState","validate","getLightConfiguration"]),n.addEventListener("Form.FieldChanged",n._updateFormViews),n.setState("new"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"validate",value:function(){switch(this.chainState){case"fullChainOfActivation":this._model._data.regions.default.forEach(function(e,t){e.updateValidation({custom:{test:"custom",fn:function(e){return e.match("default")?Promise.resolve(!1):Promise.resolve(!0)},errorMessage:"You have to choose valid options for the "+(1+t)+"th field."}})});break;case"partialChainOfActivation":this._model._data.regions.default.forEach(function(e,t){"exp_secondlight"!=e.id()&"exp_lightduration"!=e.id()?e.updateValidation({custom:{test:"custom",fn:function(e){return e.match("default")?Promise.resolve(!1):Promise.resolve(!0)},errorMessage:"You have to choose valid options for the "+(1+t)+"th field."}}):e.updateValidation({})})}return this._model.validate()}},{key:"export",value:function(){var e=this.getLightConfiguration();return e.brightness===[-1,-1,-1,-1]&&(e.brightness=[0,0,0,0]),{lights:e.lights,expForm:function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"export",this).call(this)}}},{key:"import",value:function(e){var t=this;return this.clear().then(function(){var n=!0,r=!1,i=void 0;try{for(var o,a=t._model.getFields()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;void 0!==e[s.id()]&&(s.setValue(e[s.id()]),"direction_brightness_default_choice"==e[s.id()]&&s.setVisibility("hidden",0))}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}})}},{key:"setState",value:function(e){switch(e){case"historical":switch(this.state="historical",i.default.get("AppConfig.system.experimentModality").toLowerCase()){case"observe":case"explore":this._model._data.regions.default.forEach(function(e){e.disable()}),this.getButton("submit").view().hide(),i.default.get("State.experiment.allowNew")&&this.getButton("new").view().hide(),this.getButton("aggregate").view().hide();break;case"create":case"createandhistory":this._model._data.regions.default.forEach(function(e){e.disable()}),this.getButton("submit").view().hide(),i.default.get("State.experiment.allowNew")&&this.getButton("new").view().show(),i.default.get("AppConfig.aggregate")?this.getButton("aggregate").view().show():this.getButton("aggregate").view().hide()}break;case"new":this.state="new",this._model._data.regions.default.forEach(function(e){"exp_category"==e.id()?(e.enable(),e.setVisibility("visible"),e.setDefault()):(e.disable(),e.setVisibility("hidden",0),e.setDefault())}),this.getButton("submit").view().show(),i.default.get("State.experiment.allowNew")&&this.getButton("new").view().hide(),this.getButton("aggregate").view().hide()}}},{key:"disableNew",value:function(){var e=this.getButton("new");e&&e.disable()}},{key:"enableNew",value:function(){var e=this.getButton("new");e&&e.enable()}},{key:"getLightConfiguration",value:function(){var e=this,t=0;this.expProtocol={},this._model._data.regions.default.forEach(function(n,r){e.expProtocol[n.id()]=n.value(),t="direction_brightness_default_choice"==n.value()?t+1:t});var n=!1;t<3&&(n=!0);var r={};r.brightness=Array(4).fill(-1),r.lights=[];for(var i=0;i<4;i++)r.lights.push({left:0,top:0,right:0,bottom:0,duration:15});if(n){var o=["left","top","right","bottom"];"direction_brightness_default_choice"==this.expProtocol.exp_holdconstant&&console.log("there is a problem"),this.expProtocol.exp_holdconstant.match("direction")?r.brightness=Array(4).fill().map(function(){return parseInt(this.expProtocol.exp_holdconstant.match(/\d+/)[0])},this):this.expProtocol.exp_holdconstant.match("brightness")&&function(){var t=e.expProtocol.exp_holdconstant.lastIndexOf("_");t=e.expProtocol.exp_holdconstant.substr(t+1);for(var n=function(e){o.forEach(function(n){return r.lights[e][n]=t.match("alldir|"+n)?100:0})},i=0;i<4;i++)n(i)}();var a={left:"top",top:"right",right:"bottom",bottom:"left",topleft:"topright",topright:"bottomright",bottomright:"bottomleft",bottomleft:"topleft"},s=null;if("partialChainOfActivation"==this.chainState&!("direction_brightness_default_choice"==this.expProtocol.exp_firstlight))switch(this.expProtocol.exp_procedure){case"brightness_increase":s=parseInt(this.expProtocol.exp_firstlight.match(/\d+/)[0]);for(var u=function(e){r.brightness[e]=s+25*e,o.forEach(function(t){return r.lights[e][t]=r.lights[e][t]>0?r.brightness[e]:0})},l=0;l<4;l++)u(l);break;case"brightness_decrease":s=parseInt(this.expProtocol.exp_firstlight.match(/\d+/)[0]);for(var c=function(e){r.brightness[e]=s-25*e,o.forEach(function(t){return r.lights[e][t]=r.lights[e][t]>0?r.brightness[e]:0})},f=0;f<4;f++)c(f);break;case"brightness_hold":s=parseInt(this.expProtocol.exp_firstlight.match(/\d+/)[0]);for(var d=function(e){r.brightness[e]=s,o.forEach(function(t){return r.lights[e][t]=r.lights[e][t]>0?r.brightness[e]:0})},h=0;h<4;h++)d(h);break;case"direction_around":var p=this.expProtocol.exp_firstlight.lastIndexOf("_");p=this.expProtocol.exp_firstlight.substr(p+1);for(var g=function(e){o.forEach(function(t){return r.lights[e][t]=p.match(t)?r.brightness[e]:0}),p=a[p]},m=0;m<4;m++)g(m);break;case"direction_hold":p=this.expProtocol.exp_firstlight.lastIndexOf("_");p=this.expProtocol.exp_firstlight.substr(p+1);for(var v=function(e){o.forEach(function(t){return r.lights[e][t]=p.match("alldir|"+t)?r.brightness[e]:0}),"0"==p&&(r.brightness[e]=0)},y=0;y<4;y++)v(y)}else if("direction_brightness_default_choice"!=this.expProtocol.exp_firstlight&&(this.expProtocol.exp_firstlight.match("brightness")?(r.brightness[0]=parseInt(this.expProtocol.exp_firstlight.match(/\d+/)[0]),o.forEach(function(e){return r.lights[0][e]=r.lights[0][e]>0?r.brightness[0]:0})):this.expProtocol.exp_firstlight.match("direction")&&o.forEach(function(t){return r.lights[0][t]=e.expProtocol.exp_firstlight.match("alldir|"+t)?r.brightness[0]:0})),!("direction_brightness_default_choice"==this.expProtocol.exp_secondlight)&!("direction_brightness_default_choice"==this.expProtocol.exp_lightduration)){var _=[];switch(this.expProtocol.exp_lightduration){case"brightness_direction_15on":r.lights[2]=r.lights[0],r.brightness[2]=r.brightness[0],_=[1,3];break;case"brightness_direction_15onoff":var b={duration:15};o.forEach(function(e){return b[e]=0}),r.lights[1]=b,r.brightness[1]=0,r.lights[3]=r.lights[1],r.brightness[3]=r.brightness[1],_=[2];break;case"brightness_direction_special_30on":r.lights[1]=r.lights[0],r.brightness[1]=r.brightness[0],_=[2,3]}this.expProtocol.exp_secondlight.match("brightness")?(r.brightness[_[0]]=parseInt(this.expProtocol.exp_secondlight.match(/\d+/)[0]),o.forEach(function(e){return r.lights[_[0]][e]=r.lights[_[0]][e]>0?r.brightness[_[0]]:0})):this.expProtocol.exp_secondlight.match("direction")&&o.forEach(function(t){return r.lights[_[0]][t]=e.expProtocol.exp_secondlight.match("alldir|"+t)?r.brightness[_[0]]:0}),_.length>1&&(r.lights[_[1]]=r.lights[_[0]],r.brightness[_[1]]=r.brightness[_[0]])}}return r}},{key:"_updateFormViews",value:function(e){var t=this;if("exp_category"==e.data.field._model._data.id)this._model._data.regions.default.forEach(function(n,r){"exp_category"!=n.id()?(n.showDescription(e.data.delta.value.match("default_choice")?"default_choice":e.data.delta.value),"new"==t.state&&(n.disable(),n.setVisibility("hidden",0),n.setDefault()),t._modifyOptions(n,e.data.delta.value)):n.showDescription()}),"no_light"===e.data.delta.value?this.chainState="final":this.chainState="fullChainOfActivation";else if("exp_procedure"==e.data.field._model._data.id){var n=this._findField("exp_firstlight");switch(e.data.delta.value){case"brightness_decrease":this._modifyOptions(n,"brightness_100"),this.chainState="partialChainOfActivation";break;case"brightness_increase":this._modifyOptions(n,"brightness_25"),this.chainState="partialChainOfActivation";break;case"direction_around":this._modifyOptions(n,"_left","_special"),this.chainState="partialChainOfActivation";break;case"brightness_alternate":this._modifyOptions(n,"brightness"),this.chainState="fullChainOfActivation";break;case"brightness_hold":this._modifyOptions(n,"brightness"),this.chainState="partialChainOfActivation";break;case"direction_alternate":this._modifyOptions(n,"direction","_special"),this.chainState="fullChainOfActivation";break;case"direction_hold":this._modifyOptions(n,"direction","_special|_topleft"),this.chainState="partialChainOfActivation";break;case"direction_special":this._modifyOptions(n,"special"),this.chainState="fullChainOfActivation"}var r=this._findField("exp_secondlight");switch(e.data.delta.value){case"direction_special":this._modifyOptions(r,"special|direction_brightness_0");break;default:var i=null;["direction","brightness"].forEach(function(t){e.data.delta.value.match(t)&&(i=t)}),i&&this._modifyOptions(r,i,"special")}var o=this._findField("exp_lightduration");switch(e.data.delta.value){case"direction_special":this._modifyOptions(o,"brightness_direction");break;default:this._modifyOptions(o,"brightness_direction","special")}this._model._data.regions.default.forEach(function(e,n){"exp_category"!=e.id()&"exp_procedure"!=e.id()&"new"==t.state&&(e.disable(),e.setVisibility("hidden",0),e.setDefault())})}if("final"!=this.chainState){var a=this._findField(this.chainOfActivation[this.chainState][e.data.field._model._data.id]);if(a&&!a.isVisible()){a.setVisibility("visible"),a.enable();var s=this._findField(this.chainOfActivation[this.chainState][a.id()]);s&&s.setVisibility("hidden",.3)}}}},{key:"_findField",value:function(e){for(var t=null,n=0;n<this._model._data.regions.default.length;n++)if(this._model._data.regions.default[n].id()==e){t=this._model._data.regions.default[n];break}return t}},{key:"_modifyOptions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object.keys(e.getOptions()).forEach(function(r){!r.match(n)&&r.match(t)||r.match("direction_brightness_default_choice")?e.enableOption(r):e.disableOption(r)})}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(17)),o=s(n(248)),a=s(n(0));s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||o.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.default.bindMethods(n,["_onModelChange","showDescription","setVisibility","isVisible"]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onModelChange",this).call(this,e)}},{key:"showDescription",value:function(e){e?this.view()._showDescription(this._model._data.description[e]):this.view()._showDescription(this._model._data.description)}},{key:"setVisibility",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;"hidden"==e?this.view()._setVisibility(!1,t):"visible"==e&&this.view()._setVisibility(!0,t)}},{key:"isVisible",value:function(){return this.view()._isVisible()}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(52)),o=s(n(249)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}n(250);var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e._data.label="";var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||o.default));return a.default.bindMethods(r,["_showDescription","_setVisibility","_isVisible"]),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_showDescription",value:function(e){this.$el.find(".exp-protocol__description").text(e)}},{key:"_setVisibility",value:function(e,t){this.$el.css("opacity",e?1:t)}},{key:"_isVisible",value:function(){return 1==this.$el.css("opacity")}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__field component__selectfield component__exp-protocol">\n  <div class="exp-protocol__description"></div>\n  <label class="field__label selectfield__label exp-protocol__selectfield"></label>\n  <select class="selectfield__select exp-protocol__select"></select>\n</div>\n'},function(e,t,n){var r=n(251);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__exp-protocol {\n  border: 0px solid #282828;\n  padding: 0.1rem;\n  opacity: 1.0; }\n  .component__exp-protocol .exp-protocol__description {\n    display: flex;\n    padding-right: 3rem;\n    background: #d9d9d9;\n    opacity: 1.0; }\n  .component__exp-protocol .exp-protocol__selectfield {\n    display: flex;\n    text-align: center;\n    font-weight: 700;\n    font-size: 1.2rem; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(6)),i=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a={width:200,height:200},s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(3)),o=a(n(254));a(n(0)),a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}n(255);var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));return r.$el.find(".light-display__content").css({width:e.get("width"),height:e.get("height")}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addText",value:function(e){this.$el.find(".light-display__content").text(e)}},{key:"render",value:function(e){for(var t in e)this.$el.find(".light-display__"+t).css({opacity:e[t]/100})}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),t.default='<div class="light-display">\n  <div class="light-display__content"></div>\n  <div class="light-display__light light-display__top"></div>\n  <div class="light-display__light light-display__left"></div>\n  <div class="light-display__light light-display__right"></div>\n  <div class="light-display__light light-display__bottom"></div>\n</div>'},function(e,t,n){var r=n(256);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".light-display {\n  background: #939393;\n  padding: 2rem;\n  margin: 1rem;\n  position: relative;\n  display: inline-block;\n  text-align: center; }\n  .light-display__light {\n    position: absolute;\n    background: #FFFF99; }\n  .light-display__top {\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 2rem; }\n  .light-display__bottom {\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 2rem; }\n  .light-display__left {\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 2rem; }\n  .light-display__right {\n    top: 0;\n    right: 0;\n    height: 100%;\n    width: 2rem; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(6)),i=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a={width:200,height:200},s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(3)),o=a(n(259));a(n(0)),a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}n(260);var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));return r.$el.find(".bulb-display__content").css({width:e.get("width"),height:e.get("height")}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"render",value:function(e){for(var t in e)this.$el.find(".bulb-display__"+t).css({opacity:e[t]/100})}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),t.default='<div class="bulb-display">\n  <div class="bulb-display__content"></div>\n  <div class="bulb-display__bulb bulb-display__top__fix"></div>\n  <div class="bulb-display__bulb bulb-display__top"></div>\n  <div class="bulb-display__bulb bulb-display__left__fix"></div>\n  <div class="bulb-display__bulb bulb-display__left"></div>\n  <div class="bulb-display__bulb bulb-display__right__fix"></div>\n  <div class="bulb-display__bulb bulb-display__right"></div>\n  <div class="bulb-display__bulb bulb-display__bottom__fix"></div>\n  <div class="bulb-display__bulb bulb-display__bottom"></div>\n</div>\n'},function(e,t,n){var r=n(261);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(54);(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".bulb-display {\n  padding: 4rem;\n  margin: 1rem;\n  position: relative;\n  display: inline-block; }\n  .bulb-display__bulb {\n    position: absolute; }\n  .bulb-display__top {\n    background: url("+r(n(55))+") center center no-repeat;\n    background-size: contain;\n    -webkit-transform: rotate(180deg);\n    transform: rotate(180deg);\n    top: 0;\n    left: 5%;\n    width: 90%;\n    height: 4rem; }\n  .bulb-display__top__fix {\n    background: url("+r(n(56))+") center center no-repeat;\n    background-size: contain;\n    -webkit-transform: rotate(180deg);\n    transform: rotate(180deg);\n    top: 0;\n    left: 5%;\n    width: 90%;\n    height: 4rem; }\n  .bulb-display__bottom {\n    background: url("+r(n(55))+") center center no-repeat;\n    background-size: contain;\n    bottom: 0;\n    left: 5%;\n    width: 90%;\n    height: 4rem; }\n  .bulb-display__bottom__fix {\n    background: url("+r(n(56))+") center center no-repeat;\n    background-size: contain;\n    bottom: 0;\n    left: 5%;\n    width: 90%;\n    height: 4rem; }\n  .bulb-display__left {\n    background: url("+r(n(57))+") center center no-repeat;\n    background-size: contain;\n    top: 5%;\n    left: 0;\n    height: 90%;\n    width: 4rem; }\n  .bulb-display__left__fix {\n    background: url("+r(n(58))+") center center no-repeat;\n    background-size: contain;\n    top: 5%;\n    left: 0;\n    height: 90%;\n    width: 4rem; }\n  .bulb-display__right {\n    background: url("+r(n(57))+") center center no-repeat;\n    background-size: contain;\n    -webkit-transform: rotate(180deg);\n    transform: rotate(180deg);\n    top: 5%;\n    right: 0;\n    height: 90%;\n    width: 4rem; }\n  .bulb-display__right__fix {\n    background: url("+r(n(58))+") center center no-repeat;\n    background-size: contain;\n    -webkit-transform: rotate(180deg);\n    transform: rotate(180deg);\n    top: 5%;\n    right: 0;\n    height: 90%;\n    width: 4rem; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),o=u(n(0)),a=u(n(20)),s=u(n(17));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{modelData:{id:"experiment_history",classes:["form__experiment__history"],fields:[s.default.create({id:"exp_history_id",label:"Experiment",value:i.default.get("State.experiment.allowNew")?"_new":null,classes:[],options:i.default.get("State.experiment.allowNew")?{_new:"(New Experiment)"}:{},description:"Choose different experiments that have been generated or saved previously."})],buttons:[]}}));return o.default.bindMethods(e,["_updateLastHistory"]),e._lastHistory=null,e.addEventListener("Form.FieldChanged",e._updateLastHistory),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"update",value:function(){var e=this,t=i.default.get("student_id"),n=this.historyCount();if(t){var r=i.default.get("AppConfig.experiment.experimentHistory"),a=null;return a=r?o.default.promiseAjax("/api/v1/Experiments",{data:{filter:{where:{id:{inq:r}}}}}):o.default.promiseAjax("/api/v1/Experiments/studentHistory",{data:{studentId:t,lab:i.default.get("AppConfig.lab")}}),r&&"create"===i.default.get("AppConfig.system.experimentModality")?o.default.promiseAjax("/api/v1/Experiments/studentHistory",{data:{studentId:t,lab:i.default.get("AppConfig.lab")}}).then(function(t){a.then(function(r){r=r.concat(t);var o=e.getField("exp_history_id"),a=o.value();o.clearOptions(),i.default.get("State.experiment.allowNew")&&o.addOption({value:"_new",label:"(New Experiment)"}),r.sort(function(e,t){return new Date(t.date_created).getTime()-new Date(e.date_created).getTime()}),r.forEach(function(e,t){o.addOption({value:e.id,label:"Experiment ".concat(String.fromCharCode(65+r.length-t-1))})}),"_new"==a||r.map(function(e){return e.id}).includes(parseInt(a))?o.setValue(a):r.length?o.setValue(r[0].id):o.setValue(a),i.default.get("Relay").dispatchEvent("ExperimentCount.Change",{old:n,count:e.historyCount()})})}):a.then(function(t){var r=e.getField("exp_history_id"),o=r.value();r.clearOptions(),i.default.get("State.experiment.allowNew")&&r.addOption({value:"_new",label:"(New Experiment)"}),t.sort(function(e,t){return new Date(t.date_created).getTime()-new Date(e.date_created).getTime()}),t.forEach(function(e,n){r.addOption({value:e.id,label:"Experiment ".concat(String.fromCharCode(65+t.length-n-1))})}),"_new"==o||t.map(function(e){return e.id}).includes(parseInt(o))?r.setValue(o):t.length?r.setValue(t[0].id):r.setValue(o),i.default.get("Relay").dispatchEvent("ExperimentCount.Change",{old:n,count:e.historyCount()})})}return this.getField("exp_history_id").clearOptions(),i.default.get("Relay").dispatchEvent("ExperimentCount.Change",{old:n,count:this.historyCount()}),Promise.resolve(!0)}},{key:"getHistory",value:function(){return Object.keys(this.getField("exp_history_id").getOptions()).filter(function(e){return"_new"!=e})}},{key:"historyCount",value:function(){return this.getHistory().length}},{key:"_updateLastHistory",value:function(e){var t=this.getField("exp_history_id").value();"_new"!=t&&o.default.exists(t)&&(this._lastHistory=t)}},{key:"revertToLastHistory",value:function(){this._lastHistory&&this.import({exp_history_id:this._lastHistory})}},{key:"disableNew",value:function(){this.getField("exp_history_id").disableOption("_new")}},{key:"enableNew",value:function(){this.getField("exp_history_id").enableOption("_new")}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(9)),o=c(n(0)),a=c(n(1)),s=c(n(264)),u=c(n(293)),l=c(n(18));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.bindMethods(e,["_onExperimentRequest","_onExperimentUpdate","_onSubmissionError","_onQueueError","_onExperimentReady","_searchAndLoadData"]),a.default.get("AppConfig.experiment.euglenaServerMode")?a.default.set("euglenaServerMode",a.default.get("AppConfig.experiment.euglenaServerMode")):a.default.set("euglenaServerMode","bpu"),e.bpu=new s.default,e.bpu.addEventListener("BPUController.Error.Submission",e._onSubmissionError),e.bpu.addEventListener("BPUController.Error.Queue",e._onQueueError),e.bpu.addEventListener("BPUController.Experiment.Update",e._onExperimentUpdate),e.bpu.addEventListener("BPUController.Experiment.Ready",e._onExperimentReady),e._experiments=[],a.default.get("Relay").addEventListener("ExperimentServer.ExperimentRequest",e._onExperimentRequest),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"init",value:function(){var e=this;return new Promise(function(t,n){e.bpu.addEventListener("BPUController.Ready",function(e){t(!0)}),e.bpu.addEventListener("BPUController.Error.Connection",function(e){n(e.data.error)}),e.bpu.addEventListener("BPUController.Error.ConnectionRefused",function(n){e.demo=new u.default,e.demo.addEventListener("DemoController.Experiment.Update",e._onExperimentUpdate),e.demo.addEventListener("DemoController.Experiment.Ready",e._onExperimentReady),e.demo.init(),a.default.set("euglenaServerMode","demo"),a.default.get("Relay").dispatchEvent("Notifications.Add",{id:"demo_mode",type:"notice",message:"Demo Mode"}),t(!0)}),e.bpu.init()})}},{key:"_onSubmissionError",value:function(e){a.default.get("Relay").dispatchEvent("Notifications.Add",{id:"submission_rejected",type:"error",message:"Submission rejected: "+e.data.error}),a.default.get("Relay").dispatchEvent("ExperimentServer.Failure",{error:"Submission rejected: "+e.data.error})}},{key:"_onQueueError",value:function(e){a.default.get("Relay").dispatchEvent("Notifications.Add",{id:"submission_rejected",type:"error",message:"Queue request rejected: "+e.data.error}),a.default.get("Relay").dispatchEvent("ExperimentServer.Failure",{error:"Queue request rejected: "+e.data.error})}},{key:"_onExperimentUpdate",value:function(e){a.default.get("Relay").dispatchEvent("ExperimentServer.Update",e.data)}},{key:"_onExperimentReady",value:function(e){var t=e.data.data.experiment;a.default.get("Relay").dispatchEvent("ExperimentServer.Update",{experiment_id:t.exp_metaData.ExpName,remaining_estimate:0,status:"downloading"}),l.default.generateResults({bpu_api_id:t.exp_metaData.ExpName,experimentId:t.exp_metaData.tag}).then(function(e){return a.default.get("Relay").dispatchEvent("ExperimentServer.Results",e),e}).catch(function(e){a.default.get("Relay").dispatchEvent("Notifications.Add",{id:"result_submission_error",type:"error",message:"Results saving error: "+e}),a.default.get("Relay").dispatchEvent("ExperimentServer.Failure",{error:"Results saving error: "+e})})}},{key:"_onExperimentRequest",value:function(e){var t=this,n=[],r=0;e.data.lights.forEach(function(e){n.push({topValue:e.top,rightValue:e.right,bottomValue:e.bottom,leftValue:e.left,time:r}),r+=1e3*e.duration}),new Promise(function(n,r){t._searchAndLoadData(e.data.lights,null,"experiment",n)}).then(function(r){o.default.promiseAjax("/api/v1/Experiments",{method:"POST",data:JSON.stringify({studentId:a.default.get("student_id"),configuration:e.data.lights,expForm:e.data.expForm?e.data.expForm:null,lab:a.default.get("AppConfig.lab"),copyOfID:"simulate"===a.default.get("AppConfig.experiment.euglenaServerMode")&&r.copyOfID>0&&r.results.length?r.copyOfID:0}),contentType:"application/json"}).then(function(e){a.default.get("Relay").dispatchEvent("ExperimentServer.ExperimentSaved",{experiment:e}),"demo"==a.default.get("euglenaServerMode")?t.demo.runExperiment(n,e.id):"simulate"==a.default.get("euglenaServerMode")&&e.copyOfID>0?(r.results[0].experimentId=e.id,delete r.results[0].id,l.default.generateResults(r.results[0]).then(function(e){return a.default.get("Relay").dispatchEvent("ExperimentServer.Results",e),e}).catch(function(e){a.default.get("Relay").dispatchEvent("Notifications.Add",{id:"result_submission_error",type:"error",message:"Results saving error: "+e}),a.default.get("Relay").dispatchEvent("ExperimentServer.Failure",{error:"Results saving error: "+e})})):t.bpu.runExperiment(n,e.id)}).catch(function(e){a.default.get("Relay").dispatchEvent("Notifications.Add",{id:"experiment_submission_error",type:"error",message:"Experiment saving error: "+e}),a.default.get("Relay").dispatchEvent("ExperimentServer.Failure",{error:"Experiment saving error: "+e})})}).catch(function(e){console.log("Handle rejected Experiment promise("+e+") here.")})}},{key:"_searchAndLoadData",value:function(e,t,n,r){o.default.promiseAjax("/api/v1/Experiments/expsWithResults",{data:{copyOfID:0}}).then(function(t){for(var n=t,i=0;i<4;i++)n.length>0&&(n=n.filter(function(t){var n=t.configuration,r=!0,o=!1,a=void 0;try{for(var s,u=Object.keys(e[i])[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;if(n[i][l]!=e[i][l])return!1}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return!0}));var a=0;n.length>1?(n.sort(function(e,t){return new Date(t.date_created).getTime()-new Date(e.date_created).getTime()}),a=n[0].id):1==n.length&&(a=n[0].id),a>0?o.default.promiseAjax("/api/v1/Results",{data:{filter:{where:{and:[{experimentId:a},{bpu_api_id:{neq:null}}]}}},contentType:"application/json"}).then(function(e){r({copyOfID:a,results:e})}):r({copyOfID:0,results:null})})}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(13)),o=l(n(0)),a=l(n(8)),s=l(n(265)),u=l(n(1));function l(e){return e&&e.__esModule?e:{default:e}}var c={router:{connect:"connect",disconnect:"disconnect",authorize:"setConnection",getQueue:"getJoinQueueDataObj",update:"update",submitExperiment:"/bpuCont/#submitExperimentRequest"},serverInfo:{Identifier:"C422691AA38F9A86EC02CB7B55D5F542",name:"radiantllama",socketClientServerIP:"dev"==window.EuglenaConfig.experiment.server?"biotic.stanford.edu":"euglena.stanford.edu",socketClientServerPort:8084},user:{id:"574885898bf18b9508193e2a",name:"radiantllama",groups:["default"]},session:{id:"58bf571cc89b99092553fa65",sessionID:"R-OpYLbT6Kk-GXyEmX1SOOOHDw157mJc",socketID:null,socketHandle:"/account/joinlabwithdata",url:"/account/joinlabwithdata"}},f="http://"+c.serverInfo.socketClientServerIP+"/account/joinlabwithdata/downloadFile/",d="http://"+c.serverInfo.socketClientServerIP+":"+c.serverInfo.socketClientServerPort,h=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.bindMethods(e,["_onSocketDisconnect","_onSocketConnect","_onSocketUpdate","_onSocketAuthorization","_updateProcessingTime"]),e.experiments=[],e.downloads=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"init",value:function(){var e=this;this.socket=s.default.connect(d,{multiplex:!1,reconnect:!0}),this.socket.on("connect_error",function(t){console.log(t),e.socket.close(),e.dispatchEvent("BPUController.Error.ConnectionRefused",{error:t})}),this.socket.on(c.router.disconnect,this._onSocketDisconnect),this.socket.on(c.router.connect,this._onSocketConnect),this.socket.on(c.router.update,this._onSocketUpdate),window.requestAnimationFrame(this._updateProcessingTime)}},{key:"_onSocketDisconnect",value:function(e){this.dispatchEvent("BPUController.Error.Connection",{error:"Could not connect to the BPU Controller"})}},{key:"_onSocketConnect",value:function(e,t){this.socket.emit(c.router.authorize,c.serverInfo,this._onSocketAuthorization)}},{key:"_onSocketAuthorization",value:function(e,t){e?this.dispatchEvent("BPUController.Error.Connection",{error:"Could not authorize with BPU Controller"}):(this.auth=t,c.session.socketID=this.socket.id,this.dispatchEvent("BPUController.Ready"))}},{key:"_onSocketUpdate",value:function(e,t,n){var r=this,i=e.filter(function(e){return e.isOn&&"running"==e.bpuStatus&&e.liveBpuExperiment.username==c.user.name&&r.experiments.map(function(e){return e.id}).includes(e.liveBpuExperiment.id)});console.log(i);var o=[];for(var a in t)"eug"==a.substr(0,3)&&t[a].length&&(o=o.concat(t[a].filter(function(e){return r.experiments.map(function(e){return e.id}).includes(e.id)})));o.length&&o.forEach(function(e){r.experiments.filter(function(t){return t.id==e.id}).forEach(function(e){e.status="queue"}),r.dispatchEvent("BPUController.Experiment.Update",{experiment_id:e.id,remaining_estimate:e.exp_lastResort.totalWaitTime,status:"queue"})});var s=[];i&&i.length&&i.forEach(function(e){r.experiments.filter(function(t){return t.id==e.liveBpuExperiment.id}).forEach(function(e){e.status="running"}),s.push(e.liveBpuExperiment.id),r.dispatchEvent("BPUController.Experiment.Update",{experiment_id:e.liveBpuExperiment.id,remaining_estimate:e.liveBpuExperiment.bc_timeLeft,status:"running"})}),this.experiments.forEach(function(e){"running"!=e.status||s.includes(e.id)||(e.status="processing",e.process_start=performance.now())})}},{key:"_updateProcessingTime",value:function(e){var t=this;this.experiments.forEach(function(n){if("processing"==n.status){var r=1e5-(e-n.process_start);r<=0?(n.status="retrieving",delete n.process_start,t.dispatchEvent("BPUController.Experiment.Update",{experiment_id:n.id,status:n.status,remaining_estimate:0}),t._downloadData(n)):t.dispatchEvent("BPUController.Experiment.Update",{experiment_id:n.id,remaining_estimate:r,status:n.status})}}),window.requestAnimationFrame(this._updateProcessingTime)}},{key:"_downloadData",value:function(e){var t=this;o.default.promiseAjax(""+f+e.id+"/"+e.id+".json",{timeout:1e4}).then(function(n){e.data={experiment:n,video:""+f+e.id+"/movie.mp4"},e.status="ready",t.dispatchEvent("BPUController.Experiment.Ready",e)}).catch(function(n){t._downloadData(e)})}},{key:"runExperiment",value:function(e,t){var n=this;e.push({topValue:0,rightValue:0,bottomValue:0,leftValue:0,time:6e4}),this.socket.emit(c.router.getQueue,c.serverInfo,function(r,i){if(r)n.dispatchEvent("BPUController.Error.Queue",{error:r});else{var o=[],s=JSON.parse(JSON.stringify(i)),l={exp_eventsToRun:e,group_experimentType:"text",user:JSON.parse(JSON.stringify(c.user)),session:{id:c.session.id,sessionID:c.session.sessionID,socketHandle:c.session.socketHandle,socketID:c.session.socketID,user:JSON.parse(JSON.stringify(c.user))},exp_metaData:{clientCreationDate:new Date,group_experimentType:"text",runTime:6e4,tag:t,userUrl:c.session.url}};u.default.get("AppConfig.experiment.bpuId")&&(l.exp_wantsBpuName=u.default.get("AppConfig.experiment.bpuId")),s=a.default.extend(!0,s,l),o.push(s),n.socket.emit(c.router.submitExperiment,n.auth,o,function(e,t){e?n.dispatchEvent("BPUController.Error.Submission",{error:e}):t&&t.length?n.experiments.push({id:t[0]._id,status:"submitted"}):n.dispatchEvent("BPUController.Error.Submission",{error:"No resource found"})})}})}}]),t}();t.default=h},function(e,t,n){var r=n(266),i=n(37),o=n(62),a=n(28)("socket.io-client");e.exports=t=u;var s=t.managers={};function u(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=r(e),u=i.source,l=i.id,c=i.path,f=s[l]&&c in s[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||f?(a("ignoring socket cache for %s",u),n=o(u,t)):(s[l]||(a("new io instance for %s",u),s[l]=o(u,t)),n=s[l]),i.query&&!t.query&&(t.query=i.query),n.socket(i.path,t)}t.protocol=i.protocol,t.connect=u,t.Manager=n(62),t.Socket=n(68)},function(e,t,n){(function(t){var r=n(59),i=n(28)("socket.io-client:url");e.exports=function(e,n){var o=e;n=n||t.location,null==e&&(e=n.protocol+"//"+n.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),i("parse %s",e),o=r(e));o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443"));o.path=o.path||"/";var a=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+a+":"+o.port,o.href=o.protocol+"://"+a+(n&&n.port===o.port?"":":"+o.port),o}}).call(this,n(11))},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;u++;var i=t.formatters[r];if("function"==typeof i){var o=a[u];n=i.call(e,o),a.splice(u,1),u--}return n}),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=i,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(36),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(269)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(o=++i)}),e.splice(o,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n(35))},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;u++;var i=t.formatters[r];if("function"==typeof i){var o=a[u];n=i.call(e,o),a.splice(u,1),u--}return n}),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=i,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(36),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){(function(e){var r=n(60),i=n(61),o=Object.prototype.toString,a="function"==typeof e.Blob||"[object BlobConstructor]"===o.call(e.Blob),s="function"==typeof e.File||"[object FileConstructor]"===o.call(e.File);t.deconstructPacket=function(e){var t=[],n=e.data,o=e;return o.data=function e(t,n){if(!t)return t;if(i(t)){var o={_placeholder:!0,num:n.length};return n.push(t),o}if(r(t)){for(var a=new Array(t.length),s=0;s<t.length;s++)a[s]=e(t[s],n);return a}if("object"==typeof t&&!(t instanceof Date)){var a={};for(var u in t)a[u]=e(t[u],n);return a}return t}(n,t),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],n);else if("object"==typeof t)for(var o in t)t[o]=e(t[o],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,o=e;!function e(u,l,c){if(!u)return u;if(a&&u instanceof Blob||s&&u instanceof File){n++;var f=new FileReader;f.onload=function(){c?c[l]=this.result:o=this.result,--n||t(o)},f.readAsArrayBuffer(u)}else if(r(u))for(var d=0;d<u.length;d++)e(u[d],d,u);else if("object"==typeof u&&!i(u))for(var h in u)e(u[h],h,u)}(o),n||t(o)}}).call(this,n(11))},function(e,t,n){e.exports=n(272),e.exports.parser=n(23)},function(e,t,n){(function(t){var r=n(63),i=n(22),o=n(31)("engine.io-client:socket"),a=n(67),s=n(23),u=n(59),l=n(29);function c(e,n){if(!(this instanceof c))return new c(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=u(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=u(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=l.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.transportOptions=n.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized,this.forceNode=!!n.forceNode;var r="object"==typeof t&&t;r.global===r&&(n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=c,c.priorWebsocketSuccess=!1,i(c.prototype),c.protocol=s.protocol,c.Socket=c,c.Transport=n(39),c.transports=n(63),c.parser=n(23),c.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},c.prototype.open=function(){var e;if(this.rememberUpgrade&&c.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},c.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},c.prototype.probe=function(e){o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;c.priorWebsocketSuccess="websocket"===t.name,o('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!==r.readyState&&(o("changing transport and sending upgrade packet"),d(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())})}else{o('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name,r.emit("upgradeError",a)}}))}function a(){n||(n=!0,d(),t.close(),t=null)}function s(n){var i=new Error("probe error: "+n);i.transport=t.name,a(),o('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function u(){s("transport closed")}function l(){s("socket closed")}function f(e){t&&e.name!==t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),a())}function d(){t.removeListener("open",i),t.removeListener("error",s),t.removeListener("close",u),r.removeListener("close",l),r.removeListener("upgrading",f)}c.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",s),t.once("close",u),this.once("close",l),this.once("upgrading",f),t.open()},c.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",c.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},c.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},c.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},c.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},c.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},c.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},c.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},c.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},c.prototype.write=c.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},c.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},c.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}function t(){e.onClose("forced close"),o("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},c.prototype.onError=function(e){o("socket error %j",e),c.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},c.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},c.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~a(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,n(11))},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){(function(t){var r=n(38),i=n(64),o=n(22),a=n(30),s=n(31)("engine.io-client:polling-xhr");function u(){}function l(e){if(i.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var n="https:"===location.protocol,r=location.port;r||(r=n?443:80),this.xd=e.hostname!==t.location.hostname||r!==e.port,this.xs=e.secure!==n}}function c(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function f(){for(var e in c.requests)c.requests.hasOwnProperty(e)&&c.requests[e].abort()}e.exports=l,e.exports.Request=c,a(l,i),l.prototype.supportsBinary=!0,l.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new c(e)},l.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},l.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},o(c.prototype),c.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new r(e),i=this;try{s("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){i.onLoad()},n.onerror=function(){i.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState)try{var e=n.getResponseHeader("Content-Type");i.supportsBinary&&"application/octet-stream"===e&&(n.responseType="arraybuffer")}catch(e){}4===n.readyState&&(200===n.status||1223===n.status?i.onLoad():setTimeout(function(){i.onError(n.status)},0))},s("xhr data %s",this.data),n.send(this.data)}catch(e){return void setTimeout(function(){i.onError(e)},0)}t.document&&(this.index=c.requestsCount++,c.requests[this.index]=this)},c.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},c.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},c.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},c.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,e)try{this.xhr.abort()}catch(e){}t.document&&delete c.requests[this.index],this.xhr=null}},c.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},c.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},c.prototype.abort=function(){this.cleanup()},c.requestsCount=0,c.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",f):t.addEventListener&&t.addEventListener("beforeunload",f,!1))}).call(this,n(11))},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(277),i=n(278),o=n(279);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=d(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(c(t),e=s(e,t<0?0:0|h(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(o=n;o<s;o++)if(l(e,o)===l(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===u)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var f=!0,d=0;d<u;d++)if(l(e,o+d)!==l(t,d)){f=!1;break}if(f)return o}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function _(e,t,n,r){return V(U(t,e.length-n),e,n,r)}function b(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return b(e,t,n,r)}function x(e,t,n,r){return V(z(t),e,n,r)}function E(e,t,n,r){return V(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function M(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,l=e[i],c=null,f=l>239?4:l>223?3:l>191?2:1;if(i+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&l)<<6|63&o)>127&&(c=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&l)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return l(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return f(null,e)},u.allocUnsafeSlow=function(e){return f(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return S(this,t,n);case"latin1":case"binary":return O(this,t,n);case"base64":return M(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,a=n-t,s=Math.min(o,a),l=this.slice(r,i),c=e.slice(t,n),f=0;f<s;++f)if(l[f]!==c[f]){o=l[f],a=c[f];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function S(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function O(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function k(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=B(e[o]);return i}function A(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function L(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function j(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function D(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,r,o){return o||D(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function I(e,t,n,r,o){return o||D(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):j(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):j(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return I(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return I(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=u.isBuffer(e)?e:U(new u(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(11))},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=l(e),r=n[0],a=n[1],s=new o(function(e,t,n){return 3*(t+n)/4-n}(0,r,a)),u=0,c=a>0?r-4:r,f=0;f<c;f+=4)t=i[e.charCodeAt(f)]<<18|i[e.charCodeAt(f+1)]<<12|i[e.charCodeAt(f+2)]<<6|i[e.charCodeAt(f+3)],s[u++]=t>>16&255,s[u++]=t>>8&255,s[u++]=255&t;2===a&&(t=i[e.charCodeAt(f)]<<2|i[e.charCodeAt(f+1)]>>4,s[u++]=255&t);1===a&&(t=i[e.charCodeAt(f)]<<10|i[e.charCodeAt(f+1)]<<4|i[e.charCodeAt(f+2)]>>2,s[u++]=t>>8&255,s[u++]=255&t);return s},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(f(e,a,a+16383>s?s:a+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function f(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(c(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=n?i-1:0,d=n?-1:1,h=e[t+f];for(f+=d,o=h&(1<<-c)-1,h>>=-c,c+=s;c>0;o=256*o+e[t+f],f+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+e[t+f],f+=d,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=l}return(h?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,u,l=8*o-i-1,c=(1<<l)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?d/u:d*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=c?(s=0,a=c):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&s,h+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;e[n+h]=255&a,h+=p,a/=256,l-=8);e[n+h-p]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)o[s]=i[a];return o.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){var i=!1;return r=r||n,o.count=e,0===e?t():o;function o(e,n){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,t(e),t=r):0!==o.count||i||t(null,n)}}},function(e,t,n){(function(e,r){var i;/*! https://mths.be/utf8js v2.1.2 by @mathias */!function(o){var a="object"==typeof t&&t,s=("object"==typeof e&&e&&e.exports,"object"==typeof r&&r);s.global!==s&&s.window;var u,l,c,f=String.fromCharCode;function d(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function h(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function p(e,t){return f(e>>t&63|128)}function g(e,t){if(0==(4294967168&e))return f(e);var n="";return 0==(4294965248&e)?n=f(e>>6&31|192):0==(4294901760&e)?(h(e,t)||(e=65533),n=f(e>>12&15|224),n+=p(e,6)):0==(4292870144&e)&&(n=f(e>>18&7|240),n+=p(e,12),n+=p(e,6)),n+=f(63&e|128)}function m(){if(c>=l)throw Error("Invalid byte index");var e=255&u[c];if(c++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function v(e){var t,n;if(c>l)throw Error("Invalid byte index");if(c==l)return!1;if(t=255&u[c],c++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|m())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|m()<<6|m())>=2048)return h(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=(7&t)<<18|m()<<12|m()<<6|m())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}var y={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=d(e),i=r.length,o=-1,a="";++o<i;)a+=g(r[o],n);return a},decode:function(e,t){var n=!1!==(t=t||{}).strict;u=d(e),l=u.length,c=0;for(var r,i=[];!1!==(r=v(n));)i.push(r);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=f(t);return i}(i)}};void 0===(i=function(){return y}.call(t,n,t,e))||(e.exports=i)}()}).call(this,n(284)(e),n(11))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,i,o,a,s=.75*e.length,u=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),f=new Uint8Array(c);for(t=0;t<u;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],f[l++]=r<<2|i>>4,f[l++]=(15&i)<<4|o>>2,f[l++]=(3&o)<<6|63&a;return c}}()},function(e,t,n){(function(t){var n=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;function a(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}function s(e,t){t=t||{};var r=new n;a(e);for(var i=0;i<e.length;i++)r.append(e[i]);return t.type?r.getBlob(t.type):r.getBlob()}function u(e,t){return a(e),new Blob(e,t||{})}e.exports=r?i?t.Blob:u:o?s:void 0}).call(this,n(11))},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;u++;var i=t.formatters[r];if("function"==typeof i){var o=a[u];n=i.call(e,o),a.splice(u,1),u--}return n}),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=i,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(36),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){(function(t){var r=n(64),i=n(30);e.exports=l;var o,a=/\n/g,s=/\\n/g;function u(){}function l(e){r.call(this,e),this.query=this.query||{},o||(t.___eio||(t.___eio=[]),o=t.___eio),this.index=o.length;var n=this;o.push(function(e){n.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=u)},!1)}i(l,r),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},l.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},l.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=u,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function l(){c(),t()}function c(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),c(),e=e.replace(s,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&l()}:this.iframe.onload=l}}).call(this,n(11))},function(e,t,n){(function(t){var r,i=n(39),o=n(23),a=n(29),s=n(30),u=n(66),l=n(31)("engine.io-client:websocket"),c=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{r=n(290)}catch(e){}var f=c;function d(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=c&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(f=r),i.call(this,e)}f||"undefined"!=typeof window||(f=r),e.exports=d,s(d,i),d.prototype.name="websocket",d.prototype.supportsBinary=!0,d.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new f(e,t):new f(e):new f(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},d.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},d.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,i=0,a=r;i<a;i++)!function(e){o.encodePacket(e,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),n.perMessageDeflate)("string"==typeof i?t.Buffer.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,o)}catch(e){l("websocket closed before onclose event")}--r||s()})}(e[i]);function s(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}},d.prototype.onClose=function(){i.prototype.onClose.call(this)},d.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},d.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===d.prototype.name)}}).call(this,n(11))},function(e,t){},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(13)),o=a(n(0));a(n(8)),a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.bindMethods(e,["_updateProcessingTime"]),e.experiments=[],e.demoLength=1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"init",value:function(){window.requestAnimationFrame(this._updateProcessingTime)}},{key:"_updateProcessingTime",value:function(e){var t=this,n=performance.now();this.experiments.forEach(function(e){"running"==e.status&&(n-e.startTime<1e3*t.demoLength?t.dispatchEvent("DemoController.Experiment.Update",{experiment_id:e.id,remaining_estimate:1e3*t.demoLength-(n-e.startTime),status:e.status}):(e.status="downloading",t.dispatchEvent("DemoController.Experiment.Update",{experiment_id:e.id,status:e.status,remaining_estimate:0}),Promise.all([o.default.promiseAjax("/cslib/module/euglena/experiment/demodata/58c82d732288ca69a5319aab.json"),o.default.promiseAjax("/cslib/module/euglena/experiment/demodata/tracks.json")]).then(function(n){e.data={experiment:n[0],video:"/cslib/module/euglena/experiment/demodata/movie.mp4",tracks:n[1]},e.status="ready",t.dispatchEvent("DemoController.Experiment.Ready",e)})))}),window.requestAnimationFrame(this._updateProcessingTime)}},{key:"runExperiment",value:function(e,t){var n={id:this.experiments.length,lightData:e,startTime:performance.now(),status:"running"};this.experiments.push(n)}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(u(n(1)),u(n(0))),o=u(n(3)),a=u(n(295)),s=u(n(12));function u(e){return e&&e.__esModule?e:{default:e}}n(296);var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a.default));return e.buttons={send:s.default.create({id:"send",label:"Send to Results Panel",eventName:"ExperimentReporter.Send"}),dont:s.default.create({id:"dont",label:"Don't Send",eventName:"ExperimentReporter.DontSend"})},e.addChild(e.buttons.send.view(),".exp_reporter__buttons"),e.addChild(e.buttons.dont.view(),".exp_reporter__buttons"),e.reset(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"reset",value:function(){this.update({status:"initializing",remaining_estimate:0})}},{key:"update",value:function(e){if("complete"!=e.status){this.$el.find(".exp_reporter__complete").hide(),this.$el.find(".exp_reporter__working").show();var t="";switch(e.status){case"queue":t="Experiment In Queue";break;case"initializing":t="Preparing Experiment";break;case"running":t="We sent your experiment to the real microscopes. If you can, check out the data from the last experiments.";break;case"processing":t="Your new experiment is in process. If you can, continue with the data from the last experiments.";break;case"retrieving":t="Processing Data";break;case"downloading":t="The data from your new experiment is getting downloaded."}var n="";n=e.remaining_estimate<=0?"Please wait a moment":"Approx. "+i.default.secondsToTimeString(Math.ceil(e.remaining_estimate/1e3))+" remaining",this.$el.find(".exp_reporter__phase").text(t),this.$el.find(".exp_reporter__estimate").text(n)}else this.results=e.results,this.$el.find(".exp_reporter__complete").show(),this.$el.find(".exp_reporter__working").hide()}},{key:"setFullscreen",value:function(e){this.$el.toggleClass("exp_reporter__fullscreen",e)}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="exp_reporter">\n  <div class="exp_reporter__content">\n    <div class="exp_reporter__working">\n      <div class="exp_reporter__phase"></div>\n      <div class="exp_reporter__spinner"></div>\n      <div class="exp_reporter__estimate"></div>\n    </div>\n    <div class="exp_reporter__complete">\n      <div class="exp_reporter__complete__message">Experiment Complete</div>\n      <div class="exp_reporter__buttons"></div>\n    </div>\n  </div>\n</div>'},function(e,t,n){var r=n(297);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(54);(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,'.exp_reporter {\n  position: absolute;\n  bottom: 6rem;\n  width: calc(100% - 3rem); }\n  .exp_reporter__content {\n    background: #f9f9f9;\n    padding: 1rem 1rem 1rem 1rem;\n    min-height: 7rem;\n    position: relative;\n    border: 1px solid #282828; }\n  .exp_reporter__phase {\n    font-family: "Lora", serif;\n    font-weight: 700;\n    font-size: 1.4rem;\n    line-height: 2.5rem; }\n  .exp_reporter__spinner {\n    background: url('+r(n(298))+") center center no-repeat;\n    background-size: contain;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 5rem;\n    height: 5rem; }\n  .exp_reporter__estimate {\n    font-size: 1.2rem;\n    line-height: 2.5rem; }\n  .exp_reporter__working {\n    padding-left: 6.5rem;\n    position: relative; }\n  .exp_reporter__complete__message {\n    text-align: center;\n    font-weight: bold;\n    margin-bottom: 0.5rem; }\n  .exp_reporter__complete .component__button:last-child {\n    float: right; }\n  .exp_reporter__complete .component__button button.button {\n    padding: 5px 10px; }\n  .exp_reporter.exp_reporter__fullscreen {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 999;\n    background: rgba(40, 40, 40, 0.8); }\n    .exp_reporter.exp_reporter__fullscreen .exp_reporter__content {\n      width: 50rem;\n      height: 55rem;\n      padding: 5rem 0;\n      position: absolute;\n      left: calc(50% - 25rem);\n      top: calc(50% - 20rem);\n      text-align: center;\n      box-shadow: 0px 0px 2rem 0.2rem rgba(0, 0, 0, 0.85); }\n    .exp_reporter.exp_reporter__fullscreen .exp_reporter__phase {\n      font-size: 2rem;\n      line-height: 5rem; }\n    .exp_reporter.exp_reporter__fullscreen .exp_reporter__spinner {\n      width: 20rem;\n      height: 20rem;\n      margin: auto;\n      position: static; }\n    .exp_reporter.exp_reporter__fullscreen .exp_reporter__estimate {\n      font-size: 1.4rem;\n      line-height: 5rem; }\n    .exp_reporter.exp_reporter__fullscreen .exp_reporter__working {\n      padding-left: 0; }\n",""])},function(e,t){e.exports="cslib/images/9a53b5741c75b2545269632b6ec63867-llama.png"},function(e,t,n){var r=n(300);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".form__experiment__history {\n  margin: 1.5rem 0; }\n  .form__experiment__history .field__label {\n    margin-right: 1rem; }\n\n.form__experiment .form__buttons {\n  margin-top: 3rem 0;\n  min-height: 35px; }\n\n.form__experiment__submit {\n  float: right; }\n\n.form__experiment__aggregate {\n  float: right; }\n\n.tab__experiment #expProtocol__title {\n  margin-bottom: 0.5rem;\n  font-weight: bold; }\n\n.tab__experiment .dry_run {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  min-height: 200px;\n  margin-top: 3rem; }\n  .tab__experiment .dry_run .light-display {\n    position: absolute;\n    margin: 1rem 2rem 0 0;\n    width: 22rem; }\n    .tab__experiment .dry_run .light-display__content {\n      color: #f9f9f9;\n      text-align: center; }\n      .tab__experiment .dry_run .light-display__content .dry_run__time {\n        line-height: 15rem;\n        text-align: center;\n        margin-right: 2rem; }\n  .tab__experiment .dry_run .bulb-display {\n    position: absolute;\n    margin: 0 0 0 0rem;\n    width: 24rem;\n    padding: 3rem; }\n    .tab__experiment .dry_run .bulb-display__top {\n      height: 3rem; }\n    .tab__experiment .dry_run .bulb-display__top__fix {\n      height: 3rem; }\n    .tab__experiment .dry_run .bulb-display__bottom {\n      height: 3rem; }\n    .tab__experiment .dry_run .bulb-display__bottom__fix {\n      height: 3rem; }\n    .tab__experiment .dry_run .bulb-display__left {\n      width: 3rem; }\n    .tab__experiment .dry_run .bulb-display__left__fix {\n      width: 3rem; }\n    .tab__experiment .dry_run .bulb-display__right {\n      width: 3rem; }\n    .tab__experiment .dry_run .bulb-display__right__fix {\n      width: 3rem; }\n\n.tab__experiment .exp_viz {\n  position: relative;\n  min-height: 200px;\n  min-width: 300px;\n  margin-top: 3rem; }\n  .tab__experiment .exp_viz span {\n    display: block;\n    width: 100%;\n    margin-top: 0.5rem; }\n  .tab__experiment .exp_viz span#title {\n    display: block;\n    width: 100%;\n    margin-bottom: 0.5rem;\n    font-weight: bold; }\n  .tab__experiment .exp_viz__container {\n    position: relative;\n    display: flex;\n    align-items: left;\n    justify-content: flex-start;\n    overflow-x: auto;\n    overflow-y: hidden; }\n    .tab__experiment .exp_viz__container .light-display {\n      display: flex;\n      border: 1px solid black;\n      position: relative;\n      margin: 0 0.1rem;\n      overflow: visible; }\n      .tab__experiment .exp_viz__container .light-display__content {\n        display: flex;\n        color: #f9f9f9;\n        justify-content: center;\n        min-width: 100%;\n        flex-wrap: wrap;\n        flex-direction: row; }\n        .tab__experiment .exp_viz__container .light-display__content div {\n          display: flex;\n          margin: auto;\n          justify-content: center;\n          min-width: 100%;\n          font-size: 10px; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(2)),o=c(n(0)),a=c(n(1)),s=c(n(9)),u=c(n(302)),l=c(n(18));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.bindMethods(e,["_onExperimentLoaded","_onModelLoaded","_onModelResultsRequest","_onPhaseChange","_onExperimentCountChange"]),e._currentExperiment=null,e._currentModel=null,e._view=new u.default,e._view.addEventListener("ResultsView.RequestModelData",e._onModelResultsRequest),e._firstModelSkip={},a.default.get("Relay").addEventListener("Experiment.Loaded",e._onExperimentLoaded),a.default.get("Relay").addEventListener("EuglenaModel.Loaded",e._onModelLoaded),a.default.get("Relay").addEventListener("AppPhase.Change",e._onPhaseChange),a.default.get("Relay").addEventListener("ExperimentCount.Change",e._onExperimentCountChange),a.default.get("Relay").addEventListener("EuglenaModel.directModelComparison",e._onExperimentLoaded),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),r(t,[{key:"init",value:function(){var e=this;return i.default.hook("Panel.Contents",function(t,n){return"result"==n.id&&t.push(e._view),t},10),function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"_onExperimentLoaded",value:function(e){var t=this;if(e.data.directModelComparison);else if(e.data.experiment.id!=this._currentExperiment)if(this._currentExperiment=e.data.experiment.id,"_new"!=e.data.experiment.id){var n=e.data.experiment.copyOfID>0?e.data.experiment.copyOfID:e.data.experiment.id;l.default.getLiveResults(n).then(function(n){a.default.set("currentExperimentResults",n),a.default.set("currentLightData",e.data.experiment.configuration),t._view.handleExperimentResults(e.data.experiment,n),"sequential"===a.default.get("AppConfig.system.expModelModality")?t._view.showVideo(!0):"justmodel"===a.default.get("AppConfig.system.expModelModality")&&t._view.showVideo(!0),a.default.get("directModelComparison")?t._modelCache.forEach(function(e){this._onModelLoaded({data:e})},t):t._modelCache&&null!=t._modelCache[0].model&&t._onModelLoaded({data:t._modelCache[0]})}).catch(function(e){console.log(e)})}else this._view.clear();else"justmodel"===a.default.get("AppConfig.system.expModelModality")&&this._view.showVideo(!1)}},{key:"_onModelLoaded",value:function(e){var t=this;"sequential"==a.default.get("AppConfig.system.expModelModality")?this._view.showVideo(!1):"justmodel"==a.default.get("AppConfig.system.expModelModality")&&this._view.showVideo(!1),"_new"!=e.data.model.id&&a.default.get("currentExperiment")?(e.data.tabId==this._currentModel&&this._lastModelResult["model_"+e.data.tabId]&&this._lastModelResult["model_"+e.data.tabId].euglenaModelId==e.data.model.id&&this._lastModelResult["model_"+e.data.tabId].experimentId==a.default.get("currentExperiment").id||(this._view.handleModelResults(e.data.model,null,e.data.tabId,a.default.get("directModelComparison")),l.default.getModelResults(a.default.get("currentExperiment").id,e.data.model).then(function(n){t._view.handleModelResults(e.data.model,n,e.data.tabId,a.default.get("directModelComparison"))}),this._lastModelResult["model_"+e.data.tabId]={euglenaModelId:e.data.model.id,experimentId:a.default.get("currentExperiment").id},this._currentModel=a.default.get("directModelComparison")?"both":e.data.tabId),this._cacheModel(e.data.model,e.data.tabId)):"_new"!=e.data.model.id?(this._cacheModel(e.data.model,e.data.tabId),this._currentModel=a.default.get("directModelComparison")?"both":e.data.tabId):(this._view.handleModelResults(e.data.model,null,e.data.tabId,a.default.get("directModelComparison")),this._lastModelResult["model_"+e.data.tabId]=null,this._currentModel=null)}},{key:"_cacheModel",value:function(e,t){var n=this;if(e.date_created){var r=!1,i=this._modelCache.findIndex(function(i,o){if(i){if(i.tabId===t)return n._modelCache[o]={tabId:t,model:e},!0;"none"==i.tabId&&(r=!0)}});!a.default.get("directModelComparison")||-1==i&&r?this._modelCache=[{tabId:t,model:e}]:-1==i&&this._modelCache.push({tabId:t,model:e})}else o.default.promiseAjax("/api/v1/EuglenaModels/"+e.id).then(function(e){var r=!1,i=n._modelCache.findIndex(function(i,o){if(i){if(i.tabId===t)return n._modelCache[o]={tabId:t,model:e},!0;"none"==i.tabId&&(r=!0)}});!a.default.get("directModelComparison")||-1==i&&r?n._modelCache=[{tabId:t,model:e}]:-1==i&&n._modelCache.push({tabId:t,model:e})})}},{key:"_onModelResultsRequest",value:function(e){if("none"==e.data.tabId)a.default.get("directModelComparison")&&(a.default.set("directModelComparison",!1),this._view.activateModelComparison()),this._lastModelResult={model_a:null,model_b:null},"sequential"===a.default.get("AppConfig.system.expModelModality")?this._view.showVideo(!0):"justmodel"===a.default.get("AppConfig.system.expModelModality")&&this._view.showVideo(!1),this._view.handleModelResults(null,null,e.data.tabId),a.default.get("Logger").log({type:"model_change",category:"results",data:{tab:e.data.tabId}}),this._modelCache=[{tabId:"none",model:null}];else if("both"==e.data.tabId){a.default.set("directModelComparison",!0),this._view.activateModelComparison(),a.default.get("Relay").dispatchEvent("EuglenaModel.directModelComparison",{directModelComparison:!0});var t=a.default.get("ModelTab.a").currModel(),n=a.default.get("ModelTab.b").currModel();this._lastModelResult={model_a:null,model_b:null};var r={model_a:null,model_b:null};t?(this._onModelLoaded({data:{model:t,tabId:"a"}}),r.model_a=t.id):(this._view.handleModelResults(null,null,"a",!0),this._lastModelResult.model_a=null,"create"!=a.default.get("AppConfig.system.modelModality")&&a.default.get("Relay").dispatchEvent("Model.AutomaticSimulate",{tabId:"a"})),n?(this._onModelLoaded({data:{model:n,tabId:"b"}}),r.model_b=n.id):(this._view.handleModelResults(null,null,"b",!0),this._lastModelResult.model_b=null,"create"!=a.default.get("AppConfig.system.modelModality")&&a.default.get("Relay").dispatchEvent("Model.AutomaticSimulate",{tabId:"b"})),a.default.get("Logger").log({type:"model_change",category:"results",data:{tab:e.data.tabId,modelId:r}})}else{a.default.get("directModelComparison")&&(a.default.set("directModelComparison",!1),this._view.activateModelComparison());var i=a.default.get("ModelTab."+e.data.tabId).currModel();i?(this._onModelLoaded({data:{model:i,tabId:e.data.tabId}}),a.default.get("Logger").log({type:"model_change",category:"results",data:{tab:e.data.tabId,modelId:i.id}})):(this._view.handleModelResults(null,null,e.data.tabId),this._lastModelResult["model_"+e.data.tabId]=null,a.default.get("Logger").log({type:"model_change",category:"results",data:{tab:e.data.tabId,resultId:null}}),"create"!=a.default.get("AppConfig.system.modelModality")&&(console.log("automatic simulate"),a.default.get("Relay").dispatchEvent("Model.AutomaticSimulate",{tabId:e.data.tabId}))),a.default.get("Relay").dispatchEvent("InteractiveTabs.TabRequest",{tabId:"model_"+e.data.tabId})}}},{key:"_onPhaseChange",value:function(e){"login"!=e.data.phase&&"login_attempted"!=e.data.phase||(this._view.reset(),this._view.hide(),this._firstModelSkip={})}},{key:"_onExperimentCountChange",value:function(e){e.data.count&&!e.data.old?this._view.show():e.data.count||this._view.hide()}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=g(n(1)),o=g(n(0)),a=(g(n(2)),g(n(3))),s=g(n(303)),u=g(n(304)),l=g(n(310)),c=g(n(316)),f=g(n(322)),d=g(n(328)),h=g(n(334)),p=g(n(17));function g(e){return e&&e.__esModule?e:{default:e}}n(356);var m={circle:u.default,histogram:l.default,timeseries:c.default,componentspeed:f.default,orientationchange:d.default},v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e||s.default));o.default.bindMethods(n,["_onTick","_onVisualizationChange","_onModelChange","activateModelComparison","_moveTabs"]),n._visualResult=h.default.create(),n._visualResult.addEventListener("VisualResult.Tick",n._onTick),n._graphs=i.default.get("AppConfig.visualization.visualizationTypes").map(function(e){return e.settings.id=e.id,m[e.id].create(e.settings)}),n.addChild(n._visualResult.view(),".results__euglena"),n._graphs.forEach(function(e){n.addChild(e.view(),".results__visualization")}),n.lightConfig=null;var r={};r=i.default.get("AppConfig.system.enableDirectComparison")&&2==i.default.get("AppConfig.model.tabs").length?{none:"No Model",both:"Both Models"}:{none:"No Model"},i.default.get("AppConfig.model.tabs").forEach(function(e,t){var n=1==i.default.get("AppConfig.model.tabs.length")?"":String.fromCharCode(97+t);r[n]="Model "+n.toUpperCase()}),n._modelSelect=p.default.create({id:"model",label:"Model",options:r,initialValue:"none",description:"Turn models on or off."}),n._modelSelect.setValue("none"),i.default.get("AppConfig.model.tabs").length&&(n.addChild(n._modelSelect.view(),".results__controls__model"),n._modelSelect.addEventListener("Field.Change",n._onModelChange)),i.default.get("AppConfig.system.enableDirectComparison")&&(n._visualResult_2=h.default.create(),n._visualResult_2.hideControls(),n.$el.find(".results__visuals").append('<div class="results__euglena_2">\n      <h2 class="results__title">View of Microscope and Model B</h2></div>'),n.addChild(n._visualResult_2.view(),".results__euglena_2"),n.$el.find(".results__euglena_2").hide());var a={};return i.default.get("AppConfig.visualization.visualizationTypes").forEach(function(e){a[e.id]=e.label}),n._visSelect=p.default.create({id:"visualization",label:"Visualization",options:a,description:"Each visualization shows different aspects of how the Euglena or models behave."}),Object.keys(a).length?(n.addChild(n._visSelect.view(),".results__controls__visualization"),n._visSelect.addEventListener("Field.Change",n._onVisualizationChange),n._onVisualizationChange({currentTarget:n._visSelect})):n.$el.find(".results__visualization").hide(),n.$el.find("#moveTabs").click(n._moveTabs),i.default.get("Relay").addEventListener("EuglenaModel.directComparison",n.activateModelComparison),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_moveTabs",value:function(){if(this.$el.find("#moveTabs").hasClass("notflippedX")){var e=!0;this.$el.find("#moveTabs").removeClass("notflippedX"),this.$el.find("#moveTabs").addClass("flippedX")}else{e=!1;this.$el.find("#moveTabs").removeClass("flippedX"),this.$el.find("#moveTabs").addClass("notflippedX")}i.default.get("Relay").dispatchEvent("InteractiveTabs.Toggle",{hideTab:e})}},{key:"_onTick",value:function(e){this._graphs&&this._graphs.forEach(function(t){t.update(e.data.time,e.data.lights)})}},{key:"handleExperimentResults",value:function(e,t){var n=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.lightConfig=e.configuration,this.$el.find(".results__controls__experiment").html('<label>Experiment:</label><span class="">'+new Date(e.date_created).toLocaleString()+"</span>"),this.$el.find(".results__visualization").is(":visible")&&this._graphs.forEach(function(e){e.reset(),e.handleData(t,"live",n.lightConfig),e.handleData(null,"model",n.lightConfig)}),this._visualResult.handleLightData(e.configuration),this._visualResult.play(t),i.default.get("AppConfig.system.enableDirectComparison")&&(this._visualResult_2.handleLightData(e.configuration),this._visualResult_2.play(t))}},{key:"handleModelResults",value:function(e,t,n){var r=this;if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]){this._graphs.forEach(function(e){e.handleData(null,"model",r.lightConfig)});var o=i.default.get("ModelTab."+n).color();"a"==n?this._visualResult.handleModelData(t,e,o):"b"==n&&this._visualResult_2.handleModelData(t,e,o)}else{var a=0;if("none"!=n)if(e.sensorConfigJSON){var s=0;Object.keys(JSON.parse(e.sensorConfigJSON)).forEach(function(e){e.toLowerCase().match("sensor")&&(s+=1)}),a=2==s?16318490:i.default.get("ModelTab."+n).color()}else a=i.default.get("ModelTab."+n).color();this._graphs.forEach(function(e){"sequential"===i.default.get("AppConfig.system.expModelModality")?"none"==n?(e.setLive(!0),e.handleData(null,"model",r.lightConfig)):(e.setLive(!1),e.handleData(t,"model",r.lightConfig,a)):"justmodel"===i.default.get("AppConfig.system.expModelModality")?"none"==n?(e.setLive(!1),e.handleData(null,"model",r.lightConfig)):(e.setLive(!1),e.handleData(t,"model",r.lightConfig,a)):e.handleData(t,"model",r.lightConfig,a)}),this._visualResult.handleModelData(t,e,a),i.default.get("Relay").dispatchEvent("VisualResult.ResetRequest",{}),n!=this._modelSelect.value()&&(this._silenceModelSelect=!0,this._modelSelect.setValue(n).then(function(){r._silenceModelSelect=!1}))}}},{key:"clear",value:function(){this.$el.find(".results__controls__experiment").html('<label>Experiment:</label><span class="">(New Experiment)</span>'),this._visualResult.clear(),this._graphs.forEach(function(e){e.reset()})}},{key:"showVideo",value:function(e){this._visualResult.dispatchEvent("VideoResult.ShowVideo",{showVideo:e}),i.default.get("AppConfig.system.enableDirectComparison")&&this._visualResult_2.dispatchEvent("VideoResult.ShowVideo",{showVideo:e})}},{key:"_onVisualizationChange",value:function(e){this._graphs.forEach(function(t){t.id()==e.currentTarget.value()?t.view().show():t.view().hide()}),i.default.get("Logger").log({type:"visualization_change",category:"results",data:{visualization:e.currentTarget.value()}})}},{key:"_onModelChange",value:function(e){this._silenceModelSelect||this.dispatchEvent("ResultsView.RequestModelData",{tabId:e.currentTarget.value()})}},{key:"activateModelComparison",value:function(){i.default.get("directModelComparison")?(this.$el.find(".results__visualization").hide(),this._visSelect.hide(),this.$el.find(".results__euglena").children(".results__title").html("View of Microscope and Model A"),this.$el.find(".results__euglena_2").show()):(this.$el.find(".results__euglena").children(".results__title").html("View of Microscope"),this.$el.find(".results__euglena_2").hide(),Object.keys(this._visSelect._model._data.options).length&&(this.$el.find(".results__visualization").show(),this._visSelect.show()))}},{key:"reset",value:function(){this.clear(),this._modelSelect.setValue("none"),this._visSelect.setValue(this._visSelect.getAbleOptions()[0])}}]),t}();t.default=v},function(e,t,n){"use strict";n.r(t),t.default='<div class="results">\n  <div class="results__controls">\n    <div class="results__controls__experiment"></div>\n    <div class="results__controls__model"></div>\n    <div class="results__controls__visualization"></div>\n  </div>\n  <div class="results__visuals">\n    <img id=\'moveTabs\' class = \'notflippedX\' src="/cslib/module/euglena/result/arrow.png">\n    <div class="results__euglena">\n      <h2 class="results__title">View of Microscope</h2>\n    </div>\n    <div class="results__visualization">\n      <h2 class="results__title">Visualizations of the Video Data</h2>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(7)),o=s(n(305)),a=s(n(306));s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"handleData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=(arguments[2],arguments[3]);this._model.parseData(e,t,n)}},{key:"setLive",value:function(e){this._model.setLayerLive(e)}},{key:"update",value:function(e,t){this._model.update(e,t)}},{key:"reset",value:function(){this._model.reset()}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(6)),o=a(n(0));a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}var s={binCount:24,dT:1,tStep:1,data:{},histogram:{},meanTheta:0,width:200,height:200,margins:{top:30,right:30,bottom:30,left:30}},u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"parseData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments[2];if(null==e)return this.set("data."+t,null),this.set("histogram."+t,null),void this.set("meanTheta."+t,null);var r,i=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,d=void 0;for(i=[],a=0;a<e.runTime;a+=this.get("tStep")){for(u={timeStart:a,timeEnd:Math.min(a+this.get("tStep"),e.runTime),sampleStart:Math.min(a+this.get("tStep"),e.runTime)-this.get("dT"),sampleEnd:Math.min(a+this.get("tStep"),e.runTime),bins:[]},s=0;s<this.get("binCount");s++)u.bins.push({thetaStart:s*o.default.TAU/this.get("binCount"),thetaEnd:(s+1)*o.default.TAU/this.get("binCount"),frequency:0});i.push(u)}var h=!0,p=!1,g=void 0;try{for(var m,v=e.tracks[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){l=m.value;var y=!0,_=!1,b=void 0;try{for(var w,x=l.samples[Symbol.iterator]();!(y=(w=x.next()).done);y=!0){c=w.value,d=Math.floor(this.get("binCount")*o.default.posMod(c.angleXY,o.default.TAU)/o.default.TAU);var E=!0,M=!1,C=void 0;try{for(var T,S=i[Symbol.iterator]();!(E=(T=S.next()).done);E=!0)(f=T.value).sampleStart<=c.time&&f.sampleEnd>c.time&&(f.bins[d].frequency+=1)}catch(e){M=!0,C=e}finally{try{!E&&S.return&&S.return()}finally{if(M)throw C}}}}catch(e){_=!0,b=e}finally{try{!y&&x.return&&x.return()}finally{if(_)throw b}}}}catch(e){p=!0,g=e}finally{try{!h&&v.return&&v.return()}finally{if(p)throw g}}var O=!0,k=!1,A=void 0;try{for(var P,R=i[Symbol.iterator]();!(O=(P=R.next()).done);O=!0){var L=(f=P.value).bins.reduce(function(e,t){return e+t.frequency},0),j=f.bins.reduce(function(e,t){return e+(t.thetaEnd+t.thetaStart)/2*t.frequency},0)/L;f.meanTheta=isNaN(j)?0:j}}catch(e){k=!0,A=e}finally{try{!O&&R.return&&R.return()}finally{if(k)throw A}}r=i.reduce(function(e,t){return Math.max(e,t.bins.reduce(function(e,t){return Math.max(e,t.frequency)},0))},0),this.set("data."+t,{intervals:i,maxBinValue:r,color:n,showLayer:!0})}},{key:"update",value:function(e,t){if(Object.keys(this.get("data")).length){for(var n in this.get("data"))if(this.get("data."+n+".intervals")){var r=!0,i=!1,o=void 0;try{for(var a,s=this.get("data."+n+".intervals")[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.timeStart<=e&&u.timeEnd>e){this.set("histogram."+n,u.bins),this.set("meanTheta."+n,u.meanTheta);break}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}this.set("lights",t)}}},{key:"setLayerLive",value:function(e){this.set("data.live.showLayer",e)}},{key:"reset",value:function(){this.set("data",{})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(3)),o=l(n(0)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(19)),s=l(n(307)),u=l(n(34));function l(e){return e&&e.__esModule?e:{default:e}}n(308);var c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||s.default));o.default.bindMethods(r,["_onModelChange"]),r._lightDisplay=u.default.create({width:e.get("width")+e.get("margins.left")+e.get("margins.right"),height:e.get("height")+e.get("margins.top")+e.get("margins.bottom")}),r._lightDisplay.render({top:0,left:0,right:0,bottom:0}),r.addChild(r._lightDisplay.view(),".circle-graph__lights"),e.addEventListener("Model.Change",r._onModelChange);var i=a.select(r.$el.find(".circle-graph__graph").get(0)).append("svg");return i.attr("width",e.get("width")+e.get("margins.left")+e.get("margins.right")),i.attr("height",e.get("height")+e.get("margins.top")+e.get("margins.bottom")),r.svg=i.append("g"),r.svg.attr("transform","translate("+(e.get("margins.left")+e.get("width")/2)+","+(e.get("margins.top")+e.get("height")/2)+")"),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){e.data.path.match(/^histogram/)?this.render(e.currentTarget):"lights"==e.data.path?this._lightDisplay.render(e.data.value):e.data.path.match(/^data/)&&(e.currentTarget.get("data")=={}?this.reset():(this.reset(),this.setup(e.currentTarget)))}},{key:"setup",value:function(e){var t=this,n=e.get("width");this.arcs=this.arcs||{};var r=function(r){var i=e.get("data."+r+".maxBinValue");t.arcs[r]=a.arc().outerRadius(function(e){return Math.max(.1,n*e.data.frequency/(2*i))}).innerRadius(0)};for(var i in e.get("data"))r(i);this.pie=a.pie().value(function(e){return 1}).sort(function(e,t){return t.thetaStart-e.thetaStart})}},{key:"render",value:function(e){for(var t in e.get("histogram"))if(e.get("data."+t+".showLayer")){var n=e.get("histogram."+t),r=this.svg.selectAll(".circle-graph__slice__"+t).data(this.pie(n)),i=e.get("data."+t+".color");r.enter().append("path").attr("style",i?"fill: #"+i.toString(16):null).attr("class","circle-graph__slice circle-graph__slice__"+t).attr("transform","rotate(90)").merge(r).transition().ease(function(e){return e}).duration(500*e.get("tStep")).attr("d",this.arcs[t]),r.exit().remove();n.reduce(function(e,t){return e+t.frequency},0);this.$el.find(".circle-graph__meta").html("The size of each slice shows the proportion of all Euglena moving in the corresponding direction.")}}},{key:"reset",value:function(){this.svg.selectAll(".circle-graph__slice").remove(),this.$el.find(".circle-graph__meta span").html(""),this._lightDisplay.render({top:0,bottom:0,left:0,right:0})}}]),t}();t.default=c},function(e,t,n){"use strict";n.r(t),t.default='<div class="circle-graph">\n  <div class="circle-graph__lights"></div>\n  <div class="circle-graph__graph"></div>\n  <div class="circle-graph__meta"><span class="circle-graph__meta__live"></span><span class="circle-graph__meta__model"></span></div>\n</div>'},function(e,t,n){var r=n(309);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".circle-graph {\n  max-width: 430px;\n  border: 1px solid #282828;\n  text-align: center;\n  padding: 2rem;\n  display: inline-block;\n  vertical-align: top;\n  margin: 5rem;\n  position: relative; }\n  .circle-graph__title {\n    text-align: center;\n    text-anchor: middle; }\n  .circle-graph__slice {\n    fill: #d9d9d9;\n    stroke: #282828;\n    stroke-width: 1;\n    opacity: 0.5; }\n  .circle-graph__line {\n    fill: none;\n    stroke-width: 5;\n    opacity: 0.9;\n    stroke: #939393; }\n  .circle-graph__meta {\n    border-top: 1px solid #282828;\n    margin-top: 0.5rem;\n    padding-top: 0.5rem; }\n    .circle-graph__meta span {\n      display: inline-block;\n      padding: 0 1rem;\n      border-left: 1px solid #282828; }\n      .circle-graph__meta span:first-child {\n        border-left: none; }\n    .circle-graph__meta__model {\n      color: #2222ff; }\n  .circle-graph__graph {\n    position: relative;\n    margin-bottom: 2rem; }\n  .circle-graph__lights {\n    position: absolute;\n    top: 0;\n    left: 0;\n    margin: -1rem; }\n    .circle-graph__lights .light-display__content {\n      background: #f9f9f9; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(7)),o=s(n(311)),a=s(n(312));s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"handleData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments[2];this._model.parseData(e,t,n)}},{key:"setLive",value:function(e){this._model.setLayerLive(e)}},{key:"update",value:function(e){this._model.update(e)}},{key:"reset",value:function(){this._model.reset()}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(6)),o=s(n(0)),a=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var u={binCount:20,vRange:200,mode:"total",dT:1,tStep:2,width:200,height:200,data:{},raw:{},margins:{top:20,right:20,bottom:40,left:40}},l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"parseData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments[2];this.set("raw."+n,e);var i=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,d=void 0,h=void 0,p=void 0,g=void 0,m=void 0;for(var v in p=a.default.get("AppConfig.histogram.vRange")?this.get("vRange"):Object.values(this.get("raw")).reduce(function(e,n){return Math.max(e,n.tracks.reduce(function(e,n){return Math.max(e,n.samples.filter(function(e){return o.default.exists(e.speed)}).reduce(function(e,n){return Math.max(e,"component"==t.get("mode")?Math.max(Math.abs(n.speedX),Math.abs(n.speedY)):n.speed)},0))},0))},0),p=Math.ceil(p),g={},this.get("raw")){for(m=this.get("raw."+v),i=[],s=0;s<m.runTime;s+=this.get("tStep")){c={timeStart:s,timeEnd:Math.min(s+this.get("tStep"),m.runTime),sampleStart:Math.min(s+this.get("tStep"),m.runTime)-this.get("dT"),sampleEnd:Math.min(s+this.get("tStep"),m.runTime),bins:{}};var y=0;for("component"==this.get("mode")?(c.bins.x=[],c.bins.y=[],y=2*p/this.get("binCount")):(c.bins.total=[],y=p/this.get("binCount")),u=0;u<this.get("binCount");u++)for(l in c.bins)"component"==this.get("mode")?c.bins[l].push({vStart:u*y-p,vEnd:(u+1)*y-p,frequency:0}):c.bins[l].push({vStart:u*y,vEnd:(u+1)*y,frequency:0});i.push(c)}var _=!0,b=!1,w=void 0;try{for(var x,E=m.tracks[Symbol.iterator]();!(_=(x=E.next()).done);_=!0){f=x.value;var M=!0,C=!1,T=void 0;try{for(var S,O=f.samples[Symbol.iterator]();!(M=(S=O.next()).done);M=!0)if((d=S.value).speed){if("component"==this.get("mode")){if(Math.abs(d.speedX)>p||Math.abs(d.speedY)>p)continue}else if(Math.abs(d.speed)>p)continue;var k=!0,A=!1,P=void 0;try{for(var R,L=i[Symbol.iterator]();!(k=(R=L.next()).done);k=!0)if((h=R.value).sampleStart<=d.time&&h.sampleEnd>d.time)if("component"==this.get("mode")){var j=Math.floor((d.speedX+p)/(2*p)*this.get("binCount")),D=Math.floor((d.speedY+p)/(2*p)*this.get("binCount"));h.bins.x[j].frequency+=1,h.bins.y[D].frequency+=1}else{var N=Math.floor(this.get("binCount")*d.speed/p);h.bins.total[N].frequency+=1}}catch(e){A=!0,P=e}finally{try{!k&&L.return&&L.return()}finally{if(A)throw P}}}}catch(e){C=!0,T=e}finally{try{!M&&O.return&&O.return()}finally{if(C)throw T}}}}catch(e){b=!0,w=e}finally{try{!_&&E.return&&E.return()}finally{if(b)throw w}}i.forEach(function(e){var t=Object.values(e.bins).reduce(function(e,t){return e+t.reduce(function(e,t){return e+t.frequency},0)},0);Object.values(e.bins).forEach(function(e){e.forEach(function(e){e.value=0==t?0:e.frequency/t})})}),g[v]={intervals:i,color:n==v?r:null,showLayer:v==n||this.get("data."+v+".showLayer")}}this.set("data",g)}},{key:"setLayerLive",value:function(e){this.set("data.live.showLayer",e)}},{key:"reset",value:function(){this.set("data",{})}},{key:"update",value:function(e){if(this.get("data")){var t={};for(var n in this.get("data")){var r=!0,i=!1,o=void 0;try{for(var a,s=this.get("data."+n+".intervals")[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.timeStart<=e&&u.timeEnd>e){t[n]=u.bins;break}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}this.set("histogram",t)}}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(3)),o=u(n(0)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(19)),s=u(n(313));function u(e){return e&&e.__esModule?e:{default:e}}n(314);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||s.default));for(var i in o.default.bindMethods(r,["_onModelChange"]),e.addEventListener("Model.Change",r._onModelChange),"component"==e.get("mode")?r.svgs={x:null,y:null}:r.svgs={total:null},r.svgs){var u=a.select(r.$el.find(".histogram__graph").get(0)).append("svg");u.classed("histogram__graph__"+i,!0),u.attr("width",e.get("width")+e.get("margins.left")+e.get("margins.right")),u.attr("height",e.get("height")+e.get("margins.top")+e.get("margins.bottom")),r.svgs[i]=u.append("g").attr("transform","translate("+e.get("margins.left")+", "+e.get("margins.top")+")")}return r.scales={},r.scales.x=a.scaleBand().range([0,e.get("width")]).padding(.1),r.scales.y=a.scaleLinear().range([e.get("height"),0]),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){"data"==e.data.path?this.setup(e.currentTarget):e.data.path.match(/^histogram/)&&this.render(e.currentTarget)}},{key:"setup",value:function(e){if(Object.values(e.get("data")).length){this.reset();var t=Object.values(e.get("data"))[0].intervals[0].bins;for(var n in t="component"==e.get("mode")?t.x:t.total,this.scales.x.domain(t.map(function(e){return Math.round((e.vStart+e.vEnd)/2)})),this.scales.y.domain([0,100]),this.axes={x:a.axisBottom().scale(this.scales.x),y:a.axisLeft().scale(this.scales.y).ticks(5)},this.svgs)this.svgs[n].select(".histogram__graph__axis").remove(),this.svgs[n].append("g").attr("class","histogram__graph__axis histogram__graph__axis-x").attr("transform","translate(0, "+e.get("height")+")").call(this.axes.x).append("text").attr("class","histogram__graph__axis-label").text("Speed ("+n+")").attr("x",e.get("width")/2).attr("y",30),this.svgs[n].append("g").attr("class","histogram__graph__axis histogram__graph__axis-y").call(this.axes.y).append("text").attr("class","histogram__graph__axis-label").text("Frequency (% total)").attr("y",-30).attr("x",-e.get("height")/2).attr("transform","rotate(-90)")}else this.reset()}},{key:"render",value:function(e){var t=this,n=0;for(var r in e.get("histogram"))if(e.get("data."+r+".showLayer")){for(var i in e.get("histogram."+r)){var o=e.get("histogram."+r+"."+i),s=this.svgs[i].selectAll(".histogram__bar__"+r).data(o),u=e.get("data."+r+".color");s.enter().append("rect").attr("class","histogram__bar histogram__bar__"+r).attr("x",function(e,n){return t.scales.x(Math.round((e.vStart+e.vEnd)/2))}).attr("width",this.scales.x.bandwidth()).attr("y",this.scales.y(0)).attr("style",u?"fill: #"+u.toString(16):null).merge(s).transition().ease(a.easeLinear).attr("y",function(e){return t.scales.y(100*e.value)}).attr("height",function(n){return e.get("height")-t.scales.y(100*n.value)}),s.exit().remove(),n=o.reduce(function(e,t){return e+t.frequency},0)}this.$el.find(".histogram__meta__"+r).html(n+" samples")}}},{key:"reset",value:function(){for(var e in this.svgs)this.svgs[e].selectAll(".histogram__graph__axis").remove(),this.svgs[e].selectAll(".histogram__bar").remove();this.$el.find(".histogram__meta span").html("")}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="histogram">\n  <div class="histogram__graph"></div>\n  <div class="histogram__meta"><span class="histogram__meta__live"></span><span class="histogram__meta__model"></span></div>\n</div>'},function(e,t,n){var r=n(315);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".histogram {\n  border: 1px solid #282828;\n  text-align: center;\n  padding: 0.5rem;\n  display: inline-block;\n  margin: 1rem; }\n  .histogram__bar {\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    opacity: 0.5;\n    fill: #d9d9d9;\n    stroke: #282828; }\n  .histogram__graph__axis-x .domain {\n    display: none; }\n  .histogram__graph__axis-label {\n    fill: #282828;\n    text-anchor: middle;\n    font-weight: bold; }\n  .histogram__meta {\n    border-top: 1px solid #282828;\n    margin-top: 0.5rem;\n    padding-top: 0.5rem; }\n    .histogram__meta span {\n      display: inline-block;\n      padding: 0 1rem;\n      border-left: 1px solid #282828; }\n      .histogram__meta span:first-child {\n        border-left: none; }\n    .histogram__meta__model {\n      color: #2222ff; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(7)),o=s(n(317)),a=s(n(318));s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"handleData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments[2],r=arguments[3];this._model.parseData(e,t,n,r)}},{key:"setLive",value:function(e){this._model.setLayerLive(e)}},{key:"update",value:function(e){this.view().update(e,this._model)}},{key:"reset",value:function(){this._model.reset()}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(6)),o=s(n(0)),a=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var u={vRange:null,mode:"total",stdBand:!0,dT:1,width:400,height:300,data:{},raw:{},margins:{top:40,left:40,bottom:40,right:20}},l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"parseData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=this,r=arguments[2],i=arguments[3];if(this.set("raw."+t,e),r){var s=0,u=function(e){var t=[0,0];for(var n in e)switch(n){case"left":t[0]+=e[n];break;case"right":t[0]+=-e[n];break;case"top":t[1]+=e[n];break;case"bottom":t[1]+=-e[n]}var r=Math.sqrt(t[0]*t[0]+t[1]*t[1]);r=0===r?1:r,t=t.map(function(e){return e/r}),e.lightDir=t,e.timeStart=s,e.timeEnd=s+e.duration,s+=e.duration},l=!0,c=!1,f=void 0;try{for(var d,h=r[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){u(d.value)}}catch(e){c=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(c)throw f}}}this.set("lightConfig",r);var p=a.default.get("AppConfig.histogram.vRange")?this.get("vRange"):Object.values(this.get("raw")).reduce(function(e,t){return Math.max(e,t.tracks.reduce(function(e,t){return Math.max(e,t.samples.filter(function(e){return o.default.exists(e.speed)}).reduce(function(e,t){return Math.max(e,"component"==n.get("mode")?Math.max(Math.abs(t.speedX),Math.abs(t.speedY)):t.speed)},0))},0))},0);p=Math.ceil(p);var g={};for(var m in this.get("raw")){var v=this.get("raw."+m),y={};"component"==this.get("mode")?(y.x=[],y.y=[]):y.total=[];for(var _=0;_<v.numFrames;_++)for(var b in y)y[b].push({frame:_,time:_/v.fps,samples:[],mean:null,s:null});var w=!0,x=!1,E=void 0;try{for(var M,C=v.tracks[Symbol.iterator]();!(w=(M=C.next()).done);w=!0){var T=M.value,S=!0,O=!1,k=void 0;try{for(var A,P=T.samples[Symbol.iterator]();!(S=(A=P.next()).done);S=!0){var R=A.value;if(R.speed){if("component"==this.get("mode")){if(Math.abs(R.speedX)>p||Math.abs(R.speedY)>p)continue}else if(Math.abs(R.speed)>p)continue;var L=Math.round(R.time*v.fps);"component"==this.get("mode")?(y.x[L-1].samples.push(R.speedX),y.y[L-1].samples.push(R.speedY)):y.total[L-1].samples.push(R.speed)}}}catch(e){O=!0,k=e}finally{try{!S&&P.return&&P.return()}finally{if(O)throw k}}}}catch(e){x=!0,E=e}finally{try{!w&&C.return&&C.return()}finally{if(x)throw E}}var j=0;for(var D in y){var N=function(e){e.samples.length&&(e.mean=e.samples.reduce(function(e,t){return e+t},0)/e.samples.length,e.s=Math.sqrt(e.samples.map(function(t){return Math.pow(t-e.mean,2)}).reduce(function(e,t){return e+t},0)/e.samples.length),j=Math.max(j,Math.max(Math.abs(e.mean+e.s),Math.abs(e.mean-e.s))))},I=!0,F=!1,B=void 0;try{for(var U,z=y[D][Symbol.iterator]();!(I=(U=z.next()).done);I=!0){N(U.value)}}catch(e){F=!0,B=e}finally{try{!I&&z.return&&z.return()}finally{if(F)throw B}}}g[m]={graphs:y,maxValue:j,runTime:v.runTime,color:m==t?i:null,showLayer:m==t||this.get("data."+m+".showLayer")}}this.set("data",g)}},{key:"setLayerLive",value:function(e){this.set("data.live.showLayer",e)}},{key:"reset",value:function(){this.set("data",{})}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(3)),o=u(n(0)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(19)),s=u(n(319));function u(e){return e&&e.__esModule?e:{default:e}}n(320);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||s.default));for(var i in o.default.bindMethods(r,["_onModelChange"]),e.addEventListener("Model.Change",r._onModelChange),"component"==e.get("mode")?r.svgs={x:null,y:null}:r.svgs={total:null},r.svgs){var u=a.select(r.$el.find(".time-series__graph").get(0)).append("svg");u.classed("time-series__graph__"+i,!0),u.attr("width",e.get("width")+e.get("margins.left")+e.get("margins.right")),u.attr("height",e.get("height")+e.get("margins.top")+e.get("margins.bottom")),r.svgs[i]=u.append("g").attr("transform","translate("+e.get("margins.left")+", "+e.get("margins.top")+")")}return r.scales={},r.scales.x=a.scaleLinear().range([0,e.get("width")]),r.scales.y=a.scaleLinear().range([e.get("height"),0]),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){switch(e.data.path){case"data":e.data.value?(this.reset(),this.setup(e.currentTarget)):this.reset()}}},{key:"setup",value:function(e){var t=this;this.scales.x.domain([0,Object.values(e.get("data")).reduce(function(e,t){return Math.max(e,t.runTime)},0)]);var n=Object.values(e.get("data")).reduce(function(e,t){return Math.max(e,t.maxValue)},0);for(var r in this.scales.y.domain(["component"==e.get("mode")?-n:0,n]),this.axes={x:a.axisBottom().scale(this.scales.x),y:a.axisLeft().scale(this.scales.y)},this.bgs={},this.svgs){for(var i in this.svgs[r].selectAll("*").remove(),this.svgs[r].select(".time-series__graph__axis").remove(),this.svgs[r].append("g").attr("class","time-series__graph__axis time-series__graph__axis-x").attr("transform","translate(0, "+e.get("height")+")").call(this.axes.x).append("text").attr("class","time-series__graph__axis-label").text("Time [seconds]").attr("x",e.get("width")/2).attr("y",30),this.svgs[r].append("g").attr("class","time-series__graph__axis time-series__graph__axis-y").call(this.axes.y).append("text").attr("class","time-series__graph__axis-label").text("Avg Speed [micrometers / second]").attr("transform","rotate(-90)").attr("y",-30).attr("x",-e.get("height")/2),this.svgs[r].append("g").append("text").attr("class","component-speed__graph__title").text("Average forward speed (distance covered per second)").attr("y",-10).attr("x",e.get("width")/2),this.bgs[r]=this.svgs[r].append("g").attr("class","time-series__graph__background"),e.get("data"))if(e.get("data."+i+".showLayer")){var o=e.get("data."+i+".graphs."+r).filter(function(e){return e.mean}),s=e.get("data."+i+".color");if(e.get("stdBand")){var u=a.area().x(function(e){return t.scales.x(e.time)}).y0(function(e){return t.scales.y(e.mean-e.s)}).y1(function(e){return t.scales.y(e.mean+e.s)});this.svgs[r].append("path").datum(o).attr("class","time-series__graph__std time-series__graph__std__"+i).attr("style",s?"fill: #"+s.toString(16):null).attr("d",u)}var l=a.line().x(function(e){return t.scales.x(e.time)}).y(function(e){return t.scales.y(e.mean)});this.svgs[r].append("path").datum(o).attr("class","time-series__graph__line time-series__graph__line__"+i).attr("style",s?"stroke: #"+s.toString(16):null).attr("d",l)}if(e.get("lightConfig")&&Object.keys(e.get("data")).length){this.svgs[r].append("svg:defs").append("svg:marker").attr("id","arrow__light").attr("refX",0).attr("refY",2).attr("markerWidth",4).attr("markerHeight",4).attr("orient","auto").append("svg:path").attr("d","M0,0 L0,4 L4,2 z").style("fill","rgb(235,160,17)");var c=e.get("lightConfig").reduce(function(e,t){return Math.max(e,t.timeEnd)},0),f=!0,d=!1,h=void 0;try{for(var p,g=e.get("lightConfig")[Symbol.iterator]();!(f=(p=g.next()).done);f=!0){var m=p.value;if(0!=m.timeStart&&this.svgs[r].append("line").attr("class","component-speed__graph__light-time").attr("x1",m.timeStart*e.get("width")/c).attr("y1",e.get("height")).attr("x2",m.timeStart*e.get("width")/c).attr("y2",0).attr("stroke-width",2),0!=m.lightDir[0]||0!=m.lightDir[1]){this.svgs[r].append("line").attr("class","component-speed__graph__light-arrow").attr("x1",(m.timeEnd+m.timeStart)/2*e.get("width")/c+20).attr("y1",10).attr("x2",(m.timeEnd+m.timeStart)/2*e.get("width")/c+10*m.lightDir[0]+20).attr("y2",10+10*m.lightDir[1]).attr("stroke-width",2).attr("marker-end","url(#arrow__light)");var v=Math.sqrt(Math.pow(m.left,2)+Math.pow(m.right,2)+Math.pow(m.top,2)+Math.pow(m.bottom,2));v=Math.round(v),this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text(v+"% in ").attr("y",15).attr("x",(m.timeEnd+m.timeStart)/2*e.get("width")/c-20)}else 0!=m.left&&0!=m.right&&0!=m.top&&0!=m.bottom?this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text(m.left+"% from all dir.").attr("y",15).attr("x",(m.timeEnd+m.timeStart)/2*e.get("width")/c):0!=m.left&&0!=m.right&&0==m.top&&0==m.bottom?this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text(m.left+"% from left-right").attr("y",15).attr("x",(m.timeEnd+m.timeStart)/2*e.get("width")/c):0==m.left&&0==m.right&&0!=m.top&&0!=m.bottom?this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text(m.top+"% from top-bottom").attr("y",15).attr("x",(m.timeEnd+m.timeStart)/2*e.get("width")/c):this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text("no light").attr("y",15).attr("x",(m.timeEnd+m.timeStart)/2*e.get("width")/c)}}catch(e){d=!0,h=e}finally{try{!f&&g.return&&g.return()}finally{if(d)throw h}}}}}},{key:"update",value:function(e,t){var n=this,r=Object.values(t.get("data")).reduce(function(e,t){return Math.max(e,t.runTime)},0);for(var i in this.svgs){var o=this.bgs[i].selectAll(".time-series__graph__time-band").data([e]);o.enter().append("rect").attr("class","time-series__graph__time-band").attr("y",0).attr("height",t.get("height")).merge(o).transition().duration(0).attr("x",function(e){return n.scales.x(Math.min(r,Math.max(0,e-t.get("dT")/2)))}).attr("width",function(e){return n.scales.x(t.get("dT")+Math.min(0,e-t.get("dT")/2)+Math.min(0,r-e-t.get("dT")/2))}),o.exit().remove()}}},{key:"reset",value:function(){for(var e in this.svgs)this.svgs[e].selectAll(".time-series__graph__axis").remove(),this.svgs[e].selectAll(".time-series__graph__time-band").remove(),this.svgs[e].selectAll(".time-series__graph__std").remove(),this.svgs[e].selectAll(".time-series__graph__line").remove()}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="time-series">\n  <div class="time-series__graph"></div>\n</div>'},function(e,t,n){var r=n(321);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".time-series {\n  border: 1px solid #282828;\n  text-align: center;\n  padding: 0.5rem;\n  display: inline-block;\n  margin: 1rem; }\n  .time-series__graph__line {\n    fill: none;\n    stroke-width: 1;\n    opacity: 0.75;\n    stroke: #939393; }\n  .time-series__graph__std {\n    opacity: 0.5; }\n    .time-series__graph__std__live {\n      fill: #939393; }\n    .time-series__graph__std__model {\n      fill: #2222ff; }\n  .time-series__graph__time-band {\n    fill: #939393; }\n  .time-series__graph__light-time, .time-series__graph__light-arrow {\n    stroke: #eba011;\n    fill: #eba011; }\n  .time-series__graph__light-label {\n    fill: #eba011;\n    font-size: 10px;\n    text-anchor: middle;\n    width: 50px; }\n  .time-series__graph__axis-label {\n    fill: #282828;\n    text-anchor: middle;\n    font-weight: bold; }\n  .time-series__graph__title {\n    text-align: center;\n    text-anchor: middle; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(7)),o=s(n(323)),a=s(n(324));s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"handleData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments[2],r=arguments[3];this._model.parseData(e,t,n,r)}},{key:"setLive",value:function(e){this._model.setLayerLive(e)}},{key:"update",value:function(e){this.view().update(e,this._model)}},{key:"reset",value:function(){this._model.reset()}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(6)),o=s(n(0)),a=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var u={vRange:null,mode:"total",stdBand:!0,dT:1,width:400,height:300,data:{},raw:{},margins:{top:40,left:40,bottom:40,right:20}},l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"parseData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=this,r=arguments[2],i=arguments[3];if(this.set("raw."+t,e),r){var s=0,u=function(e){var t=[0,0];for(var n in e)switch(n){case"left":t[0]+=e[n];break;case"right":t[0]+=-e[n];break;case"top":t[1]+=e[n];break;case"bottom":t[1]+=-e[n]}var r=Math.sqrt(t[0]*t[0]+t[1]*t[1]);r=0===r?1:r,t=t.map(function(e){return e/r}),e.lightDir=t,e.timeStart=s,e.timeEnd=s+e.duration,s+=e.duration},l=!0,c=!1,f=void 0;try{for(var d,h=r[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){u(d.value)}}catch(e){c=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(c)throw f}}}this.set("lightConfig",r);var p=a.default.get("AppConfig.histogram.vRange")?this.get("vRange"):Object.values(this.get("raw")).reduce(function(e,t){return Math.max(e,t.tracks.reduce(function(e,t){return Math.max(e,t.samples.filter(function(e){return o.default.exists(e.speed)}).reduce(function(e,t){return Math.max(e,"component"==n.get("mode")?Math.max(Math.abs(t.speedX),Math.abs(t.speedY)):t.speed)},0))},0))},0);p=Math.ceil(p);var g={};for(var m in this.get("raw")){var v=this.get("raw."+m),y={};"component"==this.get("mode")?(y.x=[],y.y=[]):y.total=[];for(var _=0;_<v.numFrames;_++)for(var b in y)y[b].push({frame:_,time:_/v.fps,samples:[],mean:null,s:null});var w=!0,x=!1,E=void 0;try{for(var M,C=v.tracks[Symbol.iterator]();!(w=(M=C.next()).done);w=!0){var T=M.value,S=!0,O=!1,k=void 0;try{for(var A,P=T.samples[Symbol.iterator]();!(S=(A=P.next()).done);S=!0){var R=A.value;if(R.speed){if("component"==this.get("mode")){if(Math.abs(R.speedX)>p||Math.abs(R.speedY)>p)continue}else if(Math.abs(R.speed)>p)continue;var L=Math.round(R.time*v.fps);"component"==this.get("mode")?(y.x[L-1].samples.push(R.speedX),y.y[L-1].samples.push(R.speedY)):y.total[L-1].samples.push(R.speed)}}}catch(e){O=!0,k=e}finally{try{!S&&P.return&&P.return()}finally{if(O)throw k}}}}catch(e){x=!0,E=e}finally{try{!w&&C.return&&C.return()}finally{if(x)throw E}}var j=0;for(var D in y){var N=function(e){e.samples.length&&(e.mean=e.samples.reduce(function(e,t){return e+t},0)/e.samples.length,e.s=Math.sqrt(e.samples.map(function(t){return Math.pow(t-e.mean,2)}).reduce(function(e,t){return e+t},0)/e.samples.length),j=Math.max(j,Math.max(Math.abs(e.mean+e.s),Math.abs(e.mean-e.s))))},I=!0,F=!1,B=void 0;try{for(var U,z=y[D][Symbol.iterator]();!(I=(U=z.next()).done);I=!0){N(U.value)}}catch(e){F=!0,B=e}finally{try{!I&&z.return&&z.return()}finally{if(F)throw B}}}g[m]={graphs:y,maxValue:j,runTime:v.runTime,color:m==t?i:null,showLayer:m==t||this.get("data."+m+".showLayer")}}this.set("data",g)}},{key:"setLayerLive",value:function(e){this.set("data.live.showLayer",e)}},{key:"reset",value:function(){this.set("data",{})}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(3)),o=u(n(0)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(19)),s=u(n(325));function u(e){return e&&e.__esModule?e:{default:e}}n(326);var l={x:{title:"left/right",labels:["right","left"],color:"rgb(55,152,195)",right:{x1:55,x2:75,y1:35,y2:35,xlabel:75,ylabel:30},left:{x1:45,x2:25,y1:35,y2:35,xlabel:25,ylabel:30}},y:{title:"up/down",labels:["up","down"],color:"rgb(55,143,48)",up:{x1:50,x2:50,y1:30,y2:10,xlabel:40,ylabel:15},down:{x1:50,x2:50,y1:40,y2:60,xlabel:35,ylabel:55}}},c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||s.default));for(var i in o.default.bindMethods(r,["_onModelChange"]),e.addEventListener("Model.Change",r._onModelChange),"component"==e.get("mode")?r.svgs={x:null,y:null}:r.svgs={total:null},r.svgs){var u=a.select(r.$el.find(".component-speed__graph").get(0)).append("svg");u.classed("component-speed__graph__"+i,!0),u.attr("width",e.get("width")+e.get("margins.left")+e.get("margins.right")),u.attr("height",e.get("height")+e.get("margins.top")+e.get("margins.bottom")),r.svgs[i]=u.append("g").attr("transform","translate("+e.get("margins.left")+", "+e.get("margins.top")+")")}r.scales={},r.scales.x=a.scaleLinear().range([0,e.get("width")]),r.scales.y=a.scaleLinear().range([e.get("height"),0]);var c=a.select(r.$el.find(".component-speed__graph__image").get(0)).append("svg");for(var f in c.attr("width",100).attr("height",70),c.append("ellipse").attr("cx",0).attr("cy",0).attr("rx",16).attr("ry",8).attr("transform","translate(50,35)rotate(-45)").attr("fill","black"),r.svgs)c.append("svg:defs").append("svg:marker").attr("id","arrow__image__"+f).attr("refX",0).attr("refY",2).attr("markerWidth",4).attr("markerHeight",4).attr("orient","auto").append("svg:path").attr("d","M0,0 L0,4 L4,2 z").style("fill",l[f].color),c.append("line").attr("x1",l[f][l[f].labels[0]].x1).attr("y1",l[f][l[f].labels[0]].y1).attr("x2",l[f][l[f].labels[0]].x2).attr("y2",l[f][l[f].labels[0]].y2).attr("stroke",l[f].color).attr("stroke-width",2).attr("marker-end","url(#arrow__image__"+f),c.append("line").attr("x1",l[f][l[f].labels[1]].x1).attr("y1",l[f][l[f].labels[1]].y1).attr("x2",l[f][l[f].labels[1]].x2).attr("y2",l[f][l[f].labels[1]].y2).attr("stroke",l[f].color).attr("stroke-width",2).attr("marker-end","url(#arrow__image__"+f),c.append("text").attr("class","component-speed__graph__image__label").text(l[f].labels[0]).style("fill",l[f].color).attr("y",l[f][l[f].labels[0]].ylabel).attr("x",l[f][l[f].labels[0]].xlabel),c.append("text").attr("class","component-speed__graph__image__label").text(l[f].labels[1]).style("fill",l[f].color).attr("y",l[f][l[f].labels[1]].ylabel).attr("x",l[f][l[f].labels[1]].xlabel);return r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){switch(e.data.path){case"data":e.data.value?(this.reset(),this.setup(e.currentTarget)):this.reset()}}},{key:"setup",value:function(e){var t=this;this.scales.x.domain([0,Object.values(e.get("data")).reduce(function(e,t){return Math.max(e,t.runTime)},0)]);var n=Object.values(e.get("data")).reduce(function(e,t){return Math.max(e,t.maxValue)},0);for(var r in this.scales.y.domain(["component"==e.get("mode")?-n:0,n]),this.axes={x:a.axisBottom().scale(this.scales.x),y:a.axisLeft().scale(this.scales.y).tickSize(0,0)},this.bgs={},this.svgs){for(var i in this.svgs[r].selectAll("*").remove(),this.svgs[r].select(".component-speed__graph__axis").remove(),this.svgs[r].append("g").attr("class","component-speed__graph__axis component-speed__graph__axis-x").attr("transform","translate(0, "+e.get("height")/2+")").call(this.axes.x),this.svgs[r].selectAll("text").remove(),this.svgs[r].append("g").attr("class","component-speed__graph__axis component-speed__graph__axis-x").attr("transform","translate(0, "+e.get("height")+")").call(this.axes.x).append("text").attr("class","component-speed__graph__axis-label").text("Time [seconds]").attr("x",e.get("width")/2).attr("y",30),this.svgs[r].append("g").attr("class","component-speed__graph__axis component-speed__graph__axis-y").call(this.axes.y),this.svgs[r].selectAll(".component-speed__graph__axis-y .domain").attr("stroke",0),this.svgs[r].append("svg:defs").append("svg:marker").attr("id","arrow__"+r).attr("refX",0).attr("refY",4).attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("svg:path").attr("d","M0,0 L0,8 L8,4 z").style("fill",l[r].color),this.svgs[r].append("line").attr("class","component-speed__graph__arrow-line-"+l[r].labels[0]).attr("x1",-5).attr("y1",e.get("height")/2-5).attr("x2",-5).attr("y2",5).attr("stroke",l[r].color).attr("stroke-width",2).attr("marker-end","url(#arrow__"+r),this.svgs[r].append("g").append("text").attr("class","component-speed__graph__arrow-label").text("Speed "+l[r].labels[0]).attr("transform","rotate(-90)").style("fill",l[r].color).attr("y",-10).attr("x",-e.get("height")/4),this.svgs[r].append("line").attr("class","component-speed__graph__arrow-line-"+l[r].labels[1]).attr("x1",-5).attr("y1",e.get("height")/2+5).attr("x2",-5).attr("y2",e.get("height")-5).attr("stroke",l[r].color).attr("stroke-width",2).attr("marker-end","url(#arrow__"+r+")"),this.svgs[r].append("g").append("text").attr("class","component-speed__graph__arrow-label").text("Speed "+l[r].labels[1]).attr("transform","rotate(-90)").style("fill",l[r].color).attr("y",-10).attr("x",-3*e.get("height")/4),this.svgs[r].append("g").append("text").attr("class","component-speed__graph__title").text("Average speed in "+l[r].title+" direction ").attr("y",-10).attr("x",e.get("width")/2),this.bgs[r]=this.svgs[r].append("g").attr("class","component-speed__graph__background"),e.get("data"))if(e.get("data."+i+".showLayer")){var o=e.get("data."+i+".graphs."+r).filter(function(e){return e.mean}),s=e.get("data."+i+".color");if(e.get("stdBand")){var u=a.area().x(function(e){return t.scales.x(e.time)}).y0(function(e){return t.scales.y(e.mean-e.s)}).y1(function(e){return t.scales.y(e.mean+e.s)});this.svgs[r].append("path").datum(o).attr("class","component-speed__graph__std component-speed__graph__std__"+i).attr("style",s?"fill: #"+s.toString(16):null).attr("d",u)}var c=a.line().x(function(e){return t.scales.x(e.time)}).y(function(e){return t.scales.y(e.mean)});this.svgs[r].append("path").datum(o).attr("class","component-speed__graph__line component-speed__graph__line__"+i).attr("style",s?"stroke: #"+s.toString(16):null).attr("d",c)}if(e.get("lightConfig")&&Object.keys(e.get("data")).length){this.svgs[r].append("svg:defs").append("svg:marker").attr("id","arrow__component__light").attr("refX",0).attr("refY",2).attr("markerWidth",4).attr("markerHeight",4).attr("orient","auto").append("svg:path").attr("d","M0,0 L0,4 L4,2 z").style("fill","rgb(235,160,17)");var f=e.get("lightConfig").reduce(function(e,t){return Math.max(e,t.timeEnd)},0),d=!0,h=!1,p=void 0;try{for(var g,m=e.get("lightConfig")[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var v=g.value;if(0!=v.timeStart&&this.svgs[r].append("line").attr("class","component-speed__graph__light-time").attr("x1",v.timeStart*e.get("width")/f).attr("y1",e.get("height")).attr("x2",v.timeStart*e.get("width")/f).attr("y2",0).attr("stroke-width",2),0!=v.lightDir[0]||0!=v.lightDir[1]){this.svgs[r].append("line").attr("class","component-speed__graph__light-arrow").attr("x1",(v.timeEnd+v.timeStart)/2*e.get("width")/f+20).attr("y1",10).attr("x2",(v.timeEnd+v.timeStart)/2*e.get("width")/f+10*v.lightDir[0]+20).attr("y2",10+10*v.lightDir[1]).attr("stroke-width",2).attr("marker-end","url(#arrow__component__light)");var y=Math.sqrt(Math.pow(v.left,2)+Math.pow(v.right,2)+Math.pow(v.top,2)+Math.pow(v.bottom,2));y=Math.round(y),this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text(y+"% ").attr("y",15).attr("x",(v.timeEnd+v.timeStart)/2*e.get("width")/f-20)}else 0!=v.left&&0!=v.right&&0!=v.top&&0!=v.bottom?this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text(v.left+"% from all dir.").attr("y",15).attr("x",(v.timeEnd+v.timeStart)/2*e.get("width")/f):0!=v.left&&0!=v.right&&0==v.top&&0==v.bottom?this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text(v.left+"% from left&right").attr("y",15).attr("x",(v.timeEnd+v.timeStart)/2*e.get("width")/f):0==v.left&&0==v.right&&0!=v.top&&0!=v.bottom?this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text(v.top+"% from top&bottom").attr("y",15).attr("x",(v.timeEnd+v.timeStart)/2*e.get("width")/f):this.svgs[r].append("g").append("text").attr("class","component-speed__graph__light-label").text("no light").attr("y",15).attr("x",(v.timeEnd+v.timeStart)/2*e.get("width")/f)}}catch(e){h=!0,p=e}finally{try{!d&&m.return&&m.return()}finally{if(h)throw p}}}}}},{key:"update",value:function(e,t){var n=this,r=Object.values(t.get("data")).reduce(function(e,t){return Math.max(e,t.runTime)},0);for(var i in this.svgs){var o=this.bgs[i].selectAll(".component-speed__graph__time-band").data([e]);o.enter().append("rect").attr("class","component-speed__graph__time-band").attr("y",0).attr("height",t.get("height")).merge(o).transition().duration(0).attr("x",function(e){return n.scales.x(Math.min(r,Math.max(0,e-t.get("dT")/2)))}).attr("width",function(e){return n.scales.x(t.get("dT")+Math.min(0,e-t.get("dT")/2)+Math.min(0,r-e-t.get("dT")/2))}),o.exit().remove()}}},{key:"reset",value:function(){for(var e in this.svgs)this.svgs[e].selectAll(".component-speed__graph__axis").remove(),this.svgs[e].selectAll(".component-speed__graph__time-band").remove(),this.svgs[e].selectAll(".component-speed__graph__std").remove(),this.svgs[e].selectAll(".component-speed__graph__line").remove()}}]),t}();t.default=c},function(e,t,n){"use strict";n.r(t),t.default='<div class="component-speed">\n  <div class="component-speed__graph">\n  <div class="component-speed__graph__image"></div>\n</div>\n\n</div>\n'},function(e,t,n){var r=n(327);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component-speed {\n  border: 1px solid #282828;\n  text-align: center;\n  padding: 0.5rem;\n  display: inline-block;\n  margin: 1rem; }\n  .component-speed__graph {\n    max-width: 700px;\n    display: block;\n    position: relative; }\n    .component-speed__graph__image {\n      position: absolute;\n      top: 45.2%;\n      left: 6%;\n      width: 100px;\n      height: 70px;\n      text-anchor: middle; }\n      .component-speed__graph__image__label {\n        text-anchor: middle;\n        font-weight: bold;\n        font-size: 10px; }\n    .component-speed__graph__line {\n      fill: none;\n      stroke-width: 1;\n      opacity: 0.75;\n      stroke: #939393; }\n    .component-speed__graph__std {\n      opacity: 0.5; }\n      .component-speed__graph__std__live {\n        fill: #939393; }\n      .component-speed__graph__std__model {\n        fill: #2222ff; }\n    .component-speed__graph__time-band {\n      fill: #939393; }\n    .component-speed__graph__light-time, .component-speed__graph__light-arrow {\n      stroke: #eba011;\n      fill: #eba011; }\n    .component-speed__graph__light-label {\n      fill: #eba011;\n      font-size: 10px;\n      text-anchor: middle;\n      width: 50px; }\n    .component-speed__graph__axis-label {\n      fill: #282828;\n      text-anchor: middle;\n      font-weight: bold;\n      font-size: 12px; }\n    .component-speed__graph__axis-y text {\n      display: none; }\n    .component-speed__graph__title {\n      text-align: center;\n      text-anchor: middle; }\n    .component-speed__graph__arrow-label {\n      fill: #282828;\n      text-anchor: middle;\n      font-weight: bold; }\n    .component-speed__graph__arrow-marker {\n      stroke: black;\n      fill: black; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(7)),o=s(n(329)),a=s(n(330));s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"handleData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments[2],r=arguments[3];this._model.parseData(e,t,n,r)}},{key:"setLive",value:function(e){this._model.setLayerLive(e)}},{key:"update",value:function(e){this.view().update(e,this._model)}},{key:"reset",value:function(){this._model.reset()}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(6)),o=a(n(0));a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}var s={vRange:360,stdBand:!0,dT:1,dT_Angle:15,width:400,height:300,data:{},raw:{},margins:{top:20,left:40,bottom:40,right:20}},u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,s);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.default.bindMethods(n,["parseData"]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"parseData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=this,r=arguments[2],i=arguments[3];if(this.set("raw."+t,e),r){var a=0,s=function(e){var t=[0,0];for(var n in e)switch(n){case"left":t[0]+=e[n];break;case"right":t[0]+=-e[n];break;case"top":t[1]+=e[n];break;case"bottom":t[1]+=-e[n]}var r=Math.sqrt(t[0]*t[0]+t[1]*t[1]);r=0===r?1:r,t=t.map(function(e){return e/r}),e.lightDir=t,e.timeStart=a,e.timeEnd=a+e.duration,a+=e.duration},u=!0,l=!1,c=void 0;try{for(var f,d=r[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){s(f.value)}}catch(e){l=!0,c=e}finally{try{!u&&d.return&&d.return()}finally{if(l)throw c}}}this.get("vRange");var h={},p=function(e){var a=n.get("raw."+e),s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,d=void 0,p=void 0,g=[];for(s=0;s<a.numFrames/a.fps;s+=n.get("tStep")){for(l={time:s,sampleStart:Math.min(s+n.get("tStep"),a.numFrames/a.fps)-n.get("dT"),sampleEnd:Math.min(s+n.get("tStep"),a.numFrames/a.fps),bins:[],mean:null,s:null},u=0;u<n.get("binCount");u++)l.bins.push({thetaStart:u*o.default.TAU/n.get("binCount"),thetaEnd:(u+1)*o.default.TAU/n.get("binCount"),avgBinAngle:(2*u+1)*o.default.TAU/(2*n.get("binCount")),frequency:0});g.push(l)}var v=!0,y=!1,_=void 0;try{for(var b,w=a.tracks[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){c=b.value;var x=!0,E=!1,M=void 0;try{for(var C,T=c.samples[Symbol.iterator]();!(x=(C=T.next()).done);x=!0){f=C.value,p=Math.floor(n.get("binCount")*o.default.posMod(f.angleXY,o.default.TAU)/o.default.TAU);var S=!0,O=!1,k=void 0;try{for(var A,P=g[Symbol.iterator]();!(S=(A=P.next()).done);S=!0)(d=A.value).sampleStart<=f.time&&d.sampleEnd>f.time&&(d.bins[p].frequency+=1)}catch(e){O=!0,k=e}finally{try{!S&&P.return&&P.return()}finally{if(O)throw k}}}}catch(e){E=!0,M=e}finally{try{!x&&T.return&&T.return()}finally{if(E)throw M}}}}catch(e){y=!0,_=e}finally{try{!v&&w.return&&w.return()}finally{if(y)throw _}}var R=!0,L=!1,j=void 0;try{for(var D,N=g[Symbol.iterator]();!(R=(D=N.next()).done);R=!0){d=D.value;var I=!0,F=!1,B=void 0;try{for(var U,z=r[Symbol.iterator]();!(I=(U=z.next()).done);I=!0){var V=U.value;if(V.timeStart<=d.time&&d.time<V.timeEnd)if(0==V.lightDir[0]&&0==V.lightDir[1])d.numEugs=d.bins.reduce(function(e,t){return e+t.frequency},0),d.mean=90,d.s=0;else{m=0;var H=!0,q=!1,G=void 0;try{for(var W,X=d.bins[Symbol.iterator]();!(H=(W=X.next()).done);H=!0){var Y=W.value;0<Y.avgBinAngle&&Y.avgBinAngle<=Math.PI/2?Y.angleDiff=Y.avgBinAngle:Math.PI/2<Y.avgBinAngle&&Y.avgBinAngle<=Math.PI?Y.angleDiff=Y.avgBinAngle-Math.PI/2:Math.PI<Y.avgBinAngle&&Y.avgBinAngle<=1.5*Math.PI?Y.angleDiff=Y.avgBinAngle-Math.PI:1.5*Math.PI<Y.avgBinAngle&&Y.avgBinAngle<=2*Math.PI&&(Y.angleDiff=2*Math.PI-Y.avgBinAngle),Y.angleDiff=180*Y.angleDiff/Math.PI,Y.frequency>0&&(m+=1)}}catch(e){q=!0,G=e}finally{try{!H&&X.return&&X.return()}finally{if(q)throw G}}d.numEugs=d.bins.reduce(function(e,t){return e+t.frequency},0),d.mean=d.bins.reduce(function(e,t){return e+t.angleDiff*t.frequency},0)/d.numEugs;var $=d.bins.map(function(e){return e.frequency*Math.pow(e.angleDiff-d.mean,2)}).reduce(function(e,t){return e+t},0);d.s=Math.sqrt($/((m-1)/m*d.numEugs))}}}catch(e){F=!0,B=e}finally{try{!I&&z.return&&z.return()}finally{if(F)throw B}}}}catch(e){L=!0,j=e}finally{try{!R&&N.return&&N.return()}finally{if(L)throw j}}h[e]={graphs:g,runTime:a.runTime,color:e==t?i:null,showLayer:e==t||n.get("data."+e+".showLayer")}};for(var g in this.get("raw")){var m;p(g)}this.set("data",h)}},{key:"setLayerLive",value:function(e){this.set("data.live.showLayer",e)}},{key:"reset",value:function(){this.set("data",{})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(3)),o=u(n(0)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(19)),s=u(n(331));function u(e){return e&&e.__esModule?e:{default:e}}n(332);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||s.default));return o.default.bindMethods(r,["_onModelChange"]),e.addEventListener("Model.Change",r._onModelChange),r.svg=a.select(r.$el.find(".orientation-change__graph").get(0)).append("svg"),r.svg.classed("orientation-change__graph",!0),r.svg.attr("width",e.get("width")+e.get("margins.left")+e.get("margins.right")),r.svg.attr("height",e.get("height")+e.get("margins.top")+e.get("margins.bottom")),r.svg.append("g").attr("transform","translate("+e.get("margins.left")+", "+e.get("margins.top")+")"),r.scales={},r.scales.x=a.scaleLinear().range([0,e.get("width")]),r.scales.y=a.scaleLinear().range([e.get("height"),0]),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){switch(e.data.path){case"data":e.data.value?(this.reset(),this.setup(e.currentTarget)):this.reset()}}},{key:"setup",value:function(e){var t=this;for(var n in this.scales.x.domain([0,Object.values(e.get("data")).reduce(function(e,t){return Math.max(e,t.runTime)},0)]),this.scales.y.domain([0,Object.values(e.get("data")).reduce(function(e,t){return Math.max(e,90)},0)]),this.axes={x:a.axisBottom().scale(this.scales.x),y:a.axisLeft().scale(this.scales.y)},this.svg.select(".orientation-change__graph__axis").remove(),this.svg.append("g").attr("class","orientation-change__graph__axis orientation-change__graph__axis-x").attr("transform","translate(0, "+e.get("height")+")").call(this.axes.x).append("text").attr("class","orientation-change__graph__axis-label").text("Time [seconds]").attr("x",e.get("width")/2).attr("y",30),this.svg.append("g").attr("class","orientation-change__graph__axis orientation-change__graph__axis-y").call(this.axes.y).append("text").attr("class","orientation-change__graph__axis-label").text("Avg Change in orientation per Second [degrees / second]").attr("transform","rotate(-90)").attr("y",-30).attr("x",-e.get("height")/2),this.bgs=this.svg.append("g").attr("class","orientation-change__graph__background"),e.get("data"))if(e.get("data."+n+".showLayer")){var r=e.get("data."+n+".graphs").filter(function(e){return e.mean}),i=e.get("data."+n+".color");if(e.get("stdBand")){var o=a.area().x(function(e){return t.scales.x(e.time)}).y0(function(e){return t.scales.y(e.mean-e.s)}).y1(function(e){return t.scales.y(e.mean+e.s)});this.svg.append("path").datum(r).attr("class","orientation-change__graph__std orientation-change__graph__std__"+n).attr("style",i?"fill: #"+i.toString(16):null).attr("d",o)}var s=a.line().x(function(e){return t.scales.x(e.time)}).y(function(e){return t.scales.y(e.mean)});this.svg.append("path").datum(r).attr("class","orientation-change__graph__line orientation-change__graph__line__"+n).attr("style",i?"stroke: #"+i.toString(16):null).attr("d",s)}}},{key:"update",value:function(e,t){var n=this,r=Object.values(t.get("data")).reduce(function(e,t){return Math.max(e,t.runTime)},0),i=this.bgs.selectAll(".orientation-change__graph__time-band").data([e]);i.enter().append("rect").attr("class","orientation-change__graph__time-band").attr("y",0).attr("height",t.get("height")).merge(i).transition().duration(0).attr("x",function(e){return n.scales.x(Math.min(r,Math.max(0,e-t.get("dT")/2)))}).attr("width",function(e){return n.scales.x(t.get("dT")+Math.min(0,e-t.get("dT")/2)+Math.min(0,r-e-t.get("dT")/2))}),i.exit().remove()}},{key:"reset",value:function(){this.svg.selectAll(".orientation-change__graph__axis").remove(),this.svg.selectAll(".orientation-change__graph__time-band").remove(),this.svg.selectAll(".orientation-change__graph__std").remove(),this.svg.selectAll(".orientation-change__graph__line").remove()}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="orientation-change">\n  <div class="orientation-change__graph"></div>\n</div>\n'},function(e,t,n){var r=n(333);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".orientation-change {\n  border: 1px solid #282828;\n  text-align: center;\n  padding: 0.5rem;\n  display: inline-block;\n  margin: 1rem; }\n  .orientation-change__graph__line {\n    fill: none;\n    stroke-width: 1;\n    opacity: 0.75;\n    stroke: #939393; }\n  .orientation-change__graph__std {\n    opacity: 0.5; }\n    .orientation-change__graph__std__live {\n      fill: #939393; }\n    .orientation-change__graph__std__model {\n      fill: #2222ff; }\n  .orientation-change__graph__time-band {\n    fill: #939393; }\n  .orientation-change__graph__axis-label {\n    fill: #282828;\n    text-anchor: middle;\n    font-weight: bold; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=p(n(7)),o=p(n(335)),a=p(n(336)),s=p(n(0)),u=p(n(25)),l=p(n(1)),c=(p(n(8)),p(n(34))),f=p(n(53)),d=p(n(345)),h=p(n(349));function p(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.default.bindMethods(n,["_onTick","_onPlayPauseRequest","_onVideoReady","_onResetRequest","_onTimerEnd","_onSliderRequest","_onStopDrag","_onShowVideo","_onPlaybackRateRequest"]),n._lightDisplay=c.default.create({width:n._model.get("width"),height:n._model.get("height")}),n._bulbDisplay=f.default.create({width:n._model.get("width"),height:n._model.get("height")}),n._videoDisplay=d.default.create({width:n._model.get("width"),height:n._model.get("height")}),n._euglenaDisplay=h.default.create(l.default.get("AppConfig.view3d")),n._timer=new u.default({duration:l.default.get("AppConfig.experiment.maxDuration"),loop:!0}),n._timer.addEventListener("Timer.Tick",n._onTick),n._timer.addEventListener("Timer.End",n._onTimerEnd),n.playbackFaster=!1,n.view().addChild(n._lightDisplay.view(),".visual-result__content"),n.view().addChild(n._videoDisplay.view(),".visual-result__content"),n.view().addChild(n._euglenaDisplay.view(),".visual-result__content"),n.view().addChild(n._bulbDisplay.view(),".visual-result__content"),n.reset(),l.default.get("Relay").addEventListener("VisualResult.PlayPauseRequest",n._onPlayPauseRequest),l.default.get("Relay").addEventListener("VisualResult.PlaybackRateRequest",n._onPlaybackRateRequest),l.default.get("Relay").addEventListener("VisualResult.ResetRequest",n._onResetRequest),n.view().addEventListener("VideoDisplay.Ready",n._onVideoReady),l.default.get("Relay").addEventListener("VisualResult.SliderRequest",n._onSliderRequest),l.default.get("Relay").addEventListener("VisualResult.StopDrag",n._onStopDrag),n.addEventListener("VideoResult.ShowVideo",n._onShowVideo),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"handleLightData",value:function(e){this._model.set("lightData",e)}},{key:"handleModelData",value:function(e,t,n){null==e?this._euglenaDisplay.handleData({tracks:[]},t):this._euglenaDisplay.handleData(e,t,n)}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.stop(),e?(this._mode="video",this._videoDisplay.handleVideo(e),this._timer.setSource(this._videoDisplay)):(this._mode="dryRun",this._videoDisplay.handleVideo(null),this._timer.setSource(null),this._timer.start(),this.view().handlePlayState(this._timer.active()))}},{key:"stop",value:function(){this._timer.stop(),this.view().handlePlayState(this._timer.active())}},{key:"pause",value:function(){this._timer.pause(),this.view().handlePlayState(this._timer.active())}},{key:"reset",value:function(){this._timer.stop();var e={top:0,left:0,right:0,bottom:0};this._lightDisplay.render(e),this._bulbDisplay.render(e),this._euglenaDisplay.render(e,0),this.view().handlePlayState(this._timer.active())}},{key:"_onTick",value:function(e){var t=this._timer.time(),n=this._model.getLightState(t);this._lightDisplay.render(n),this._bulbDisplay.render(n),this._euglenaDisplay.render(n,t),this.view().tick(t),this.dispatchEvent("VisualResult.Tick",{mode:this._mode,time:t,lights:n})}},{key:"_onPlaybackRateRequest",value:function(e){this.playbackFaster=!this.playbackFaster,this.view().handlePlaybackState(this.playbackFaster),this._videoDisplay.changePlaybackRate(this.playbackFaster),l.default.get("Logger").log({type:"playbackrate",category:"results",data:{playbackrate:this.playbackFaster?"faster":"normal"}})}},{key:"_onPlayPauseRequest",value:function(e){this._timer.active()?this._timer.pause():this._timer.start(),this.view().handlePlayState(this._timer.active()),l.default.get("Logger").log({type:this._timer.active()?"play":"pause",category:"results",data:{}})}},{key:"_onVideoReady",value:function(e){this._timer.seek(0),this._onTick(null),this.view().handlePlayState(this._timer.active()),this.view().handlePlaybackState(this.playbackFaster),this._videoDisplay.changePlaybackRate(this.playbackFaster)}},{key:"_onResetRequest",value:function(e){this._timer.seek(0);var t=this._model.getLightState(0);this._lightDisplay.render(t),this._bulbDisplay.render(t),this._euglenaDisplay.render(t,0),this.view().videoSlider.setValue(0),this.dispatchEvent("VisualResult.Tick",{mode:this._mode,time:0,lights:t}),l.default.get("Logger").log({type:"reset",category:"results",data:{}})}},{key:"_onSliderRequest",value:function(e){if(!this._timer.active()){this._timer.seek(e.data.sliderValue);var t=this._timer.time(),n=this._model.getLightState(t);this.view().$el.find(".visual-result__time").text(s.default.secondsToTimeString(t)),this._lightDisplay.render(n),this._bulbDisplay.render(n),this._euglenaDisplay.render(n,t),this.dispatchEvent("VisualResult.Tick",{mode:this._mode,time:t,lights:n})}}},{key:"_onStopDrag",value:function(e){l.default.get("Logger").log({type:"videoSlider",category:"results",data:{newTime:this._timer.time().toFixed(2)}})}},{key:"clear",value:function(){this._timer.stop(),this._videoDisplay.handleVideo(null),this._timer.setSource(null),this.reset()}},{key:"_onShowVideo",value:function(e){this._videoDisplay.dispatchEvent("VideoDisplay.ShowVideo",{showVideo:e.data.showVideo})}},{key:"_onTimerEnd",value:function(e){this.view().handlePlayState(this._timer.active())}},{key:"hideControls",value:function(){this.view().$el.find(".visual-result__control").hide(),this.view().$el.find(".visual-result__time").hide()}}]),t}();g.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new g({modelData:e})},t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(6)),o=s(n(0)),a=s(n(18));function s(e){return e&&e.__esModule?e:{default:e}}var u={width:500,height:375,lightData:[]},l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"getLightState",value:function(e){return a.default.getLightState(this.get("lightData"),e)}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(3)),o=c(n(337)),a=c(n(0)),s=c(n(1)),u=c(n(12)),l=c(n(40));function c(e){return e&&e.__esModule?e:{default:e}}n(343);var f=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));return a.default.bindMethods(r,["_onSliderChange","_onStopDrag"]),r.$el.find(".visual-result__content").css({width:e.get("width"),height:e.get("height")}),r.playPauseButton=u.default.create({id:"playPause",label:"Pause",eventName:"VisualResult.PlayPauseRequest",style:"visual-result__control__toggle",eventStyle:"global"}),r.resetButton=u.default.create({id:"reset",label:"Reset",eventName:"VisualResult.ResetRequest",style:"visual-result__control__reset",eventStyle:"global"}),r.playbackButton=u.default.create({id:"playbackRate",label:"Normal Speed",eventName:"VisualResult.PlaybackRateRequest",style:"visual-result__control__playback",eventStyle:"global"}),r.addChild(r.playbackButton.view(),".visual-result__control"),r.addChild(r.playPauseButton.view(),".visual-result__control"),r.addChild(r.resetButton.view(),".visual-result__control"),r.videoSlider=l.default.create({label:"",min:0,max:s.default.get("AppConfig.experiment.maxDuration"),steps:.5,defaultValue:0}),r.addChild(r.videoSlider.view(),".visual-result__control"),r.videoSlider.addEventListener("Field.Change",r._onSliderChange),r.videoSlider.addEventListener("Field.StopDrag",r._onStopDrag),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"tick",value:function(e){this.$el.find(".visual-result__time").text(a.default.secondsToTimeString(e)),this.videoSlider.setValue(e.toFixed(1))}},{key:"handlePlayState",value:function(e){this.playPauseButton.setLabel(e?"Pause":"Play")}},{key:"handlePlaybackState",value:function(e){this.playbackButton.setLabel(e?"Faster Speed":"Normal Speed")}},{key:"_onSliderChange",value:function(e){s.default.get("Relay").dispatchEvent("VisualResult.SliderRequest",{sliderValue:e.currentTarget.value()})}},{key:"_onStopDrag",value:function(e){s.default.get("Relay").dispatchEvent("VisualResult.StopDrag",{})}}]),t}();t.default=f},function(e,t,n){"use strict";n.r(t),t.default='<div class="visual-result">\n  <div class="visual-result__content"></div>\n  <div class="visual-result__control"></div>\n  <div class="visual-result__time"></div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(a(n(1)),a(n(0))),o=(a(n(2)),a(n(14)));function a(e){return e&&e.__esModule?e:{default:e}}var s={min:0,max:1,steps:0,defaultValue:.5,unitValue:.5},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n.get("min"),o=n.get("max");return n.set("unitValue",(n.value()-r)/(o-r)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"setValue",value:function(e){this.setUnitValue((e-this.get("min"))/(this.get("max")-this.get("min")))}},{key:"setUnitValue",value:function(e){var t=this.get("steps"),n=this.get("min"),r=this.get("max");if(e=Math.min(1,Math.max(0,e)),t>1&&(e=Math.round(e*t)/t),this.set("unitValue",e),t>1){var o=(r-n)/t,a=o.toExponential().split("e");a=a[1]?+a[1]:0,this.set("value",i.default.roundDecimal(this.get("unitValue")*t*o+n,a))}else this.set("value",this.get("unitValue")*(r-n)+n)}},{key:"unitValue",value:function(){return this.get("unitValue")}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),o=l(n(0)),a=(l(n(2)),l(n(16))),s=l(n(340)),u=(l(n(3)),l(n(8)));function l(e){return e&&e.__esModule?e:{default:e}}n(341);var c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||s.default));return o.default.bindMethods(r,["_onModelChange","_startDrag","_drag","_stopDrag","_onInputChange"]),r.$el.find(".sliderfield__control").on("mousedown",r._startDrag),r.$el.find(".sliderfield__input").on("change blur",r._onInputChange),r.$el.find(".sliderfield__input").attr({min:e.get("min"),max:e.get("max"),step:(e.get("max")-e.get("min"))/e.get("steps")}),(0,u.default)(window).on("mousemove",r._drag),(0,u.default)(window).on("mouseup",r._stopDrag),r.render(e),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_onModelChange",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onModelChange",this).call(this,e),this.render(e.currentTarget)}},{key:"render",value:function(e){this.$el.find(".sliderfield__control").css({left:100*e.get("unitValue")+"%"}),this.$el.find(".sliderfield__span").first().css({width:100*e.get("unitValue")+"%",left:"0%"}),this.$el.find(".sliderfield__span").last().css({width:100*(1-e.get("unitValue"))+"%",left:100*e.get("unitValue")+"%"}),this.$el.find(".sliderfield__input").val(e.value()),e.get("label")&&this.$el.find(".sliderfield__label").html(e.get("label")),e.get("help")&&this.$el.find(".sliderfield__help").html(e.get("help")),this.$el.find(".sliderfield__input").prop("disabled",e.get("disabled"))}},{key:"_startDrag",value:function(e){if(!this._dragging){i.default.get("Logger").log({type:"videoSlider",category:"results",data:"startSlider"}),e.stopPropagation();return this._dragging=e.currentTarget,!1}}},{key:"_drag",value:function(e){if(this._dragging){var t=this.$dom().find(".sliderfield__track").width(),n=this.$dom().find(".sliderfield__track").offset().left,r=(o.default.mouseTouchPosition(e).x-n)/t;this.dispatchEvent("SliderField.UnitChangeRequest",{value:r})}}},{key:"_stopDrag",value:function(e){this._dragging&&(this._dragging=!1,this.dispatchEvent("SliderField.StopDrag",{}))}},{key:"_onInputChange",value:function(e){this.dispatchEvent("SliderField.ChangeRequest",{value:(0,u.default)(e.currentTarget).val()})}}]),t}();t.default=c},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__sliderfield component__field">\n  <label class="field__label sliderfield__label"></label>\n  <div class="sliderfield__content">\n    <div class="sliderfield__field_wrap">\n      <div class="sliderfield__track">\n        <div class="sliderfield__span"></div>\n        <div class="sliderfield__span"></div>\n      </div>\n      <div class="sliderfield__controls">\n        <div class="sliderfield__control"></div>\n      </div>\n    </div>\n    <div class="sliderfield__inputs">\n      <input type="number" class="sliderfield__input"/>\n    </div>\n    <span class="sliderfield__help"></span>\n  </div>\n</div>'},function(e,t,n){var r=n(342);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__sliderfield .sliderfield__field_wrap {\n  position: relative;\n  margin: 1rem 1.5rem; }\n\n.component__sliderfield .sliderfield__track {\n  width: 100%;\n  height: 0.5rem;\n  border-radius: 0.5rem;\n  background: #939393;\n  position: relative;\n  border: 0.1rem solid #f9f9f9; }\n\n.component__sliderfield .sliderfield__span {\n  position: absolute;\n  top: 0;\n  left: 0%;\n  width: 0%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.25); }\n  .component__sliderfield .sliderfield__span:first-child, .component__sliderfield .sliderfield__span:last-child {\n    background: transparent; }\n\n.component__sliderfield .sliderfield__control {\n  width: 2.5rem;\n  height: 2.5rem;\n  border-radius: 100%;\n  background: #d9d9d9;\n  position: absolute;\n  top: 0;\n  left: 0%;\n  margin-left: -1.25rem;\n  margin-top: -1rem;\n  border: 0.1rem solid #939393; }\n\n.component__sliderfield .sliderfield__inputs {\n  text-align: center; }\n  .component__sliderfield .sliderfield__inputs input {\n    text-align: center; }\n",""])},function(e,t,n){var r=n(344);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".visual-result {\n  position: relative;\n  display: inline-block;\n  vertical-align: middle;\n  margin: 3rem;\n  margin-top: 4rem; }\n  .visual-result__content {\n    position: relative;\n    margin: 1rem; }\n  .visual-result__time {\n    position: absolute;\n    bottom: 0;\n    left: 60%;\n    text-align: center; }\n  .visual-result__control {\n    position: relative;\n    left: 0;\n    width: 100%;\n    height: 5rem;\n    margin-top: 5rem; }\n    .visual-result__control__toggle.component__button, .visual-result__control__reset.component__button {\n      margin: 0;\n      padding: 0;\n      position: absolute;\n      bottom: 0%; }\n      .visual-result__control__toggle.component__button .button, .visual-result__control__reset.component__button .button {\n        width: 5rem;\n        height: 5rem;\n        padding: 0;\n        border-radius: 50%;\n        border: 1px solid #282828;\n        background: #f9f9f9;\n        outline: none;\n        text-align: center; }\n    .visual-result__control__reset.component__button {\n      left: 0.5%; }\n    .visual-result__control__toggle.component__button {\n      left: calc(0.5% + 5.5rem); }\n    .visual-result__control__playback.component__button {\n      margin: 0;\n      padding: 0;\n      position: absolute;\n      bottom: 20%;\n      left: calc(0.5% + 11rem); }\n      .visual-result__control__playback.component__button .button {\n        font-size: 10px;\n        width: 4rem;\n        height: 3rem;\n        padding: 0;\n        border: 1px solid #282828;\n        background: #f9f9f9;\n        outline: none;\n        text-align: center; }\n  .visual-result .component__field {\n    position: absolute;\n    left: 35%;\n    width: 65%; }\n    .visual-result .component__field .sliderfield__field_wrap {\n      position: relative;\n      margin: 1rem 1.5rem; }\n    .visual-result .component__field .sliderfield__track {\n      width: 100%;\n      height: 0.5rem;\n      border-radius: 0.5rem;\n      background: #939393;\n      position: relative;\n      border: 0.1rem solid #f9f9f9; }\n    .visual-result .component__field .sliderfield__inputs {\n      display: none;\n      text-align: center; }\n      .visual-result .component__field .sliderfield__inputs input {\n        text-align: center;\n        width: 5rem; }\n  .visual-result .light-display {\n    position: absolute;\n    top: 0;\n    left: 0;\n    margin: -2rem; }\n  .visual-result .euglena-display {\n    position: absolute;\n    top: 0;\n    left: 0; }\n  .visual-result .video-display {\n    position: absolute;\n    top: 0;\n    left: 0; }\n  .visual-result .bulb-display {\n    position: absolute;\n    top: 0;\n    left: 0;\n    margin: -4rem; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(7)),o=u(n(346)),a=u(n(347)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.default.bindMethods(n,["_onTimerEvent","_onShowVideo"]),n.view().addEventListener("TimerSource.End",n._onTimerEvent),n.addEventListener("VideoDisplay.ShowVideo",n._onShowVideo),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"handleVideo",value:function(e){e?(this._model.set("runTime",e.runTime),this._model.set("video",e.video)):(this._model.set("runTime",0),this._model.set("video",null))}},{key:"_onShowVideo",value:function(e){this._model.set("showVideo",e.data.showVideo)}},{key:"changePlaybackRate",value:function(e){this.view().setPlaybackRate(e)}},{key:"timer_time",value:function(){return this.view().time()}},{key:"timer_start",value:function(){this.view().start()}},{key:"timer_stop",value:function(){this.view().stop()}},{key:"timer_pause",value:function(){this.view().pause()}},{key:"timer_seek",value:function(e){this.view().seek(e)}},{key:"timer_duration",value:function(){return this._model.get("runTime")}},{key:"_onTimerEvent",value:function(e){this.dispatchEvent(e)}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(6)),i=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}var a={runTime:0,video:null},s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(0)),a=s(n(348));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));return o.default.bindMethods(r,["_onModelChange","_onVideoMetaData","_onVideoEnd","_onVideoTick"]),r._video=r.$el.find(".video-display__video"),r._video.on("loadedmetadata",r._onVideoMetaData),r._video.on("ended",r._onVideoEnd),r._video.on("timeupdate",r._onVideoTick),r._video.css({width:e.get("width"),height:e.get("height")}),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"time",value:function(){return this._runTime*this._video[0].currentTime/this._video[0].duration}},{key:"setPlaybackRate",value:function(e){this._video[0]&&(this._video[0].playbackRate=e?4*this._video[0].duration/this._runTime:1*this._video[0].duration/this._runTime)}},{key:"start",value:function(){this._video[0].play()}},{key:"stop",value:function(){this.pause(),this.seek(0)}},{key:"pause",value:function(){this._video[0].pause()}},{key:"seek",value:function(e){this._video[0].duration?this._video[0].currentTime=e*this._video[0].duration/this._runTime:this._video[0].currentTime=0}},{key:"_onModelChange",value:function(e){e.currentTarget;switch(e.data.path){case"video":this._video.attr("src",e.data.value),null==e.data.value?this._video.hide():this._video.show();break;case"runTime":this._runTime=e.data.value;break;case"showVideo":e.data.value?this._video.css({display:"inline"}):this._video.css({display:"none"})}}},{key:"_onVideoMetaData",value:function(e){this._video[0].playbackRate=this._video[0].duration/this._runTime,this.dispatchEvent("VideoDisplay.Ready",{},!0)}},{key:"_onVideoTick",value:function(e){var t=this.time();this._lastTime&&t<this._lastTime&&this.dispatchEvent("TimerSource.Loop"),this._lastTime=t}},{key:"_onVideoEnd",value:function(e){this.dispatchEvent("TimerSource.End")}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="video-display">\n  <video class="video-display__video"></video>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(7)),o=s(n(350)),a=s(n(354));s(n(0)),s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._lastRender=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"handleData",value:function(e,t,n){e.magnification&&this._model.setMagnification(e.magnification),this._model.setTrackData(e.tracks,t,n)}},{key:"render",value:function(e,t){this.view().render({lights:e,time:t,model:this._model})}}]),t}();u.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(6)),o=s(n(0)),a=s(n(351));function s(e){return e&&e.__esModule?e:{default:e}}var u={euglena:[],bounds:{width:640,height:480},magnification:1,camera:{height:500,near:.1,far:1e3}},l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"setTrackData",value:function(e,t,n){this.set("tracks",e);var r=[];e.forEach(function(e){var i=a.default.create({track:e,config:t,color:n});i.setInitialPosition({x:0,y:0,z:0}),r.push(i)}),this.set("euglena",r)}},{key:"setMagnification",value:function(e){this.set("magnification",e)}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(24)),o=(s(n(0)),s(n(352))),a=s(n(353));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||o.default,e.modelClass=e.modelClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"view",value:function(){return this._view.threeObject()}},{key:"setInitialPosition",value:function(e){this._model.setInitialPosition(e)}},{key:"update",value:function(e,t){this._view.update(this._model.getState(e,t))}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(13)),o=(s(n(0)),function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(21))),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._three=a.default.invoke("Euglena.3dView",null,{config:e.get("config"),color:e.get("color")}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"threeObject",value:function(){return this._three}},{key:"update",value:function(e){this._three.position.set(e.position.x,e.position.y,e.position.z);var t=new o.Euler(e.roll,e.pitch,e.yaw,"XYZ");this._three.setRotationFromEuler(t)}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(0)),o=(a(n(1)),a(n(2)),a(n(6)));function a(e){return e&&e.__esModule?e:{default:e}}var s={track:null,initialPosition:{x:0,y:0,z:0},color:2237183},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"setInitialPosition",value:function(e){this.set("initialPosition",e)}},{key:"getState",value:function(e,t){for(var n=void 0,r=void 0,o=0;o<this.get("track").samples.length&&(n=this.get("track").samples[o],(r=this.get("track").samples.length==o+1?null:this.get("track").samples[o+1])&&r.time<e);o++);if(null==r)return n=this.get("track").samples[0],{position:{x:i.default.posMod(n.x+this.get("initialPosition").x+t.width/2,t.width)-t.width/2,y:i.default.posMod(n.y+this.get("initialPosition").y+t.height/2,t.height)-t.width/2,z:this.get("initialPosition").z},yaw:n.yaw,roll:n.roll,pitch:n.pitch};var a=(e-n.time)/(r.time-n.time);return{position:{x:i.default.posMod(n.x+(r.x-n.x)*a+this.get("initialPosition").x+t.width/2,t.width)-t.width/2,y:i.default.posMod(n.y+(r.y-n.y)*a+this.get("initialPosition").y+t.height/2,t.height)-t.height/2,z:this.get("initialPosition").z},yaw:this._lesserArcEase(n.yaw,r.yaw,a),roll:this._lesserArcEase(n.roll,r.roll,a),pitch:this._lesserArcEase(n.pitch,r.pitch,a)}}},{key:"_lesserArcEase",value:function(e,t,n){var r=t-e;return Math.abs(r)>Math.PI&&(r=-1*Math.sign(r)*(i.default.TAU-Math.abs(r))),e+r*n}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(3)),o=u(n(0)),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(21)),s=u(n(355));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||s.default));o.default.bindMethods(r,["_onModelChange"]),r.scene=new a.Scene;var i=e.get("bounds.width")/e.get("bounds.height"),u=2*Math.atan2(e.get("bounds.height")/2,e.get("camera.height"))*180/Math.PI;for(var l in r.camera=new a.PerspectiveCamera(u,i,e.get("camera.near"),e.get("camera.far")),r.camera.position.z=e.get("camera.height"),r.camera.lookAt(new a.Vector3(0,0,0)),r.renderer=new a.WebGLRenderer({alpha:!0}),r.renderer.setClearColor(16186870,.25),r.renderer.setSize(500,375),r.lights={top:new a.DirectionalLight(16777215,0),left:new a.DirectionalLight(16777215,0),right:new a.DirectionalLight(16777215,0),bottom:new a.DirectionalLight(16777215,0),global:new a.AmbientLight(16777215,.6)},r.lights.top.position.set(0,1,0),r.lights.left.position.set(-1,0,0),r.lights.right.position.set(1,0,0),r.lights.bottom.position.set(0,-1,0),r.lights)r.scene.add(r.lights[l]);return r._euglena=[],r.$el.append(r.renderer.domElement),r._ensureEuglena(e),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onModelChange",value:function(e){var t=e.currentTarget;switch(e.data.path){case"euglena":this._ensureEuglena(t);break;case"magnification":this._adjustCamera(t)}}},{key:"_ensureEuglena",value:function(e){for(;this._euglena.length;)this.scene.remove(this._euglena.pop());var t=!0,n=!1,r=void 0;try{for(var i,o=e.get("euglena")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.scene.add(a.view()),this._euglena.push(a.view())}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_adjustCamera",value:function(e){var t=e.get("bounds.width")/e.get("bounds.height"),n=2*Math.atan2(e.get("bounds.height")/(2*e.get("magnification")),e.get("camera.height"))*180/Math.PI;this.camera=new a.PerspectiveCamera(n,t,e.get("camera.near"),e.get("camera.far")),this.camera.position.z=e.get("camera.height"),this.camera.lookAt(new a.Vector3(0,0,0))}},{key:"render",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e.model.get("euglena")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){i.value.update(e.time,{width:e.model.get("bounds.width")/e.model.get("magnification"),height:e.model.get("bounds.height")/e.model.get("magnification")})}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}for(var a in e.lights)this.lights[a].intensity=5*e.lights[a]/100;this.renderer.render(this.scene,this.camera)}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="euglena-display"></div>'},function(e,t,n){var r=n(357);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".results {\n  height: 100%; }\n  .results__controls {\n    padding: 1.5rem;\n    margin: -1.5rem -1.5rem 1rem;\n    background: #939393;\n    border-bottom: 1px solid #282828;\n    display: flex;\n    justify-content: space-evenly; }\n    .results__controls label {\n      margin-right: 1rem;\n      font-weight: bold; }\n    .results__controls__experiment {\n      text-align: left;\n      flex-grow: 1; }\n    .results__controls__model {\n      text-align: center;\n      flex-grow: 1; }\n    .results__controls__visualization {\n      text-align: right;\n      flex-grow: 2; }\n  .results__visuals {\n    display: flex;\n    align-items: top;\n    justify-content: flex-start;\n    overflow: auto;\n    height: 90%;\n    width: 100%; }\n    .results__visuals #moveTabs.flippedX {\n      width: 40px;\n      height: 20px;\n      margin-right: 30px;\n      transform: scaleX(-1); }\n    .results__visuals #moveTabs.notflippedX {\n      width: 40px;\n      height: 20px;\n      margin-right: 30px;\n      transform: scaleX(1); }\n  .results__visualization {\n    min-width: 400px;\n    min-height: 500px;\n    margin-left: 10px;\n    margin-right: 10px;\n    flex-grow: 2;\n    text-align: center; }\n  .results__euglena {\n    min-width: 600px;\n    min-height: 500px;\n    text-align: center; }\n  .results__euglena_2 {\n    min-width: 600px;\n    min-height: 500px;\n    flex-grow: 1;\n    text-align: center; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a(n(2)),a(n(0));var r=a(n(1)),i=a(n(9)),o=a(n(359));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.logger=new o.default,r.default.set("Logger",e.logger),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(s(n(2)),s(n(0))),o=s(n(1)),a=s(n(13));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"log",value:function(e){return e.type?e.studentId||o.default.get("student_id")?i.default.promiseAjax("/api/v1/Logs",{method:"POST",data:JSON.stringify({type:e.type,category:e.category,data:e.data,studentId:e.studentId?e.studentId:o.default.get("student_id"),lab:o.default.get("AppConfig.lab")}),contentType:"application/json"}):Promise.resolve(!0):Promise.reject("Logs require a type property")}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),o=c(n(0)),a=c(n(2)),s=c(n(9)),u=c(n(361)),l=c(n(32));function c(e){return e&&e.__esModule?e:{default:e}}n(374);var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.bindMethods(e,["_hookInteractiveTabs","_hook3dView","_onExperimentCountChange","_onAutomaticSimulate"]),e._tabs=[],e.threeView=new l.default,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),r(t,[{key:"init",value:function(){var e=this;return i.default.get("AppConfig.model")&&i.default.get("AppConfig.model.tabs.length")&&(i.default.get("AppConfig.model.tabs").forEach(function(t,n){t.id=1==i.default.get("AppConfig.model.tabs.length")?"":String.fromCharCode(97+n),t.euglenaCount=i.default.get("AppConfig.model.euglenaCount"),t.euglenaInit=i.default.get("AppConfig.model.euglenaInit"),t.simulationFps=i.default.get("AppConfig.model.simulationFps");var r=u.default.create(t);e._tabs.push(r),i.default.set("ModelTab."+r.id(),r)}),a.default.hook("InteractiveTabs.ListTabs",this._hookInteractiveTabs,1),i.default.get("Relay").addEventListener("ExperimentCount.Change",this._onExperimentCountChange),i.default.get("Relay").addEventListener("Model.AutomaticSimulate",this._onAutomaticSimulate)),function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"_hookInteractiveTabs",value:function(e,t){return this._tabs.forEach(function(t,n){e.push({id:"model_"+t.id(),tabType:t._model._data.modelType,title:"Model "+t.id().toUpperCase(),content:t.view()})}),e}},{key:"_hook3dView",value:function(e,t){return e||this.threeView.clone()}},{key:"_onExperimentCountChange",value:function(e){e.data.count&&!e.data.old?this._tabs.forEach(function(e){i.default.get("Relay").dispatchEvent("InteractiveTabs.EnableRequest",{tabId:"model_"+e.id()})}):e.data.count||this._tabs.forEach(function(e){i.default.get("Relay").dispatchEvent("InteractiveTabs.DisableRequest",{tabId:"model_"+e.id()})})}},{key:"_onAutomaticSimulate",value:function(e){this._tabs.find(function(t){return t.id()==e.data.tabId})._onSimulateRequest(e)}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=g(n(8)),o=g(n(1)),a=g(n(0)),s=(g(n(2)),g(n(7))),u=g(n(362)),l=g(n(363)),c=g(n(365)),f=g(n(366)),d=g(n(367)),h=g(n(18)),p=g(n(368));function g(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||u.default,e.viewClass=e.viewClass||l.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.default.bindMethods(n,["_onSimulateRequest","_onSaveRequest","_onAggregateRequest","_onNameCancel","_onNameSubmit","_onGlobalsChange","_loadModelInForm","_onHistorySelectionChange","_onConfigChange","_onNewRequest","_onPhaseChange","_onDisableRequest","_onEnableRequest"]),n._history=c.default.create({id:"model_history__"+n._model.get("id"),modelType:n._model.get("modelType")}),n._history.addEventListener("Form.FieldChanged",n._onHistorySelectionChange),o.default.get("Relay").addEventListener("Blockly.Changed",n._onHistorySelectionChange),n._silenceLoadLogs=!1,n._form=f.default.create({modelType:n._model.get("modelType"),fieldConfig:n._model.get("parameters"),euglenaCountConfig:n._model.get("euglenaCount"),euglenaInitConfig:n._model.get("euglenaInit")}),n._form.addEventListener("Form.FieldChanged",n._onConfigChange),o.default.get("Relay").addEventListener("Blockly.Changed",n._onConfigChange),n._form.view().addEventListener("ModelForm.Simulate",n._onSimulateRequest),n._form.view().addEventListener("ModelForm.Save",n._onSaveRequest),n._form.view().addEventListener("ModelForm.AddToAggregate",n._onAggregateRequest),n._form.view().addEventListener("ModelForm.NewRequest",n._onNewRequest);var r=document.createElement("h2");if(r.className="tab__model__title",r.innerHTML=o.default.get("AppConfig.model.modelName")?o.default.get("AppConfig.model.modelName"):"Model of the Body",n.view().$dom().append(r),n._nameForm=d.default.create(),n._nameForm.view().addEventListener("ModelSave.Submit",n._onNameSubmit),n._nameForm.view().addEventListener("ModelSave.Cancel",n._onNameCancel),n.view().addChild(n._history.view()),"blockly"==n._model.get("modelType")){var i=n._form.export(),s={};s.reaction=Object.keys(n._model.get("parameters").K.options),s.motor=Object.keys(n._model.get("parameters").v.options),n._model.get("parameters").omega?s.roll=Object.keys(n._model.get("parameters").omega.options):n._model.get("parameters").motion&&(s.motion=Object.keys(n._model.get("parameters").motion.options)),n.bodyConfigurations=p.default.create({initialConfig:i,paramOptions:s,modelRepresentation:n._model.get("parameters").modelRepresentation}),n._form.view().addChild(n.bodyConfigurations.view(),null,0)}return n.view().addChild(n._form.view()),n._setModelRepresentation(),o.default.addEventListener("Model.Change",n._onGlobalsChange),o.default.get("Relay").addEventListener("AppPhase.Change",n._onPhaseChange),o.default.get("Relay").addEventListener("Notifications.Add",n._onDisableRequest),o.default.get("Relay").addEventListener("Notifications.Remove",n._onEnableRequest),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),r(t,[{key:"id",value:function(){return this._model.get("id")}},{key:"currModelId",value:function(){return this._currModelId}},{key:"currModel",value:function(){return this._currentModel}},{key:"color",value:function(){return this._model.get("color")}},{key:"historyCount",value:function(){return this._history.historyCount()}},{key:"_onGlobalsChange",value:function(e){var t=this;switch(e.data.path){case"student_id":this._history.update().then(function(){var e=t._history.getHistory();return e.length?t._history.import({model_history_id:e[e.length-1]}):(t._form.setState("new"),!0)}).then(function(){t._loadModelInForm(t._history.export().model_history_id)})}}},{key:"_onHistorySelectionChange",value:function(e){"Blockly.Changed"===e.name?this._model._data.modelType==e.data.modelType&&this._loadModelInForm("_new"):this._loadModelInForm(e.currentTarget.export().model_history_id)}},{key:"_onConfigChange",value:function(e){this._lastSimSaved=null,"Blockly.Changed"===e.name?this._model._data.modelType==e.data.modelType&&(this._history.import({model_history_id:"_new"}),this._form.setState("new")):(this._history.import({model_history_id:"_new"}),this._form.setState("new")),"Form.FieldChanged"===e.name&&("opacity"===e.data.field._model._data.id?this.bodyConfigurations.setBodyOpacity(e.data.delta.value):"blockly"==e.currentTarget._model._data.modelType&&this.bodyConfigurations.setActiveConfiguration(e.data.delta.value))}},{key:"_loadModelInForm",value:function(e){var t=this;if(e){var n=this._currModelId;n!=("_new"==e?null:e)?("_new"!=e?(this._currModelId=e,a.default.promiseAjax("/api/v1/EuglenaModels/"+e).then(function(e){if(t._form.removeEventListener("Form.FieldChanged",t._onConfigChange),t._currentModel=e,"blockly"==t._model._data.modelType){o.default.get("Relay").dispatchEvent("Blockly.Load",e.blocklyXml);for(var n=Object.keys(e.configuration).length-1;n>=0;n--)if(!Object.keys(e.configuration)[n].match("_|count")){var r=Object.keys(e.configuration)[n];t.bodyConfigurations.setActiveConfiguration(e.configuration[r])}}t._form.import(e.configuration).then(function(){t._form.addEventListener("Form.FieldChanged",t._onConfigChange),o.default.get("Relay").dispatchEvent("EuglenaModel.Loaded",{model:e,tabId:t._model.get("id")})}),e.simulated?t._form.setState("new"):t._form.setState("historical")})):(this._currModelId=null,this._currentModel=null,o.default.get("Relay").dispatchEvent("EuglenaModel.Loaded",{model:{id:"_new"},tabId:this._model.get("id")}),this._form.setState("new")),this._silenceLoadLogs||o.default.get("Logger").log({type:"load",category:"model",data:{modelId:e,tab:this._model.get("id")}})):this._lastSimSaved&&this._lastSimSaved.id==n&&o.default.get("Relay").dispatchEvent("EuglenaModel.Loaded",{model:this._lastSimSaved,tabId:this._model.get("id")})}}},{key:"_onSimulateRequest",value:function(e){var t=this,n=this._form.export(),r=null,a=null,s={name:"(simulation)",simulated:!0,configuration:n};"blockly"==this._model.get("modelType")&&(r=this._extractBlockly(),s=i.default.extend(s,r),a=JSON.stringify(this.bodyConfigurations.getActiveSensorConfiguration()),s=i.default.extend(s,{sensorConfigJSON:a})),this._saveModel(s).then(function(e){t._silenceLoadLogs=!0,t._loadModelInForm(e.id),t._silenceLoadLogs=!1}),o.default.get("Logger").log({type:"simulate",category:"model",data:{modelType:this._model.get("modelType"),configuration:r?i.default.extend(n,{jsCode:r.jsCode,sensorConfigJSON:a}):n}})}},{key:"_extractBlockly",value:function(){var e=window.Blockly.Xml.workspaceToDom(window.Blockly.getMainWorkspace());Array.prototype.slice.call(e.childNodes).map(function(t){"BLOCK"==t.tagName&&"master_block"!=t.getAttribute("type")&&e.removeChild(t)});for(var t=window.Blockly.mainWorkspace.getTopBlocks(!0),n=!1,r="",i=0;i<t.length;i++)if("master_block"==t[i].type){r=window.Blockly.JavaScript.blockToCode(t[i]),n=!0;break}return n||alert("there is no main block"),{blocklyXml:e.outerHTML,jsCode:r}}},{key:"_onSaveRequest",value:function(e){o.default.get("InteractiveModal").display(this._nameForm.view())}},{key:"_saveModel",value:function(e){var t=this;e.studentId=o.default.get("student_id"),e.modelType=this._model.get("modelType"),e.lab=o.default.get("AppConfig.lab");return(this._lastSimSaved?a.default.promiseAjax("/api/v1/EuglenaModels/"+this._lastSimSaved.id,{method:"PATCH",data:JSON.stringify({name:e.name,simulated:e.simulated}),contentType:"application/json"}):a.default.promiseAjax("/api/v1/EuglenaModels",{method:"POST",data:JSON.stringify(e),contentType:"application/json"})).then(function(n){if(e.simulated?t._lastSimSaved=n:t._lastSimSaved=null,n)return n})}},{key:"_onNameSubmit",value:function(e){var t=this,n=null,r=null;"blockly"==this._model.get("modelType")&&(n=this._extractBlockly(),r=JSON.stringify(this.bodyConfigurations.getActiveSensorConfiguration()),n=i.default.extend(n,{sensorConfigJSON:r})),this._nameForm.validate().then(function(e){return t._saveModel(i.default.extend(n,{name:t._nameForm.export().name,configuration:t._form.export(),simulated:!1}))}).then(function(e){t._lastSimSaved=null,o.default.get("InteractiveModal").hide().then(function(){t._nameForm.clear()}),t._silenceLoadLogs=!0,t._history.update().then(function(){t._silenceLoadLogs=!1,t._history.import({model_history_id:e.id})})}),o.default.get("Logger").log({type:"save",category:"model",data:{configuration:n?i.default.extend(this._form.export(),{sensorConfigJSON:r,jsCode:n.jsCode}):this._form.export(),modelType:this._model.get("modelType"),name:this._nameForm.export().name}})}},{key:"_onNameCancel",value:function(e){var t=this;o.default.get("InteractiveModal").hide().then(function(){t._nameForm.clear()})}},{key:"_onAggregateRequest",value:function(e){h.default.getModelResults(o.default.get("currentExperiment.id"),this._currentModel).then(function(e){o.default.get("Relay").dispatchEvent("AggregateData.AddRequest",{data:e})}),o.default.get("Logger").log({type:"aggregate",category:"model",data:{modelId:this._history.export().model_history_id}})}},{key:"_onDisableRequest",value:function(e){if(o.default.get("AppConfig.system.modelModality"))switch(o.default.get("AppConfig.system.modelModality").toLowerCase()){case"create":this._form.disable(),this._history.disable();break;case"explore":this._form.disable(),this._history.enable()}}},{key:"_onEnableRequest",value:function(e){if(o.default.get("AppConfig.system.modelModality"))switch(o.default.get("AppConfig.system.modelModality").toLowerCase()){case"create":this._form.enable(),this._history.enable();break;case"explore":this._form.enable(),this._form.partiallyDisableFields(["count","initialization"]),this._history.enable()}}},{key:"_onNewRequest",value:function(e){this._onConfigChange(e)}},{key:"_onPhaseChange",value:function(e){"login"!=e.data.phase&&"login_attempted"!=e.data.phase||this._history.import({model_history_id:"_new"})}},{key:"_setModelRepresentation",value:function(){if(o.default.get("AppConfig.system.modelModality"))switch(o.default.get("AppConfig.system.modelModality").toLowerCase()){case"observe":this._form.hideFields(),this._history.hideFields();break;case"explore":this._form.disableFields(),this._history.enable()}}}]),t}();m.create=function(e){return new m({modelData:e})},t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(n(1));var r=o(n(0)),i=(o(n(2)),o(n(6)));function o(e){return e&&e.__esModule?e:{default:e}}var a={id:null,color:2237183},s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=r.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(n(1)),o(n(0)),o(n(2));var r=o(n(3)),i=o(n(364));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||i.default))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a},function(e,t,n){"use strict";n.r(t),t.default='<div class="tab__model">\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),o=u(n(0)),a=(u(n(2)),u(n(20))),s=u(n(17));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n={modelData:{classes:["form__model__history"],fields:[s.default.create({id:"model_history_id",label:"Model",value:"_new",classes:[],options:{_new:"(New Model)"},description:"Choose different models that have been generated or saved previously."})],buttons:[]}};return e=o.default.ensureDefaults(e,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"update",value:function(){var e=this,t=i.default.get("student_id");if(t){var n=i.default.get("AppConfig.model.modelHistory"),r=null;return r=n?o.default.promiseAjax("/api/v1/EuglenaModels",{data:{filter:{where:{id:{inq:n}}}}}):o.default.promiseAjax("/api/v1/EuglenaModels",{data:{filter:{where:{and:[{studentId:t},{modelType:this._model.get("modelType")},{lab:i.default.get("AppConfig.lab")},{simulated:!1}]}}}}),n&&"create"===i.default.get("AppConfig.system.modelModality")?o.default.promiseAjax("/api/v1/EuglenaModels",{data:{filter:{where:{and:[{studentId:t},{modelType:this._model.get("modelType")},{lab:i.default.get("AppConfig.lab")},{simulated:!1}]}}}}).then(function(t){r.then(function(n){n=n.concat(t);var r=e.getField("model_history_id"),o=r.value();r.clearOptions(),"create"===i.default.get("AppConfig.system.modelModality")&&r.addOption({value:"_new",label:"(New Model)"}),n.sort(function(e,t){return new Date(t.date_created).getTime()-new Date(e.date_created).getTime()}),n.forEach(function(e,t){r.addOption({value:e.id,label:e.name})}),"_new"==o||n.map(function(e){return e.id}).includes(parseInt(o))?r.setValue(o):n.length?r.setValue(n[0].id):r.setValue("_new")})}):r.then(function(t){var n=e.getField("model_history_id"),r=n.value();n.clearOptions(),"create"===i.default.get("AppConfig.system.modelModality")&&n.addOption({value:"_new",label:"(New Model)"}),t.sort(function(e,t){return new Date(t.date_created).getTime()-new Date(e.date_created).getTime()}),t.forEach(function(e,t){n.addOption({value:e.id,label:e.name})}),"_new"==r||t.map(function(e){return e.id}).includes(parseInt(r))?n.setValue(r):t.length?n.setValue(t[0].id):n.setValue("_new")})}return this.getField("model_history_id").clearOptions(),Promise.resolve(!0)}},{key:"getHistory",value:function(){return Object.keys(this.getField("model_history_id").getOptions()).filter(function(e){return"_new"!=e})}},{key:"historyCount",value:function(){return this.getHistory().length}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},o=c(n(1)),a=(c(n(0)),c(n(2))),s=c(n(20)),u=c(n(12)),l=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelData.fields=a.default.invoke("ModelForm.Fields",[],{type:e.modelData.modelType,config:e.modelData.fieldConfig}),e.modelData.fields.push(l.default.create({id:"count",label:"Number of Euglena:",value:e.modelData.euglenaCountConfig.initialValue,classes:[],options:e.modelData.euglenaCountConfig.options,description:"Set the number of models to be simulated."})),e.modelData.fields.push(l.default.create({id:"initialization",label:"Initial Orientation of Euglena:",value:e.modelData.euglenaInitConfig.initialValue,classes:[],options:e.modelData.euglenaInitConfig.options,description:"Set the initial orientation of models to be simulated."})),e.modelData.buttons=[u.default.create({id:"simulate",label:"Run Model",classes:["form__model__simulate"],eventName:"ModelForm.Simulate"}),u.default.create({id:"submit",label:"Save",classes:["form__model__submit"],eventName:"ModelForm.Save"}),u.default.create({id:"new",label:"New Model",classes:["form__model__new"],eventName:"ModelForm.NewRequest"}),u.default.create({id:"aggregate",label:"Add Results to Aggregate",classes:["form__model__aggregate"],eventName:"ModelForm.AddToAggregate"})],e.modelData.classes=["form__model"],function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),r(t,[{key:"export",value:function(){return a.default.invoke("ModelForm.ModifyExport",i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"export",this).call(this),{type:this._model.get("modelType")})}},{key:"import",value:function(e){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"import",this).call(this,a.default.invoke("ModelForm.ModifyImport",e,{type:this._model.get("modelType")}))}},{key:"setState",value:function(e){switch(e){case"historical":switch(o.default.get("AppConfig.system.modelModality").toLowerCase()){case"observe":case"explore":this.getButton("submit").view().hide(),this.getButton("simulate").view().show(),this.getButton("aggregate").view().hide(),this.getButton("new").view().hide();break;default:this.getButton("submit").view().hide(),this.getButton("simulate").view().hide(),o.default.get("AppConfig.aggregate")?this.getButton("aggregate").view().show():this.getButton("aggregate").view().hide(),this.getButton("new").view().show()}break;case"new":switch(o.default.get("AppConfig.system.modelModality").toLowerCase()){case"observe":case"explore":this.getButton("submit").view().hide(),this.getButton("simulate").view().show(),this.getButton("aggregate").view().hide(),this.getButton("new").view().hide();break;default:this.getButton("submit").view().show(),this.getButton("simulate").view().show(),this.getButton("aggregate").view().hide(),this.getButton("new").view().hide()}}}}]),t}();f.create=function(e){return new f({modelData:e})},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a(n(1)),a(n(0)),a(n(2));var r=a(n(20)),i=a(n(12)),o=a(n(49));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelData.title=e.modelData.title||"Give your model a name",e.modelData.classes=(e.modelData.classes||[]).concat(["form__model__name"]),e.modelData.fields=(e.modelData.fields||[]).concat([o.default.create({id:"name",label:"Name",required:!0})]),e.modelData.buttons=(e.modelData.buttons||[]).concat([i.default.create({id:"cancel",eventName:"ModelSave.Cancel",label:"Cancel",classes:["form__model__name__cancel"]}),i.default.create({id:"submit",eventName:"ModelSave.Submit",label:"Save",classes:["form__model__name__submit"]})]),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();s.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new s({modelData:e})},t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(7)),o=l(n(369)),a=l(n(370)),s=l(n(1)),u=l(n(0));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return u.default.bindMethods(n,["_importAllImages","setBodyOpacity","setActiveConfiguration","hide","show"]),n._model.setConfigs(),n.modelRepresentation=e.modelData.modelRepresentation,n.allowedConfigs=e.modelData.allowedConfigs,n.paramOptions=e.modelData.paramOptions,e.modelData.initialConfig.omega?n.activeConfigs={sensorConfig:null,reaction:null,motor:null,roll:null}:e.modelData.initialConfig.motion?n.activeConfigs={sensorConfig:null,reaction:null,motor:null,motion:null}:n.activeConfigs={sensorConfig:null,reaction:null,motor:null,roll:null},n.opacity=e.modelData.initialConfig.opacity?e.modelData.initialConfig.opacity:.2,n.imgPath="/cslib/module/euglena/model_blockly/bodyConfigurations/imgs/",n._importAllImages(),n.setActiveConfiguration(e.modelData.initialConfig.bodyConfigurationName),n.setActiveConfiguration(e.modelData.initialConfig.v),e.modelData.initialConfig.omega?n.setActiveConfiguration(e.modelData.initialConfig.omega):e.modelData.initialConfig.motion&&n.setActiveConfiguration(e.modelData.initialConfig.motion),n.setActiveConfiguration(e.modelData.initialConfig.k),n.setBodyOpacity(n.opacity),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"setActiveConfiguration",value:function(e){var t=null;e&&(t=e.qualitativeValue?e.qualitativeValue:e),t&&Object.keys(this.activeConfigs).some(function(e){if(t.match(e))return t=e,!0});var n=null;switch(t){case"sensorConfig":var r=0;this.activeConfigs.sensorConfig&&(r=this._model.getNumberOfSensors(this.activeConfigs.sensorConfig),this.hide(this._model.getConfigId(this.activeConfigs.sensorConfig)),this.activeConfigs.reaction&&this.hide(this.activeConfigs.reaction));var i=this._model.getNumberOfSensors(e);i!=r&&s.default.get("Relay").dispatchEvent("Body.Change",{numSensors:i}),this.activeConfigs.sensorConfig=e,this.show(this._model.getConfigId(this.activeConfigs.sensorConfig)),this.activeConfigs.reaction&&(n="reaction_"+this.modelRepresentation+"_"+this._model.getConfigId(this.activeConfigs.sensorConfig).toLowerCase().split("_")[1]+"_",n+=this.activeConfigs.reaction.split("_")[3],this.activeConfigs.reaction=n,this.show(this.activeConfigs.reaction));break;case"reaction":this.activeConfigs.sensorConfig&&(this.activeConfigs.reaction&&this.hide(this.activeConfigs.reaction),n="reaction_"+this.modelRepresentation+"_"+this._model.getConfigId(this.activeConfigs.sensorConfig).toLowerCase().split("_")[1]+"_",n+=e.substr(e.indexOf("_")+1),this.activeConfigs.reaction=n,this.show(this.activeConfigs.reaction));break;case"motor":case"roll":this.activeConfigs[t]&&this.hide(this.activeConfigs[t]),n=t+"_"+this.modelRepresentation+"_",n+=e.substr(e.indexOf("_")+1),this.activeConfigs[t]=n,this.show(this.activeConfigs[t]);break;case"motion":this.activeConfigs[t]&&this.hide(this.activeConfigs[t]),n=e.substr(0,e.match("0|1").index-1),this.activeConfigs[t]=n,this.show(this.activeConfigs[t])}}},{key:"getActiveSensorConfiguration",value:function(){return this.activeConfigs.sensorConfig?this._model.getConfigJSON(this.activeConfigs.sensorConfig):null}},{key:"setBodyOpacity",value:function(e){"string"==typeof e?e=parseInt(e.substr(e.indexOf("_")+1))/100:Object.keys(e).length&&(e=e.numericValue),this.opacity=e,this.view()._setBodyOpacity(e)}},{key:"hide",value:function(e){this.view()._hideConfig(e)}},{key:"show",value:function(e){this.view()._showConfig(e)}},{key:"_importAllImages",value:function(){var e=this;Object.keys(this._model.defaultConfigs).map(function(t){e.view()._addLayer(e._model.defaultConfigs[t].id,e.imgPath)});var t=null;t="labels_"+this.modelRepresentation,this.view()._addLayer(t,this.imgPath);var n=["back","front","backleft","backright","frontleft","frontright","frontcenter"];this.paramOptions.reaction.forEach(function(r){n.forEach(function(n){t="reaction_"+e.modelRepresentation+"_"+n+"_"+r.substr(r.indexOf("_")+1),e.view()._addLayer(t,e.imgPath)})}),this.paramOptions.motor.forEach(function(n){t="motor_"+e.modelRepresentation+"_",t+=n.substr(n.indexOf("_")+1),e.view()._addLayer(t,e.imgPath)}),Object.keys(this.paramOptions).indexOf("roll")>-1?this.paramOptions.roll.forEach(function(n){t="roll_"+e.modelRepresentation+"_",t+=n.substr(n.indexOf("_")+1),e.view()._addLayer(t,e.imgPath)}):Object.keys(this.paramOptions).indexOf("motion")>-1&&this.paramOptions.motion.forEach(function(n){t="motion_"+n.split("_")[1],e.view()._addLayer(t,e.imgPath)})}},{key:"id",value:function(){return this._model.get("id")}},{key:"select",value:function(){this._model.set("selected",!0)}},{key:"deselect",value:function(){this._model.set("selected",!1)}},{key:"export",value:function(){return this._model.get("id")}}]),t}();c.create=function(e){return new c({modelData:e})},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(6)),o=s(n(0)),a=s(n(71));function s(e){return e&&e.__esModule?e:{default:e}}var u={id:0,selected:!1},l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.data.id=e.data.id||o.default.guid4(),e.defaults=o.default.ensureDefaults(e.defaults,u);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.default.bindMethods(n,["setConfigs","getConfigId","getConfigJSON"]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"setConfigs",value:function(){this.defaultConfigs=a.default,this.defaultConfigs.bodybackground={id:"bodybckgrnd"}}},{key:"getConfigId",value:function(e){return this.defaultConfigs[e].id}},{key:"getConfigJSON",value:function(e){return this.defaultConfigs[e].config}},{key:"getNumberOfSensors",value:function(e){var t=0;return Object.keys(this.defaultConfigs[e].config).forEach(function(e){e.toLowerCase().match("sensor")&&(t+=1)}),t}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(3)),o=s(n(371)),a=(s(n(8)),s(n(0)));function s(e){return e&&e.__esModule?e:{default:e}}n(372);var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||o.default));return a.default.bindMethods(r,["_onChange","_render","_addLayer","_setBodyOpacity","_showConfig","_hideConfig"]),e.addEventListener("Model.Change",r._onChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onChange",value:function(e){this._render(e.currentTarget)}},{key:"_render",value:function(e){console.log("move render code to here")}},{key:"_addLayer",value:function(e,t){var n=document.createElement("div");n.id=e,n.className="multilayerimage__configuration";var r=document.createElement("img");r.src=t+e+".png",n.appendChild(r),this.$el[0].appendChild(n)}},{key:"_setBodyOpacity",value:function(e){this.$el.find("#bodybckgrnd").css("opacity",e)}},{key:"_showConfig",value:function(e){this.$el.find("#"+e).css("visibility","visible")}},{key:"_hideConfig",value:function(e){this.$el.find("#"+e).css("visibility","hidden")}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__multilayerimage">\n</div>\n'},function(e,t,n){var r=n(373);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,'.component__multilayerimage {\n  position: relative;\n  display: block;\n  width: 100%;\n  height: 160px;\n  max-height: 160px;\n  margin: 0 0 2rem 0; }\n  .component__multilayerimage [id^="labels"],\n  .component__multilayerimage #bodybckgrnd .multilayerimage__configuration,\n  .component__multilayerimage .multilayerimage__configuration {\n    position: absolute;\n    top: 0;\n    left: 10%;\n    z-index: 2;\n    visibility: hidden;\n    width: 90%;\n    margin: 0 auto; }\n  .component__multilayerimage [id^="reaction_mechanistic"] {\n    z-index: 0; }\n  .component__multilayerimage [id^="reaction_functional"] {\n    z-index: 1; }\n  .component__multilayerimage [id^="roll_mechanistic"] {\n    z-index: 1; }\n  .component__multilayerimage [id^="roll_functional"] {\n    z-index: 0; }\n  .component__multilayerimage [id^="motion"] {\n    z-index: 0; }\n  .component__multilayerimage [id^="motor"] {\n    z-index: 3; }\n  .component__multilayerimage .multilayerimage__configuration img {\n    width: 100%; }\n  .component__multilayerimage [id^="labels"] {\n    z-index: 5;\n    visibility: visible;\n    width: 95%;\n    left: 5%; }\n  .component__multilayerimage #bodybckgrnd {\n    z-index: 4;\n    visibility: visible;\n    opacity: 1; }\n',""])},function(e,t,n){var r=n(375);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".form__model {\n  border-top: 1px solid #101010; }\n  .form__model__history {\n    margin: 1.5rem 0; }\n    .form__model__history .field__label {\n      margin-right: 1rem; }\n  .form__model .component__field {\n    margin: 1rem 0; }\n    .form__model .component__field .selectfield__select {\n      margin-left: 0.5rem; }\n  .form__model .component__sliderfield, .form__model .component__symsliderfield {\n    display: flex; }\n    .form__model .component__sliderfield .field__label, .form__model .component__symsliderfield .field__label {\n      flex: 2;\n      text-align: right; }\n    .form__model .component__sliderfield .symsliderfield__content,\n    .form__model .component__sliderfield .sliderfield__content, .form__model .component__symsliderfield .symsliderfield__content,\n    .form__model .component__symsliderfield .sliderfield__content {\n      flex: 5; }\n    .form__model .component__sliderfield .symsliderfield__inputs,\n    .form__model .component__sliderfield .sliderfield__inputs, .form__model .component__symsliderfield .symsliderfield__inputs,\n    .form__model .component__symsliderfield .sliderfield__inputs {\n      margin: 1.5rem 0; }\n      .form__model .component__sliderfield .symsliderfield__inputs input,\n      .form__model .component__sliderfield .sliderfield__inputs input, .form__model .component__symsliderfield .symsliderfield__inputs input,\n      .form__model .component__symsliderfield .sliderfield__inputs input {\n        width: 8rem; }\n  .form__model .component__symsliderfield .symsliderfield__span {\n    background: #282828; }\n    .form__model .component__symsliderfield .symsliderfield__span:first-child, .form__model .component__symsliderfield .symsliderfield__span:last-child {\n      background: transparent; }\n  .form__model .form__buttons {\n    margin-top: 2rem; }\n  .form__model__submit {\n    float: right; }\n  .form__model__aggregate {\n    float: right; }\n  .form__model__name {\n    padding: 1rem; }\n    .form__model__name__submit {\n      float: right; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(c(n(1)),c(n(0))),o=c(n(2)),a=c(n(9)),s=c(n(72)),u=c(n(40)),l=c(n(382));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.default.bindMethods(e,["_hookModelFields","_hookModifyExport","_hookModifyImport","_hook3dView"]),o.default.hook("ModelForm.Fields",e._hookModelFields),o.default.hook("ModelForm.ModifyExport",e._hookModifyExport),o.default.hook("ModelForm.ModifyImport",e._hookModifyImport),o.default.hook("Euglena.3dView",e._hook3dView),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_hookModelFields",value:function(e,t){return"oneEye"==t.type&&(e=e.concat([s.default.create({id:"k",label:t.config.K.label,min:t.config.K.range[0],max:t.config.K.range[1],steps:Math.round((t.config.K.range[1]-t.config.K.range[0])/t.config.K.resolution),defaultValue:t.config.K.initialValue}),s.default.create({id:"v",label:t.config.v.label,min:t.config.v.range[0],max:t.config.v.range[1],steps:Math.round((t.config.v.range[1]-t.config.v.range[0])/t.config.v.resolution),defaultValue:t.config.v.initialValue}),s.default.create({id:"omega",label:t.config.omega.label,min:t.config.omega.range[0],max:t.config.omega.range[1],steps:Math.round((t.config.omega.range[1]-t.config.omega.range[0])/t.config.omega.resolution),defaultValue:t.config.omega.initialValue}),u.default.create({id:"randomness",label:t.config.randomness.label,min:t.config.randomness.range[0],max:t.config.randomness.range[1],steps:Math.round((t.config.randomness.range[1]-t.config.randomness.range[0])/t.config.randomness.resolution),defaultValue:t.config.randomness.initialValue})])),e}},{key:"_hookModifyExport",value:function(e,t){return"oneEye"==t.type&&["k","v","omega"].forEach(function(t){e[t+"_delta"]=e[t].delta,e[t]=e[t].base}),e}},{key:"_hookModifyImport",value:function(e,t){return"oneEye"==t.type&&["k","v","omega"].forEach(function(t){e[t]={base:e[t],delta:e[t+"_delta"]},delete e[t+"_delta"]}),e}},{key:"_hook3dView",value:function(e,t){return"oneEye"==t.config.modelType?new l.default({baseColor:t.color}).view():e}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(a(n(1)),a(n(0))),o=(a(n(2)),a(n(14)));function a(e){return e&&e.__esModule?e:{default:e}}var s={min:0,max:1,steps:0,defaultValue:{base:.5,delta:.1},unitValue:.5,deltaUnitValue:.1},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n.get("min"),o=n.get("max");return n.set("unitValue",(n.value().base-r)/(o-r)),n.set("deltaUnitValue",n.value().delta/(o-r)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"setBaseValue",value:function(e){this.setUnitValue((e-this.get("min"))/(this.get("max")-this.get("min")))}},{key:"setDeltaValue",value:function(e){this.setDeltaUnitValue(e/(this.get("max")-this.get("min")))}},{key:"setUnitValue",value:function(e){e=Math.min(1,Math.max(0,e));var t=this.get("steps");t>1&&(e=Math.round(e*t)/t),this.set("unitValue",e),e<this.get("deltaUnitValue")&&this.set("deltaUnitValue",e),1-e<this.get("deltaUnitValue")&&this.set("deltaUnitValue",1-e),this._updateValue()}},{key:"setDeltaUnitValue",value:function(e){e=Math.min(this.get("unitValue"),1-this.get("unitValue"),e);var t=this.get("steps");t>1&&(e=Math.round(e*t)/t),this.set("deltaUnitValue",e),this._updateValue()}},{key:"_updateValue",value:function(){var e=this.get("max"),t=this.get("min"),n=this.get("steps"),r=void 0;if(n>1){var o=(e-t)/n,a=o.toExponential().split("e");a=a[1]?+a[1]:0,r={base:i.default.roundDecimal(this.get("unitValue")*n*o+t,a),delta:i.default.roundDecimal(this.get("deltaUnitValue")*n*o,a)}}else r={base:this.get("unitValue")*(e-t)+t,delta:this.get("deltaUnitValue")*(e-t)};this.set("value",r)}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(u(n(1)),u(n(0))),o=(u(n(2)),u(n(16))),a=u(n(379)),s=u(n(8));function u(e){return e&&e.__esModule?e:{default:e}}n(380);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||a.default));return i.default.bindMethods(r,["_onModelChange","_startDrag","_drag","_stopDrag","_onBaseInputChange","_onDeltaInputChange"]),(0,s.default)(window).on("mousemove",r._drag),(0,s.default)(window).on("mouseup",r._stopDrag),r.$el.find(".symsliderfield__control").on("mousedown",r._startDrag),r.$el.find(".symsliderfield__input__base").attr({min:e.get("min"),max:e.get("max"),step:(e.get("max")-e.get("min"))/e.get("steps")}),r.$el.find(".symsliderfield__input__delta").attr({min:0,max:e.get("max")-e.get("min"),step:(e.get("max")-e.get("min"))/e.get("steps")}),r.$el.find(".symsliderfield__input__base").on("change blur",r._onBaseInputChange),r.$el.find(".symsliderfield__input__delta").on("change blur",r._onDeltaInputChange),e.get("color")&&r.$el.find(".symsliderfield__label").css("color",e.get("color")),r.render(e),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onModelChange",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onModelChange",this).call(this,e),this.render(e.currentTarget)}},{key:"render",value:function(e){this.$el.find(".symsliderfield__control__base").css({left:100*e.get("unitValue")+"%"}),this.$el.find(".symsliderfield__control__delta_min").css({left:100*(e.get("unitValue")-e.get("deltaUnitValue"))+"%"}),this.$el.find(".symsliderfield__control__delta_max").css({left:100*(e.get("unitValue")+e.get("deltaUnitValue"))+"%"}),this.$el.find(".symsliderfield__span").each(function(t,n){switch(t){case 0:(0,s.default)(n).css({width:100*(e.get("unitValue")-e.get("deltaUnitValue"))+"%",left:"0%"});break;case 1:(0,s.default)(n).css({width:100*e.get("deltaUnitValue")+"%",left:100*(e.get("unitValue")-e.get("deltaUnitValue"))+"%"});break;case 2:(0,s.default)(n).css({width:100*e.get("deltaUnitValue")+"%",left:100*e.get("unitValue")+"%"});break;case 3:(0,s.default)(n).css({width:100*(1-(e.get("unitValue")+e.get("deltaUnitValue")))+"%",left:100*(e.get("unitValue")+e.get("deltaUnitValue"))+"%"})}}),this.$el.find(".symsliderfield__input__base").val(e.value().base),this.$el.find(".symsliderfield__input__delta").val(e.value().delta),e.get("label")&&this.$el.find(".symsliderfield__label").html(e.get("label")),e.get("help")&&this.$el.find(".symsliderfield__help").html(e.get("help")),this.$el.find(".symsliderfield__input__base").prop("disabled",e.get("disabled")),this.$el.find(".symsliderfield__input__delta").prop("disabled",e.get("disabled"))}},{key:"_startDrag",value:function(e){if(!this._dragging)return e.stopPropagation(),this._dragging=(0,s.default)(e.currentTarget),!1}},{key:"_drag",value:function(e){if(this._dragging){var t=this.$dom().find(".symsliderfield__track").width(),n=this.$dom().find(".symsliderfield__track").offset().left,r=(i.default.mouseTouchPosition(e).x-n)/t;this._dragging.hasClass("symsliderfield__control__base")?this.dispatchEvent("SymSliderField.UnitChangeRequest",{value:r,property:"base"}):this._dragging.hasClass("symsliderfield__control__delta_min")?this.dispatchEvent("SymSliderField.UnitChangeRequest",{offset:r,property:"delta"}):this._dragging.hasClass("symsliderfield__control__delta_max")&&this.dispatchEvent("SymSliderField.UnitChangeRequest",{offset:r,property:"delta"})}}},{key:"_stopDrag",value:function(e){this._dragging=null}},{key:"_onBaseInputChange",value:function(e){this.dispatchEvent("SymSliderField.ChangeRequest",{property:"base",value:this.$el.find(".symsliderfield__input__base").val()})}},{key:"_onDeltaInputChange",value:function(e){this.dispatchEvent("SymSliderField.ChangeRequest",{property:"delta",value:this.$el.find(".symsliderfield__input__delta").val()})}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__symsliderfield component__field">\n  <label class="field__label symsliderfield__label"></label>\n  <div class="symsliderfield__content">\n    <div class="symsliderfield__field_wrap">\n      <div class="symsliderfield__track">\n        <div class="symsliderfield__span"></div>\n        <div class="symsliderfield__span"></div>\n        <div class="symsliderfield__span"></div>\n        <div class="symsliderfield__span"></div>\n      </div>\n      <div class="symsliderfield__controls">\n        <div class="symsliderfield__control symsliderfield__control__delta_min"></div>\n        <div class="symsliderfield__control symsliderfield__control__base"></div>\n        <div class="symsliderfield__control symsliderfield__control__delta_max"></div>\n      </div>\n    </div>\n    <div class="symsliderfield__inputs">\n      <input type="number" class="symsliderfield__input__base"/> ± <input type="number" class="symsliderfield__input__delta"/>\n    </div>\n    <span class="symsliderfield__help"></span>\n  </div>\n</div>'},function(e,t,n){var r=n(381);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__symsliderfield .symsliderfield__field_wrap {\n  position: relative;\n  margin: 1rem 1.5rem; }\n\n.component__symsliderfield .symsliderfield__track {\n  width: 100%;\n  height: 0.5rem;\n  border-radius: 0.5rem;\n  background: #939393;\n  position: relative;\n  border: 0.1rem solid #f9f9f9; }\n\n.component__symsliderfield .symsliderfield__span {\n  position: absolute;\n  top: 0;\n  left: 0%;\n  width: 0%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.25); }\n  .component__symsliderfield .symsliderfield__span:first-child, .component__symsliderfield .symsliderfield__span:last-child {\n    background: transparent; }\n\n.component__symsliderfield .symsliderfield__control {\n  position: absolute;\n  top: 0;\n  left: 0%;\n  border: 0.1rem solid #939393;\n  border-radius: 100%; }\n  .component__symsliderfield .symsliderfield__control__base {\n    width: 2.5rem;\n    height: 2.5rem;\n    background: #d9d9d9;\n    margin-left: -1.25rem;\n    margin-top: -1rem;\n    z-index: 0; }\n  .component__symsliderfield .symsliderfield__control__delta_min, .component__symsliderfield .symsliderfield__control__delta_max {\n    width: 1.5rem;\n    height: 1.5rem;\n    margin-left: -0.75rem;\n    margin-top: -0.5rem;\n    background: #efefef;\n    z-index: 1; }\n\n.component__symsliderfield .symsliderfield__inputs {\n  text-align: center; }\n  .component__symsliderfield .symsliderfield__inputs input {\n    width: 6rem;\n    text-align: center; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(32)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(21)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u={eyeColor:16777215},l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.config=a.default.ensureDefaults(n.config,u),n.addEye({z:n.tubeCurve.getPoint(.85).z,y:2*n.config.tubeRadius/3,x:0},.75),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addEye",value:function(e,t){for(var n=new o.SphereGeometry(this.config.tubeRadius,this.config.tubeSegments,this.config.tubeSegments),r=new o.MeshLambertMaterial({color:this.config.eyeColor}),i=new o.Mesh(n,r),a=["x","y","z"],s=0;s<a.length;s++){var u=a[s];i.scale[u]=t,i.position[u]=e[u]||0}this._body.add(i)}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(c(n(1)),c(n(0))),o=c(n(2)),a=c(n(9)),s=c(n(72)),u=c(n(40)),l=c(n(384));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.default.bindMethods(e,["_hookModelFields","_hookModifyExport","_hookModifyImport","_hook3dView"]),o.default.hook("ModelForm.Fields",e._hookModelFields),o.default.hook("ModelForm.ModifyExport",e._hookModifyExport),o.default.hook("ModelForm.ModifyImport",e._hookModifyImport),o.default.hook("Euglena.3dView",e._hook3dView),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_hookModelFields",value:function(e,t){return"twoEye"==t.type&&(e=e.concat([s.default.create({id:"k",label:t.config.K.label,min:t.config.K.range[0],max:t.config.K.range[1],steps:Math.round((t.config.K.range[1]-t.config.K.range[0])/t.config.K.resolution),defaultValue:t.config.K.initialValue}),s.default.create({id:"v",label:t.config.v.label,min:t.config.v.range[0],max:t.config.v.range[1],steps:Math.round((t.config.v.range[1]-t.config.v.range[0])/t.config.v.resolution),defaultValue:t.config.v.initialValue}),s.default.create({id:"omega",label:t.config.omega.label,min:t.config.omega.range[0],max:t.config.omega.range[1],steps:Math.round((t.config.omega.range[1]-t.config.omega.range[0])/t.config.omega.resolution),defaultValue:t.config.omega.initialValue}),u.default.create({id:"randomness",label:t.config.randomness.label,min:t.config.randomness.range[0],max:t.config.randomness.range[1],steps:Math.round((t.config.randomness.range[1]-t.config.randomness.range[0])/t.config.randomness.resolution),defaultValue:t.config.randomness.initialValue})])),e}},{key:"_hookModifyExport",value:function(e,t){return"twoEye"==t.type&&["k","v","omega"].forEach(function(t){e[t+"_delta"]=e[t].delta,e[t]=e[t].base}),e}},{key:"_hookModifyImport",value:function(e,t){return"twoEye"==t.type&&["k","v","omega"].forEach(function(t){e[t]={base:e[t],delta:e[t+"_delta"]},delete e[t+"_delta"]}),e}},{key:"_hook3dView",value:function(e,t){return"twoEye"==t.config.modelType?new l.default({baseColor:t.color}).view():e}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(32)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(21)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u={eyeColor:16777215},l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.config=a.default.ensureDefaults(n.config,u),n.addEye({z:n.tubeCurve.getPoint(.85).z,y:2*n.config.tubeRadius/3,x:0},.75),n.addEye({z:n.tubeCurve.getPoint(.85).z,y:2*-n.config.tubeRadius/3,x:0},.75),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addEye",value:function(e,t){for(var n=new o.SphereGeometry(this.config.tubeRadius,this.config.tubeSegments,this.config.tubeSegments),r=new o.MeshLambertMaterial({color:this.config.eyeColor}),i=new o.Mesh(n,r),a=["x","y","z"],s=0;s<a.length;s++){var u=a[s];i.scale[u]=t,i.position[u]=e[u]||0}this._body.add(i)}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=h(n(0)),o=h(n(1)),a=h(n(2)),s=h(n(9)),u=h(n(386)),l=h(n(17)),c=h(n(392)),f=h(n(400)),d=h(n(71));function h(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.get("AppConfig.modeling")&&(i.default.bindMethods(e,["_onPhaseChange","_onExperimentCountChange","_hookModelFields","_hookModifyExport","_hookModifyImport","_hook3dView"]),o.default.get("AppConfig.model.tabs").length&&(e.tab=new u.default,o.default.get("Relay").addEventListener("AppPhase.Change",e._onPhaseChange),o.default.get("Relay").addEventListener("ExperimentCount.Change",e._onExperimentCountChange)),a.default.hook("ModelForm.Fields",e._hookModelFields),a.default.hook("ModelForm.ModifyExport",e._hookModifyExport),a.default.hook("ModelForm.ModifyImport",e._hookModifyImport),a.default.hook("Euglena.3dView",e._hook3dView)),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),r(t,[{key:"run",value:function(){this.tab&&o.default.get("Layout").getPanel("result").addContent(this.tab.view())}},{key:"_onPhaseChange",value:function(e){"login"!=e.data.phase&&"login_attempted"!=e.data.phase||this.tab.hide()}},{key:"_onExperimentCountChange",value:function(e){e.data.count&&!e.data.old?this.tab.show():!e.data.count&&o.default.get("blocklyLoaded")&&this.tab.hide()}},{key:"_hookModelFields",value:function(e,t){var n=this;if("blockly"==t.type){var r=Array.apply(null,{length:Object.keys(d.default).length}).map(function(e,t){return"sensorConfig_"+(t+1)});if(t.config.allowedConfigs.length)for(var i=r.length-1;i>=0;i--)-1==t.config.allowedConfigs.indexOf(d.default[r[i]].id.toLowerCase())&&r.splice(i,1);this.bodyConfigOptions={},r.map(function(e){return n.bodyConfigOptions[e]=d.default[e].id}),e=e.concat([l.default.create({id:"bodyConfigurationName",inverse_order:!0,color:t.config.bodyConfiguration.color?t.config.bodyConfiguration.color:null,label:t.config.bodyConfiguration.label,value:t.config.bodyConfiguration.initialValue,min_width:t.config.bodyConfiguration.min_width,description:t.config.bodyConfiguration.description,classes:[],options:this.bodyConfigOptions}),c.default.create({id:"v",inverse_order:!0,varOptions:t.config.v.varOptions,label:t.config.v.label,color:t.config.v.color?t.config.v.color:null,value:t.config.v.initialValue,maxValue:t.config.v.maxValue,description:t.config.v.description,classes:[],options:t.config.v.options}),c.default.create({id:"k",inverse_order:!0,varOptions:t.config.K.varOptions,label:t.config.K.label,color:t.config.K.color?t.config.K.color:null,value:t.config.K.initialValue,maxValue:t.config.K.maxValue,description:t.config.K.description,classes:[],options:t.config.K.options})]),t.config.omega?e.splice(3,0,c.default.create({id:"omega",inverse_order:!0,varOptions:t.config.omega.varOptions,label:t.config.omega.label,color:t.config.omega.color?t.config.omega.color:null,value:t.config.omega.initialValue,maxValue:t.config.omega.maxValue,description:t.config.omega.description,classes:[],options:t.config.omega.options})):t.config.motion&&e.splice(3,0,c.default.create({id:"motion",inverse_order:!0,label:t.config.motion.label,color:t.config.motion.color?t.config.motion.color:null,value:t.config.motion.initialValue,maxValue:t.config.motion.maxValue,description:t.config.motion.description,classes:[],options:t.config.motion.options})),t.config.opacity&&e.splice(1,0,c.default.create({id:"opacity",inverse_order:!0,varOptions:t.config.opacity.varOptions,label:t.config.opacity.label,color:t.config.opacity.color?t.config.opacity.color:null,value:t.config.opacity.initialValue,maxValue:t.config.opacity.maxValue,description:t.config.opacity.description,classes:[],options:t.config.opacity.options}))}return e}},{key:"_hookModifyExport",value:function(e,t){return"blockly"==t.type&&["k","v","omega","opacity","motion"].forEach(function(t){Object.keys(e).indexOf(t)>-1&&(e[t+"_numeric"]=e[t].numericValue,e[t+"_variation"]=e[t].variation,e[t]=e[t].qualitativeValue)}),e}},{key:"_hookModifyImport",value:function(e,t){return"blockly"==t.type&&["k","v","omega","opacity","motion"].forEach(function(t){Object.keys(e).indexOf(t)>-1&&(e[t]={qualitativeValue:e[t],numericValue:e[t+"_numeric"],variation:e[t+"_variation"]},delete e[t+"_numeric"],delete e[t+"_variation"])}),e}},{key:"_hook3dView",value:function(e,t){if("blockly"==t.config.modelType){if(-1==Object.keys(d.default).indexOf(t.config.configuration.bodyConfigurationName))console.log("this is not good");else{var n=0,r=null,i=d.default[t.config.configuration.bodyConfigurationName].config;if(Object.keys(i).forEach(function(e){e.toLowerCase().match("sensor")&&(n+=1,r=e)}),2==n)var o={baseColor:t.color,addEye:"both"};else if(0==i[r].sensorOrientation)o={baseColor:t.color,addEye:"right"};else o={baseColor:t.color,addEye:"left"}}return new f.default(o).view()}return e}}]),t}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(0)),o=c(n(1)),a=(c(n(2)),c(n(7))),s=c(n(387)),u=c(n(388)),l=c(n(8));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||s.default,e.viewClass=e.viewClass||u.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.default.bindMethods(n,["_onToggleRequest","_onResultToggleRequest","_onClearAllRequest","_onClearRequest","_onPhaseChange","toggleBlocklyEvent","_onBlocklyLoad","_listenBlocklyEvents","_onDisableRequest","_onEnableRequest","_onBodyChange","_updateToolbox"]),o.default.set("blocklyLoaded",!1),"justbody"!==o.default.get("AppConfig.system.expModelModality")&&(o.default.get("Relay").addEventListener("ModelingTab.ToggleRequest",n._onToggleRequest),o.default.get("Relay").addEventListener("Tab.Change",n._onToggleRequest)),o.default.get("Relay").addEventListener("AppPhase.Change",n._onPhaseChange),o.default.get("Relay").addEventListener("Blockly.Load",n._onBlocklyLoad),o.default.get("Relay").addEventListener("Notifications.Remove",n._listenBlocklyEvents),o.default.get("Relay").addEventListener("ModelingTab.TransitionEnd",n._listenBlocklyEvents),o.default.get("Relay").addEventListener("Notifications.Add",n._onDisableRequest),o.default.get("Relay").addEventListener("Notifications.Remove",n._onEnableRequest),o.default.get("Relay").addEventListener("Body.Change",n._onBodyChange),o.default.get("Relay").addEventListener("Toolbox.Update",n._updateToolbox),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_onDisableRequest",value:function(e){this.view().disable(),this.workspace&&(this.workspace.options.readOnly=!0,this.workspace.options.maxBlocks=0)}},{key:"_onEnableRequest",value:function(e){"create"===o.default.get("AppConfig.system.modelModality")?(this.view().enable(),this.workspace&&(this.workspace.options.readOnly=!1,this.workspace.options.maxBlocks=50)):"explore"===o.default.get("AppConfig.system.modelModality")&&this.view().enable()}},{key:"hide",value:function(){this.view().hide()}},{key:"show",value:function(){this.view().show()}},{key:"_onToggleRequest",value:function(e){if(!this._model.get("open"))if(this.workspace.getAllBlocks().length){var t=window.Blockly.Xml.workspaceToDom(window.Blockly.getMainWorkspace());this.workspace.removeChangeListener(this.toggleBlocklyEvent),this.workspace.clear(),window.Blockly.Xml.domToWorkspace(t,this.workspace)}else{var n=document.getElementById("defaultWorkspaceBlocks");window.Blockly.Xml.domToWorkspace(n,this.workspace)}"ModelingTab.ToggleRequest"==e.name?(this._model.toggle(),this._view.toggle(this._model.get("open")),o.default.get("Logger").log({type:this._model.get("open")?"open":"close",category:"modeling",data:{displayState:this._model.getDisplayState(),visualization:""}})):"blockly"==e.data.tabType?(this._model.toggle(),this._view.toggle(this._model.get("open"))):this._model.get("open")&&(this._model.toggle(),this._view.toggle(this._model.get("open")))}},{key:"_onResultToggleRequest",value:function(e){o.default.get("Logger").log({type:"result_toggle",category:"modeling",data:{displayState:this._model.getDisplayState(),visualization:""}})}},{key:"_onClearRequest",value:function(e){o.default.get("Logger").log({type:"remove_data",category:"modeling",data:{resultId:e.data.resultId,displayState:this._model.getDisplayState(),visualization:""}})}},{key:"_onClearAllRequest",value:function(e){o.default.get("Logger").log({type:"remove_group",category:"modeling",data:{experimentId:e.data.experimentId,displayState:this._model.getDisplayState(),visualization:""}})}},{key:"_onPhaseChange",value:function(e){if(("login"==e.data.phase||"login_attempted"==e.data.phase)&&!o.default.get("blocklyLoaded")){var t={toolbox:document.getElementById("toolbox"),collapse:!0,comments:!0,disable:!0,maxBlocks:1/0,trashcan:!0,horizontalLayout:!0,toolboxPosition:"start",css:!0,media:"https://blockly-demo.appspot.com/static/media/",rtl:!1,scrollbars:!0,sounds:!0,oneBasedIndex:!0};this.workspace=window.Blockly.inject(document.getElementById("BlocklyDiv"),t);for(var n=document.getElementsByClassName("blocklyScrollbarHandle"),r=0;r<n.length;r++)n[r].style.fill="grey";o.default.set("blocklyLoaded",!0)}}},{key:"_updateToolbox",value:function(e){var t=0;this.workspace.getAllBlocks().forEach(function(n){n.type===e&&(t+=1)});var n=document.getElementById(e);String(t)>=n.getAttribute("max_use")?n.setAttribute("disabled",!0):n.setAttribute("disabled",!1)}},{key:"toggleBlocklyEvent",value:function(e){var t=this;if("ui"!=e.type&&o.default.get("Relay").dispatchEvent("Blockly.Changed",{blocklyEvt:e,modelType:"blockly"}),"create"==e.type){var n=!0;if(Array.prototype.slice.call((0,l.default)(document.getElementById("defaultWorkspaceBlocks")).find("block")).map(function(r){r.getAttribute("type")===t.workspace.getBlockById(e.blockId).type&&(n=!1)}),n){var r=this.workspace.getBlockById(e.blockId).type;this._updateToolbox(r)}}if("delete"==e.type){r=e.oldXml.getAttribute("type");this._updateToolbox(r)}if("move"==e.type&&["either_way","no_light","see_light"].indexOf(e.blockId)>-1){var i=e.newParentId,a=this.workspace.getBlockById(i);-1===["master_block","either_way","no_light","see_light"].indexOf(i)&&a.dispose(!0)}}},{key:"_onBlocklyLoad",value:function(e){if(!this.workspace)throw new Error("Blockly workspace does not exist.");if(this.workspace.removeChangeListener(this.toggleBlocklyEvent),this.workspace.clear(),e.data){var t=l.default.parseXML(e.data).documentElement;window.Blockly.Xml.domToWorkspace(t,this.workspace);for(var n=document.getElementById("toolbox").getElementsByTagName("block"),r=0;r<n.length;r++)this._updateToolbox(n[r].getAttribute("type"))}if(!this.workspace.getAllBlocks().length){var i=document.getElementById("defaultWorkspaceBlocks");window.Blockly.Xml.domToWorkspace(i,this.workspace)}}},{key:"_listenBlocklyEvents",value:function(e){"model"!==e.data.type||this.workspace.listeners_.length||this.workspace.addChangeListener(this.toggleBlocklyEvent)}},{key:"_onBodyChange",value:function(e){this._numSensors=e.data.numSensors;for(var t=toolbox.getElementsByTagName("block"),n=0;n<t.length;n++){var r=t[n],i=null;switch(r.getAttribute("sensors")){case"one":i=1;break;case"two":i=2}i&&String(i)!=e.data.numSensors?r.setAttribute("disabled",!0):r.setAttribute("disabled",!1)}if(this.workspace){this.workspace.removeChangeListener(this.toggleBlocklyEvent);var o=window.Blockly.Xml.workspaceToDom(window.Blockly.getMainWorkspace()),a=o.getElementsByTagName("block");for(n=0;n<a.length;n++){var s=a[n],u=document.getElementById(s.id);if(u.getAttribute("equivalence")){var l=document.getElementById(u.getAttribute("equivalence")).cloneNode(!0),c=s.parentNode,f=s.getElementsByTagName("next").length?s.getElementsByTagName("next")[0]:null;if(f&&l.appendChild(f),u.id.match("turn_at_")){var d=s.getElementsByTagName("field").DIRECTION.innerHTML;l.getElementsByTagName("field").DIRECTION.innerHTML=d}c.firstChild.remove(),c.append(l)}}this.workspace.clear(),window.Blockly.Xml.domToWorkspace(o,this.workspace),this.workspace.addChangeListener(this.toggleBlocklyEvent)}}}]),t}();f.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new f({modelData:e})},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(0)),o=(a(n(1)),a(n(2)),a(n(6)));a(n(73));function a(e){return e&&e.__esModule?e:{default:e}}var s={datasets:{},open:!1},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"toggle",value:function(){return this.set("open",!this.get("open")),Promise.resolve(!0)}},{key:"getDisplayState",value:function(){return{}}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(u(n(8)),u(n(0))),o=u(n(1)),a=(u(n(2)),u(n(3))),s=u(n(389));function u(e){return e&&e.__esModule?e:{default:e}}n(390);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||s.default));return i.default.bindMethods(r,["_onTabClick","_onModelChange","_onTransitionEnd"]),e.addEventListener("Model.Change",r._onModelChange),o.default.get("AppConfig.system.expModelModality").match("justbody")?(r.$el.find(".modeling__tab").css("display","none"),r.$el.find(".modeling").css("visibility","hidden")):r.$el.find(".modeling__tab").on("click",r._onTabClick),r.$el[0].addEventListener("transitionend",r._onTransitionEnd),r.disableFields(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"_onTransitionEnd",value:function(e){o.default.get("Relay").dispatchEvent("ModelingTab.TransitionEnd",{type:"model"},!0)}},{key:"disable",value:function(){this.$el.find(".modeling__tab").off("click")}},{key:"enable",value:function(){"justbody"!==o.default.get("AppConfig.system.expModelModality")&&this.$el.find(".modeling__tab").on("click",this._onTabClick)}},{key:"_onModelChange",value:function(e){"open"==e.data.path&&(this.$el.toggleClass("modeling__open",e.data.value),this.updateFieldStatus(e.currentTarget))}},{key:"updateFieldStatus",value:function(e){e.get("open")?this.enableFields():this.disableFields()}},{key:"enableFields",value:function(){this.$el.find("input, button").removeProp("disabled")}},{key:"disableFields",value:function(){this.$el.find("input, button").prop("disabled",!0)}},{key:"_onTabClick",value:function(e){o.default.get("Relay").dispatchEvent("ModelingTab.ToggleRequest",{tabType:"blockly"},!0)}},{key:"toggle",value:function(e){e?(this.$el.find("#selectModeling").removeClass("notflippedY"),this.$el.find("#selectModeling").addClass("flippedY")):(this.$el.find("#selectModeling").removeClass("flippedY"),this.$el.find("#selectModeling").addClass("notflippedY"))}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="modeling">\n  <div class="modeling__tab"> <img id=\'selectModeling\' class = \'notflippedY\' src="/cslib/module/euglena/model_blockly/blocklytab/arrow.png"> Modeling</div>\n  <div class="modeling__content">\n    <h2 class="modeling__title">Model of the Control Center</h2>\n    \x3c!-- <div class="modeling__display">\n      <div class="modeling__display__input" > Calculate the light signal at each moment, based on: <br>\n        <span id="one-eye"> the brightness of the photosensor. </span>\n        <span id="two-eyes"> the difference in brightness between the left and the right photosensor. </span>\n       </div>\n      <div class="modeling__display__arrow">\n        <img src="/cslib/module/euglena/model_blockly/blocklytab/arrow.png">\n        <img src="/cslib/module/euglena/model_blockly/blocklytab/arrow.png">\n        <img src="/cslib/module/euglena/model_blockly/blocklytab/arrow.png">\n      </div>\n      <div class="modeling__display__input"> Act on the light signal: </div> --\x3e\n      <div class="modeling__display__blockly" id=\'BlocklyDiv\'> </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){var r=n(391);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,'.modeling {\n  position: absolute;\n  z-index: 100;\n  right: -700px;\n  width: 700px;\n  height: 95%;\n  top: 8%;\n  border: 1px solid #282828;\n  background: #f9f9f9;\n  padding-right: 4rem;\n  transition: 0.5s ease right; }\n  .modeling.modeling__open {\n    right: -4rem;\n    z-index: 110; }\n  .modeling__content {\n    padding: 2rem;\n    width: 100%;\n    height: 80%; }\n  .modeling__tab {\n    font-size: 1.5rem;\n    line-height: 2rem;\n    border: 1px solid #282828;\n    background: #f9f9f9;\n    position: absolute;\n    top: calc(34% + 10.5rem);\n    left: calc(-6.2rem - 2px);\n    border-bottom: none;\n    padding: 0.5rem 1rem;\n    transform: rotate(-90deg);\n    cursor: pointer;\n    width: 10rem;\n    text-align: center; }\n    .modeling__tab #selectModeling.flippedY {\n      height: 20px;\n      transform: scaleY(-1); }\n    .modeling__tab #selectModeling.notflippedY {\n      height: 20px;\n      transform: scaleY(1); }\n  .modeling__display {\n    display: flex;\n    flex-direction: column;\n    align-items: top;\n    justify-content: flex-start;\n    width: 100%;\n    overflow-y: auto;\n    overflow-x: hidden; }\n    .modeling__display__input {\n      height: 10%;\n      min-width: 400px;\n      border: 1px solid #282828;\n      background: #f9f9f9;\n      text-align: center;\n      font-family: "Lora", serif;\n      font-weight: 700;\n      font-size: 14px;\n      padding: 0.5rem 2rem; }\n      .modeling__display__input #one-eye,\n      .modeling__display__input #two-eyes {\n        color: #7030A0; }\n    .modeling__display__arrow {\n      height: 30px;\n      text-align: center;\n      width: 450px;\n      margin: 0.5rem;\n      display: flex;\n      justify-content: space-around; }\n    .modeling__display__arrow img {\n      height: 30px; }\n    .modeling__display__blockly {\n      height: 450px;\n      min-width: 550px;\n      min-height: 300px;\n      border: 0px;\n      background: #f9f9f9;\n      text-align: center;\n      padding: 0.5rem 2rem; }\n',""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(15)),o=u(n(393)),a=u(n(394)),s=u(n(0));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.viewClass=e.viewClass||a.default,e.modelClass=e.modelClass||o.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));s.default.bindMethods(n,["_onVariationChange"]),n.checked=!1;var r=2===n._model.get("value").split("_").length?parseFloat(n._model.get("value").split("_")[1])/100:parseFloat(n._model.get("value").split("_").slice(-1).pop())/100,i={qualitativeValue:n._model.get("value"),numericValue:r*parseFloat(n._model.get("maxValue")),variation:0};return n._model.set("value",i),n._view.addEventListener("Field.ValueChange",n._onFieldChange),n._view.addEventListener("SymSelectField.ChangeRequest",n._onVariationChange),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onVariationChange",value:function(e){e.bubbles&&e.stopPropagation();var t=this._model.value(),n=2===e.data.value.split("_").length?parseFloat(e.data.value.split("_")[1])/100:parseFloat(e.data.value.split("_").slice(-1).pop())/100;this._model.updateValue("variation",n),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value().qualitativeValue})}},{key:"_onFieldChange",value:function(e){e.bubbles&&e.stopPropagation();var t=this._model.value(),n=2===e.data.value.split("_").length?parseFloat(e.data.value.split("_")[1])/100:parseFloat(e.data.value.split("_").slice(-1).pop())/100;this._model.set("value",{variation:this._model.get("value").variation,qualitativeValue:e.data.value,numericValue:n*parseFloat(this._model.get("maxValue"))}),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value().qualitativeValue})}},{key:"addOption",value:function(e){this._model.addOption(e)}},{key:"removeOption",value:function(e){this._model.removeOption(e)}},{key:"clearOptions",value:function(){this._model.clearOptions()}},{key:"getOptions",value:function(){return this._model.get("options")}},{key:"getAbleOptions",value:function(){return this._model.listAbleOptions()}},{key:"disableOption",value:function(e){this._model.disableOption(e)}},{key:"enableOption",value:function(e){this._model.enableOption(e)}},{key:"selectFirstAble",value:function(){var e=this._model.listAbleOptions();e.includes(this.value())||this.setValue(e[0])}},{key:"setValue",value:function(e){if(e){var t=this._model.value();this._model.updateValue("qualitativeValue",e.qualitativeValue),this._model.updateValue("numericValue",e.numericValue),this._model.updateValue("variation",e.variation),this.view()._render(this._model),this.dispatchEvent("Field.Change",{oldValue:t,value:this._model.value()})}}}]),t}();l.create=function(e){return new l({modelData:e})},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(14)),o=a(n(0));function a(e){return e&&e.__esModule?e:{default:e}}var s={options:{},disabledOptions:[]},u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=o.default.ensureDefaults(e.defaults,s);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.default.exists(n.get("value"))||n.set("value",Object.keys(n.get("options"))[0]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"updateValue",value:function(e,t){var n=this.get("value");n[e]=t,this.set("value",n)}},{key:"addOption",value:function(e){var t=this.get("options");t[e.value]=e.label,this.set("options",t,!0)}},{key:"removeOption",value:function(e){var t=this.get("options");delete t[e],this.set("options",t,!0)}},{key:"clearOptions",value:function(){this.set("options",{},!0),this.set("value",null)}},{key:"disableOption",value:function(e){var t=this.get("options"),n=this.get("disabledOptions");void 0===t[e]||n.includes(e)||(n.push(e),this.set("disabledOptions",n))}},{key:"enableOption",value:function(e){var t=this.get("options"),n=this.get("disabledOptions");void 0!==t[e]&&n.includes(e)&&(n.splice(n.indexOf(e),1),this.set("disabledOptions",n))}},{key:"listAbleOptions",value:function(){var e=Object.keys(this.get("options")),t=this.get("disabledOptions"),n=[];return e.forEach(function(e){t.includes(e)||n.push(e)}),n}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(16)),o=l(n(395)),a=l(n(0)),s=l(n(397)),u=l(n(8));function l(e){return e&&e.__esModule?e:{default:e}}n(398);var c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n||s.default));return a.default.bindMethods(r,["_onFieldChange","_onModelChange","_addVariationPopUp","_onVariationChange"]),r._options={},r._varOptions={},e.get("color")&&r.$el.find(".symselectfield__label").css("color",e.get("color")),Object.keys(e.get("varOptions")).length?(r.variation=!0,r._addVariationPopUp(e),r.$el.find(".variation__select").on("change",r._onVariationChange)):(r.variation=!1,r.$el.find(".symselectfield__variation").remove(),r.$el.find(".symselectfield__select").css({"margin-right":"calc(0.5rem + 160px)"})),r._render(e),r.$el.find(".symselectfield__select").on("change",r._onFieldChange),r.$el.find(".symselectfield__select").css({"font-size":"12px"}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"_onVariationChange",value:function(e){this.dispatchEvent("SymSelectField.ChangeRequest",{value:this.$el.find(".variation__select").val()})}},{key:"_onModelChange",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onModelChange",this).call(this,e),"disabledOptions"==e.data.path?Object.values(this._options).forEach(function(t){e.data.value.includes(t.id())?(t.disable(),t.hide()):(t.show(),t.enable())}):this._render(e.currentTarget)}},{key:"_onFieldChange",value:function(e){this.dispatchEvent("Field.ValueChange",{value:this.$el.find(".symselectfield__select").val()})}},{key:"disable",value:function(){this.$el.find(".symselectfield__select").prop("disabled",!0),this.variation&&this.$el.find(".variation_select").prop("disabled",!0)}},{key:"enable",value:function(){this.$el.find(".symselectfield__select").prop("disabled",!1),this.variation&&this.$el.find(".variation_select").prop("disabled",!1)}},{key:"focus",value:function(){this.$el.find(".symselectfield__select").focus()}},{key:"_render",value:function(e){for(var t in this.$el.find(".symselectfield__label").html(e.get("label")),this._options)Object.keys(e.get("options")).includes(t)||(this.removeChild(this._options[t]),delete this._options[t]);for(var n in e.get("options")){var r=e.get("options")[n];if(this._options[n]){var i=e.value().qualitativeValue;this._options[n].select(i==n)}else this._options[n]=new o.default({id:n,label:r,selected:e.value()==n}),this.addChild(this._options[n],".symselectfield__select")}if(this.variation){for(var a in this._varOptions)Object.keys(e.get("varOptions")).includes(a)||(this.removeChild(this._varOptions[a]),delete this._varOptions[a]);for(var s in e.get("varOptions")){var u=e.get("varOptions")[s];if(this._varOptions[s]){i="variation_"+100*e.value().variation;this._varOptions[s].select(i==s)}else this._varOptions[s]=new o.default({id:s,label:u,selected:e.value().variation==s}),this.addChild(this._varOptions[s],".variation__select")}}e.get("disabled")?this.disable():this.enable()}},{key:"_addVariationPopUp",value:function(e){var t="Variation means that some models can have a "+e.get("label").toLowerCase()+" that is different from the average value you picked. The bigger the variation the bigger the possible differences from the average.";this.$el.find(".variation__popup").html(t),this.$el.find(".variation__description").hover(function(e){var t=(0,u.default)(this).find(".variation__popup").position().left,n=(0,u.default)(this).find(".variation__popup").position().top,r=(0,u.default)(this).find(".variation__popup").height(),i=(0,u.default)(this).find(".variation__popup").width();(0,u.default)(this).find(".variation__popup").css({display:"inline-block",left:t-1*i,top:n-1.1*r})},function(){(0,u.default)(this).find(".variation__popup").css({display:"none"})})}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(3)),o=a(n(396));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.default));return n.$el.attr("value",e.id),n.$el.attr("numericValue",e.numericValue),n.$el.html(e.label),n.select(e.selected),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"id",value:function(){return this.$el.attr("value")}},{key:"numericValue",value:function(){return this.$el.attr("numericValue")}},{key:"select",value:function(e){this.$el.prop("selected",e)}},{key:"disable",value:function(){this.$el.prop("disabled",!0)}},{key:"enable",value:function(){this.$el.prop("disabled",!1)}}]),t}();t.default=s},function(e,t,n){"use strict";n.r(t),t.default="<option></option>\n"},function(e,t,n){"use strict";n.r(t),t.default='<div class="component__symselectfield component__field">\n  <label class="field__label symselectfield__label"></label>\n  <select class="symselectfield__select"></select>\n  <div class="symselectfield__variation">\n    <div class="variation__description_small"> + </div>\n    <select class="variation__select symselectfield__select"></select>\n    <div class="variation__description"> <div class="variation__popup"></div> Variation </div>\n\n\n  </div>\n</div>\n'},function(e,t,n){var r=n(399);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".component__symselectfield {\n  display: flex;\n  width: 100%;\n  justify-content: flex-end; }\n  .component__symselectfield .symselectfield__label {\n    display: inline-block;\n    flex-grow: 1;\n    font-size: 14px; }\n  .component__symselectfield .symselectfield__select {\n    display: inline-block;\n    margin: 0 0.5rem;\n    min-width: 90px; }\n  .component__symselectfield .symselectfield__variation {\n    display: inline-block;\n    width: 160px;\n    vertical-align: middle;\n    text-align: center; }\n    .component__symselectfield .symselectfield__variation .variation__select {\n      display: inline;\n      position: relative;\n      min-width: 50px;\n      font-size: 12px; }\n    .component__symselectfield .symselectfield__variation .variation__description {\n      position: relative;\n      display: inline;\n      font-size: 12px; }\n      .component__symselectfield .symselectfield__variation .variation__description_small {\n        position: relative;\n        display: inline;\n        font-size: 12px; }\n    .component__symselectfield .symselectfield__variation .variation__popup {\n      display: none;\n      position: absolute;\n      min-width: 150px;\n      max-width: 300px;\n      min-height: 25px;\n      background-color: #FFFFCD;\n      border: 1px solid black;\n      opacity: 0.95;\n      z-index: 10;\n      text-align: left;\n      font-size: 12px;\n      padding: 5px;\n      -webkit-box-shadow: 10px 10px 57px 0px #6b6b6b;\n      -moz-box-shadow: 10px 10px 57px 0px #6b6b6b;\n      box-shadow: 10px 10px 57px 0px #6b6b6b;\n      font-family: Arial, Helvetica, sans-serif; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(32)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(21)),a=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}var u={eyeColor:16777215},l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.config=a.default.ensureDefaults(n.config,u),"both"==e.addEye?(n.addEye({z:n.tubeCurve.getPoint(.85).z,y:2*n.config.tubeRadius/3,x:0},.75,"right"),n.addEye({z:n.tubeCurve.getPoint(.85).z,y:2*-n.config.tubeRadius/3,x:0},.75,"left")):"left"==e.addEye?n.addEye({z:n.tubeCurve.getPoint(.85).z,y:2*-n.config.tubeRadius/3,x:0},.75,"left"):n.addEye({z:n.tubeCurve.getPoint(.85).z,y:2*n.config.tubeRadius/3,x:0},.75,"right"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"addEye",value:function(e,t,n){for(var r=new o.SphereGeometry(this.config.tubeRadius,this.config.tubeSegments,this.config.tubeSegments),i=new o.MeshLambertMaterial({color:this.config.eyeColor}),a=new o.Mesh(r,i),s=["x","y","z"],u=0;u<s.length;u++){var l=s[u];a.scale[l]=t,a.position[l]=e[l]||0}a.name=n,this._body.add(a)}},{key:"addLeftEye",value:function(){this.addEye({z:this.tubeCurve.getPoint(.85).z,y:2*-this.config.tubeRadius/3,x:0},.75,"left")}},{key:"addRightEye",value:function(){this.addEye({z:this.tubeCurve.getPoint(.85).z,y:2*this.config.tubeRadius/3,x:0},.75,"right")}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(0)),o=u(n(1)),a=(u(n(2)),u(n(9))),s=u(n(402));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.get("AppConfig.aggregate")&&(i.default.bindMethods(e,["_onPhaseChange","_onExperimentCountChange"]),e.tab=new s.default,o.default.get("Relay").addEventListener("AppPhase.Change",e._onPhaseChange),o.default.get("Relay").addEventListener("ExperimentCount.Change",e._onExperimentCountChange)),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"run",value:function(){this.tab&&o.default.get("Layout").getPanel("result").addContent(this.tab.view())}},{key:"_onPhaseChange",value:function(e){"login"!=e.data.phase&&"login_attempted"!=e.data.phase||this.tab.hide()}},{key:"_onExperimentCountChange",value:function(e){e.data.count&&!e.data.old?this.tab.show():e.data.count||this.tab.hide()}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(0)),o=l(n(1)),a=(l(n(2)),l(n(7))),s=l(n(403)),u=l(n(405));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||s.default,e.viewClass=e.viewClass||u.default;var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.default.bindMethods(n,["_onAddRequest","_onToggleRequest","_onResultToggleRequest","_onClearAllRequest","_onClearRequest","_onGraphSelectionChange"]),o.default.get("Relay").addEventListener("AggregateData.AddRequest",n._onAddRequest),n.view().addEventListener("AggregateTab.ToggleRequest",n._onToggleRequest),n.view().addEventListener("LegendRow.ShowToggleRequest",n._onResultToggleRequest),n.view().addEventListener("LegendRow.ClearRequest",n._onClearRequest),n.view().addEventListener("Legend.ClearAllRequest",n._onClearAllRequest),n.view().addEventListener("AggregateTab.GraphSelectionChange",n._onGraphSelectionChange),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"hide",value:function(){this.view().hide()}},{key:"show",value:function(){this.view().show()}},{key:"_onAddRequest",value:function(e){this._model.addDataSet(e.data.data)}},{key:"_onToggleRequest",value:function(e){this._model.toggle(),o.default.get("Logger").log({type:this._model.get("open")?"open":"close",category:"aggregate",data:{displayState:this._model.getDisplayState(),visualization:this.view().getCurrentVisualization()}})}},{key:"_onResultToggleRequest",value:function(e){this._model.toggleResult(e.data.resultId),o.default.get("Logger").log({type:"result_toggle",category:"aggregate",data:{displayState:this._model.getDisplayState(),visualization:this.view().getCurrentVisualization()}})}},{key:"_onClearRequest",value:function(e){this._model.clearResult(e.data.resultId),o.default.get("Logger").log({type:"remove_data",category:"aggregate",data:{resultId:e.data.resultId,displayState:this._model.getDisplayState(),visualization:this.view().getCurrentVisualization()}})}},{key:"_onClearAllRequest",value:function(e){this._model.clearResultGroup(e.data.experimentId),o.default.get("Logger").log({type:"remove_group",category:"aggregate",data:{experimentId:e.data.experimentId,displayState:this._model.getDisplayState(),visualization:this.view().getCurrentVisualization()}})}},{key:"_onGraphSelectionChange",value:function(e){o.default.get("Logger").log({type:"visualization_change",category:"aggregate",data:{displayState:this._model.getDisplayState(),visualization:this.view().getCurrentVisualization()}})}}]),t}();c.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new c({modelData:e})},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(0)),o=l(n(1)),a=(l(n(2)),l(n(6))),s=l(n(73)),u=l(n(404));function l(e){return e&&e.__esModule?e:{default:e}}var c={datasets:{},open:!1},f=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,c),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"addDataSet",value:function(e){var t=this.get("datasets");if(t[e.experimentId]||(t[e.experimentId]=new u.default({data:{experimentId:e.experimentId,experiment:o.default.get("currentExperiment")}})),!t[e.experimentId].contains(e.id)){var n=new a.default({data:e}),r=Object.values(t).reduce(function(e,t){return e.concat(t.get("results").map(function(e){return e.get("color")}))},[]),i=!0,l=!1,c=void 0;try{for(var f,d=s.default[Symbol.iterator]();!(i=(f=d.next()).done);i=!0){var h=f.value;if(!r.includes(h)){n.set("color",h);break}}}catch(e){l=!0,c=e}finally{try{!i&&d.return&&d.return()}finally{if(l)throw c}}n.get("color")||n.set("color","#000000"),n.set("shown",!0),t[e.experimentId].addResult(n),this.set("datasets",t),this.dispatchEvent("AggregateData.DataSetAdded",{dataset:n,resultGroup:t[e.experimentId]})}}},{key:"clearResult",value:function(e){var t=this.getResultById(e),n=this.get("datasets"),r=t.get("experimentId");n[r]&&n[r].contains(e)&&(n[r].removeResult(e),0==n[r].length()&&this.clearResultGroup(r)),this.set("datasets",n),this.dispatchEvent("AggregateData.DataSetRemoved",{dataset:t})}},{key:"clearResultGroup",value:function(e){var t=this.get("datasets"),n=t[e];delete t[e],this.dispatchEvent("AggregateData.ResultGroupRemoved",{group:n})}},{key:"getResultById",value:function(e){var t=Object.values(this.get("datasets")),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=!0,l=!1,c=void 0;try{for(var f,d=s.get("results")[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var h=f.value;if(h.get("id")==e)return h}}catch(e){l=!0,c=e}finally{try{!u&&d.return&&d.return()}finally{if(l)throw c}}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return null}},{key:"toggle",value:function(){this.set("open",!this.get("open"))}},{key:"toggleResult",value:function(e){var t=this.getResultById(e);t&&(t.set("shown",!t.get("shown")),this.dispatchEvent("AggregateData.ResultToggle",{resultId:t.get("id"),shown:t.get("shown")}))}},{key:"getDisplayState",value:function(){var e={};return Object.values(this.get("datasets")).forEach(function(t){e[t.get("experimentId")]={},t.get("results").forEach(function(n){e[t.get("experimentId")][n.get("id")]=n.get("shown")})}),e}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(0)),o=(a(n(1)),a(n(2)),a(n(6)));function a(e){return e&&e.__esModule?e:{default:e}}var s={experiment:null,results:[]},u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.default.bindMethods(n,["_ensureExperimentName"]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"contains",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.get("results")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){if(i.value.get("id")==e)return!0}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return!1}},{key:"length",value:function(){return this.get("results").length}},{key:"addResult",value:function(e){var t=this.get("results");t.map(function(e){return e.get("id")}).includes(e.get("id"))||(t.push(e),t.sort(function(e,t){return e.get("experimentId")==t.get("experimentId")?e.get("id")-t.get("id"):e.get("experimentId")-t.get("experimentId")}),this.set("results",t),this.dispatchEvent("ResultGroup.ResultAdded",{dataset:e}),e.get("euglenaModelId")?i.default.promiseAjax("/api/v1/EuglenaModels/"+e.get("euglenaModelId")).then(function(t){e.set("name",t.name)}):this.get("experiment")?e.set("name",new Date(this.get("experiment.date_created")).toLocaleString()):this.addEventListener("Model.Change",this._ensureExperimentName))}},{key:"_ensureExperimentName",value:function(e){var t=this;"experiment"==e.data.path&&(this.removeEventListener("Model.Change",this._ensureExperimentName),this.get("results").forEach(function(e){e.get("name")||e.get("euglenaModelId")||e.set("name",new Date(t.get("experiment.date_created")).toLocaleString())}))}},{key:"removeResult",value:function(e){var t=this.get("results"),n=t.filter(function(t){return t.get("id")==e})[0];t.splice(t.indexOf(n),1),this.set("results",t),this.dispatchEvent("ResultGroup.ResultRemoved",{dataset:n})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=h(n(0)),o=(h(n(1)),h(n(2)),h(n(3))),a=h(n(406)),s=h(n(407)),u=h(n(411)),l=h(n(423)),c=h(n(425)),f=h(n(431)),d=h(n(17));function h(e){return e&&e.__esModule?e:{default:e}}n(437);var p=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));i.default.bindMethods(r,["_onDataSetAdded","_onDataSetRemoved","_onDataSetsCleared","_onTabClick","_onModelChange","_onResultGroupRemoved","_onGraphSelectionChange","_onResultToggle","_onGraphDisableRequest","_onGraphEnableRequest"]),r._legends={},r._graphs={orientation_time:u.default.create({}),velocity_time:l.default.create({}),orientation_intensity:c.default.create({}),orientation_direction:f.default.create({})},Object.values(r._graphs).forEach(function(e){r.addChild(e.view(),".aggregate__graphs"),e.addEventListener("AggregateGraph.DisableRequest",r._onGraphDisableRequest),e.addEventListener("AggregateGraph.EnableRequest",r._onGraphEnableRequest)});var o={};for(var s in r._graphs)o[s]=r._graphs[s].label();return r._graphSelect=d.default.create({label:"Visualization",id:"visualization",options:o,value:"orientation_time"}),r.addChild(r._graphSelect.view(),".aggregate__legend__visualization"),r._graphSelect.addEventListener("Field.Change",r._onGraphSelectionChange),r._onGraphSelectionChange(),e.addEventListener("Model.Change",r._onModelChange),e.addEventListener("AggregateData.DataSetAdded",r._onDataSetAdded),e.addEventListener("AggregateData.DataSetRemoved",r._onDataSetRemoved),e.addEventListener("AggregateData.DataSetsCleared",r._onDataSetsCleared),e.addEventListener("AggregateData.ResultGroupRemoved",r._onResultGroupRemoved),e.addEventListener("AggregateData.ResultToggle",r._onResultToggle),r.$el.find(".aggregate__tab").click(r._onTabClick),r.disableFields(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"updateGraphs",value:function(e){Object.values(this._graphs).forEach(function(t){t.update(e.get("datasets")),Object.values(e.get("datasets")).forEach(function(e){e.get("results").forEach(function(e){t.toggleResult(e.get("id"),e.get("shown"))})})})}},{key:"_onGraphSelectionChange",value:function(e){for(var t in this._graphs)t==this._graphSelect.value()?this._graphs[t].view().show():this._graphs[t].view().hide();this.dispatchEvent("AggregateTab.GraphSelectionChange",{})}},{key:"_onModelChange",value:function(e){"open"==e.data.path&&(this.$el.toggleClass("aggregate__open",e.data.value),this.updateFieldStatus(e.currentTarget))}},{key:"updateFieldStatus",value:function(e){e.get("open")?this.enableFields():this.disableFields()}},{key:"enableFields",value:function(){this._graphSelect.enable(),this.$el.find("input, button").removeProp("disabled")}},{key:"disableFields",value:function(){this._graphSelect.disable(),this.$el.find("input, button").prop("disabled",!0)}},{key:"_onDataSetAdded",value:function(e){this.$el.find(".aggregate__legend__empty").hide();e.data.dataset;var t=e.data.resultGroup.get("experimentId");this._legends[t]||(this._legends[t]=new s.default(e.currentTarget.get("datasets."+t)),this.addChild(this._legends[t],".aggregate__legend__results")),this.updateGraphs(e.currentTarget),this.updateFieldStatus(e.currentTarget)}},{key:"_onDataSetRemoved",value:function(e){0==Object.values(e.currentTarget.get("datasets")).length&&this.$el.find(".aggregate__legend__empty").show(),this.updateGraphs(e.currentTarget),this.updateFieldStatus(e.currentTarget)}},{key:"_onDataSetsCleared",value:function(e){this.$el.find(".aggregate__legend__empty").show(),this.updateGraphs(e.currentTarget),this.updateFieldStatus(e.currentTarget)}},{key:"_onTabClick",value:function(e){this.dispatchEvent("AggregateTab.ToggleRequest",{},!0)}},{key:"_onResultGroupRemoved",value:function(e){var t=e.data.group.get("experimentId");this.removeChild(this._legends[t]),delete this._legends[t],this._onDataSetRemoved(e),this.updateFieldStatus(e.currentTarget)}},{key:"_onResultToggle",value:function(e){Object.values(this._graphs).forEach(function(t){t.toggleResult(e.data.resultId,e.data.shown)})}},{key:"_onGraphEnableRequest",value:function(e){this._graphSelect.enableOption(e.data.id)}},{key:"_onGraphDisableRequest",value:function(e){this._graphSelect.disableOption(e.data.id),this._graphSelect.selectFirstAble()}},{key:"getCurrentVisualization",value:function(){return this._graphs[this._graphSelect.value()].label()}}]),t}();t.default=p},function(e,t,n){"use strict";n.r(t),t.default='<div class="aggregate">\n  <div class="aggregate__tab">Compare Experiments</div>\n  <div class="aggregate__content">\n    <h2 class="aggregate__title">Compare Experiments</h2>\n    <div class="aggregate__display">\n      <div class="aggregate__graphs"></div>\n      <div class="aggregate__legend">\n        <div class="aggregate__legend__visualization"></div>\n        <h3 class="aggregate__legend__title">Result Sets:</h3>\n        <div class="aggregate__legend__results"></div>\n        <div class="aggregate__legend__empty">Live and model results may be added to the visualization via the Experiment and Model Tabs.</div>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(0)),o=(l(n(1)),l(n(2)),l(n(3))),a=l(n(408)),s=l(n(409)),u=l(n(12));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));return i.default.bindMethods(r,["_onDataSetRemoved","_onDataSetAdded"]),r._rows=[],r._clear=u.default.create({id:"clear_all",label:"Clear All",style:"link",eventName:"Legend.ClearAllRequest",eventData:{experimentId:e.get("experimentId")}}),r.addChild(r._clear.view(),"thead th:last-child"),r.$el.find(".aggregate__legend__experiment__label").html("Experiment: "+new Date(e.get("experiment.date_created")).toLocaleString()),r.render(e),e.addEventListener("ResultGroup.ResultAdded",r._onDataSetAdded),e.addEventListener("ResultGroup.ResultRemoved",r._onDataSetRemoved),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onDataSetAdded",value:function(e){this.render(e.currentTarget)}},{key:"_onDataSetRemoved",value:function(e){this.render(e.currentTarget)}},{key:"render",value:function(e){for(var t=this;this._rows.length;)this.removeChild(this._rows.pop());e.get("results").forEach(function(e){var n=new s.default(e);t._rows.push(n),t.addChild(n,".aggregate__legend__experiment__list tbody")})}}]),t}();t.default=c},function(e,t,n){"use strict";n.r(t),t.default='<div class="aggregate__legend__experiment">\n  <div class="aggregate__legend__experiment__label"></div>\n  <table class="aggregate__legend__experiment__list">\n    <thead>\n      <tr>\n        <th>Show</th>\n        <th>Color</th>\n        <th>Name</th>\n        <th></th>\n      </tr>\n    </thead>\n    <tbody></tbody>\n  </table>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(0)),o=(u(n(1)),u(n(2)),u(n(3))),a=u(n(410)),s=u(n(12));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));return i.default.bindMethods(r,["_onModelChange","_onShownClick"]),r._resultId=e.get("id"),r._clear=s.default.create({id:"clear",label:"Clear",style:"link",eventName:"LegendRow.ClearRequest",eventData:{resultId:r._resultId}}),r.addChild(r._clear.view(),".aggregate__legend__clear"),e.addEventListener("Model.Change",r._onModelChange),r._render(e),r.$dom().find(".aggregate__legend__show").click(r._onShownClick),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onModelChange",value:function(e){this._render(e.currentTarget)}},{key:"_onShownClick",value:function(e){this.dispatchEvent("LegendRow.ShowToggleRequest",{resultId:this._resultId},!0)}},{key:"_render",value:function(e){e.get("name")&&this.$dom().find(".aggregate__legend__name").html(e.get("name")),e.get("color")&&this.$dom().find(".aggregate__legend__color").css({background:e.get("color")}),this.$dom().find(".aggregate__legend__show").prop("checked",e.get("shown"))}},{key:"id",value:function(){return this._resultId}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<tr>\n  <td><input class="aggregate__legend__show" type="checkbox" checked/></td>\n  <td><div class="aggregate__legend__color"></div></td>\n  <td><div class="aggregate__legend__name"></div></td>\n  <td><div class="aggregate__legend__clear"></div></td>\n</tr>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(n(0)),o(n(1)),o(n(2));var r=o(n(74)),i=o(n(422));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||i.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();a.create=function(e){return new a({modelData:e})},t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(0)),o=(l(n(1)),l(n(2)),l(n(3))),a=l(n(413)),s=l(n(414)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(19));function l(e){return e&&e.__esModule?e:{default:e}}n(420);var c=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));i.default.bindMethods(r,["_onModelChange"]);var o=u.select(r.$el.find(".graph").get(0)).append("svg");return o.classed(e.get("graph_class"),!0),o.attr("width","100%").attr("viewBox","0 0 "+(e.get("width")+e.get("margins.left")+e.get("margins.right"))+" "+(e.get("height")+e.get("margins.top")+e.get("margins.bottom"))).attr("preserveAspectRatio","xMinYMin"),r.svg=o.append("g").attr("transform","translate("+e.get("margins.left")+", "+e.get("margins.top")+")"),r.scales={},r.scales.x=u.scaleLinear().range([0,e.get("width")]),r.scales.y=u.scaleLinear().range([e.get("height"),0]),r.grid=s.default.create(),r.addChild(r.grid.view(),".timegraph__lightgrid"),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onModelChange",value:function(e){"graph"==e.data.path&&(this.reset(e.currentTarget),e.data.value&&this.render(e.currentTarget))}},{key:"reset",value:function(e){this.svg.selectAll(".aggregate_time__line").remove(),this.grid.reset()}},{key:"render",value:function(e){var t=this;this.grid.update(e.get("graph.lights")),this.scales.x.domain([0,e.get("graph.runTime")]);var n=Math.max(Math.abs(e.get("graph.minValue")),Math.abs(e.get("graph.maxValue")));for(var r in this.scales.y.domain([e.get("graph.minValue")<0?-n:0,n]),this.axes={x:u.axisBottom().scale(this.scales.x),y:u.axisLeft().scale(this.scales.y)},this.svg.selectAll(".aggregate_time__axis").remove(),this.svg.append("g").attr("class","aggregate_time__axis aggregate_time__axis-x").attr("transform","translate(0, "+e.get("height")+")").call(this.axes.x).append("text").attr("class","aggregate_time__axis-label").text("Time").attr("x",e.get("width")/2).attr("y",30),this.svg.append("g").attr("class","aggregate_time__axis aggregate_time__axis-y").call(this.axes.y).append("text").attr("class","aggregate_time__axis-label").text(e.get("axis_label")).attr("transform","rotate(-90)").attr("y",-30).attr("x",-e.get("height")/2),e.get("graph.lines")){var i=e.get("graph.lines."+r+".data"),o=u.line().x(function(e){return t.scales.x(e.time)}).y(function(e){return t.scales.y(e.value)});this.svg.append("path").datum(i).attr("class","aggregate_time__line aggregate_time__line__"+r).attr("d",o).style("stroke",e.get("graph.lines."+r+".color"))}}},{key:"toggleResult",value:function(e,t){this.svg.selectAll(".aggregate_time__line__"+e).style("opacity",t?.8:0)}}]),t}();t.default=c},function(e,t,n){"use strict";n.r(t),t.default='<div class="aggregatetimegraph">\n  <div class="graph"></div>\n  <div class="timegraph__lightgrid"></div>\n</div>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(s(n(0)),s(n(1)),s(n(2)),s(n(7))),o=s(n(415)),a=s(n(416));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"update",value:function(e){this._model.update(e)}},{key:"reset",value:function(){this._model.reset()}}]),t}();u.create=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(0)),o=(a(n(1)),a(n(2)),a(n(6)));function a(e){return e&&e.__esModule?e:{default:e}}var s={duration:0,lights:{top:[],bottom:[],left:[],right:[]}},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"update",value:function(e){var t={top:[],bottom:[],left:[],right:[]},n=0;e.forEach(function(e){for(var r in n+=e.duration,t)t[r].push({intensity:e[r],duration:e.duration})}),this.set("duration",n),this.set("lights",t)}},{key:"reset",value:function(){this.set("lights",{top:[],bottom:[],left:[],right:[]})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(0)),o=(s(n(1)),s(n(2)),s(n(3))),a=s(n(417));s(n(8));function s(e){return e&&e.__esModule?e:{default:e}}n(418);var u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));return i.default.bindMethods(r,["_onModelChange"]),r._spans=[],e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onModelChange",value:function(e){"lights"==e.data.path&&this.render(e.currentTarget)}},{key:"render",value:function(e){for(var t=this,n=e.get("lights");this._spans.length;)this.removeChild(this._spans.pop());var r=function(r){var i=0;n[r].forEach(function(n){if(n.intensity>0){var a=new o.default('<span class="lightgrid__span">'+n.intensity+"</span>");a.$dom().css({width:100*n.duration/e.get("duration")+"%",left:100*i/e.get("duration")+"%"}),t._spans.push(a),t.addChild(a,".lightgrid__row__"+r+" .lightgrid__row__intensities")}i+=n.duration})};for(var i in n)r(i)}}]),t}();t.default=u},function(e,t,n){"use strict";n.r(t),t.default='<div class="lightgrid">\n  <div class="lightgrid__row lightgrid__row__top">\n    <label class="lightgrid__row__label">Top</label>\n    <div class="lightgrid__row__intensities"></div>\n  </div>\n  <div class="lightgrid__row lightgrid__row__left">\n    <label class="lightgrid__row__label">Left</label>\n    <div class="lightgrid__row__intensities"></div>\n  </div>\n  <div class="lightgrid__row lightgrid__row__right">\n    <label class="lightgrid__row__label">Right</label>\n    <div class="lightgrid__row__intensities"></div>\n  </div>\n  <div class="lightgrid__row lightgrid__row__bottom">\n    <label class="lightgrid__row__label">Bottom</label>\n    <div class="lightgrid__row__intensities"></div>\n  </div>\n</div>'},function(e,t,n){var r=n(419);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".lightgrid__row {\n  line-height: 2rem; }\n  .lightgrid__row__label {\n    font-size: 1rem;\n    font-weight: bold;\n    width: 13.33333%;\n    float: left;\n    padding-right: 2rem; }\n  .lightgrid__row__intensities {\n    width: 83.33333%;\n    margin-left: 13.33333%;\n    height: 2rem;\n    position: relative; }\n\n.lightgrid__span {\n  position: absolute;\n  height: 100%;\n  border: 1px solid #101010;\n  background: #FFFF99;\n  text-align: center;\n  font-size: 1rem;\n  line-height: 2rem;\n  overflow: hidden; }\n",""])},function(e,t,n){var r=n(421);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".aggregate_time__line {\n  stroke-width: 0.15rem;\n  fill: none;\n  opacity: 0.8; }\n\n.aggregate_time__axis-label {\n  fill: #282828;\n  text-anchor: middle;\n  font-weight: bold; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(0)),o=(a(n(1)),a(n(2)),a(n(41)));function a(e){return e&&e.__esModule?e:{default:e}}var s={id:"orientation_time",graph_class:"orientation_time",axis_label:"Average Orientation",label:"Average Orientation over Time"},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"generateLinePoint",value:function(e,t){var n=0,r=0;e.samples.forEach(function(e){n+=Math.cos(e.angleXY),r+=Math.sin(e.angleXY)});var i=180*Math.atan2(r,n)/Math.PI;return Math.abs(i)>90&&(i-=180*Math.sign(i)),Math.abs(i)}},{key:"getMinValue",value:function(e){return 0}},{key:"getMaxValue",value:function(e){return 90}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o(n(0)),o(n(1)),o(n(2));var r=o(n(74)),i=o(n(424));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||i.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();a.create=function(e){return new a({modelData:e})},t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(0)),o=(a(n(1)),a(n(2)),a(n(41)));function a(e){return e&&e.__esModule?e:{default:e}}var s={id:"velocity_time",graph_class:"velocity_time",axis_label:"Average Velocity",label:"Average Velocity over Time"},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,s),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"generateLinePoint",value:function(e,t){return e.samples.length?e.samples.reduce(function(e,t){return e+t.speed},0)/e.samples.length:0}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(s(n(0)),s(n(1)),s(n(2)),s(n(7))),o=s(n(426)),a=s(n(427));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"update",value:function(e){this._model.update(e)}},{key:"label",value:function(){return this._model.get("label")}},{key:"toggleResult",value:function(e,t){this.view().toggleResult(e,t)}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(0)),o=(s(n(1)),s(n(2)),s(n(6))),a=s(n(18));function s(e){return e&&e.__esModule?e:{default:e}}var u={graph_class:"orientation_intensity",label:"Orientation WRT Light by Light Intensity",width:500,height:300,margins:{top:20,bottom:40,left:80,right:20}},l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"update",value:function(e){var t=this,n={};Object.values(e).forEach(function(e){e.get("results").forEach(function(r){n[r.get("id")]=t.generateBuckets(r,e.get("experiment"))})}),this.set("graph",{histograms:n})}},{key:"generateBuckets",value:function(e,t){var n={};return e.get("tracks").forEach(function(e){e.samples.forEach(function(e){var r=a.default.getLightState(t.configuration,e.time,{angle:!0,intensity:!0}),o=i.default.roundDecimal(r.intensity,-2).toString();n[o]=n[o]||{samples:[]},n[o].samples.push(e.angleXY-r.angle)})}),Object.values(n).forEach(function(e){var t=0,n=0;e.samples.forEach(function(e){t+=Math.cos(e),n+=Math.sin(e)}),e.value=180*Math.atan2(n,t)/Math.PI}),{id:e.get("id"),color:e.get("color"),data:n}}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(0)),o=(u(n(1)),u(n(2)),u(n(3))),a=u(n(428)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(19));function u(e){return e&&e.__esModule?e:{default:e}}n(429);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));i.default.bindMethods(r,["_onModelChange"]);var o=s.select(r.$el.find(".graph").get(0)).append("svg");return o.classed(e.get("graph_class"),!0),o.attr("width","100%").attr("viewBox","0 0 "+(e.get("width")+e.get("margins.left")+e.get("margins.right"))+" "+(e.get("height")+e.get("margins.top")+e.get("margins.bottom"))).attr("preserveAspectRatio","xMinYMin"),r.svg=o.append("g").attr("transform","translate("+e.get("margins.left")+", "+e.get("margins.top")+")"),r.scales={},r.scales.x=s.scalePoint().range([0,e.get("width")]).padding(.5),r.scales.y=s.scaleLinear().range([e.get("height"),0]),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onModelChange",value:function(e){"graph"==e.data.path&&(this.reset(),this.render(e.currentTarget))}},{key:"reset",value:function(){this.svg.selectAll(".orin__axis").remove(),this.svg.selectAll(".orin__pt").remove()}},{key:"render",value:function(e){var t=this,n=e.get("graph.histograms"),r=[];Object.values(n).forEach(function(e){Object.keys(e.data).forEach(function(e){r.includes(e)||r.push(e)})}),r.sort(function(e,t){return+e-+t}),this.scales.x.domain(r),this.scales.y.domain([-180,180]),this.axes={x:s.axisBottom().scale(this.scales.x),y:s.axisLeft().scale(this.scales.y).tickValues([-180,-135,-90,-45,0,45,90,135,180])},this.svg.selectAll(".orin__axis").remove(),this.svg.append("g").attr("class","orin__axis orin__axis-x").attr("transform","translate(0, "+e.get("height")+")").call(this.axes.x).append("text").attr("class","orin__axis-label").text("Light Intensity").attr("x",e.get("width")/2).attr("y",30),this.svg.append("g").attr("class","orin__axis orin__axis-y").call(this.axes.y).append("text").attr("class","orin__axis-label").text("Avg. Orientation WRT Light Direction").attr("transform","rotate(-90)").attr("y",-30).attr("x",-e.get("height")/2);var i=s.symbol().size(20);Object.values(n).forEach(function(e){for(var n in e.data)t.svg.append("path").attr("d",i).attr("class","orin__pt orin__pt__"+e.id).attr("fill",e.color).attr("transform","translate("+t.scales.x(n)+", "+t.scales.y(e.data[n].value)+")").style("opacity",.95)})}},{key:"toggleResult",value:function(e,t){this.svg.selectAll(".orin__pt__"+e).style("opacity",t?.75:0)}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="oringraph">\n  <div class="graph"></div>\n</div>'},function(e,t,n){var r=n(430);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".oringraph .orin__axis-x .domain {\n  display: none; }\n\n.oringraph .orin__axis-label {\n  fill: #282828;\n  text-anchor: middle;\n  font-weight: bold; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(s(n(0)),s(n(1)),s(n(2)),s(n(7))),o=s(n(432)),a=s(n(433));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,e.viewClass=e.viewClass||a.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"update",value:function(e){this._model.update(e)}},{key:"label",value:function(){return this._model.get("label")}},{key:"toggleResult",value:function(e,t){this.view().toggleResult(e,t)}}]),t}();u.create=function(e){return new u({modelData:e})},t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(0)),o=(s(n(1)),s(n(2)),s(n(6))),a=s(n(18));function s(e){return e&&e.__esModule?e:{default:e}}var u={graph_class:"orientation_Direction",label:"Orientation WRT Light by Light Direction",width:500,height:300,margins:{top:20,bottom:40,left:80,right:20}},l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"update",value:function(e){var t=this,n=[];Object.values(e).forEach(function(e){e.get("results").forEach(function(r){n.push(t.generateBuckets(r,e.get("experiment")))})}),this.set("graph",{histograms:n})}},{key:"generateBuckets",value:function(e,t){var n={};return e.get("tracks").forEach(function(e){e.samples.forEach(function(e){var r=a.default.getLightState(t.configuration,e.time,{angle:!0}),i=r.angle.toString();n[i]=n[i]||{angle:r.angle,samples:[]},n[i].samples.push(e.angleXY-r.angle)})}),Object.values(n).forEach(function(e){var t=0,n=0;e.samples.forEach(function(e){t+=Math.cos(e),n+=Math.sin(e)}),e.value=180*Math.atan2(n,t)/Math.PI}),{id:e.get("id"),color:e.get("color"),data:n}}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(0)),o=(u(n(1)),u(n(2)),u(n(3))),a=u(n(434)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(19));function u(e){return e&&e.__esModule?e:{default:e}}n(435);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n||a.default));i.default.bindMethods(r,["_onModelChange"]);var o=s.select(r.$el.find(".graph").get(0)).append("svg");return o.classed(e.get("graph_class"),!0),o.attr("width","100%").attr("viewBox","0 0 "+(e.get("width")+e.get("margins.left")+e.get("margins.right"))+" "+(e.get("height")+e.get("margins.top")+e.get("margins.bottom"))).attr("preserveAspectRatio","xMinYMin"),r.svg=o.append("g").attr("transform","translate("+e.get("margins.left")+", "+e.get("margins.top")+")"),r.scales={},r.scales.x=s.scaleLinear().range([0,e.get("width")]).domain([-180,180]),r.scales.y=s.scaleLinear().range([e.get("height"),0]).domain([-180,180]),r.axes={x:s.axisBottom().scale(r.scales.x).tickValues([-180,-135,-90,-45,0,45,90,135,180]),y:s.axisLeft().scale(r.scales.y).tickValues([-180,-135,-90,-45,0,45,90,135,180])},r.svg.append("g").attr("class","ordir__axis ordir__axis-x").attr("transform","translate(0, "+e.get("height")+")").call(r.axes.x).append("text").attr("class","ordir__axis-label").text("Light Direction").attr("x",e.get("width")/2).attr("y",30),r.svg.append("g").attr("class","ordir__axis ordir__axis-y").call(r.axes.y).append("text").attr("class","ordir__axis-label").text("Avg. Orientation WRT Light Direction").attr("transform","rotate(-90)").attr("y",-30).attr("x",-e.get("height")/2),e.addEventListener("Model.Change",r._onModelChange),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"_onModelChange",value:function(e){"graph"==e.data.path&&(this.reset(),this.render(e.currentTarget))}},{key:"reset",value:function(){this.svg.selectAll(".ordir__pt").remove()}},{key:"render",value:function(e){var t=this,n=e.get("graph.histograms"),r=[];Object.values(n).forEach(function(e){Object.keys(e.data).forEach(function(e){r.includes(e)||r.push(e)})}),r.sort(function(e,t){return+e-+t});var i=s.symbol().size(20);n.forEach(function(e){Object.values(e.data).forEach(function(n){t.svg.append("path").attr("d",i).attr("class","ordir__pt ordir__pt__"+e.id).attr("fill",e.color).attr("transform","translate("+t.scales.x(180*n.angle/Math.PI)+", "+t.scales.y(n.value)+")").style("opacity",.95)})})}},{key:"toggleResult",value:function(e,t){this.svg.selectAll(".ordir__pt__"+e).style("opacity",t?.75:0)}}]),t}();t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<div class="ordirgraph">\n  <div class="graph"></div>\n</div>'},function(e,t,n){var r=n(436);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".ordirgraph .ordir__axis-label {\n  fill: #282828;\n  text-anchor: middle;\n  font-weight: bold; }\n",""])},function(e,t,n){var r=n(438);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,".aggregate {\n  position: absolute;\n  z-index: 100;\n  right: -100%;\n  width: 100%;\n  height: 98%;\n  top: 1%;\n  border: 1px solid #282828;\n  background: #f9f9f9;\n  padding-right: 4rem;\n  transition: 0.5s ease right; }\n  .aggregate.aggregate__open {\n    right: -4rem;\n    z-index: 110; }\n  .aggregate__content {\n    padding: 2rem;\n    overflow: auto; }\n  .aggregate__tab {\n    font-size: 1.5rem;\n    line-height: 2rem;\n    border: 1px solid #282828;\n    background: #f9f9f9;\n    position: absolute;\n    top: calc(40% - 5rem);\n    left: calc(-11.2rem - 2px);\n    border-bottom: none;\n    padding: 0.5rem 1rem;\n    transform: rotate(-90deg);\n    cursor: pointer;\n    width: 20rem;\n    text-align: center; }\n  .aggregate__display {\n    display: flex; }\n  .aggregate__graphs {\n    flex: 2; }\n  .aggregate__legend {\n    flex: 1; }\n    .aggregate__legend__experiment {\n      margin-bottom: 1rem; }\n      .aggregate__legend__experiment__label {\n        font-style: italic; }\n      .aggregate__legend__experiment__list {\n        border-collapse: collapse; }\n        .aggregate__legend__experiment__list th, .aggregate__legend__experiment__list td {\n          padding: 0.25rem 0.5rem;\n          text-align: center; }\n        .aggregate__legend__experiment__list thead {\n          background: #939393; }\n        .aggregate__legend__experiment__list tbody tr {\n          background: #efefef; }\n          .aggregate__legend__experiment__list tbody tr:nth-child(2n) {\n            background: #f9f9f9; }\n    .aggregate__legend__show {\n      display: block;\n      margin: auto; }\n    .aggregate__legend__color {\n      width: 2rem;\n      height: 1.5rem;\n      margin: auto; }\n    .aggregate__legend__name {\n      text-align: left; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(9)),i=(s(n(0)),s(n(1))),o=s(n(2)),a=s(n(440));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.default.hook("Euglena.Manager",function(e){return a.default.setModelData(i.default.get("AppConfig.managers.component")),e.candidates.push(a.default),e.manager=a.default,e}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(24)),o=(s(n(0)),s(n(441))),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(21));s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.modelClass=e.modelClass||o.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"initialize",value:function(e){e.controllerState.component={K:this._model.get("K")+(2*Math.random()-1)*this._model.get("K_delta"),v:this._model.get("v")+(2*Math.random()-1)*this._model.get("v_delta"),omega:this._model.get("omega")+(2*Math.random()-1)*this._model.get("omega_delta")}}},{key:"update",value:function(e){var t={position:{x:e.position.x,y:e.position.y,z:e.position.z},dYaw:0,dRoll:0};t.dRoll=e.controllerState.component.omega*e.dT;var n=e.object.getObjectByName("base").localToWorld(new a.Vector3(0,1,0)).sub(e.object.localToWorld(new a.Vector3(0,0,0))).normalize(),r=e.object.localToWorld(new a.Vector3(1,0,0)).sub(e.object.localToWorld(new a.Vector3(0,0,0))).normalize(),i=0,o=0;for(var s in e.lights){var u=new a.Vector3;switch(s){case"left":u.set(-1,0,0);break;case"right":u.set(1,0,0);break;case"top":u.set(0,1,0);break;case"bottom":u.set(0,-1,0)}u.normalize();var l=Math.acos(n.dot(u)),c=Math.cos(l)*e.lights[s];Math.acos(r.dot(u));if(Math.cos(l)>=0&&c>0)i+=c,o+=c*Math.sign(r.x*u.y-r.y*u.x)}return i*=o>0?1:-1,t.dYaw=e.controllerState.component.K*i+(2*Math.random()-1)*this._model.get("randomness"),t.position.x=e.position.x+Math.cos(e.yaw+t.dYaw)*e.controllerState.component.v*e.dT,t.position.y=e.position.y+Math.sin(e.yaw+t.dYaw)*e.controllerState.component.v*e.dT,t}},{key:"setModelData",value:function(e){for(var t in e)this._model.set(t,e[t])}}]),t}();t.default=new u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(6)),i=o(n(0));o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var a={K:.001,K_delta:2e-4,v:20,v_delta:4,omega:1,omega_delta:.2,opacity:.5,opacity_delta:.1,randomness:0},s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.defaults=i.default.ensureDefaults(e.defaults,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(42)),i=o(n(443));function o(e){return e&&e.__esModule?e:{default:e}}n(75);var a=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||i.default,function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a},function(e,t,n){"use strict";n.r(t),t.default='<div class="app"></div>'},function(e,t,n){(t=e.exports=n(4)(!1)).push([e.i,"@import url(http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300,400,700);",""]),t.push([e.i,"@import url(https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic);",""]),t.push([e.i,"@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css);",""]),t.push([e.i,'html, body {\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n  font-size: 12px;\n  overflow: hidden; }\n\nbody {\n  font-family: "Open Sans", Arial, sans-serif;\n  background: #f9f9f9; }\n\nhtml {\n  box-sizing: border-box; }\n\n*, *:before, *:after {\n  box-sizing: inherit; }\n\nh1, h2, h3, h4, h5, h6 {\n  font-family: "Lora", serif;\n  font-weight: 700; }\n\n.app {\n  display: flex;\n  width: 100%;\n  height: 100%;\n  font-size: 1.4rem; }\n\n.panel {\n  position: relative;\n  padding: 1.5rem;\n  height: 100%;\n  overflow-x: hidden;\n  overflow-y: hidden; }\n  .panel__interactive {\n    flex: 1;\n    min-width: 37rem;\n    background: #efefef;\n    border-right: 1px solid #282828; }\n  .panel__result {\n    flex: 4; }\n\n.component__textfield .textfield__field {\n  width: 100%;\n  padding: 4px;\n  line-height: 2rem;\n  font-size: 1.6rem; }\n\n.form__header {\n  font-family: "Lora", serif;\n  font-weight: 700;\n  font-size: 2.2rem;\n  margin-bottom: 1.5rem; }\n\n.form__login .component__button {\n  width: 100%;\n  margin: 0; }\n\n.form__login button.button {\n  width: 100%;\n  margin-left: 0;\n  margin-right: 0; }\n\n.form__help {\n  font-style: italic; }\n\n.component__button button.button {\n  padding: 10px; }\n  .component__button button.button:hover {\n    background: #d9d9d9; }\n\n.profile {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  padding: 1.5rem 2rem;\n  width: 100%;\n  font-size: 1.2rem;\n  line-height: 1.2rem;\n  border-top: 0.1rem solid #282828;\n  transition: 0.5s ease top; }\n  .profile__open {\n    top: calc(100% - 4.3rem); }\n  .profile .logout {\n    float: right; }\n',""])}]);
//# sourceMappingURL=litc-main.js.map
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

define(function (require) {
  var DomView = require('core/view/dom_view'),
      Utils = require('core/util/utils'),
      d3 = require('d3'),
      Template = require('text!./componentspeedgraph.html');
  require('link!./componentspeedgraph.css');

  var componentMap = {
    x: {
      title: 'left/right',
      labels: ['right', 'left'],
      color: 'rgb(55,152,195)',
      right: { 'x1': 55, 'x2': 75, 'y1': 35, 'y2': 35, 'xlabel': 75, 'ylabel': 30 },
      left: { 'x1': 45, 'x2': 25, 'y1': 35, 'y2': 35, 'xlabel': 25, 'ylabel': 30 }
    },
    y: {
      title: 'up/down',
      labels: ['up', 'down'],
      color: 'rgb(55,143,48)',
      up: { 'x1': 50, 'x2': 50, 'y1': 30, 'y2': 10, 'xlabel': 40, 'ylabel': 15 },
      down: { 'x1': 50, 'x2': 50, 'y1': 40, 'y2': 60, 'xlabel': 35, 'ylabel': 55 }
    }
  };
  return function (_DomView) {
    _inherits(ComponentSpeedView, _DomView);

    function ComponentSpeedView(model, tmpl) {
      _classCallCheck(this, ComponentSpeedView);

      var _this = _possibleConstructorReturn(this, (ComponentSpeedView.__proto__ || Object.getPrototypeOf(ComponentSpeedView)).call(this, tmpl || Template));

      Utils.bindMethods(_this, ['_onModelChange']);

      model.addEventListener('Model.Change', _this._onModelChange);

      if (model.get('mode') == "component") {
        _this.svgs = {
          x: null,
          y: null
        };
      } else {
        _this.svgs = {
          total: null
        };
      }
      for (var key in _this.svgs) {
        var _svg = d3.select(_this.$el.find('.component-speed__graph').get(0)).append('svg');
        _svg.classed('component-speed__graph__' + key, true);
        _svg.attr('width', model.get('width') + model.get('margins.left') + model.get('margins.right'));
        _svg.attr('height', model.get('height') + model.get('margins.top') + model.get('margins.bottom'));
        _this.svgs[key] = _svg.append('g').attr('transform', 'translate(' + model.get('margins.left') + ', ' + model.get('margins.top') + ')');
      }
      _this.scales = {};
      _this.scales.x = d3.scaleLinear().range([0, model.get('width')]);
      _this.scales.y = d3.scaleLinear().range([model.get('height'), 0]);

      var svg = d3.select(_this.$el.find('.component-speed__graph__image').get(0)).append('svg');
      svg.attr('width', 100).attr('height', 70);

      // Draw visualization to illustrate the meaning
      svg.append('ellipse').attr("cx", 0).attr("cy", 0).attr("rx", 16).attr("ry", 8).attr('transform', 'translate(50,35)rotate(-45)').attr('fill', 'black');

      for (var _key in _this.svgs) {
        svg.append("svg:defs").append("svg:marker").attr("id", 'arrow__image__' + _key).attr("refX", 0).attr("refY", 2).attr("markerWidth", 4).attr("markerHeight", 4).attr("orient", "auto").append("svg:path").attr("d", "M0,0 L0,4 L4,2 z").style('fill', componentMap[_key].color);

        svg.append("line").attr("x1", componentMap[_key][componentMap[_key].labels[0]].x1).attr("y1", componentMap[_key][componentMap[_key].labels[0]].y1).attr("x2", componentMap[_key][componentMap[_key].labels[0]].x2).attr("y2", componentMap[_key][componentMap[_key].labels[0]].y2).attr("stroke", componentMap[_key].color).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__image__' + _key);

        svg.append("line").attr("x1", componentMap[_key][componentMap[_key].labels[1]].x1).attr("y1", componentMap[_key][componentMap[_key].labels[1]].y1).attr("x2", componentMap[_key][componentMap[_key].labels[1]].x2).attr("y2", componentMap[_key][componentMap[_key].labels[1]].y2).attr("stroke", componentMap[_key].color).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__image__' + _key);

        svg.append('text').attr('class', 'component-speed__graph__image__label').text(componentMap[_key].labels[0]).style('fill', componentMap[_key].color).attr('y', componentMap[_key][componentMap[_key].labels[0]].ylabel).attr('x', componentMap[_key][componentMap[_key].labels[0]].xlabel);

        svg.append('text').attr('class', 'component-speed__graph__image__label').text(componentMap[_key].labels[1]).style('fill', componentMap[_key].color).attr('y', componentMap[_key][componentMap[_key].labels[1]].ylabel).attr('x', componentMap[_key][componentMap[_key].labels[1]].xlabel);
      }

      return _this;
    }

    _createClass(ComponentSpeedView, [{
      key: '_onModelChange',
      value: function _onModelChange(evt) {
        switch (evt.data.path) {
          case "data":
            if (evt.data.value) {
              this.reset();
              this.setup(evt.currentTarget);
            } else {
              this.reset();
            }
            break;
        }
      }
    }, {
      key: 'setup',
      value: function setup(model) {
        var _this2 = this;

        this.scales.x.domain([0, Object.values(model.get('data')).reduce(function (acc, val) {
          return Math.max(acc, val.runTime);
        }, 0)]);

        var maxValue = Object.values(model.get('data')).reduce(function (acc, val) {
          return Math.max(acc, val.maxValue);
        }, 0);
        this.scales.y.domain([model.get('mode') == 'component' ? -maxValue : 0, maxValue]);
        this.axes = {
          x: d3.axisBottom().scale(this.scales.x),
          y: d3.axisLeft().scale(this.scales.y).tickSize(0, 0)
        };
        this.bgs = {};
        for (var key in this.svgs) {
          this.svgs[key].selectAll('*').remove();

          this.svgs[key].select('.component-speed__graph__axis').remove();
          this.svgs[key].append('g').attr('class', 'component-speed__graph__axis component-speed__graph__axis-x').attr('transform', 'translate(0, ' + model.get('height') / 2 + ')').call(this.axes.x);
          this.svgs[key].selectAll("text").remove();

          this.svgs[key].append('g').attr('class', 'component-speed__graph__axis component-speed__graph__axis-x').attr('transform', 'translate(0, ' + model.get('height') + ')').call(this.axes.x).append('text').attr('class', 'component-speed__graph__axis-label').text('Time [seconds]').attr('x', model.get('width') / 2).attr('y', 30);

          this.svgs[key].append('g').attr('class', 'component-speed__graph__axis component-speed__graph__axis-y').call(this.axes.y);
          this.svgs[key].selectAll(".component-speed__graph__axis-y .domain").attr("stroke", 0);

          // this.svgs[key].append('g')
          //   .append('text')
          //     .attr('class', 'component-speed__graph__axis-label')
          //     .text(`Speed [micrometers / second]`)
          //     .attr('transform', 'rotate(-90)')
          //     .attr('y', -20)
          //     .attr('x', -model.get('height') / 2);

          this.svgs[key].append("svg:defs").append("svg:marker").attr("id", 'arrow__' + key).attr("refX", 0).attr("refY", 4).attr("markerWidth", 8).attr("markerHeight", 8).attr("orient", "auto").append("svg:path").attr("d", "M0,0 L0,8 L8,4 z").style('fill', componentMap[key].color);

          this.svgs[key].append("line").attr('class', 'component-speed__graph__arrow-line-' + componentMap[key].labels[0]).attr("x1", -5).attr("y1", model.get('height') / 2 - 5).attr("x2", -5).attr("y2", 5).attr("stroke", componentMap[key].color).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__' + key);

          this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__arrow-label').text('Speed ' + componentMap[key].labels[0]).attr('transform', 'rotate(-90)').style('fill', componentMap[key].color).attr('y', -10).attr('x', -model.get('height') / 4);

          this.svgs[key].append("line").attr('class', 'component-speed__graph__arrow-line-' + componentMap[key].labels[1]).attr("x1", -5).attr("y1", model.get('height') / 2 + 5).attr("x2", -5).attr("y2", model.get('height') - 5).attr("stroke", componentMap[key].color).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__' + key + ')');

          this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__arrow-label').text('Speed ' + componentMap[key].labels[1]).attr('transform', 'rotate(-90)').style('fill', componentMap[key].color).attr('y', -10).attr('x', -3 * model.get('height') / 4);

          this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__title').text('Average speed in ' + componentMap[key].title + ' direction ').attr('y', -10).attr('x', model.get('width') / 2);

          this.bgs[key] = this.svgs[key].append('g').attr('class', 'component-speed__graph__background');

          for (var layer in model.get('data')) {
            if (!model.get('data.' + layer + '.showLayer')) {
              continue;
            }
            var graphdata = model.get('data.' + layer + '.graphs.' + key).filter(function (item) {
              return item.mean;
            });
            var color = model.get('data.' + layer + '.color');
            if (model.get('stdBand')) {
              var std = d3.area().x(function (d) {
                return _this2.scales.x(d.time);
              }).y0(function (d) {
                return _this2.scales.y(d.mean - d.s);
              }).y1(function (d) {
                return _this2.scales.y(d.mean + d.s);
              });
              this.svgs[key].append('path').datum(graphdata).attr('class', 'component-speed__graph__std component-speed__graph__std__' + layer).attr('style', color ? 'fill: #' + color.toString(16) : null).attr('d', std);
            }

            // Function to be used for plotting
            // It defines that it takes for each data point the time element and the mean and plots it in x,y.
            // .datum(graphdata): That's the data on which to apply the function.
            // .attr(): Characteristics of the svg.
            // .attr('d',line) is where the datum gets transformed into the line.
            var line = d3.line().x(function (d) {
              return _this2.scales.x(d.time);
            }).y(function (d) {
              return _this2.scales.y(d.mean);
            });
            this.svgs[key].append('path').datum(graphdata).attr('class', 'component-speed__graph__line component-speed__graph__line__' + layer).attr('style', color ? 'stroke: #' + color.toString(16) : null).attr('d', line);
          }

          // Draw the lines at the different time intervals.
          if (model.get('lightConfig')) {

            this.svgs[key].append("svg:defs").append("svg:marker").attr("id", 'arrow__component__light').attr("refX", 0).attr("refY", 2).attr("markerWidth", 4).attr("markerHeight", 4).attr("orient", "auto").append("svg:path").attr("d", "M0,0 L0,4 L4,2 z").style('fill', 'rgb(235,160,17)');

            var expDuration = model.get('lightConfig').reduce(function (acc, curr) {
              return Math.max(acc, curr.timeEnd);
            }, 0);

            var _iteratorNormalCompletion = true;
            var _didIteratorError = false;
            var _iteratorError = undefined;

            try {
              for (var _iterator = model.get('lightConfig')[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                var config = _step.value;

                if (config.timeStart != 0) {
                  this.svgs[key].append("line").attr('class', 'component-speed__graph__light-time').attr("x1", config.timeStart * model.get('width') / expDuration).attr("y1", model.get('height')).attr("x2", config.timeStart * model.get('width') / expDuration).attr("y2", 0).attr("stroke-width", 2);
                }
                if (config.lightDir[0] != 0 || config.lightDir[1] != 0) {
                  this.svgs[key].append("line").attr('class', 'component-speed__graph__light-arrow').attr("x1", (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration + 20).attr("y1", 10).attr("x2", (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration + 10 * config.lightDir[0] + 20).attr("y2", 10 + 10 * config.lightDir[1]).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__component__light)');
                  //var lightValue = config.left!=0? config.left: (config.right!=0? config.right : (config.top!=0? : config.top : (config.bottom!=0? config.bottom : 0)));
                  var lightValue = Math.sqrt(Math.pow(config.left, 2) + Math.pow(config.right, 2) + Math.pow(config.top, 2) + Math.pow(config.bottom, 2));
                  lightValue = Math.round(lightValue);
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text(lightValue + '% in ').attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration - 20);
                } else if (config.left != 0 && config.right != 0 && config.top != 0 && config.bottom != 0) {
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text(config.left + '% from all dir.').attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration);
                } else if (config.left != 0 && config.right != 0 && config.top == 0 && config.bottom == 0) {
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text(config.left + '% from left&right').attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration);
                } else if (config.left == 0 && config.right == 0 && config.top != 0 && config.bottom != 0) {
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text(config.top + '% from top&bottom').attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration);
                } else {
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text("no light").attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration);
                }
              }
            } catch (err) {
              _didIteratorError = true;
              _iteratorError = err;
            } finally {
              try {
                if (!_iteratorNormalCompletion && _iterator.return) {
                  _iterator.return();
                }
              } finally {
                if (_didIteratorError) {
                  throw _iteratorError;
                }
              }
            }
          }
        }
      }
    }, {
      key: 'update',
      value: function update(timestamp, model) {
        var _this3 = this;

        var runtime = Object.values(model.get('data')).reduce(function (acc, val) {
          return Math.max(acc, val.runTime);
        }, 0);
        for (var key in this.svgs) {
          var timeband = this.bgs[key].selectAll('.component-speed__graph__time-band').data([timestamp]);
          timeband.enter().append('rect').attr('class', 'component-speed__graph__time-band').attr('y', 0).attr('height', model.get('height')).merge(timeband).transition().duration(0).attr('x', function (d) {
            return _this3.scales.x(Math.min(runtime, Math.max(0, d - model.get('dT') / 2)));
          }).attr('width', function (d) {
            return _this3.scales.x(model.get('dT') + Math.min(0, d - model.get('dT') / 2) + Math.min(0, runtime - d - model.get('dT') / 2));
          });
          timeband.exit().remove();
        }
      }
    }, {
      key: 'reset',
      value: function reset() {
        for (var key in this.svgs) {
          this.svgs[key].selectAll('.component-speed__graph__axis').remove();
          this.svgs[key].selectAll('.component-speed__graph__time-band').remove();
          this.svgs[key].selectAll('.component-speed__graph__std').remove();
          this.svgs[key].selectAll('.component-speed__graph__line').remove();
        }
      }
    }]);

    return ComponentSpeedView;
  }(DomView);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS9ldWdsZW5hL2NvbXBvbmVudC9jb21wb25lbnRzcGVlZGdyYXBoL3ZpZXcuanMiXSwibmFtZXMiOlsiZGVmaW5lIiwicmVxdWlyZSIsIkRvbVZpZXciLCJVdGlscyIsImQzIiwiVGVtcGxhdGUiLCJjb21wb25lbnRNYXAiLCJ4IiwidGl0bGUiLCJsYWJlbHMiLCJjb2xvciIsInJpZ2h0IiwibGVmdCIsInkiLCJ1cCIsImRvd24iLCJtb2RlbCIsInRtcGwiLCJiaW5kTWV0aG9kcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfb25Nb2RlbENoYW5nZSIsImdldCIsInN2Z3MiLCJ0b3RhbCIsImtleSIsInN2ZyIsInNlbGVjdCIsIiRlbCIsImZpbmQiLCJhcHBlbmQiLCJjbGFzc2VkIiwiYXR0ciIsInNjYWxlcyIsInNjYWxlTGluZWFyIiwicmFuZ2UiLCJzdHlsZSIsIngxIiwieTEiLCJ4MiIsInkyIiwidGV4dCIsInlsYWJlbCIsInhsYWJlbCIsImV2dCIsImRhdGEiLCJwYXRoIiwidmFsdWUiLCJyZXNldCIsInNldHVwIiwiY3VycmVudFRhcmdldCIsImRvbWFpbiIsIk9iamVjdCIsInZhbHVlcyIsInJlZHVjZSIsImFjYyIsInZhbCIsIk1hdGgiLCJtYXgiLCJydW5UaW1lIiwibWF4VmFsdWUiLCJheGVzIiwiYXhpc0JvdHRvbSIsInNjYWxlIiwiYXhpc0xlZnQiLCJ0aWNrU2l6ZSIsImJncyIsInNlbGVjdEFsbCIsInJlbW92ZSIsImNhbGwiLCJsYXllciIsImdyYXBoZGF0YSIsImZpbHRlciIsIml0ZW0iLCJtZWFuIiwic3RkIiwiYXJlYSIsImQiLCJ0aW1lIiwieTAiLCJzIiwiZGF0dW0iLCJ0b1N0cmluZyIsImxpbmUiLCJleHBEdXJhdGlvbiIsImN1cnIiLCJ0aW1lRW5kIiwiY29uZmlnIiwidGltZVN0YXJ0IiwibGlnaHREaXIiLCJsaWdodFZhbHVlIiwic3FydCIsInBvdyIsInRvcCIsImJvdHRvbSIsInJvdW5kIiwidGltZXN0YW1wIiwicnVudGltZSIsInRpbWViYW5kIiwiZW50ZXIiLCJtZXJnZSIsInRyYW5zaXRpb24iLCJkdXJhdGlvbiIsIm1pbiIsImV4aXQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQUEsT0FBTyxVQUFDQyxPQUFELEVBQWE7QUFDbEIsTUFBTUMsVUFBVUQsUUFBUSxvQkFBUixDQUFoQjtBQUFBLE1BQ0VFLFFBQVFGLFFBQVEsaUJBQVIsQ0FEVjtBQUFBLE1BRUVHLEtBQUtILFFBQVEsSUFBUixDQUZQO0FBQUEsTUFHRUksV0FBV0osUUFBUSxpQ0FBUixDQUhiO0FBS0FBLFVBQVEsZ0NBQVI7O0FBRUEsTUFBTUssZUFBZTtBQUNuQkMsT0FBRztBQUNEQyxhQUFPLFlBRE47QUFFREMsY0FBUSxDQUFDLE9BQUQsRUFBUyxNQUFULENBRlA7QUFHREMsYUFBTyxpQkFITjtBQUlEQyxhQUFPLEVBQUMsTUFBSyxFQUFOLEVBQVUsTUFBTSxFQUFoQixFQUFvQixNQUFNLEVBQTFCLEVBQThCLE1BQU0sRUFBcEMsRUFBd0MsVUFBVSxFQUFsRCxFQUFzRCxVQUFVLEVBQWhFLEVBSk47QUFLREMsWUFBTSxFQUFDLE1BQUssRUFBTixFQUFVLE1BQU0sRUFBaEIsRUFBb0IsTUFBTSxFQUExQixFQUE4QixNQUFNLEVBQXBDLEVBQXdDLFVBQVUsRUFBbEQsRUFBc0QsVUFBVSxFQUFoRTtBQUxMLEtBRGdCO0FBUW5CQyxPQUFHO0FBQ0RMLGFBQU8sU0FETjtBQUVEQyxjQUFRLENBQUMsSUFBRCxFQUFNLE1BQU4sQ0FGUDtBQUdEQyxhQUFPLGdCQUhOO0FBSURJLFVBQUksRUFBQyxNQUFLLEVBQU4sRUFBVSxNQUFNLEVBQWhCLEVBQW9CLE1BQU0sRUFBMUIsRUFBOEIsTUFBTSxFQUFwQyxFQUF3QyxVQUFVLEVBQWxELEVBQXNELFVBQVUsRUFBaEUsRUFKSDtBQUtEQyxZQUFNLEVBQUMsTUFBSyxFQUFOLEVBQVUsTUFBTSxFQUFoQixFQUFvQixNQUFNLEVBQTFCLEVBQThCLE1BQU0sRUFBcEMsRUFBd0MsVUFBVSxFQUFsRCxFQUFz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QUFLN0MsSUFBTCxDQUFVRSxHQUFWLEVBQWUwQyxTQUFmLENBQXlCLG9DQUF6QixFQUErREMsTUFBL0Q7QUFDQSxlQUFLN0MsSUFBTCxDQUFVRSxHQUFWLEVBQWUwQyxTQUFmLENBQXlCLDhCQUF6QixFQUF5REMsTUFBekQ7QUFDQSxlQUFLN0MsSUFBTCxDQUFVRSxHQUFWLEVBQWUwQyxTQUFmLENBQXlCLCtCQUF6QixFQUEwREMsTUFBMUQ7QUFDRDtBQUNGO0FBNVZIOztBQUFBO0FBQUEsSUFBd0NqRSxPQUF4QztBQThWRCxDQXRYRCIsImZpbGUiOiJtb2R1bGUvZXVnbGVuYS9jb21wb25lbnQvY29tcG9uZW50c3BlZWRncmFwaC92aWV3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZGVmaW5lKChyZXF1aXJlKSA9PiB7XG4gIGNvbnN0IERvbVZpZXcgPSByZXF1aXJlKCdjb3JlL3ZpZXcvZG9tX3ZpZXcnKSxcbiAgICBVdGlscyA9IHJlcXVpcmUoJ2NvcmUvdXRpbC91dGlscycpLFxuICAgIGQzID0gcmVxdWlyZSgnZDMnKSxcbiAgICBUZW1wbGF0ZSA9IHJlcXVpcmUoJ3RleHQhLi9jb21wb25lbnRzcGVlZGdyYXBoLmh0bWwnKVxuICA7XG4gIHJlcXVpcmUoJ2xpbmshLi9jb21wb25lbnRzcGVlZGdyYXBoLmNzcycpO1xuXG4gIGNvbnN0IGNvbXBvbmVudE1hcCA9IHtcbiAgICB4OiB7XG4gICAgICB0aXRsZTogJ2xlZnQvcmlnaHQnLFxuICAgICAgbGFiZWxzOiBbJ3JpZ2h0JywnbGVmdCddLFxuICAgICAgY29sb3I6ICdyZ2IoNTUsMTUyLDE5NSknLFxuICAgICAgcmlnaHQ6IHsneDEnOjU1LCAneDInOiA3NSwgJ3kxJzogMzUsICd5Mic6IDM1LCAneGxhYmVsJzogNzUsICd5bGFiZWwnOiAzMH0sXG4gICAgICBsZWZ0OiB7J3gxJzo0NSwgJ3gyJzogMjUsICd5MSc6IDM1LCAneTInOiAzNSwgJ3hsYWJlbCc6IDI1LCAneWxhYmVsJzogMzB9XG4gICAgfSxcbiAgICB5OiB7XG4gICAgICB0aXRsZTogJ3VwL2Rvd24nLFxuICAgICAgbGFiZWxzOiBbJ3VwJywnZG93biddLFxuICAgICAgY29sb3I6ICdyZ2IoNTUsMTQzLDQ4KScsXG4gICAgICB1cDogeyd4MSc6NTAsICd4Mic6IDUwLCAneTEnOiAzMCwgJ3kyJzogMTAsICd4bGFiZWwnOiA0MCwgJ3lsYWJlbCc6IDE1fSxcbiAgICAgIGRvd246IHsneDEnOjUwLCAneDInOiA1MCwgJ3kxJzogNDAsICd5Mic6IDYwLCAneGxhYmVsJzogMzUsICd5bGFiZWwnOiA1NX1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIGNsYXNzIENvbXBvbmVudFNwZWVkVmlldyBleHRlbmRzIERvbVZpZXcge1xuICAgIGNvbnN0cnVjdG9yKG1vZGVsLCB0bXBsKSB7XG4gICAgICBzdXBlcih0bXBsIHx8IFRlbXBsYXRlKTtcbiAgICAgIFV0aWxzLmJpbmRNZXRob2RzKHRoaXMsIFsnX29uTW9kZWxDaGFuZ2UnXSk7XG5cbiAgICAgIG1vZGVsLmFkZEV2ZW50TGlzdGVuZXIoJ01vZGVsLkNoYW5nZScsIHRoaXMuX29uTW9kZWxDaGFuZ2UpO1xuXG4gICAgICBpZiAobW9kZWwuZ2V0KCdtb2RlJykgPT0gXCJjb21wb25lbnRcIikge1xuICAgICAgICB0aGlzLnN2Z3MgPSB7XG4gICAgICAgICAgeDogbnVsbCxcbiAgICAgICAgICB5OiBudWxsXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3ZncyA9IHtcbiAgICAgICAgICB0b3RhbDogbnVsbFxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmb3IgKGxldCBrZXkgaW4gdGhpcy5zdmdzKSB7XG4gICAgICAgIGxldCBzdmcgPSBkMy5zZWxlY3QodGhpcy4kZWwuZmluZCgnLmNvbXBvbmVudC1zcGVlZF9fZ3JhcGgnKS5nZXQoMCkpLmFwcGVuZCgnc3ZnJyk7XG4gICAgICAgIHN2Zy5jbGFzc2VkKGBjb21wb25lbnQtc3BlZWRfX2dyYXBoX18ke2tleX1gLCB0cnVlKTtcbiAgICAgICAgc3ZnLmF0dHIoJ3dpZHRoJywgbW9kZWwuZ2V0KCd3aWR0aCcpICsgbW9kZWwuZ2V0KCdtYXJnaW5zLmxlZnQnKSArIG1vZGVsLmdldCgnbWFyZ2lucy5yaWdodCcpKTtcbiAgICAgICAgc3ZnLmF0dHIoJ2hlaWdodCcsIG1vZGVsLmdldCgnaGVpZ2h0JykgKyBtb2RlbC5nZXQoJ21hcmdpbnMudG9wJykgKyBtb2RlbC5nZXQoJ21hcmdpbnMuYm90dG9tJykpO1xuICAgICAgICB0aGlzLnN2Z3Nba2V5XSA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7bW9kZWwuZ2V0KCdtYXJnaW5zLmxlZnQnKX0sICR7bW9kZWwuZ2V0KCdtYXJnaW5zLnRvcCcpfSlgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc2NhbGVzID0ge307XG4gICAgICB0aGlzLnNjYWxlcy54ID0gZDMuc2NhbGVMaW5lYXIoKS5yYW5nZShbMCwgbW9kZWwuZ2V0KCd3aWR0aCcpXSk7XG4gICAgICB0aGlzLnNjYWxlcy55ID0gZDMuc2NhbGVMaW5lYXIoKS5yYW5nZShbbW9kZWwuZ2V0KCdoZWlnaHQnKSwgMF0pO1xuXG4gICAgICBsZXQgc3ZnID0gZDMuc2VsZWN0KHRoaXMuJGVsLmZpbmQoJy5jb21wb25lbnQtc3BlZWRfX2dyYXBoX19pbWFnZScpLmdldCgwKSkuYXBwZW5kKCdzdmcnKTtcbiAgICAgIHN2Zy5hdHRyKCd3aWR0aCcsIDEwMClcbiAgICAgIC5hdHRyKCdoZWlnaHQnLCA3MClcblxuICAgICAgLy8gRHJhdyB2aXN1YWxpemF0aW9uIHRvIGlsbHVzdHJhdGUgdGhlIG1lYW5pbmdcbiAgICAgIHN2Zy5hcHBlbmQoJ2VsbGlwc2UnKVxuICAgICAgICAuYXR0cihcImN4XCIsMClcbiAgICAgICAgLmF0dHIoXCJjeVwiLDApXG4gICAgICAgIC5hdHRyKFwicnhcIiwxNilcbiAgICAgICAgLmF0dHIoXCJyeVwiLDgpXG4gICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDUwLDM1KXJvdGF0ZSgtNDUpJylcbiAgICAgICAgLmF0dHIoJ2ZpbGwnLCdibGFjaycpXG5cbiAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLnN2Z3MpIHtcbiAgICAgICAgc3ZnLmFwcGVuZChcInN2ZzpkZWZzXCIpXG4gICAgICAgICAgIC5hcHBlbmQoXCJzdmc6bWFya2VyXCIpXG4gICAgICAgICAgIC5hdHRyKFwiaWRcIiwgYGFycm93X19pbWFnZV9fJHtrZXl9YClcbiAgICAgICAgICAgLmF0dHIoXCJyZWZYXCIsIDApXG4gICAgICAgIFx0LmF0dHIoXCJyZWZZXCIsIDIpXG4gICAgICAgIFx0LmF0dHIoXCJtYXJrZXJXaWR0aFwiLCA0KVxuICAgICAgICBcdC5hdHRyKFwibWFya2VySGVpZ2h0XCIsIDQpXG4gICAgICAgIFx0LmF0dHIoXCJvcmllbnRcIiwgXCJhdXRvXCIpXG4gICAgICAgIFx0LmFwcGVuZChcInN2ZzpwYXRoXCIpXG4gICAgICAgIFx0LmF0dHIoXCJkXCIsIFwiTTAsMCBMMCw0IEw0LDIgelwiKVxuICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLGNvbXBvbmVudE1hcFtrZXldLmNvbG9yKTtcblxuICAgICAgIHN2Zy5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAgICAuYXR0cihcIngxXCIsY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzBdXS54MSlcbiAgICAgICAgIC5hdHRyKFwieTFcIixjb21wb25lbnRNYXBba2V5XVtjb21wb25lbnRNYXBba2V5XS5sYWJlbHNbMF1dLnkxKVxuICAgICAgICAgLmF0dHIoXCJ4MlwiLGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1swXV0ueDIpXG4gICAgICAgICAuYXR0cihcInkyXCIsY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzBdXS55MilcbiAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsY29tcG9uZW50TWFwW2tleV0uY29sb3IpXG4gICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLDIpXG4gICAgICAgICAuYXR0cihcIm1hcmtlci1lbmRcIixgdXJsKCNhcnJvd19faW1hZ2VfXyR7a2V5fWApO1xuXG4gICAgICAgc3ZnLmFwcGVuZChcImxpbmVcIilcbiAgICAgICAgIC5hdHRyKFwieDFcIixjb21wb25lbnRNYXBba2V5XVtjb21wb25lbnRNYXBba2V5XS5sYWJlbHNbMV1dLngxKVxuICAgICAgICAgLmF0dHIoXCJ5MVwiLGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1sxXV0ueTEpXG4gICAgICAgICAuYXR0cihcIngyXCIsY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzFdXS54MilcbiAgICAgICAgIC5hdHRyKFwieTJcIixjb21wb25lbnRNYXBba2V5XVtjb21wb25lbnRNYXBba2V5XS5sYWJlbHNbMV1dLnkyKVxuICAgICAgICAgLmF0dHIoXCJzdHJva2VcIixjb21wb25lbnRNYXBba2V5XS5jb2xvcilcbiAgICAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsMilcbiAgICAgICAgIC5hdHRyKFwibWFya2VyLWVuZFwiLGB1cmwoI2Fycm93X19pbWFnZV9fJHtrZXl9YCk7XG5cbiAgICAgICBzdmcuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2ltYWdlX19sYWJlbCcpXG4gICAgICAgICAgIC50ZXh0KGNvbXBvbmVudE1hcFtrZXldLmxhYmVsc1swXSlcbiAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgY29tcG9uZW50TWFwW2tleV0uY29sb3IpXG4gICAgICAgICAgIC5hdHRyKCd5JywgY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzBdXS55bGFiZWwpXG4gICAgICAgICAgIC5hdHRyKCd4JywgY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzBdXS54bGFiZWwpO1xuXG5cbiAgICAgICBzdmcuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2ltYWdlX19sYWJlbCcpXG4gICAgICAgICAgIC50ZXh0KGNvbXBvbmVudE1hcFtrZXldLmxhYmVsc1sxXSlcbiAgICAgICAgICAgLnN0eWxlKCdmaWxsJywgY29tcG9uZW50TWFwW2tleV0uY29sb3IpXG4gICAgICAgICAgIC5hdHRyKCd5JywgY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzFdXS55bGFiZWwpXG4gICAgICAgICAgIC5hdHRyKCd4JywgY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzFdXS54bGFiZWwpO1xuICAgICAgfVxuXG4gICAgfVxuXG4gICAgX29uTW9kZWxDaGFuZ2UoZXZ0KSB7XG4gICAgICBzd2l0Y2ggKGV2dC5kYXRhLnBhdGgpIHtcbiAgICAgICAgY2FzZSBcImRhdGFcIjpcbiAgICAgICAgICBpZiAoZXZ0LmRhdGEudmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0dXAoZXZ0LmN1cnJlbnRUYXJnZXQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHNldHVwKG1vZGVsKSB7XG5cbiAgICAgIHRoaXMuc2NhbGVzLnguZG9tYWluKFswLCBPYmplY3QudmFsdWVzKG1vZGVsLmdldCgnZGF0YScpKS5yZWR1Y2UoKGFjYywgdmFsKSA9PiBNYXRoLm1heChhY2MsIHZhbC5ydW5UaW1lKSwgMCldKTtcblxuICAgICAgbGV0IG1heFZhbHVlID0gT2JqZWN0LnZhbHVlcyhtb2RlbC5nZXQoJ2RhdGEnKSkucmVkdWNlKChhY2MsIHZhbCkgPT4gTWF0aC5tYXgoYWNjLCB2YWwubWF4VmFsdWUpLCAwKTtcbiAgICAgIHRoaXMuc2NhbGVzLnkuZG9tYWluKFttb2RlbC5nZXQoJ21vZGUnKSA9PSAnY29tcG9uZW50JyA/IC1tYXhWYWx1ZSA6IDAsIG1heFZhbHVlXSk7XG4gICAgICB0aGlzLmF4ZXMgPSB7XG4gICAgICAgIHg6IGQzLmF4aXNCb3R0b20oKS5zY2FsZSh0aGlzLnNjYWxlcy54KSxcbiAgICAgICAgeTogZDMuYXhpc0xlZnQoKS5zY2FsZSh0aGlzLnNjYWxlcy55KS50aWNrU2l6ZSgwLDApXG4gICAgICB9O1xuICAgICAgdGhpcy5iZ3MgPSB7fTtcbiAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLnN2Z3MpIHtcbiAgICAgICAgdGhpcy5zdmdzW2tleV0uc2VsZWN0QWxsKCcqJykucmVtb3ZlKCk7XG5cbiAgICAgICAgdGhpcy5zdmdzW2tleV0uc2VsZWN0KCcuY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYXhpcycpLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzIGNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2F4aXMteCcpXG4gICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoMCwgJHttb2RlbC5nZXQoJ2hlaWdodCcpIC8gMn0pYClcbiAgICAgICAgICAuY2FsbCh0aGlzLmF4ZXMueClcbiAgICAgICAgdGhpcy5zdmdzW2tleV0uc2VsZWN0QWxsKFwidGV4dFwiKS5yZW1vdmUoKTtcblxuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzIGNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2F4aXMteCcpXG4gICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoMCwgJHttb2RlbC5nZXQoJ2hlaWdodCcpfSlgKVxuICAgICAgICAgIC5jYWxsKHRoaXMuYXhlcy54KVxuICAgICAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2F4aXMtbGFiZWwnKVxuICAgICAgICAgICAgLnRleHQoJ1RpbWUgW3NlY29uZHNdJylcbiAgICAgICAgICAgIC5hdHRyKCd4JywgbW9kZWwuZ2V0KCd3aWR0aCcpIC8gMilcbiAgICAgICAgICAgIC5hdHRyKCd5JywgMzApO1xuXG4gICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2F4aXMgY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYXhpcy15JylcbiAgICAgICAgICAuY2FsbCh0aGlzLmF4ZXMueSlcbiAgICAgICAgdGhpcy5zdmdzW2tleV0uc2VsZWN0QWxsKFwiLmNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2F4aXMteSAuZG9tYWluXCIpLmF0dHIoXCJzdHJva2VcIiwwKVxuXG4gICAgICAgIC8vIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgIC8vICAgLmFwcGVuZCgndGV4dCcpXG4gICAgICAgIC8vICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYXhpcy1sYWJlbCcpXG4gICAgICAgIC8vICAgICAudGV4dChgU3BlZWQgW21pY3JvbWV0ZXJzIC8gc2Vjb25kXWApXG4gICAgICAgIC8vICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3JvdGF0ZSgtOTApJylcbiAgICAgICAgLy8gICAgIC5hdHRyKCd5JywgLTIwKVxuICAgICAgICAvLyAgICAgLmF0dHIoJ3gnLCAtbW9kZWwuZ2V0KCdoZWlnaHQnKSAvIDIpO1xuXG4gICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKFwic3ZnOmRlZnNcIilcbiAgICAgICAgXHQuYXBwZW5kKFwic3ZnOm1hcmtlclwiKVxuICAgICAgICBcdC5hdHRyKFwiaWRcIiwgYGFycm93X18ke2tleX1gKVxuICAgICAgICBcdC5hdHRyKFwicmVmWFwiLCAwKVxuICAgICAgICBcdC5hdHRyKFwicmVmWVwiLCA0KVxuICAgICAgICBcdC5hdHRyKFwibWFya2VyV2lkdGhcIiwgOClcbiAgICAgICAgXHQuYXR0cihcIm1hcmtlckhlaWdodFwiLCA4KVxuICAgICAgICBcdC5hdHRyKFwib3JpZW50XCIsIFwiYXV0b1wiKVxuICAgICAgICBcdC5hcHBlbmQoXCJzdmc6cGF0aFwiKVxuICAgICAgICBcdC5hdHRyKFwiZFwiLCBcIk0wLDAgTDAsOCBMOCw0IHpcIilcbiAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLGNvbXBvbmVudE1hcFtrZXldLmNvbG9yKTtcblxuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAgICAgLmF0dHIoJ2NsYXNzJywgYGNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2Fycm93LWxpbmUtJHtjb21wb25lbnRNYXBba2V5XS5sYWJlbHNbMF19YClcbiAgICAgICAgICAuYXR0cihcIngxXCIsLTUpXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLG1vZGVsLmdldCgnaGVpZ2h0JykgLyAyIC0gNSlcbiAgICAgICAgICAuYXR0cihcIngyXCIsLTUpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLDUpXG4gICAgICAgICAgLmF0dHIoXCJzdHJva2VcIixjb21wb25lbnRNYXBba2V5XS5jb2xvcilcbiAgICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLDIpXG4gICAgICAgICAgLmF0dHIoXCJtYXJrZXItZW5kXCIsYHVybCgjYXJyb3dfXyR7a2V5fWApO1xuXG4gICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYXJyb3ctbGFiZWwnKVxuICAgICAgICAgICAgLnRleHQoYFNwZWVkICR7Y29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzBdfWApXG4gICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3JvdGF0ZSgtOTApJylcbiAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIGNvbXBvbmVudE1hcFtrZXldLmNvbG9yKVxuICAgICAgICAgICAgLmF0dHIoJ3knLCAtMTApXG4gICAgICAgICAgICAuYXR0cigneCcsIC1tb2RlbC5nZXQoJ2hlaWdodCcpIC8gNCk7XG5cbiAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKFwibGluZVwiKVxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsIGBjb21wb25lbnQtc3BlZWRfX2dyYXBoX19hcnJvdy1saW5lLSR7Y29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzFdfWApXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLC01KVxuICAgICAgICAgIC5hdHRyKFwieTFcIiwgbW9kZWwuZ2V0KCdoZWlnaHQnKSAvIDIgKyA1KVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwtNSlcbiAgICAgICAgICAuYXR0cihcInkyXCIsbW9kZWwuZ2V0KCdoZWlnaHQnKSAtIDUpXG4gICAgICAgICAgLmF0dHIoXCJzdHJva2VcIixjb21wb25lbnRNYXBba2V5XS5jb2xvcilcbiAgICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLDIpXG4gICAgICAgICAgLmF0dHIoXCJtYXJrZXItZW5kXCIsYHVybCgjYXJyb3dfXyR7a2V5fSlgKVxuXG4gICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYXJyb3ctbGFiZWwnKVxuICAgICAgICAgICAgLnRleHQoYFNwZWVkICR7Y29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzFdfWApXG4gICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3JvdGF0ZSgtOTApJylcbiAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIGNvbXBvbmVudE1hcFtrZXldLmNvbG9yKVxuICAgICAgICAgICAgLmF0dHIoJ3knLCAtMTApXG4gICAgICAgICAgICAuYXR0cigneCcsIC0zICogbW9kZWwuZ2V0KCdoZWlnaHQnKSAvIDQpO1xuXG4gICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fdGl0bGUnKVxuICAgICAgICAgICAgLnRleHQoYEF2ZXJhZ2Ugc3BlZWQgaW4gJHtjb21wb25lbnRNYXBba2V5XS50aXRsZX0gZGlyZWN0aW9uIGApXG4gICAgICAgICAgICAuYXR0cigneScsIC0xMClcbiAgICAgICAgICAgIC5hdHRyKCd4JywgbW9kZWwuZ2V0KCd3aWR0aCcpIC8gMik7XG5cblxuICAgICAgICB0aGlzLmJnc1trZXldID0gdGhpcy5zdmdzW2tleV0uYXBwZW5kKCdnJylcbiAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYmFja2dyb3VuZCcpO1xuXG4gICAgICAgIGZvciAobGV0IGxheWVyIGluIG1vZGVsLmdldCgnZGF0YScpKSB7XG4gICAgICAgICAgaWYgKCFtb2RlbC5nZXQoYGRhdGEuJHtsYXllcn0uc2hvd0xheWVyYCkpIHtjb250aW51ZX1cbiAgICAgICAgICBsZXQgZ3JhcGhkYXRhID0gbW9kZWwuZ2V0KGBkYXRhLiR7bGF5ZXJ9LmdyYXBocy4ke2tleX1gKS5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0ubWVhbik7XG4gICAgICAgICAgbGV0IGNvbG9yID0gbW9kZWwuZ2V0KGBkYXRhLiR7bGF5ZXJ9LmNvbG9yYClcbiAgICAgICAgICBpZiAobW9kZWwuZ2V0KCdzdGRCYW5kJykpIHtcbiAgICAgICAgICAgIGxldCBzdGQgPSBkMy5hcmVhKClcbiAgICAgICAgICAgICAgLngoKGQpID0+IHRoaXMuc2NhbGVzLngoZC50aW1lKSlcbiAgICAgICAgICAgICAgLnkwKChkKSA9PiB0aGlzLnNjYWxlcy55KGQubWVhbiAtIGQucykpXG4gICAgICAgICAgICAgIC55MSgoZCkgPT4gdGhpcy5zY2FsZXMueShkLm1lYW4gKyBkLnMpKTtcbiAgICAgICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAgIC5kYXR1bShncmFwaGRhdGEpXG4gICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsIGBjb21wb25lbnQtc3BlZWRfX2dyYXBoX19zdGQgY29tcG9uZW50LXNwZWVkX19ncmFwaF9fc3RkX18ke2xheWVyfWApXG4gICAgICAgICAgICAgIC5hdHRyKCdzdHlsZScsIGNvbG9yID8gYGZpbGw6ICMke2NvbG9yLnRvU3RyaW5nKDE2KX1gIDogbnVsbClcbiAgICAgICAgICAgICAgLmF0dHIoJ2QnLCBzdGQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEZ1bmN0aW9uIHRvIGJlIHVzZWQgZm9yIHBsb3R0aW5nXG4gICAgICAgICAgLy8gSXQgZGVmaW5lcyB0aGF0IGl0IHRha2VzIGZvciBlYWNoIGRhdGEgcG9pbnQgdGhlIHRpbWUgZWxlbWVudCBhbmQgdGhlIG1lYW4gYW5kIHBsb3RzIGl0IGluIHgseS5cbiAgICAgICAgICAvLyAuZGF0dW0oZ3JhcGhkYXRhKTogVGhhdCdzIHRoZSBkYXRhIG9uIHdoaWNoIHRvIGFwcGx5IHRoZSBmdW5jdGlvbi5cbiAgICAgICAgICAvLyAuYXR0cigpOiBDaGFyYWN0ZXJpc3RpY3Mgb2YgdGhlIHN2Zy5cbiAgICAgICAgICAvLyAuYXR0cignZCcsbGluZSkgaXMgd2hlcmUgdGhlIGRhdHVtIGdldHMgdHJhbnNmb3JtZWQgaW50byB0aGUgbGluZS5cbiAgICAgICAgICBsZXQgbGluZSA9IGQzLmxpbmUoKVxuICAgICAgICAgICAgLngoKGQpID0+IHRoaXMuc2NhbGVzLngoZC50aW1lKSlcbiAgICAgICAgICAgIC55KChkKSA9PiB0aGlzLnNjYWxlcy55KGQubWVhbikpXG4gICAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKCdwYXRoJylcbiAgICAgICAgICAgIC5kYXR1bShncmFwaGRhdGEpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCBgY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGluZSBjb21wb25lbnQtc3BlZWRfX2dyYXBoX19saW5lX18ke2xheWVyfWApXG4gICAgICAgICAgICAuYXR0cignc3R5bGUnLCBjb2xvciA/IGBzdHJva2U6ICMke2NvbG9yLnRvU3RyaW5nKDE2KX1gIDogbnVsbClcbiAgICAgICAgICAgIC5hdHRyKCdkJywgbGluZSk7XG5cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gRHJhdyB0aGUgbGluZXMgYXQgdGhlIGRpZmZlcmVudCB0aW1lIGludGVydmFscy5cbiAgICAgICAgaWYgKG1vZGVsLmdldCgnbGlnaHRDb25maWcnKSkge1xuXG4gICAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKFwic3ZnOmRlZnNcIilcbiAgICAgICAgICAgXHQuYXBwZW5kKFwic3ZnOm1hcmtlclwiKVxuICAgICAgICAgICBcdC5hdHRyKFwiaWRcIiwgYGFycm93X19jb21wb25lbnRfX2xpZ2h0YClcbiAgICAgICAgICAgXHQuYXR0cihcInJlZlhcIiwgMClcbiAgICAgICAgICAgXHQuYXR0cihcInJlZllcIiwgMilcbiAgICAgICAgICAgXHQuYXR0cihcIm1hcmtlcldpZHRoXCIsIDQpXG4gICAgICAgICAgIFx0LmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgNClcbiAgICAgICAgICAgXHQuYXR0cihcIm9yaWVudFwiLCBcImF1dG9cIilcbiAgICAgICAgICAgXHQuYXBwZW5kKFwic3ZnOnBhdGhcIilcbiAgICAgICAgICAgXHQuYXR0cihcImRcIiwgXCJNMCwwIEwwLDQgTDQsMiB6XCIpXG4gICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywncmdiKDIzNSwxNjAsMTcpJyk7XG5cbiAgICAgICAgICB2YXIgZXhwRHVyYXRpb24gPSBtb2RlbC5nZXQoJ2xpZ2h0Q29uZmlnJykucmVkdWNlKChhY2MsY3VycikgPT4gTWF0aC5tYXgoYWNjLGN1cnIudGltZUVuZCksMCk7XG5cbiAgICAgICAgICBmb3IgKGxldCBjb25maWcgb2YgbW9kZWwuZ2V0KCdsaWdodENvbmZpZycpKSB7XG4gICAgICAgICAgICBpZiAoY29uZmlnLnRpbWVTdGFydCAhPSAwKSB7XG4gICAgICAgICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZChcImxpbmVcIilcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGlnaHQtdGltZScpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ4MVwiLCBjb25maWcudGltZVN0YXJ0ICogbW9kZWwuZ2V0KCd3aWR0aCcpIC8gZXhwRHVyYXRpb24pXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ5MVwiLCBtb2RlbC5nZXQoJ2hlaWdodCcpKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieDJcIiwgY29uZmlnLnRpbWVTdGFydCAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieTJcIiwwKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsMilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb25maWcubGlnaHREaXJbMF0gIT0gMCB8fCBjb25maWcubGlnaHREaXJbMV0gIT0gMCkge1xuICAgICAgICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGlnaHQtYXJyb3cnKVxuICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ4MVwiLChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uICsgMjApXG4gICAgICAgICAgICAgICAgICAuYXR0cihcInkxXCIsIDEwKVxuICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ4MlwiLChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAgKiBtb2RlbC5nZXQoJ3dpZHRoJykgLyBleHBEdXJhdGlvbiArIDEwICogY29uZmlnLmxpZ2h0RGlyWzBdICsgMjApXG4gICAgICAgICAgICAgICAgICAuYXR0cihcInkyXCIsIDEwICsgMTAgKiBjb25maWcubGlnaHREaXJbMV0pXG4gICAgICAgICAgICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLDIpXG4gICAgICAgICAgICAgICAgICAuYXR0cihcIm1hcmtlci1lbmRcIixgdXJsKCNhcnJvd19fY29tcG9uZW50X19saWdodClgKVxuICAgICAgICAgICAgICAvL3ZhciBsaWdodFZhbHVlID0gY29uZmlnLmxlZnQhPTA/IGNvbmZpZy5sZWZ0OiAoY29uZmlnLnJpZ2h0IT0wPyBjb25maWcucmlnaHQgOiAoY29uZmlnLnRvcCE9MD8gOiBjb25maWcudG9wIDogKGNvbmZpZy5ib3R0b20hPTA/IGNvbmZpZy5ib3R0b20gOiAwKSkpO1xuICAgICAgICAgICAgICB2YXIgbGlnaHRWYWx1ZSA9IE1hdGguc3FydChNYXRoLnBvdyhjb25maWcubGVmdCwyKSArIE1hdGgucG93KGNvbmZpZy5yaWdodCwyKSArIE1hdGgucG93KGNvbmZpZy50b3AsMikgKyBNYXRoLnBvdyhjb25maWcuYm90dG9tLDIpKTtcbiAgICAgICAgICAgICAgbGlnaHRWYWx1ZSA9IE1hdGgucm91bmQobGlnaHRWYWx1ZSk7XG4gICAgICAgICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2xpZ2h0LWxhYmVsJylcbiAgICAgICAgICAgICAgICAudGV4dChgJHtsaWdodFZhbHVlfSUgaW4gYClcbiAgICAgICAgICAgICAgICAuYXR0cigneScsIDE1KVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgKGNvbmZpZy50aW1lRW5kICsgY29uZmlnLnRpbWVTdGFydCkgLyAyICogbW9kZWwuZ2V0KCd3aWR0aCcpIC8gZXhwRHVyYXRpb24gLSAyMCk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLmxlZnQgIT0gMCAmJiBjb25maWcucmlnaHQgIT0gMCAmJiBjb25maWcudG9wICE9IDAgJiYgY29uZmlnLmJvdHRvbSAhPSAwKXtcbiAgICAgICAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGlnaHQtbGFiZWwnKVxuICAgICAgICAgICAgICAgIC50ZXh0KGAke2NvbmZpZy5sZWZ0fSUgZnJvbSBhbGwgZGlyLmApXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCAxNSlcbiAgICAgICAgICAgICAgICAuYXR0cigneCcsIChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLmxlZnQgIT0gMCAmJiBjb25maWcucmlnaHQgIT0gMCAmJiBjb25maWcudG9wID09IDAgJiYgY29uZmlnLmJvdHRvbSA9PSAwKXtcbiAgICAgICAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGlnaHQtbGFiZWwnKVxuICAgICAgICAgICAgICAgIC50ZXh0KGAke2NvbmZpZy5sZWZ0fSUgZnJvbSBsZWZ0JnJpZ2h0YClcbiAgICAgICAgICAgICAgICAuYXR0cigneScsIDE1KVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgKGNvbmZpZy50aW1lRW5kICsgY29uZmlnLnRpbWVTdGFydCkgLyAyICogbW9kZWwuZ2V0KCd3aWR0aCcpIC8gZXhwRHVyYXRpb24pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWcubGVmdCA9PSAwICYmIGNvbmZpZy5yaWdodCA9PSAwICYmIGNvbmZpZy50b3AgIT0gMCAmJiBjb25maWcuYm90dG9tICE9IDApe1xuICAgICAgICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjb21wb25lbnQtc3BlZWRfX2dyYXBoX19saWdodC1sYWJlbCcpXG4gICAgICAgICAgICAgICAgLnRleHQoYCR7Y29uZmlnLnRvcH0lIGZyb20gdG9wJmJvdHRvbWApXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCAxNSlcbiAgICAgICAgICAgICAgICAuYXR0cigneCcsIChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2xpZ2h0LWxhYmVsJylcbiAgICAgICAgICAgICAgICAudGV4dChcIm5vIGxpZ2h0XCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCAxNSlcbiAgICAgICAgICAgICAgICAuYXR0cigneCcsIChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH1cblxuICAgIHVwZGF0ZSh0aW1lc3RhbXAsIG1vZGVsKSB7XG4gICAgICBsZXQgcnVudGltZSA9IE9iamVjdC52YWx1ZXMobW9kZWwuZ2V0KCdkYXRhJykpLnJlZHVjZSgoYWNjLCB2YWwpID0+IE1hdGgubWF4KGFjYywgdmFsLnJ1blRpbWUpLCAwKTtcbiAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLnN2Z3MpIHtcbiAgICAgICAgbGV0IHRpbWViYW5kID0gdGhpcy5iZ3Nba2V5XS5zZWxlY3RBbGwoJy5jb21wb25lbnQtc3BlZWRfX2dyYXBoX190aW1lLWJhbmQnKVxuICAgICAgICAgIC5kYXRhKFt0aW1lc3RhbXBdKVxuICAgICAgICB0aW1lYmFuZC5lbnRlcigpLmFwcGVuZCgncmVjdCcpXG4gICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX3RpbWUtYmFuZCcpXG4gICAgICAgICAgLmF0dHIoJ3knLCAwKVxuICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBtb2RlbC5nZXQoJ2hlaWdodCcpKVxuICAgICAgICAgIC5tZXJnZSh0aW1lYmFuZClcbiAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAgIC5hdHRyKCd4JywgKGQpID0+IHRoaXMuc2NhbGVzLngoTWF0aC5taW4ocnVudGltZSwgTWF0aC5tYXgoMCwgZCAtIG1vZGVsLmdldCgnZFQnKSAvIDIpKSkpXG4gICAgICAgICAgICAuYXR0cignd2lkdGgnLCAoZCkgPT4gdGhpcy5zY2FsZXMueChtb2RlbC5nZXQoJ2RUJykgKyBNYXRoLm1pbigwLCBkIC0gbW9kZWwuZ2V0KCdkVCcpIC8gMikgKyBNYXRoLm1pbigwLCBydW50aW1lIC0gZCAtIG1vZGVsLmdldCgnZFQnKSAvIDIpKSlcbiAgICAgICAgdGltZWJhbmQuZXhpdCgpLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJlc2V0KCkge1xuICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuc3Zncykge1xuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5zZWxlY3RBbGwoJy5jb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzJykucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuc3Znc1trZXldLnNlbGVjdEFsbCgnLmNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX3RpbWUtYmFuZCcpLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5zZWxlY3RBbGwoJy5jb21wb25lbnQtc3BlZWRfX2dyYXBoX19zdGQnKS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5zdmdzW2tleV0uc2VsZWN0QWxsKCcuY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGluZScpLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSlcbiJdfQ==

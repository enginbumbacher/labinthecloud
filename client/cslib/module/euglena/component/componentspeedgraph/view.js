'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

define(function (require) {
  var DomView = require('core/view/dom_view'),
      Utils = require('core/util/utils'),
      d3 = require('d3'),
      Template = require('text!./componentspeedgraph.html');
  require('link!./componentspeedgraph.css');

  var componentMap = {
    x: {
      title: 'left/right',
      labels: ['right', 'left'],
      color: 'rgb(55,152,195)',
      right: { 'x1': 55, 'x2': 75, 'y1': 35, 'y2': 35, 'xlabel': 75, 'ylabel': 30 },
      left: { 'x1': 45, 'x2': 25, 'y1': 35, 'y2': 35, 'xlabel': 25, 'ylabel': 30 }
    },
    y: {
      title: 'up/down',
      labels: ['up', 'down'],
      color: 'rgb(55,143,48)',
      up: { 'x1': 50, 'x2': 50, 'y1': 30, 'y2': 10, 'xlabel': 40, 'ylabel': 15 },
      down: { 'x1': 50, 'x2': 50, 'y1': 40, 'y2': 60, 'xlabel': 35, 'ylabel': 55 }
    }
  };
  return function (_DomView) {
    _inherits(ComponentSpeedView, _DomView);

    function ComponentSpeedView(model, tmpl) {
      _classCallCheck(this, ComponentSpeedView);

      var _this = _possibleConstructorReturn(this, (ComponentSpeedView.__proto__ || Object.getPrototypeOf(ComponentSpeedView)).call(this, tmpl || Template));

      Utils.bindMethods(_this, ['_onModelChange']);

      model.addEventListener('Model.Change', _this._onModelChange);

      if (model.get('mode') == "component") {
        _this.svgs = {
          x: null,
          y: null
        };
      } else {
        _this.svgs = {
          total: null
        };
      }
      for (var key in _this.svgs) {
        var _svg = d3.select(_this.$el.find('.component-speed__graph').get(0)).append('svg');
        _svg.classed('component-speed__graph__' + key, true);
        _svg.attr('width', model.get('width') + model.get('margins.left') + model.get('margins.right'));
        _svg.attr('height', model.get('height') + model.get('margins.top') + model.get('margins.bottom'));
        _this.svgs[key] = _svg.append('g').attr('transform', 'translate(' + model.get('margins.left') + ', ' + model.get('margins.top') + ')');
      }
      _this.scales = {};
      _this.scales.x = d3.scaleLinear().range([0, model.get('width')]);
      _this.scales.y = d3.scaleLinear().range([model.get('height'), 0]);

      var svg = d3.select(_this.$el.find('.component-speed__graph__image').get(0)).append('svg');
      svg.attr('width', 100).attr('height', 70);

      // Draw visualization to illustrate the meaning
      svg.append('ellipse').attr("cx", 0).attr("cy", 0).attr("rx", 16).attr("ry", 8).attr('transform', 'translate(50,35)rotate(-45)').attr('fill', 'black');

      for (var _key in _this.svgs) {
        svg.append("svg:defs").append("svg:marker").attr("id", 'arrow__image__' + _key).attr("refX", 0).attr("refY", 2).attr("markerWidth", 4).attr("markerHeight", 4).attr("orient", "auto").append("svg:path").attr("d", "M0,0 L0,4 L4,2 z").style('fill', componentMap[_key].color);

        svg.append("line").attr("x1", componentMap[_key][componentMap[_key].labels[0]].x1).attr("y1", componentMap[_key][componentMap[_key].labels[0]].y1).attr("x2", componentMap[_key][componentMap[_key].labels[0]].x2).attr("y2", componentMap[_key][componentMap[_key].labels[0]].y2).attr("stroke", componentMap[_key].color).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__image__' + _key);

        svg.append("line").attr("x1", componentMap[_key][componentMap[_key].labels[1]].x1).attr("y1", componentMap[_key][componentMap[_key].labels[1]].y1).attr("x2", componentMap[_key][componentMap[_key].labels[1]].x2).attr("y2", componentMap[_key][componentMap[_key].labels[1]].y2).attr("stroke", componentMap[_key].color).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__image__' + _key);

        svg.append('text').attr('class', 'component-speed__graph__image__label').text(componentMap[_key].labels[0]).style('fill', componentMap[_key].color).attr('y', componentMap[_key][componentMap[_key].labels[0]].ylabel).attr('x', componentMap[_key][componentMap[_key].labels[0]].xlabel);

        svg.append('text').attr('class', 'component-speed__graph__image__label').text(componentMap[_key].labels[1]).style('fill', componentMap[_key].color).attr('y', componentMap[_key][componentMap[_key].labels[1]].ylabel).attr('x', componentMap[_key][componentMap[_key].labels[1]].xlabel);
      }

      return _this;
    }

    _createClass(ComponentSpeedView, [{
      key: '_onModelChange',
      value: function _onModelChange(evt) {
        switch (evt.data.path) {
          case "data":
            if (evt.data.value) {
              this.reset();
              this.setup(evt.currentTarget);
            } else {
              this.reset();
            }
            break;
        }
      }
    }, {
      key: 'setup',
      value: function setup(model) {
        var _this2 = this;

        this.scales.x.domain([0, Object.values(model.get('data')).reduce(function (acc, val) {
          return Math.max(acc, val.runTime);
        }, 0)]);

        var maxValue = Object.values(model.get('data')).reduce(function (acc, val) {
          return Math.max(acc, val.maxValue);
        }, 0);
        this.scales.y.domain([model.get('mode') == 'component' ? -maxValue : 0, maxValue]);
        this.axes = {
          x: d3.axisBottom().scale(this.scales.x),
          y: d3.axisLeft().scale(this.scales.y).tickSize(0, 0)
        };
        this.bgs = {};
        for (var key in this.svgs) {
          this.svgs[key].selectAll('*').remove();

          this.svgs[key].select('.component-speed__graph__axis').remove();
          this.svgs[key].append('g').attr('class', 'component-speed__graph__axis component-speed__graph__axis-x').attr('transform', 'translate(0, ' + model.get('height') / 2 + ')').call(this.axes.x);
          this.svgs[key].selectAll("text").remove();

          this.svgs[key].append('g').attr('class', 'component-speed__graph__axis component-speed__graph__axis-x').attr('transform', 'translate(0, ' + model.get('height') + ')').call(this.axes.x).append('text').attr('class', 'component-speed__graph__axis-label').text('Time [seconds]').attr('x', model.get('width') / 2).attr('y', 30);

          this.svgs[key].append('g').attr('class', 'component-speed__graph__axis component-speed__graph__axis-y').call(this.axes.y);
          this.svgs[key].selectAll(".component-speed__graph__axis-y .domain").attr("stroke", 0);

          // this.svgs[key].append('g')
          //   .append('text')
          //     .attr('class', 'component-speed__graph__axis-label')
          //     .text(`Speed [micrometers / second]`)
          //     .attr('transform', 'rotate(-90)')
          //     .attr('y', -20)
          //     .attr('x', -model.get('height') / 2);

          this.svgs[key].append("svg:defs").append("svg:marker").attr("id", 'arrow__' + key).attr("refX", 0).attr("refY", 4).attr("markerWidth", 8).attr("markerHeight", 8).attr("orient", "auto").append("svg:path").attr("d", "M0,0 L0,8 L8,4 z").style('fill', componentMap[key].color);

          this.svgs[key].append("line").attr('class', 'component-speed__graph__arrow-line-' + componentMap[key].labels[0]).attr("x1", -5).attr("y1", model.get('height') / 2 - 5).attr("x2", -5).attr("y2", 5).attr("stroke", componentMap[key].color).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__' + key);

          this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__arrow-label').text('Speed ' + componentMap[key].labels[0]).attr('transform', 'rotate(-90)').style('fill', componentMap[key].color).attr('y', -10).attr('x', -model.get('height') / 4);

          this.svgs[key].append("line").attr('class', 'component-speed__graph__arrow-line-' + componentMap[key].labels[1]).attr("x1", -5).attr("y1", model.get('height') / 2 + 5).attr("x2", -5).attr("y2", model.get('height') - 5).attr("stroke", componentMap[key].color).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__' + key + ')');

          this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__arrow-label').text('Speed ' + componentMap[key].labels[1]).attr('transform', 'rotate(-90)').style('fill', componentMap[key].color).attr('y', -10).attr('x', -3 * model.get('height') / 4);

          this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__title').text('Average speed in ' + componentMap[key].title + ' direction ').attr('y', -10).attr('x', model.get('width') / 2);

          this.bgs[key] = this.svgs[key].append('g').attr('class', 'component-speed__graph__background');

          for (var layer in model.get('data')) {
            if (!model.get('data.' + layer + '.showLayer')) {
              continue;
            }
            var graphdata = model.get('data.' + layer + '.graphs.' + key).filter(function (item) {
              return item.mean;
            });
            var color = model.get('data.' + layer + '.color');
            if (model.get('stdBand')) {
              var std = d3.area().x(function (d) {
                return _this2.scales.x(d.time);
              }).y0(function (d) {
                return _this2.scales.y(d.mean - d.s);
              }).y1(function (d) {
                return _this2.scales.y(d.mean + d.s);
              });
              this.svgs[key].append('path').datum(graphdata).attr('class', 'component-speed__graph__std component-speed__graph__std__' + layer).attr('style', color ? 'fill: #' + color.toString(16) : null).attr('d', std);
            }

            // Function to be used for plotting
            // It defines that it takes for each data point the time element and the mean and plots it in x,y.
            // .datum(graphdata): That's the data on which to apply the function.
            // .attr(): Characteristics of the svg.
            // .attr('d',line) is where the datum gets transformed into the line.
            var line = d3.line().x(function (d) {
              return _this2.scales.x(d.time);
            }).y(function (d) {
              return _this2.scales.y(d.mean);
            });
            this.svgs[key].append('path').datum(graphdata).attr('class', 'component-speed__graph__line component-speed__graph__line__' + layer).attr('style', color ? 'stroke: #' + color.toString(16) : null).attr('d', line);
          }

          // Draw the lines at the different time intervals.
          if (model.get('lightConfig') && Object.keys(model.get('data')).length) {

            this.svgs[key].append("svg:defs").append("svg:marker").attr("id", 'arrow__component__light').attr("refX", 0).attr("refY", 2).attr("markerWidth", 4).attr("markerHeight", 4).attr("orient", "auto").append("svg:path").attr("d", "M0,0 L0,4 L4,2 z").style('fill', 'rgb(235,160,17)');

            var expDuration = model.get('lightConfig').reduce(function (acc, curr) {
              return Math.max(acc, curr.timeEnd);
            }, 0);

            var _iteratorNormalCompletion = true;
            var _didIteratorError = false;
            var _iteratorError = undefined;

            try {
              for (var _iterator = model.get('lightConfig')[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                var config = _step.value;

                if (config.timeStart != 0) {
                  this.svgs[key].append("line").attr('class', 'component-speed__graph__light-time').attr("x1", config.timeStart * model.get('width') / expDuration).attr("y1", model.get('height')).attr("x2", config.timeStart * model.get('width') / expDuration).attr("y2", 0).attr("stroke-width", 2);
                }
                if (config.lightDir[0] != 0 || config.lightDir[1] != 0) {
                  this.svgs[key].append("line").attr('class', 'component-speed__graph__light-arrow').attr("x1", (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration + 20).attr("y1", 10).attr("x2", (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration + 10 * config.lightDir[0] + 20).attr("y2", 10 + 10 * config.lightDir[1]).attr("stroke-width", 2).attr("marker-end", 'url(#arrow__component__light)');
                  //var lightValue = config.left!=0? config.left: (config.right!=0? config.right : (config.top!=0? : config.top : (config.bottom!=0? config.bottom : 0)));
                  var lightValue = Math.sqrt(Math.pow(config.left, 2) + Math.pow(config.right, 2) + Math.pow(config.top, 2) + Math.pow(config.bottom, 2));
                  lightValue = Math.round(lightValue);
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text(lightValue + '% ').attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration - 20);
                } else if (config.left != 0 && config.right != 0 && config.top != 0 && config.bottom != 0) {
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text(config.left + '% from all dir.').attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration);
                } else if (config.left != 0 && config.right != 0 && config.top == 0 && config.bottom == 0) {
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text(config.left + '% from left&right').attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration);
                } else if (config.left == 0 && config.right == 0 && config.top != 0 && config.bottom != 0) {
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text(config.top + '% from top&bottom').attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration);
                } else {
                  this.svgs[key].append('g').append('text').attr('class', 'component-speed__graph__light-label').text("no light").attr('y', 15).attr('x', (config.timeEnd + config.timeStart) / 2 * model.get('width') / expDuration);
                }
              }
            } catch (err) {
              _didIteratorError = true;
              _iteratorError = err;
            } finally {
              try {
                if (!_iteratorNormalCompletion && _iterator.return) {
                  _iterator.return();
                }
              } finally {
                if (_didIteratorError) {
                  throw _iteratorError;
                }
              }
            }
          }
        }
      }
    }, {
      key: 'update',
      value: function update(timestamp, model) {
        var _this3 = this;

        var runtime = Object.values(model.get('data')).reduce(function (acc, val) {
          return Math.max(acc, val.runTime);
        }, 0);
        for (var key in this.svgs) {
          var timeband = this.bgs[key].selectAll('.component-speed__graph__time-band').data([timestamp]);
          timeband.enter().append('rect').attr('class', 'component-speed__graph__time-band').attr('y', 0).attr('height', model.get('height')).merge(timeband).transition().duration(0).attr('x', function (d) {
            return _this3.scales.x(Math.min(runtime, Math.max(0, d - model.get('dT') / 2)));
          }).attr('width', function (d) {
            return _this3.scales.x(model.get('dT') + Math.min(0, d - model.get('dT') / 2) + Math.min(0, runtime - d - model.get('dT') / 2));
          });
          timeband.exit().remove();
        }
      }
    }, {
      key: 'reset',
      value: function reset() {
        for (var key in this.svgs) {
          this.svgs[key].selectAll('.component-speed__graph__axis').remove();
          this.svgs[key].selectAll('.component-speed__graph__time-band').remove();
          this.svgs[key].selectAll('.component-speed__graph__std').remove();
          this.svgs[key].selectAll('.component-speed__graph__line').remove();
        }
      }
    }]);

    return ComponentSpeedView;
  }(DomView);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS9ldWdsZW5hL2NvbXBvbmVudC9jb21wb25lbnRzcGVlZGdyYXBoL3ZpZXcuanMiXSwibmFtZXMiOlsiZGVmaW5lIiwicmVxdWlyZSIsIkRvbVZpZXciLCJVdGlscyIsImQzIiwiVGVtcGxhdGUiLCJjb21wb25lbnRNYXAiLCJ4IiwidGl0bGUiLCJsYWJlbHMiLCJjb2xvciIsInJpZ2h0IiwibGVmdCIsInkiLCJ1cCIsImRvd24iLCJtb2RlbCIsInRtcGwiLCJiaW5kTWV0aG9kcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfb25Nb2RlbENoYW5nZSIsImdldCIsInN2Z3MiLCJ0b3RhbCIsImtleSIsInN2ZyIsInNlbGVjdCIsIiRlbCIsImZpbmQiLCJhcHBlbmQiLCJjbGFzc2VkIiwiYXR0ciIsInNjYWxlcyIsInNjYWxlTGluZWFyIiwicmFuZ2UiLCJzdHlsZSIsIngxIiwieTEiLCJ4MiIsInkyIiwidGV4dCIsInlsYWJlbCIsInhsYWJlbCIsImV2dCIsImRhdGEiLCJwYXRoIiwidmFsdWUiLCJyZXNldCIsInNldHVwIiwiY3VycmVudFRhcmdldCIsImRvbWFpbiIsIk9iamVjdCIsInZhbHVlcyIsInJlZHVjZSIsImFjYyIsInZhbCIsIk1hdGgiLCJtYXgiLCJydW5UaW1lIiwibWF4VmFsdWUiLCJheGVzIiwiYXhpc0JvdHRvbSIsInNjYWxlIiwiYXhpc0xlZnQiLCJ0aWNrU2l6ZSIsImJncyIsInNlbGVjdEFsbCIsInJlbW92ZSIsImNhbGwiLCJsYXllciIsImdyYXBoZGF0YSIsImZpbHRlciIsIml0ZW0iLCJtZWFuIiwic3RkIiwiYXJlYSIsImQiLCJ0aW1lIiwieTAiLCJzIiwiZGF0dW0iLCJ0b1N0cmluZyIsImxpbmUiLCJrZXlzIiwibGVuZ3RoIiwiZXhwRHVyYXRpb24iLCJjdXJyIiwidGltZUVuZCIsImNvbmZpZyIsInRpbWVTdGFydCIsImxpZ2h0RGlyIiwibGlnaHRWYWx1ZSIsInNxcnQiLCJwb3ciLCJ0b3AiLCJib3R0b20iLCJyb3VuZCIsInRpbWVzdGFtcCIsInJ1bnRpbWUiLCJ0aW1lYmFuZCIsImVudGVyIiwibWVyZ2UiLCJ0cmFuc2l0aW9uIiwiZHVyYXRpb24iLCJtaW4iLCJleGl0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUFBLE9BQU8sVUFBQ0MsT0FBRCxFQUFhO0FBQ2xCLE1BQU1DLFVBQVVELFFBQVEsb0JBQVIsQ0FBaEI7QUFBQSxNQUNFRSxRQUFRRixRQUFRLGlCQUFSLENBRFY7QUFBQSxNQUVFRyxLQUFLSCxRQUFRLElBQVIsQ0FGUDtBQUFBLE1BR0VJLFdBQVdKLFFBQVEsaUNBQVIsQ0FIYjtBQUtBQSxVQUFRLGdDQUFSOztBQUVBLE1BQU1LLGVBQWU7QUFDbkJDLE9BQUc7QUFDREMsYUFBTyxZQUROO0FBRURDLGNBQVEsQ0FBQyxPQUFELEVBQVMsTUFBVCxDQUZQO0FBR0RDLGFBQU8saUJBSE47QUFJREMsYUFBTyxFQUFDLE1BQUssRUFBTixFQUFVLE1BQU0sRUFBaEIsRUFBb0IsTUFBTSxFQUExQixFQUE4QixNQUFNLEVBQXBDLEVBQXdDLFVBQVUsRUFBbEQsRUFBc0QsVUFBVSxFQUFoRSxFQUpOO0FBS0RDLFlBQU0sRUFBQyxNQUFLLEVBQU4sRUFBVSxNQUFNLEVBQWhCLEVBQW9CLE1BQU0sRUFBMUIsRUFBOEIsTUFBTSxFQUFwQyxFQUF3QyxVQUFVLEVBQWxELEVBQXNELFVBQVUsRUFBaEU7QUFMTCxLQURnQjtBQVFuQkMsT0FBRztBQUNETCxhQUFPLFNBRE47QUFFREMsY0FBUSxDQUFDLElBQUQsRUFBTSxNQUFOLENBRlA7QUFHREMsYUFBTyxnQkFITjtBQUlESSxVQUFJLEVBQUMsTUFBSyxFQUFOLEVBQVUsTUFBTSxFQUFoQixFQUFvQixNQUFNLEVBQTFCLEVBQThCLE1BQU0sRUFBcEMsRUFBd0MsVUFBVSxFQUFsRCxFQUFzRCxVQUFVLEVBQWhFLEVBSkg7QUFLREMsWUFBTSxFQUFDLE1BQUssRUFBTixFQUFVLE1BQU0sRUFBaEIsRUFBb0IsTUFBTSxFQUExQixFQUE4QixNQUFNLEVBQXBDLEVBQXdD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LEVBQTJCO0FBQ3pCLGVBQUtBLElBQUwsQ0FBVUUsR0FBVixFQUFlMEMsU0FBZixDQUF5QiwrQkFBekIsRUFBMERDLE1BQTFEO0FBQ0EsZUFBSzdDLElBQUwsQ0FBVUUsR0FBVixFQUFlMEMsU0FBZixDQUF5QixvQ0FBekIsRUFBK0RDLE1BQS9EO0FBQ0EsZUFBSzdDLElBQUwsQ0FBVUUsR0FBVixFQUFlMEMsU0FBZixDQUF5Qiw4QkFBekIsRUFBeURDLE1BQXpEO0FBQ0EsZUFBSzdDLElBQUwsQ0FBVUUsR0FBVixFQUFlMEMsU0FBZixDQUF5QiwrQkFBekIsRUFBMERDLE1BQTFEO0FBQ0Q7QUFDRjtBQTVWSDs7QUFBQTtBQUFBLElBQXdDakUsT0FBeEM7QUE4VkQsQ0F0WEQiLCJmaWxlIjoibW9kdWxlL2V1Z2xlbmEvY29tcG9uZW50L2NvbXBvbmVudHNwZWVkZ3JhcGgvdmlldy5qcyIsInNvdXJjZXNDb250ZW50IjpbImRlZmluZSgocmVxdWlyZSkgPT4ge1xuICBjb25zdCBEb21WaWV3ID0gcmVxdWlyZSgnY29yZS92aWV3L2RvbV92aWV3JyksXG4gICAgVXRpbHMgPSByZXF1aXJlKCdjb3JlL3V0aWwvdXRpbHMnKSxcbiAgICBkMyA9IHJlcXVpcmUoJ2QzJyksXG4gICAgVGVtcGxhdGUgPSByZXF1aXJlKCd0ZXh0IS4vY29tcG9uZW50c3BlZWRncmFwaC5odG1sJylcbiAgO1xuICByZXF1aXJlKCdsaW5rIS4vY29tcG9uZW50c3BlZWRncmFwaC5jc3MnKTtcblxuICBjb25zdCBjb21wb25lbnRNYXAgPSB7XG4gICAgeDoge1xuICAgICAgdGl0bGU6ICdsZWZ0L3JpZ2h0JyxcbiAgICAgIGxhYmVsczogWydyaWdodCcsJ2xlZnQnXSxcbiAgICAgIGNvbG9yOiAncmdiKDU1LDE1MiwxOTUpJyxcbiAgICAgIHJpZ2h0OiB7J3gxJzo1NSwgJ3gyJzogNzUsICd5MSc6IDM1LCAneTInOiAzNSwgJ3hsYWJlbCc6IDc1LCAneWxhYmVsJzogMzB9LFxuICAgICAgbGVmdDogeyd4MSc6NDUsICd4Mic6IDI1LCAneTEnOiAzNSwgJ3kyJzogMzUsICd4bGFiZWwnOiAyNSwgJ3lsYWJlbCc6IDMwfVxuICAgIH0sXG4gICAgeToge1xuICAgICAgdGl0bGU6ICd1cC9kb3duJyxcbiAgICAgIGxhYmVsczogWyd1cCcsJ2Rvd24nXSxcbiAgICAgIGNvbG9yOiAncmdiKDU1LDE0Myw0OCknLFxuICAgICAgdXA6IHsneDEnOjUwLCAneDInOiA1MCwgJ3kxJzogMzAsICd5Mic6IDEwLCAneGxhYmVsJzogNDAsICd5bGFiZWwnOiAxNX0sXG4gICAgICBkb3duOiB7J3gxJzo1MCwgJ3gyJzogNTAsICd5MSc6IDQwLCAneTInOiA2MCwgJ3hsYWJlbCc6IDM1LCAneWxhYmVsJzogNTV9XG4gICAgfVxuICB9XG4gIHJldHVybiBjbGFzcyBDb21wb25lbnRTcGVlZFZpZXcgZXh0ZW5kcyBEb21WaWV3IHtcbiAgICBjb25zdHJ1Y3Rvcihtb2RlbCwgdG1wbCkge1xuICAgICAgc3VwZXIodG1wbCB8fCBUZW1wbGF0ZSk7XG4gICAgICBVdGlscy5iaW5kTWV0aG9kcyh0aGlzLCBbJ19vbk1vZGVsQ2hhbmdlJ10pO1xuXG4gICAgICBtb2RlbC5hZGRFdmVudExpc3RlbmVyKCdNb2RlbC5DaGFuZ2UnLCB0aGlzLl9vbk1vZGVsQ2hhbmdlKTtcblxuICAgICAgaWYgKG1vZGVsLmdldCgnbW9kZScpID09IFwiY29tcG9uZW50XCIpIHtcbiAgICAgICAgdGhpcy5zdmdzID0ge1xuICAgICAgICAgIHg6IG51bGwsXG4gICAgICAgICAgeTogbnVsbFxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN2Z3MgPSB7XG4gICAgICAgICAgdG90YWw6IG51bGxcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuc3Zncykge1xuICAgICAgICBsZXQgc3ZnID0gZDMuc2VsZWN0KHRoaXMuJGVsLmZpbmQoJy5jb21wb25lbnQtc3BlZWRfX2dyYXBoJykuZ2V0KDApKS5hcHBlbmQoJ3N2ZycpO1xuICAgICAgICBzdmcuY2xhc3NlZChgY29tcG9uZW50LXNwZWVkX19ncmFwaF9fJHtrZXl9YCwgdHJ1ZSk7XG4gICAgICAgIHN2Zy5hdHRyKCd3aWR0aCcsIG1vZGVsLmdldCgnd2lkdGgnKSArIG1vZGVsLmdldCgnbWFyZ2lucy5sZWZ0JykgKyBtb2RlbC5nZXQoJ21hcmdpbnMucmlnaHQnKSk7XG4gICAgICAgIHN2Zy5hdHRyKCdoZWlnaHQnLCBtb2RlbC5nZXQoJ2hlaWdodCcpICsgbW9kZWwuZ2V0KCdtYXJnaW5zLnRvcCcpICsgbW9kZWwuZ2V0KCdtYXJnaW5zLmJvdHRvbScpKTtcbiAgICAgICAgdGhpcy5zdmdzW2tleV0gPSBzdmcuYXBwZW5kKCdnJylcbiAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke21vZGVsLmdldCgnbWFyZ2lucy5sZWZ0Jyl9LCAke21vZGVsLmdldCgnbWFyZ2lucy50b3AnKX0pYCk7XG4gICAgICB9XG4gICAgICB0aGlzLnNjYWxlcyA9IHt9O1xuICAgICAgdGhpcy5zY2FsZXMueCA9IGQzLnNjYWxlTGluZWFyKCkucmFuZ2UoWzAsIG1vZGVsLmdldCgnd2lkdGgnKV0pO1xuICAgICAgdGhpcy5zY2FsZXMueSA9IGQzLnNjYWxlTGluZWFyKCkucmFuZ2UoW21vZGVsLmdldCgnaGVpZ2h0JyksIDBdKTtcblxuICAgICAgbGV0IHN2ZyA9IGQzLnNlbGVjdCh0aGlzLiRlbC5maW5kKCcuY29tcG9uZW50LXNwZWVkX19ncmFwaF9faW1hZ2UnKS5nZXQoMCkpLmFwcGVuZCgnc3ZnJyk7XG4gICAgICBzdmcuYXR0cignd2lkdGgnLCAxMDApXG4gICAgICAuYXR0cignaGVpZ2h0JywgNzApXG5cbiAgICAgIC8vIERyYXcgdmlzdWFsaXphdGlvbiB0byBpbGx1c3RyYXRlIHRoZSBtZWFuaW5nXG4gICAgICBzdmcuYXBwZW5kKCdlbGxpcHNlJylcbiAgICAgICAgLmF0dHIoXCJjeFwiLDApXG4gICAgICAgIC5hdHRyKFwiY3lcIiwwKVxuICAgICAgICAuYXR0cihcInJ4XCIsMTYpXG4gICAgICAgIC5hdHRyKFwicnlcIiw4KVxuICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSg1MCwzNSlyb3RhdGUoLTQ1KScpXG4gICAgICAgIC5hdHRyKCdmaWxsJywnYmxhY2snKVxuXG4gICAgICBmb3IgKGxldCBrZXkgaW4gdGhpcy5zdmdzKSB7XG4gICAgICAgIHN2Zy5hcHBlbmQoXCJzdmc6ZGVmc1wiKVxuICAgICAgICAgICAuYXBwZW5kKFwic3ZnOm1hcmtlclwiKVxuICAgICAgICAgICAuYXR0cihcImlkXCIsIGBhcnJvd19faW1hZ2VfXyR7a2V5fWApXG4gICAgICAgICAgIC5hdHRyKFwicmVmWFwiLCAwKVxuICAgICAgICBcdC5hdHRyKFwicmVmWVwiLCAyKVxuICAgICAgICBcdC5hdHRyKFwibWFya2VyV2lkdGhcIiwgNClcbiAgICAgICAgXHQuYXR0cihcIm1hcmtlckhlaWdodFwiLCA0KVxuICAgICAgICBcdC5hdHRyKFwib3JpZW50XCIsIFwiYXV0b1wiKVxuICAgICAgICBcdC5hcHBlbmQoXCJzdmc6cGF0aFwiKVxuICAgICAgICBcdC5hdHRyKFwiZFwiLCBcIk0wLDAgTDAsNCBMNCwyIHpcIilcbiAgICAgICAgICAgLnN0eWxlKCdmaWxsJyxjb21wb25lbnRNYXBba2V5XS5jb2xvcik7XG5cbiAgICAgICBzdmcuYXBwZW5kKFwibGluZVwiKVxuICAgICAgICAgLmF0dHIoXCJ4MVwiLGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1swXV0ueDEpXG4gICAgICAgICAuYXR0cihcInkxXCIsY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzBdXS55MSlcbiAgICAgICAgIC5hdHRyKFwieDJcIixjb21wb25lbnRNYXBba2V5XVtjb21wb25lbnRNYXBba2V5XS5sYWJlbHNbMF1dLngyKVxuICAgICAgICAgLmF0dHIoXCJ5MlwiLGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1swXV0ueTIpXG4gICAgICAgICAuYXR0cihcInN0cm9rZVwiLGNvbXBvbmVudE1hcFtrZXldLmNvbG9yKVxuICAgICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwyKVxuICAgICAgICAgLmF0dHIoXCJtYXJrZXItZW5kXCIsYHVybCgjYXJyb3dfX2ltYWdlX18ke2tleX1gKTtcblxuICAgICAgIHN2Zy5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAgICAuYXR0cihcIngxXCIsY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzFdXS54MSlcbiAgICAgICAgIC5hdHRyKFwieTFcIixjb21wb25lbnRNYXBba2V5XVtjb21wb25lbnRNYXBba2V5XS5sYWJlbHNbMV1dLnkxKVxuICAgICAgICAgLmF0dHIoXCJ4MlwiLGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1sxXV0ueDIpXG4gICAgICAgICAuYXR0cihcInkyXCIsY29tcG9uZW50TWFwW2tleV1bY29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzFdXS55MilcbiAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsY29tcG9uZW50TWFwW2tleV0uY29sb3IpXG4gICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLDIpXG4gICAgICAgICAuYXR0cihcIm1hcmtlci1lbmRcIixgdXJsKCNhcnJvd19faW1hZ2VfXyR7a2V5fWApO1xuXG4gICAgICAgc3ZnLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjb21wb25lbnQtc3BlZWRfX2dyYXBoX19pbWFnZV9fbGFiZWwnKVxuICAgICAgICAgICAudGV4dChjb21wb25lbnRNYXBba2V5XS5sYWJlbHNbMF0pXG4gICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIGNvbXBvbmVudE1hcFtrZXldLmNvbG9yKVxuICAgICAgICAgICAuYXR0cigneScsIGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1swXV0ueWxhYmVsKVxuICAgICAgICAgICAuYXR0cigneCcsIGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1swXV0ueGxhYmVsKTtcblxuXG4gICAgICAgc3ZnLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjb21wb25lbnQtc3BlZWRfX2dyYXBoX19pbWFnZV9fbGFiZWwnKVxuICAgICAgICAgICAudGV4dChjb21wb25lbnRNYXBba2V5XS5sYWJlbHNbMV0pXG4gICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIGNvbXBvbmVudE1hcFtrZXldLmNvbG9yKVxuICAgICAgICAgICAuYXR0cigneScsIGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1sxXV0ueWxhYmVsKVxuICAgICAgICAgICAuYXR0cigneCcsIGNvbXBvbmVudE1hcFtrZXldW2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1sxXV0ueGxhYmVsKTtcbiAgICAgIH1cblxuICAgIH1cblxuICAgIF9vbk1vZGVsQ2hhbmdlKGV2dCkge1xuICAgICAgc3dpdGNoIChldnQuZGF0YS5wYXRoKSB7XG4gICAgICAgIGNhc2UgXCJkYXRhXCI6XG4gICAgICAgICAgaWYgKGV2dC5kYXRhLnZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgICAgICB0aGlzLnNldHVwKGV2dC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBzZXR1cChtb2RlbCkge1xuXG4gICAgICB0aGlzLnNjYWxlcy54LmRvbWFpbihbMCwgT2JqZWN0LnZhbHVlcyhtb2RlbC5nZXQoJ2RhdGEnKSkucmVkdWNlKChhY2MsIHZhbCkgPT4gTWF0aC5tYXgoYWNjLCB2YWwucnVuVGltZSksIDApXSk7XG5cbiAgICAgIGxldCBtYXhWYWx1ZSA9IE9iamVjdC52YWx1ZXMobW9kZWwuZ2V0KCdkYXRhJykpLnJlZHVjZSgoYWNjLCB2YWwpID0+IE1hdGgubWF4KGFjYywgdmFsLm1heFZhbHVlKSwgMCk7XG4gICAgICB0aGlzLnNjYWxlcy55LmRvbWFpbihbbW9kZWwuZ2V0KCdtb2RlJykgPT0gJ2NvbXBvbmVudCcgPyAtbWF4VmFsdWUgOiAwLCBtYXhWYWx1ZV0pO1xuICAgICAgdGhpcy5heGVzID0ge1xuICAgICAgICB4OiBkMy5heGlzQm90dG9tKCkuc2NhbGUodGhpcy5zY2FsZXMueCksXG4gICAgICAgIHk6IGQzLmF4aXNMZWZ0KCkuc2NhbGUodGhpcy5zY2FsZXMueSkudGlja1NpemUoMCwwKVxuICAgICAgfTtcbiAgICAgIHRoaXMuYmdzID0ge307XG4gICAgICBmb3IgKGxldCBrZXkgaW4gdGhpcy5zdmdzKSB7XG4gICAgICAgIHRoaXMuc3Znc1trZXldLnNlbGVjdEFsbCgnKicpLnJlbW92ZSgpO1xuXG4gICAgICAgIHRoaXMuc3Znc1trZXldLnNlbGVjdCgnLmNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2F4aXMnKS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKCdnJylcbiAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYXhpcyBjb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzLXgnKVxuICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKDAsICR7bW9kZWwuZ2V0KCdoZWlnaHQnKSAvIDJ9KWApXG4gICAgICAgICAgLmNhbGwodGhpcy5heGVzLngpXG4gICAgICAgIHRoaXMuc3Znc1trZXldLnNlbGVjdEFsbChcInRleHRcIikucmVtb3ZlKCk7XG5cbiAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKCdnJylcbiAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYXhpcyBjb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzLXgnKVxuICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKDAsICR7bW9kZWwuZ2V0KCdoZWlnaHQnKX0pYClcbiAgICAgICAgICAuY2FsbCh0aGlzLmF4ZXMueClcbiAgICAgICAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzLWxhYmVsJylcbiAgICAgICAgICAgIC50ZXh0KCdUaW1lIFtzZWNvbmRzXScpXG4gICAgICAgICAgICAuYXR0cigneCcsIG1vZGVsLmdldCgnd2lkdGgnKSAvIDIpXG4gICAgICAgICAgICAuYXR0cigneScsIDMwKTtcblxuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzIGNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2F4aXMteScpXG4gICAgICAgICAgLmNhbGwodGhpcy5heGVzLnkpXG4gICAgICAgIHRoaXMuc3Znc1trZXldLnNlbGVjdEFsbChcIi5jb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzLXkgLmRvbWFpblwiKS5hdHRyKFwic3Ryb2tlXCIsMClcblxuICAgICAgICAvLyB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAvLyAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAvLyAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2F4aXMtbGFiZWwnKVxuICAgICAgICAvLyAgICAgLnRleHQoYFNwZWVkIFttaWNyb21ldGVycyAvIHNlY29uZF1gKVxuICAgICAgICAvLyAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICdyb3RhdGUoLTkwKScpXG4gICAgICAgIC8vICAgICAuYXR0cigneScsIC0yMClcbiAgICAgICAgLy8gICAgIC5hdHRyKCd4JywgLW1vZGVsLmdldCgnaGVpZ2h0JykgLyAyKTtcblxuICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZChcInN2ZzpkZWZzXCIpXG4gICAgICAgIFx0LmFwcGVuZChcInN2ZzptYXJrZXJcIilcbiAgICAgICAgXHQuYXR0cihcImlkXCIsIGBhcnJvd19fJHtrZXl9YClcbiAgICAgICAgXHQuYXR0cihcInJlZlhcIiwgMClcbiAgICAgICAgXHQuYXR0cihcInJlZllcIiwgNClcbiAgICAgICAgXHQuYXR0cihcIm1hcmtlcldpZHRoXCIsIDgpXG4gICAgICAgIFx0LmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgOClcbiAgICAgICAgXHQuYXR0cihcIm9yaWVudFwiLCBcImF1dG9cIilcbiAgICAgICAgXHQuYXBwZW5kKFwic3ZnOnBhdGhcIilcbiAgICAgICAgXHQuYXR0cihcImRcIiwgXCJNMCwwIEwwLDggTDgsNCB6XCIpXG4gICAgICAgICAgLnN0eWxlKCdmaWxsJyxjb21wb25lbnRNYXBba2V5XS5jb2xvcik7XG5cbiAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKFwibGluZVwiKVxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsIGBjb21wb25lbnQtc3BlZWRfX2dyYXBoX19hcnJvdy1saW5lLSR7Y29tcG9uZW50TWFwW2tleV0ubGFiZWxzWzBdfWApXG4gICAgICAgICAgLmF0dHIoXCJ4MVwiLC01KVxuICAgICAgICAgIC5hdHRyKFwieTFcIixtb2RlbC5nZXQoJ2hlaWdodCcpIC8gMiAtIDUpXG4gICAgICAgICAgLmF0dHIoXCJ4MlwiLC01KVxuICAgICAgICAgIC5hdHRyKFwieTJcIiw1KVxuICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsY29tcG9uZW50TWFwW2tleV0uY29sb3IpXG4gICAgICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwyKVxuICAgICAgICAgIC5hdHRyKFwibWFya2VyLWVuZFwiLGB1cmwoI2Fycm93X18ke2tleX1gKTtcblxuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2Fycm93LWxhYmVsJylcbiAgICAgICAgICAgIC50ZXh0KGBTcGVlZCAke2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1swXX1gKVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICdyb3RhdGUoLTkwKScpXG4gICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCBjb21wb25lbnRNYXBba2V5XS5jb2xvcilcbiAgICAgICAgICAgIC5hdHRyKCd5JywgLTEwKVxuICAgICAgICAgICAgLmF0dHIoJ3gnLCAtbW9kZWwuZ2V0KCdoZWlnaHQnKSAvIDQpO1xuXG4gICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZChcImxpbmVcIilcbiAgICAgICAgICAuYXR0cignY2xhc3MnLCBgY29tcG9uZW50LXNwZWVkX19ncmFwaF9fYXJyb3ctbGluZS0ke2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1sxXX1gKVxuICAgICAgICAgIC5hdHRyKFwieDFcIiwtNSlcbiAgICAgICAgICAuYXR0cihcInkxXCIsIG1vZGVsLmdldCgnaGVpZ2h0JykgLyAyICsgNSlcbiAgICAgICAgICAuYXR0cihcIngyXCIsLTUpXG4gICAgICAgICAgLmF0dHIoXCJ5MlwiLG1vZGVsLmdldCgnaGVpZ2h0JykgLSA1KVxuICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsY29tcG9uZW50TWFwW2tleV0uY29sb3IpXG4gICAgICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwyKVxuICAgICAgICAgIC5hdHRyKFwibWFya2VyLWVuZFwiLGB1cmwoI2Fycm93X18ke2tleX0pYClcblxuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2Fycm93LWxhYmVsJylcbiAgICAgICAgICAgIC50ZXh0KGBTcGVlZCAke2NvbXBvbmVudE1hcFtrZXldLmxhYmVsc1sxXX1gKVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICdyb3RhdGUoLTkwKScpXG4gICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCBjb21wb25lbnRNYXBba2V5XS5jb2xvcilcbiAgICAgICAgICAgIC5hdHRyKCd5JywgLTEwKVxuICAgICAgICAgICAgLmF0dHIoJ3gnLCAtMyAqIG1vZGVsLmdldCgnaGVpZ2h0JykgLyA0KTtcblxuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX3RpdGxlJylcbiAgICAgICAgICAgIC50ZXh0KGBBdmVyYWdlIHNwZWVkIGluICR7Y29tcG9uZW50TWFwW2tleV0udGl0bGV9IGRpcmVjdGlvbiBgKVxuICAgICAgICAgICAgLmF0dHIoJ3knLCAtMTApXG4gICAgICAgICAgICAuYXR0cigneCcsIG1vZGVsLmdldCgnd2lkdGgnKSAvIDIpO1xuXG5cbiAgICAgICAgdGhpcy5iZ3Nba2V5XSA9IHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2JhY2tncm91bmQnKTtcblxuICAgICAgICBmb3IgKGxldCBsYXllciBpbiBtb2RlbC5nZXQoJ2RhdGEnKSkge1xuICAgICAgICAgIGlmICghbW9kZWwuZ2V0KGBkYXRhLiR7bGF5ZXJ9LnNob3dMYXllcmApKSB7Y29udGludWV9XG4gICAgICAgICAgbGV0IGdyYXBoZGF0YSA9IG1vZGVsLmdldChgZGF0YS4ke2xheWVyfS5ncmFwaHMuJHtrZXl9YCkuZmlsdGVyKChpdGVtKSA9PiBpdGVtLm1lYW4pO1xuICAgICAgICAgIGxldCBjb2xvciA9IG1vZGVsLmdldChgZGF0YS4ke2xheWVyfS5jb2xvcmApXG4gICAgICAgICAgaWYgKG1vZGVsLmdldCgnc3RkQmFuZCcpKSB7XG4gICAgICAgICAgICBsZXQgc3RkID0gZDMuYXJlYSgpXG4gICAgICAgICAgICAgIC54KChkKSA9PiB0aGlzLnNjYWxlcy54KGQudGltZSkpXG4gICAgICAgICAgICAgIC55MCgoZCkgPT4gdGhpcy5zY2FsZXMueShkLm1lYW4gLSBkLnMpKVxuICAgICAgICAgICAgICAueTEoKGQpID0+IHRoaXMuc2NhbGVzLnkoZC5tZWFuICsgZC5zKSk7XG4gICAgICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAgICAgICAuZGF0dW0oZ3JhcGhkYXRhKVxuICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCBgY29tcG9uZW50LXNwZWVkX19ncmFwaF9fc3RkIGNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX3N0ZF9fJHtsYXllcn1gKVxuICAgICAgICAgICAgICAuYXR0cignc3R5bGUnLCBjb2xvciA/IGBmaWxsOiAjJHtjb2xvci50b1N0cmluZygxNil9YCA6IG51bGwpXG4gICAgICAgICAgICAgIC5hdHRyKCdkJywgc3RkKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBGdW5jdGlvbiB0byBiZSB1c2VkIGZvciBwbG90dGluZ1xuICAgICAgICAgIC8vIEl0IGRlZmluZXMgdGhhdCBpdCB0YWtlcyBmb3IgZWFjaCBkYXRhIHBvaW50IHRoZSB0aW1lIGVsZW1lbnQgYW5kIHRoZSBtZWFuIGFuZCBwbG90cyBpdCBpbiB4LHkuXG4gICAgICAgICAgLy8gLmRhdHVtKGdyYXBoZGF0YSk6IFRoYXQncyB0aGUgZGF0YSBvbiB3aGljaCB0byBhcHBseSB0aGUgZnVuY3Rpb24uXG4gICAgICAgICAgLy8gLmF0dHIoKTogQ2hhcmFjdGVyaXN0aWNzIG9mIHRoZSBzdmcuXG4gICAgICAgICAgLy8gLmF0dHIoJ2QnLGxpbmUpIGlzIHdoZXJlIHRoZSBkYXR1bSBnZXRzIHRyYW5zZm9ybWVkIGludG8gdGhlIGxpbmUuXG4gICAgICAgICAgbGV0IGxpbmUgPSBkMy5saW5lKClcbiAgICAgICAgICAgIC54KChkKSA9PiB0aGlzLnNjYWxlcy54KGQudGltZSkpXG4gICAgICAgICAgICAueSgoZCkgPT4gdGhpcy5zY2FsZXMueShkLm1lYW4pKVxuICAgICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgncGF0aCcpXG4gICAgICAgICAgICAuZGF0dW0oZ3JhcGhkYXRhKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgYGNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2xpbmUgY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGluZV9fJHtsYXllcn1gKVxuICAgICAgICAgICAgLmF0dHIoJ3N0eWxlJywgY29sb3IgPyBgc3Ryb2tlOiAjJHtjb2xvci50b1N0cmluZygxNil9YCA6IG51bGwpXG4gICAgICAgICAgICAuYXR0cignZCcsIGxpbmUpO1xuXG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vIERyYXcgdGhlIGxpbmVzIGF0IHRoZSBkaWZmZXJlbnQgdGltZSBpbnRlcnZhbHMuXG4gICAgICAgIGlmIChtb2RlbC5nZXQoJ2xpZ2h0Q29uZmlnJykgJiYgT2JqZWN0LmtleXMobW9kZWwuZ2V0KCdkYXRhJykpLmxlbmd0aCkge1xuXG4gICAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKFwic3ZnOmRlZnNcIilcbiAgICAgICAgICAgXHQuYXBwZW5kKFwic3ZnOm1hcmtlclwiKVxuICAgICAgICAgICBcdC5hdHRyKFwiaWRcIiwgYGFycm93X19jb21wb25lbnRfX2xpZ2h0YClcbiAgICAgICAgICAgXHQuYXR0cihcInJlZlhcIiwgMClcbiAgICAgICAgICAgXHQuYXR0cihcInJlZllcIiwgMilcbiAgICAgICAgICAgXHQuYXR0cihcIm1hcmtlcldpZHRoXCIsIDQpXG4gICAgICAgICAgIFx0LmF0dHIoXCJtYXJrZXJIZWlnaHRcIiwgNClcbiAgICAgICAgICAgXHQuYXR0cihcIm9yaWVudFwiLCBcImF1dG9cIilcbiAgICAgICAgICAgXHQuYXBwZW5kKFwic3ZnOnBhdGhcIilcbiAgICAgICAgICAgXHQuYXR0cihcImRcIiwgXCJNMCwwIEwwLDQgTDQsMiB6XCIpXG4gICAgICAgICAgICAgLnN0eWxlKCdmaWxsJywncmdiKDIzNSwxNjAsMTcpJyk7XG5cbiAgICAgICAgICB2YXIgZXhwRHVyYXRpb24gPSBtb2RlbC5nZXQoJ2xpZ2h0Q29uZmlnJykucmVkdWNlKChhY2MsY3VycikgPT4gTWF0aC5tYXgoYWNjLGN1cnIudGltZUVuZCksMCk7XG5cbiAgICAgICAgICBmb3IgKGxldCBjb25maWcgb2YgbW9kZWwuZ2V0KCdsaWdodENvbmZpZycpKSB7XG4gICAgICAgICAgICBpZiAoY29uZmlnLnRpbWVTdGFydCAhPSAwKSB7XG4gICAgICAgICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZChcImxpbmVcIilcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGlnaHQtdGltZScpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ4MVwiLCBjb25maWcudGltZVN0YXJ0ICogbW9kZWwuZ2V0KCd3aWR0aCcpIC8gZXhwRHVyYXRpb24pXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ5MVwiLCBtb2RlbC5nZXQoJ2hlaWdodCcpKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieDJcIiwgY29uZmlnLnRpbWVTdGFydCAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieTJcIiwwKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsMilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb25maWcubGlnaHREaXJbMF0gIT0gMCB8fCBjb25maWcubGlnaHREaXJbMV0gIT0gMCkge1xuICAgICAgICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGlnaHQtYXJyb3cnKVxuICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ4MVwiLChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uICsgMjApXG4gICAgICAgICAgICAgICAgICAuYXR0cihcInkxXCIsIDEwKVxuICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ4MlwiLChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAgKiBtb2RlbC5nZXQoJ3dpZHRoJykgLyBleHBEdXJhdGlvbiArIDEwICogY29uZmlnLmxpZ2h0RGlyWzBdICsgMjApXG4gICAgICAgICAgICAgICAgICAuYXR0cihcInkyXCIsIDEwICsgMTAgKiBjb25maWcubGlnaHREaXJbMV0pXG4gICAgICAgICAgICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLDIpXG4gICAgICAgICAgICAgICAgICAuYXR0cihcIm1hcmtlci1lbmRcIixgdXJsKCNhcnJvd19fY29tcG9uZW50X19saWdodClgKVxuICAgICAgICAgICAgICAvL3ZhciBsaWdodFZhbHVlID0gY29uZmlnLmxlZnQhPTA/IGNvbmZpZy5sZWZ0OiAoY29uZmlnLnJpZ2h0IT0wPyBjb25maWcucmlnaHQgOiAoY29uZmlnLnRvcCE9MD8gOiBjb25maWcudG9wIDogKGNvbmZpZy5ib3R0b20hPTA/IGNvbmZpZy5ib3R0b20gOiAwKSkpO1xuICAgICAgICAgICAgICB2YXIgbGlnaHRWYWx1ZSA9IE1hdGguc3FydChNYXRoLnBvdyhjb25maWcubGVmdCwyKSArIE1hdGgucG93KGNvbmZpZy5yaWdodCwyKSArIE1hdGgucG93KGNvbmZpZy50b3AsMikgKyBNYXRoLnBvdyhjb25maWcuYm90dG9tLDIpKTtcbiAgICAgICAgICAgICAgbGlnaHRWYWx1ZSA9IE1hdGgucm91bmQobGlnaHRWYWx1ZSk7XG4gICAgICAgICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2xpZ2h0LWxhYmVsJylcbiAgICAgICAgICAgICAgICAudGV4dChgJHtsaWdodFZhbHVlfSUgYClcbiAgICAgICAgICAgICAgICAuYXR0cigneScsIDE1KVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgKGNvbmZpZy50aW1lRW5kICsgY29uZmlnLnRpbWVTdGFydCkgLyAyICogbW9kZWwuZ2V0KCd3aWR0aCcpIC8gZXhwRHVyYXRpb24gLSAyMCk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLmxlZnQgIT0gMCAmJiBjb25maWcucmlnaHQgIT0gMCAmJiBjb25maWcudG9wICE9IDAgJiYgY29uZmlnLmJvdHRvbSAhPSAwKXtcbiAgICAgICAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGlnaHQtbGFiZWwnKVxuICAgICAgICAgICAgICAgIC50ZXh0KGAke2NvbmZpZy5sZWZ0fSUgZnJvbSBhbGwgZGlyLmApXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCAxNSlcbiAgICAgICAgICAgICAgICAuYXR0cigneCcsIChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLmxlZnQgIT0gMCAmJiBjb25maWcucmlnaHQgIT0gMCAmJiBjb25maWcudG9wID09IDAgJiYgY29uZmlnLmJvdHRvbSA9PSAwKXtcbiAgICAgICAgICAgICAgdGhpcy5zdmdzW2tleV0uYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGlnaHQtbGFiZWwnKVxuICAgICAgICAgICAgICAgIC50ZXh0KGAke2NvbmZpZy5sZWZ0fSUgZnJvbSBsZWZ0JnJpZ2h0YClcbiAgICAgICAgICAgICAgICAuYXR0cigneScsIDE1KVxuICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgKGNvbmZpZy50aW1lRW5kICsgY29uZmlnLnRpbWVTdGFydCkgLyAyICogbW9kZWwuZ2V0KCd3aWR0aCcpIC8gZXhwRHVyYXRpb24pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWcubGVmdCA9PSAwICYmIGNvbmZpZy5yaWdodCA9PSAwICYmIGNvbmZpZy50b3AgIT0gMCAmJiBjb25maWcuYm90dG9tICE9IDApe1xuICAgICAgICAgICAgICB0aGlzLnN2Z3Nba2V5XS5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdjb21wb25lbnQtc3BlZWRfX2dyYXBoX19saWdodC1sYWJlbCcpXG4gICAgICAgICAgICAgICAgLnRleHQoYCR7Y29uZmlnLnRvcH0lIGZyb20gdG9wJmJvdHRvbWApXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCAxNSlcbiAgICAgICAgICAgICAgICAuYXR0cigneCcsIChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuc3Znc1trZXldLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX2xpZ2h0LWxhYmVsJylcbiAgICAgICAgICAgICAgICAudGV4dChcIm5vIGxpZ2h0XCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3knLCAxNSlcbiAgICAgICAgICAgICAgICAuYXR0cigneCcsIChjb25maWcudGltZUVuZCArIGNvbmZpZy50aW1lU3RhcnQpIC8gMiAqIG1vZGVsLmdldCgnd2lkdGgnKSAvIGV4cER1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH1cblxuICAgIHVwZGF0ZSh0aW1lc3RhbXAsIG1vZGVsKSB7XG4gICAgICBsZXQgcnVudGltZSA9IE9iamVjdC52YWx1ZXMobW9kZWwuZ2V0KCdkYXRhJykpLnJlZHVjZSgoYWNjLCB2YWwpID0+IE1hdGgubWF4KGFjYywgdmFsLnJ1blRpbWUpLCAwKTtcbiAgICAgIGZvciAobGV0IGtleSBpbiB0aGlzLnN2Z3MpIHtcbiAgICAgICAgbGV0IHRpbWViYW5kID0gdGhpcy5iZ3Nba2V5XS5zZWxlY3RBbGwoJy5jb21wb25lbnQtc3BlZWRfX2dyYXBoX190aW1lLWJhbmQnKVxuICAgICAgICAgIC5kYXRhKFt0aW1lc3RhbXBdKVxuICAgICAgICB0aW1lYmFuZC5lbnRlcigpLmFwcGVuZCgncmVjdCcpXG4gICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2NvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX3RpbWUtYmFuZCcpXG4gICAgICAgICAgLmF0dHIoJ3knLCAwKVxuICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBtb2RlbC5nZXQoJ2hlaWdodCcpKVxuICAgICAgICAgIC5tZXJnZSh0aW1lYmFuZClcbiAgICAgICAgICAudHJhbnNpdGlvbigpXG4gICAgICAgICAgICAuZHVyYXRpb24oMClcbiAgICAgICAgICAgIC5hdHRyKCd4JywgKGQpID0+IHRoaXMuc2NhbGVzLngoTWF0aC5taW4ocnVudGltZSwgTWF0aC5tYXgoMCwgZCAtIG1vZGVsLmdldCgnZFQnKSAvIDIpKSkpXG4gICAgICAgICAgICAuYXR0cignd2lkdGgnLCAoZCkgPT4gdGhpcy5zY2FsZXMueChtb2RlbC5nZXQoJ2RUJykgKyBNYXRoLm1pbigwLCBkIC0gbW9kZWwuZ2V0KCdkVCcpIC8gMikgKyBNYXRoLm1pbigwLCBydW50aW1lIC0gZCAtIG1vZGVsLmdldCgnZFQnKSAvIDIpKSlcbiAgICAgICAgdGltZWJhbmQuZXhpdCgpLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJlc2V0KCkge1xuICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuc3Zncykge1xuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5zZWxlY3RBbGwoJy5jb21wb25lbnQtc3BlZWRfX2dyYXBoX19heGlzJykucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuc3Znc1trZXldLnNlbGVjdEFsbCgnLmNvbXBvbmVudC1zcGVlZF9fZ3JhcGhfX3RpbWUtYmFuZCcpLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLnN2Z3Nba2V5XS5zZWxlY3RBbGwoJy5jb21wb25lbnQtc3BlZWRfX2dyYXBoX19zdGQnKS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5zdmdzW2tleV0uc2VsZWN0QWxsKCcuY29tcG9uZW50LXNwZWVkX19ncmFwaF9fbGluZScpLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSlcbiJdfQ==
